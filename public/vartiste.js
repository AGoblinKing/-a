/*! For license information please see vartiste-toolkit.js.LICENSE.txt */
!function(t){function e(e){for(var i,r,a=e[0],o=e[1],s=0,c=[];s<a.length;s++)r=a[s],Object.prototype.hasOwnProperty.call(n,r)&&n[r]&&c.push(n[r][0]),n[r]=0;for(i in o)Object.prototype.hasOwnProperty.call(o,i)&&(t[i]=o[i]);for(l&&l(e);c.length;)c.shift()()}var i={},n={1:0};function r(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.e=function(t){var e=[],i=n[t];if(0!==i)if(i)e.push(i[2]);else{var a=new Promise((function(e,r){i=n[t]=[e,r]}));e.push(i[2]=a);var o,s=document.createElement("script");s.charset="utf-8",s.timeout=120,r.nc&&s.setAttribute("nonce",r.nc),s.src=function(t){return r.p+""+t+".vartiste-toolkit.js"}(t);var l=new Error;o=function(e){s.onerror=s.onload=null,clearTimeout(c);var i=n[t];if(0!==i){if(i){var r=e&&("load"===e.type?"missing":e.type),a=e&&e.target&&e.target.src;l.message="Loading chunk "+t+" failed.\n("+r+": "+a+")",l.name="ChunkLoadError",l.type=r,l.request=a,i[1](l)}n[t]=void 0}};var c=setTimeout((function(){o({type:"timeout",target:s})}),12e4);s.onerror=s.onload=o,document.head.appendChild(s)}return Promise.all(e)},r.m=t,r.c=i,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(i,n,function(e){return t[e]}.bind(null,n));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r.oe=function(t){throw console.error(t),t};var a=window.webpackJsonp=window.webpackJsonp||[],o=a.push.bind(a);a.push=e,a=a.slice();for(var s=0;s<a.length;s++)e(a[s]);var l=o;r(r.s=183)}([function(t,e,i){"use strict";i.r(e),i.d(e,"MAP_FROM_FILENAME",(function(){return l})),i.d(e,"Util",(function(){return h}));var n=i(3),r=i(4),a=i(14),o=i(2);const s=i(13),l={aoMap:[/AmbientOcclusion(Map)?/i,/(\b|_)AO(map)?(\b|_)/i],displacementMap:[/(\b|_)Height(\b|_)/i,/(\b|_)Disp(lacement)?(Map)?(\b|_)/i],normalMap:[/(\b|_)norm?(al)?(map)?(gl|dx)?(\b|_)/i],emissiveMap:[/(\b|_)emi(t|tion|ssive|ss|ssion)?(map)?(\b|_)/i],metalnessMap:[/(\b|_)metal(ness|l?ic)?(map)?(\b|_)/i],roughnessMap:[/(\b|_)rough(ness)?(map)?(\b|_)/i],matcap:[/(\b|_)matcap(\b|_)/i]};function c(t,e){t.hasLoaded?e():t.addEventListener("loaded",e)}function u(t){return new Promise(((e,i)=>c(t,e)))}const h=new class{validateSize({width:t,height:e}){if(t=parseInt(t),e=parseInt(e),!(Number.isInteger(t)&&t>0))throw console.trace(),new Error(`Invalid composition width ${t}`);if(!(Number.isInteger(e)&&e>0))throw console.trace(),new Error(`Invalid composition height ${e}`);return{width:t,height:e}}whenLoaded(t,e){return Array.isArray(t)&&e?function(t,e){let i=t.map((()=>!1));for(let n=0;n<t.length;++n){let r=n;c(t[r],(()=>{i[r]=!0,i.every((t=>t))&&e()}))}}(t,e):Array.isArray(t)?async function(t){for(let e of t)await u(e)}(t):e?c(t,e):u(t)}applyMatrix(t,e){e.matrix.copy(t),t.decompose(e.position,e.rotation,e.scale)}cloneCanvas(t,e){return void 0===e&&(e=document.createElement("canvas")),e.width=t.width,e.height=t.height,e.getContext("2d").drawImage(t,0,0),e}ensureSize(t,e,i){t.width===e&&t.height===i||(t.width=e,t.height=i)}positionObject3DAtTarget(t,e,{scale:i,transformOffset:n,transformRoot:r}={}){void 0===r&&(r=t.parent),e.updateMatrixWorld();let a=this.pool("dest",THREE.Matrix4);if(a.copy(e.matrixWorld),n){let t=this.pool("transformMat",THREE.Matrix4);t.makeTranslation(n.x,n.y,n.z),a.multiply(t)}if(i){let t=this.pool("scale",THREE.Vector3);t.setFromMatrixScale(a),t.set(i.x/t.x,i.y/t.y,i.z/t.z),a.scale(t)}let o=this.pool("inv",THREE.Matrix4);r.updateMatrixWorld(),o.copy(r.matrixWorld).invert(),a.premultiply(o),h.applyMatrix(a,t)}keepingWorldPosition(t,e){let i=this.pool("positioner",THREE.Object3D);t.el.sceneEl.object3D.add(i);let n=new THREE.Matrix4;n.copy(t.matrixWorld);let r=e();return r&&"function"==typeof r.then?r.then((()=>{h.applyMatrix(n,i),h.positionObject3DAtTarget(t,i)})):(h.applyMatrix(n,i),h.positionObject3DAtTarget(t,i),r)}autoScaleViewer(t,e){let i=this.pool("boundingBox",THREE.Box3),n=this.pool("tmpBox",THREE.Box3),r=t.getObjectByProperty("type","Mesh")||t.getObjectByProperty("type","SkinnedMesh");t.updateMatrixWorld(),r.geometry.computeBoundingBox(),i.copy(r.geometry.boundingBox),r.updateMatrixWorld(),i.applyMatrix4(r.matrixWorld),t.traverse((t=>{t.geometry&&(t.geometry.computeBoundingBox(),t.updateMatrixWorld(),n.copy(t.geometry.boundingBox),n.applyMatrix4(t.matrixWorld),i.union(n))}));let a=.5/Math.max(i.max.x-i.min.x,i.max.y-i.min.y,i.max.z-i.min.z);e.setAttribute("scale",`${a} ${a} ${a}`),i.getCenter(e.object3D.position),e.object3D.position.multiplyScalar(-a),e.object3D.position.z=i.min.z*a}cameraObject3D(){let t=AFRAME.scenes[0],e=AFRAME.scenes[0].camera.el;return t.is("vr-mode")&&document.querySelector("a-scene").hasWebXR?e.getObject3D("camera-matrix-helper"):e.object3D}flyToCamera(t,{propogate:e=!0,...i}={}){let n=this.cameraObject3D(),r=t;for(;e&&r["redirect-grab"];)r=r["redirect-grab"];this.positionObject3DAtTarget(r.object3D,n,{transformOffset:{x:0,y:0,z:-.5},...i})}registerComponentSystem(t,e){AFRAME.registerComponent(t,e),AFRAME.registerSystem("_"+t,{init(){this.el.sceneEl.setAttribute(t,""),this.el.sceneEl.systems[t]=this.el.sceneEl.components[t]}})}traverseAncestors(t,e){for(t=t.parentEl;t;)e(t),t=t.parentEl}traverseFindAncestor(t,e){for(t=t.parentEl;t;){if(e(t))return t;t=t.parentEl}}traverseFind(t,e,{visibleOnly:i=!1}={}){if(e(t))return t;for(let n of t.children){if(i&&!n.visible)continue;let t=this.traverseFind(n,e,{visibleOnly:i});if(t)return t}}traverseFindAll(t,e,{outputArray:i=[],visibleOnly:n=!1}={}){e(t)&&i.push(t);for(let r of t.children)n&&!r.visible||this.traverseFindAll(r,e,{outputArray:i,visibleOnly:n});return i}visibleWithAncestors(t){if(!t.visible)return!1;for(;t.parent;)if(!(t=t.parent).visible)return!1;return!0}recursiveDispose(t){t.object3D&&(t=t.object3D),t.traverse((t=>{if(t.material){for(let e of o.THREED_MODES)t.material[e]&&t.material[e].dispose&&t.material[e].dispose();t.material.dispose&&t.material.dispose()}t.geometry&&t.geometry.dispose()}))}titleCase(t){return t.replace(/\w\S*/g,(t=>t.charAt(0).toUpperCase()+t.substr(1)))}unenumerable(t,e){}debugCanvas(t){document.querySelector("a-scene").systems["settings-system"].download(t.toDataURL(),{extension:"png",suffix:"debug"},"Debug Image")}divideCanvasRegions(t,{margin:e=0}={}){let i=1,n=1;for(;i*n<t;)n>i?i++:n++;let r=[];for(let t=0;t<i;++t)for(let a=0;a<n;++a){let o=new THREE.Box2(new THREE.Vector2(a/n,t/i),new THREE.Vector2((a+1)/n,(t+1)/i));o.expandByScalar(-e),r.push(o)}return r}uvWrapClamp(t){return t%=1}applyUVBox(t,e){let i=e.attributes.uv;if(i.data)for(let e=0;e<i.count;++e)i.setXY(e,THREE.Math.mapLinear(i.getX(e)%1.00000000000001,0,1,t.min.x,t.max.x),THREE.Math.mapLinear(i.getY(e)%1.00000000000001,0,1,t.min.y,t.max.y));else{let n={has:function(){return!0}};e.index&&(n=new Set(e.index.array));for(let r in e.attributes.uv.array)n.has(Math.floor(r/2))&&(i.array[r]=r%2==0?THREE.Math.mapLinear(i.array[r]%1.00000000000001,0,1,t.min.x,t.max.x):THREE.Math.mapLinear(i.array[r]%1.00000000000001,0,1,t.min.y,t.max.y))}return i.needsUpdate=!0,e}resolveGrabRedirection(t){let e=t;for(let i=t["redirect-grab"];i;i=e["redirect-grab"])e=i;return e}deinterleaveAttributes(t){for(let e in t.attributes){let i=t.attributes[e];if(!i)continue;if(!i.isInterleavedBufferAttribute)continue;let n=[];console.log(e,i);for(let t=0;t<i.count;++t)n.push(i.getX(t)),i.itemSize>=2&&n.push(i.getY(t)),i.itemSize>=3&&n.push(i.getZ(t)),i.itemSize>=4&&n.push(i.getW(t));t.setAttribute(e,new THREE.Float32BufferAttribute(n,i.itemSize))}}interpTransformMatrices(t,e,i,{result:n}={}){n||(n=new THREE.Matrix4);let r=this.pool("startPose",THREE.Vector3),a=this.pool("endPose",THREE.Vector3),o=this.pool("startQuat",THREE.Quaternion),s=this.pool("endQuat",THREE.Quaternion),l=this.pool("startScale",THREE.Vector3),c=this.pool("endScale",THREE.Vector3);return e.decompose(r,o,l),i.decompose(a,s,c),r.lerp(a,t),o.slerp(s,t),l.lerp(c,t),n.compose(r,o,l),n}isCanvasFullyOpaque(t,e=255){let i=t.getContext("2d").getImageData(0,0,t.width,t.height);for(let t=3;t<i.data.length;t+=4)if(i.data[t]<e)return!1;return!0}isCanvasFullyTransparent(t){let e=t.getContext("2d").getImageData(0,0,t.width,t.height);for(let t=3;t<e.data.length;t+=4)if(e.data[t]>0)return!1;return!0}autoCropBounds(t){let e=t.getContext("2d").getImageData(0,0,t.width,t.height),i=new THREE.Box2,n=new THREE.Box2;for(let r=0;r<t.height;++r)for(let a=0;a<t.width;++a)e.data[4*(r*t.width+a)+3]>0&&(n.min.set(a,r),n.max.set(a+1,r+1),i.union(n));return i}autoCropCanvas(t){let e=this.autoCropBounds(t),i=document.createElement("canvas"),n=new THREE.Vector2;return e.getSize(n),i.width=n.x,i.height=n.y,i.getContext("2d").drawImage(t,e.min.x,e.min.y,n.x,n.y,0,0,n.x,n.y),i}callLater(t=function(){}){return new Promise(((e,i)=>{window.setTimeout((()=>{t(),e()}),1)}))}mapFromFilename(t){for(let e in l)if(l[e].some((e=>e.test(t))))return e}fillDefaultCanvasForMap(t,e,{replace:i=!1}={}){let n=!1,a=t.getContext("2d");switch(e){case"normalMap":a.fillStyle="rgb(128, 128, 255)",n=!0;break;case"metalnessMap":a.fillStyle="rgb(0, 0, 0)",n=!0;break;case"roughnessMap":a.fillStyle="rgb(255, 255, 255)",n=!0;break;case"bumpMap":a.fillStyle="rgb(0, 0, 0)",n=!0;break;case"aoMap":a.fillStyle="rgb(255, 255, 255)",n=!0;break;case"emissiveMap":a.fillStyle="rgb(0, 0, 0)",n=!0;break;default:console.warn("Can't fill unknown map",e)}return n&&(r.Undo.pushCanvas(t),a.globalCompositeOperation=i?"source-over":"destination-over",a.fillRect(0,0,a.canvas.width,a.canvas.height),a.globalCompositeOperation="source-over"),n}whenComponentInitialized(t,e,i){return t&&t.components[e]&&t.components[e].initialized?Promise.resolve(i?i():void 0):new Promise(((n,r)=>{if(t&&t.components[e]&&t.components[e].initialized)return Promise.resolve(i?i():void 0);let a=r=>{r.detail.name===e&&(t.removeEventListener("componentinitialized",a),i&&i(),n())};t.addEventListener("componentinitialized",a)}))}recursiveBoundingBox(t,{box:e}={}){let i=e||this.pool("boundingBox",THREE.Box3),n=this.pool("tmpBox",THREE.Box3),r=t.getObjectByProperty("type","Mesh")||t.getObjectByProperty("type","SkinnedMesh");return t.updateMatrixWorld(),r.geometry.computeBoundingBox(),i.copy(r.geometry.boundingBox),r.updateMatrixWorld(),i.applyMatrix4(r.matrixWorld),t.traverse((t=>{t.geometry&&(t.geometry.computeBoundingBox(),t.updateMatrixWorld(),n.copy(t.geometry.boundingBox),n.applyMatrix4(t.matrixWorld),i.union(n))})),i}emitsEvents(t){t.emitDetails=AFRAME.utils.clone(Object.getPrototypeOf(t).emits)}async busy(t,e){let i=AFRAME.scenes[0].systems["busy-indicator"].busy(e);try{await t(),i.done()}catch(t){throw i.error(t),t}}busify(t,e,i){let n=AFRAME.scenes[0];return async function(...r){let a=n.systems["busy-indicator"].busy(t);try{await e.call(i,...r),a.done()}catch(t){throw a.error(t),t}}}async delay(t){return new Promise((e=>setTimeout(e,t)))}isLowPower(){let t=AFRAME.utils.device.isMobileVR(),e=new URLSearchParams(document.location.search);return e.get("lowPower")&&(t=!0),e.get("highPower")&&(t=!1),t}meshPointsInContainerMesh(t,e){"Mesh"===t.type&&"Mesh"===e.type||console.warn("meshPointsInContainerMesh only works on meshes!",t,e);const i=new THREE.Matrix4;i.copy(t.matrixWorld).invert(),e.geometry.computeBoundingSphere();const n=new THREE.Sphere;e.getWorldPosition(n.center).applyMatrix4(i),n.radius=e.geometry.boundingSphere.radius;let r=new THREE.Matrix4;r.copy(e.matrixWorld).invert(),r.premultiply(t.matrixWorld);let o=t.geometry.computeBoundsTree(),s=(e.geometry.computeBoundsTree(),[]),l=new THREE.Vector3,c=t.geometry.index.array,u=new THREE.Raycaster;u.ray.direction.set(1,.1,0);let h=e.material.side;return e.material.side=THREE.DoubleSide,o.shapecast(t,{intersectsBounds:t=>{const e=n.intersectsBox(t),{min:i,max:r}=t;if(e){for(let t=0;t<=1;t++)for(let e=0;e<=1;e++)for(let o=0;o<=1;o++)if(l.set(0===t?i.x:r.x,0===e?i.y:r.y,0===o?i.z:r.z),!n.containsPoint(l))return a.INTERSECTED;return a.CONTAINED}return e?a.INTERSECTED:a.NOT_INTERSECTED},intersectsTriangle:(i,r,a)=>{if(a||i.intersectsSphere(n)){const n=3*r;u.ray.origin.copy(i.a),t.localToWorld(u.ray.origin);let a=[];u.intersectObject(e,!1,a),a.length%2==1&&s.push(c[n]),a.length=0,u.ray.origin.copy(i.b),t.localToWorld(u.ray.origin),u.intersectObject(e,!1,a),a.length%2==1&&s.push(c[n+1]),a.length=0,u.ray.origin.copy(i.c),t.localToWorld(u.ray.origin),u.intersectObject(e,!1,a),a.length%2==1&&s.push(c[n+2])}return!1}}),e.material.side=h,s}meshesIntersect(t,e,i=!1){let n;if(3!==t.geometry.attributes.position.itemSize)return;if(3!==e.geometry.attributes.position.itemSize)return;n=t.geometry.computeBoundsTree(),e.geometry.computeBoundsTree();let r=this.pool("matrix",THREE.Matrix4);if(t.updateMatrixWorld(),e.updateMatrixWorld(),r.copy(t.matrixWorld),r.invert(),r.multiply(e.matrixWorld),n.intersectsGeometry(t,e.geometry,r))return!0;if(!i)return!1;let a=this.pool("tmpBox",THREE.Box3);if(a.copy(e.geometry.boundingBox),a.applyMatrix4(r),!a.intersectsBox(t.geometry.boundingBox))return!1;let o=[],s=this.pool("raycaster",THREE.Raycaster);s.ray.direction.set(1,.1,0);let l=t.material.side;return t.material.side=THREE.DoubleSide,s.ray.origin.fromBufferAttribute(e.geometry.attributes.position,0),e.localToWorld(s.ray.origin),s.intersectObject(t,!1,o),t.material.side=l,o.length%2==1||(o.length=0,l=e.material.side,e.material.side=THREE.DoubleSide,s.ray.origin.fromBufferAttribute(t.geometry.attributes.position,0),t.localToWorld(s.ray.origin),s.intersectObject(e,!1,o),e.material.side=l,o.length%2==1)}objectsIntersect(t,e,{visibleOnly:i=!0,intersectionInfo:n,includeContained:r=!0}={}){t.object3D&&(t=t.object3D),e.object3D&&(e=e.object3D);let a=!1;return t.traverseVisible((t=>{a||t.isMesh&&(i&&t.el&&t.el.className.includes("raycast-invisible")||i&&!t.visible||e.traverseVisible((e=>{a||e.isMesh&&(i&&!e.visible||i&&e.el&&e.el.className.includes("raycast-invisible")||this.meshesIntersect(t,e,r)&&(n&&(n.objectA=t,n.objectB=e),a=!0))})))})),a}translate(t){return this.el.sceneEl.systems["ui-translation"]?this.el.sceneEl.systems["ui-translation"].translate(t):t}};n.Pool.init(h),window.VARTISTE={Util:h,Color:s},AFRAME.registerSystem("vartiste-util",{init(){h.el=this.el.sceneEl}})},function(t,e,i){"use strict";i.r(e),i.d(e,"Brush",(function(){return Brush})),i.d(e,"ProceduralBrush",(function(){return brush_ProceduralBrush})),i.d(e,"ImageBrush",(function(){return brush_ImageBrush})),i.d(e,"LambdaBrush",(function(){return LambdaBrush})),i.d(e,"FillBrush",(function(){return FillBrush})),i.d(e,"NoiseBrush",(function(){return NoiseBrush})),i.d(e,"FxBrush",(function(){return brush_FxBrush})),i.d(e,"LineBrush",(function(){return brush_LineBrush})),i.d(e,"StretchBrush",(function(){return brush_StretchBrush})),i.d(e,"VectorBrush",(function(){return brush_VectorBrush})),i.d(e,"FillShapeBrush",(function(){return FillShapeBrush})),i.d(e,"FloodFillBrush",(function(){return brush_FloodFillBrush}));var n=i(177),r=i.n(n),a=i(13),o=i.n(a),s=i(10),l=i(0),c=i(3);const u={getBlobOutlinePoints:function(t,e,i=0,n=0,r=null){if(t instanceof HTMLCanvasElement){e=t.width,i=t.height;const n=t.getContext("2d").getImageData(0,0,e,i).data,r=e*i,a=new Uint8Array(r);for(let t=0;t<r;++t)a[t]=n[4*t+3];t=a}else 0==i&&(i=t.length/e|0);return null===(r=u.getFirstNonTransparentPixelTopDown(t,e,i,n))?(console.log("[Warning] Marching Squares could not find an object in the given array"),[]):u.walkPerimeter(t,e,i,r.w,r.h,n)},getFirstNonTransparentPixelTopDown:function(t,e,i,n=0){let r;for(let a=0;a<i;++a){r=a*e|0;for(let i=0;i<e;++i){if(t[r]>n)return{w:i,h:a};++r}}return null},walkPerimeter:function(t,e,i,n,r,a=0){e|=0,i|=0;const o=[],s=u.step;let l,c=0,h=n,d=r;do{switch(c=(d-1)*e+(h-1),l=s(c,t,e,a),h>=0&&h<e&&d>=0&&d<i&&o.push(h-1,d),l){case 1:--d;break;case 2:--h;break;case 3:++d;break;case 4:++h}}while(h!=n||d!=r);return o.push(h,d),o},step:function(t,e,i,n=0){let r=0;switch(0<e[t+1]-n&&(r|=1),0<e[t+2]-n&&(r|=2),0<e[t+i+1]-n&&(r|=4),0<e[t+i+2]-n&&(r|=8),r){case 1:u.next_step=1;break;case 2:case 3:u.next_step=4;break;case 4:u.next_step=2;break;case 5:u.next_step=1;break;case 6:1==u.next_step?u.next_step=2:u.next_step=4;break;case 7:u.next_step=4;break;case 8:u.next_step=3;break;case 9:4==u.next_step?u.next_step=1:u.next_step=3;break;case 10:case 11:u.next_step=3;break;case 12:u.next_step=2;break;case 13:u.next_step=1;break;case 14:u.next_step=2;break;default:u.next_step=0}return u.next_step}};class Brush{static schema(){return{baseid:{type:"string"},user:{default:!1},color:{type:"color",default:"black"},opacity:{default:1},scale:{default:1},tooltip:{type:"string"},hidden:{default:!1}}}constructor(t){this.ignoredAttributes=[],this.baseid=t,this.storableAttributes=["baseid","color","opacity","scale","user"],this.unenumerableAttrs={}}unenumerable(t){this.unenumerableAttrs[t]=!0}clone(){return Object.assign(Object.create(Object.getPrototypeOf(this)),this)}store(){let t={};for(let e of this.storableAttributes)t[e]=this[e];return t}static fromStore(t,e){let i=e.find((e=>e.baseid===t.baseid));if(!i)throw new Error("Can't find brush for serialized brush",t);return i=Object.assign(i.clone(),t),i.changeScale(t.scale),i.changeColor(t.color),i.changeOpacity(t.opacity),i}fullStore(){let t={_class:this.constructor.name},e=this.constructor.schema();for(let i in e)i in this&&("store"in e[i]?t[i]=e[i].store.call(this,this[i]):t[i]=this[i]);return t}static fullRestore(t){let e=h[t._class],i={},n=e.schema();for(let e in n)e in t?"restore"in n[e]?i[e]=n[e].restore(t[e]):i[e]=t[e]:i[e]=n[e].default;return new e(i)}}window.Brush=Brush;class brush_ProceduralBrush extends Brush{static schema(){return Object.assign({width:{default:20},height:{default:20},baseWidth:{default:20},baseHeight:{default:20},distanceBased:{default:!1},maxDistance:{default:1.5},connected:{default:!1},autoRotate:{default:!1},dragRotate:{default:!1},hqBlending:{default:!1},drawEdges:{default:!1},invertScale:{default:!1},minMovement:{type:"float",default:void 0},mode:{default:"source-over"}},super.schema())}constructor(t,{width:e=20,height:n=20,distanceBased:r=!1,maxDistance:a=1.5,connected:o=!1,autoRotate:l=!1,dragRotate:c=!1,hqBlending:u=!1,drawEdges:h=!1,invertScale:d=!1,minMovement:p,tooltip:f,user:m=!1,hidden:g=!1,mode:y="source-over",...b}={}){super(t),this.baseWidth=e,this.baseHeight=n,this.width=e,this.height=n,this.scale=1,this.opacity=1,this.options=b,this.distanceBased=r,this.maxDistance=a,this.connected=o,this.autoRotate=l,this.hqBlending=u,this.drawEdges=h,this.dragRotate=c,this.invertScale=d,this.minMovement=p,this.tooltip=f,this.user=m,this.mode=y,this.hidden=g;let A=document.createElement("canvas");A.width=e,A.height=n,this.overlayCanvas=A,this.unenumerable("overlayCanvas"),this.hqBlending&&(this.hqBlender=new s.CanvasShaderProcessor({source:i(40)}),this.unenumerable("hqBlender")),this.color3=new THREE.Color,this.unenumerable("color3"),this.unenumerable("ccolor"),this.unenumerable("brushdata"),this.changeColor("#FFF")}clone(){let t=super.clone();return t.overlayCanvas=l.Util.cloneCanvas(this.overlayCanvas),t.hqBlending&&(t.hqBlender=new s.CanvasShaderProcessor({source:i(40)})),console.log("Returning cloned brush"),t}changeColor(t){this.color=t,this.color3.set(this.color),this.ccolor=o()(t),this.updateBrush()}changeScale(t){this.scale=t,this.width=this.baseWidth*t,this.height=this.baseHeight*t,this.overlayCanvas.width=Math.max(this.width,1),this.overlayCanvas.height=Math.max(this.height,1),this.updateBrush()}changeOpacity(t){this.opacity=t}createBrush(){if(this.invalid)return;let t=this.overlayCanvas.getContext("2d"),e=this.width,i=this.height;t.clearRect(0,0,e,i);let{innerRadius:n=2}=this.options;const{outerRadius:r=e/2}=this.options;this.options.hardness&&(n=e/2*this.options.hardness);let a=e/2,o=i/2,s=this.color3,l=t.createRadialGradient(a,o,n,a,o,r);l.addColorStop(0,`rgba(${255*s.r}, ${255*s.g}, ${255*s.b}, 1)`),l.addColorStop(1,`rgba(${255*s.r}, ${255*s.g}, ${255*s.b}, 0.0)`),t.fillStyle=l,t.fillRect(0,0,e,i)}updateBrush(){if(this.invalid)return;this.createBrush();let t=this.overlayCanvas.getContext("2d"),{width:e,height:i}=this;e<=1||i<=1||t.canvas.width<=1||t.canvas.height<=1||(this.hqBlending&&(this.brushData=t.getImageData(0,0,e,i)),this.previewSrc||(this.previewSrc=this.overlayCanvas.toDataURL()),this.createOutline(this.overlayCanvas),this.brushData=t.getImageData(0,0,e,i),this.hqBlending&&Object.keys(this.hqBlender.textures).length>0&&this.hqBlender.setCanvasAttribute("u_brush",this.overlayCanvas))}createOutline(t){if(!this.drawEdges)return;let{width:e,height:i}=t;this.outlineCanvas=this.outlineCanvas||document.createElement("canvas"),this.outlineCanvas.width=e,this.outlineCanvas.height=i;let n=this.outlineCanvas.getContext("2d");n.drawImage(t,1,1,e-2,i-2),n.globalCompositeOperation="source-in",n.fillStyle="#fff",n.fillRect(0,0,e,i);r()([[-1,-1,-1],[-1,8.01,-1],[-1,-1,-1]]).canvas(this.outlineCanvas)}carry(t,e){let i=THREE.Math.clamp(255*this.color3[e]+t[e],0,254.4),n=Math.round(i);return t[e]=i-n,n}drawTo(t,e,i,n={}){if(this.invalid)return;let{rotation:r=0,pressure:a=1,distance:o=0,eraser:s=!1,scale:l=1,hqBlending:c=!1}=n;if(this.invertScale&&(l=1.1-l,a*=a),this.hqBlending&&c&&!s)this.hqBlender.drawBrush(this,t,e,i,{reupdate:!1,...n,scale:l});else{if(t.save(),s||(t.globalCompositeOperation=this.mode),this.distanceBased?t.globalAlpha=Math.max(0,(this.maxDistance-o)/this.maxDistance):t.globalAlpha=a,t.globalAlpha*=this.opacity,t.translate(e,i),this.distanceBased){let e=2*t.globalAlpha;t.scale(1/e,1/e)}t.scale(l,l),t.rotate(this.autoRotate?2*Math.PI*Math.random():r),t.drawImage(this.overlayCanvas,-this.width/2,-this.height/2),t.restore()}}drawOutline(t,e,i,{distance:n=0,rotation:r=0}={}){if(this.invalid)return;const a=this.width,o=this.height;t.globalAlpha;if(this.distanceBased&&(t.globalAlpha=Math.max(0,(this.maxDistance-n)/this.maxDistance)),this.drawEdges)return t.save(),t.translate(e,i),t.rotate(r),this.outlineCanvas&&a>0&&o>0&&t.drawImage(this.outlineCanvas,-a/2,-o/2,a,o),t.beginPath(),t.strokeStyle="#FFFFFF",t.rect(-a/2,-o/2,a,o),t.stroke(),void t.restore();t.beginPath(),t.arc(e,i,a/3,0,2*Math.PI,!1),t.strokeStyle="#FFFFFF",t.stroke()}}class brush_ImageBrush extends brush_ProceduralBrush{static schema(){return Object.assign({textured:{default:!1},image:{type:"map",store:t=>t.src.startsWith("blob:")||t.src.startsWith("http")?l.Util.cloneCanvas(t).toDataURL():t.src,restore:t=>{let e=new Image;return e.src=t,e}}},super.schema())}constructor(t,e,n={}){let r;void 0===e?(t=(n=t).baseid,e=n.name,r=n.image):e instanceof Image?(r=e,e=t):r="width"in n&&"height"in n?new Image(n.width,n.height):new Image;try{if(r.decoding="sync",r.loading="eager",!r.src){let t=i(164)(`./${e}.png`);t.startsWith("brushes/")&&window.VARTISTE_TOOLKIT_URL&&(t=`${VARTISTE_TOOLKIT_URL}/${t}`),r.src=t}let a,o;"width"in n&&"height"in n?(a=n.width,o=n.height):(a=r.width,o=r.height),super(t,Object.assign({drawEdges:!0},n,{width:a,height:o})),n.tooltip||(this.tooltip=l.Util.titleCase(e.replace(/[\_\-\.]/g," "))),this.textured=n.textured,this.image=r,this.previewSrc=r,this.image.decode().then((()=>this.updateBrush())).catch((t=>{console.warn("Couldn't decode brush image",t),this.invalid=!0}))}catch(e){console.warn("Couldn't load brush",e),super(t,{}),this.invalid=!0}}createBrush(){if(!this.image)return;if(!this.image.complete)return;if(this.invalid)return;let t=this.overlayCanvas.getContext("2d");const e=this.width,i=this.height;t.clearRect(0,0,e,i),t.save(),t.drawImage(this.image,0,0,e,i),t.globalCompositeOperation="source-in",t.fillStyle=this.color,t.fillRect(0,0,e,i),this.options.textured&&(t.globalCompositeOperation="multiply",t.drawImage(this.image,0,0,e,i)),t.restore()}}class LambdaBrush extends brush_ProceduralBrush{constructor(t,e={},i){super(t,e),this.lambda=i,this.previewSrc=void 0,this.updateBrush()}createBrush(){if(!this.lambda)return;let t=this.overlayCanvas.getContext("2d");const e=this.width,i=this.height;t.clearRect(0,0,e,i),t.fillStyle=this.color,t.strokeStyle=this.color,this.lambda(t,{width:e,height:i}),this.previewSrc||(this.previewSrc=this.overlayCanvas.toDataURL())}}class FillBrush extends Brush{constructor(t,{mode:e="source-over",previewSrc:n,tooltip:r}={}){super(t),this.previewSrc=n||i(36),this.mode=e,this.hqBlending=!1,this.width=48,this.height=48,this.tooltip=r||`Fill ${e}`}changeColor(t){this.color=t}changeScale(){}changeOpacity(t){this.opacity=t}drawTo(t,e,i,{rotation:n=0,pressure:r=1}={}){let a=t.globalAlpha,o=t.fillStyle,s=t.globalCompositeOperation;t.globalAlpha=r*this.opacity,t.fillStyle=this.color,t.globalCompositeOperation=this.mode,t.fillRect(0,0,t.canvas.width,t.canvas.height),t.globalAlpha=a,t.fillStyle=o,t.globalCompositeOperation=s}drawOutline(t,e,i){t.beginPath(),t.moveTo(0,0),t.lineTo(t.canvas.width,t.canvas.height),t.moveTo(t.canvas.width,0),t.lineTo(0,t.canvas.height),t.strokeStyle="#FFF",t.stroke()}}class NoiseBrush extends brush_ProceduralBrush{constructor(t,{rainbow:e=!1,lightness:i=!0,opacityness:n=!1,round:r=!1,tooltip:a,...o}={}){super(t,o),this.superInitialized,this.rainbow=e,this.lightness=i,this.opacityness=n,this.round=r,this.previewSrc=void 0,this.tooltip=a||"Noise",this.updateBrush()}createBrush(){let t=this.overlayCanvas.getContext("2d"),{width:e,height:i}=this;e=Math.floor(e),i=Math.floor(i),t.clearRect(0,0,e,i),this.brushData=t.getImageData(0,0,e,i);let n=this.ccolor.hsl(),r=this.ccolor,a=e/2;for(let t=0;t<i;++t)for(let i=0;i<e;++i){if(this.rainbow)this.brushData.data[4*(t*e+i)+0]=THREE.Math.randInt(0,255),this.brushData.data[4*(t*e+i)+1]=THREE.Math.randInt(0,255),this.brushData.data[4*(t*e+i)+2]=THREE.Math.randInt(0,255);else if(this.lightness){let a=n.lightness();r=n.lightness(THREE.Math.randInt(a-a*this.opacity,a*this.opacity)),this.brushData.data[4*(t*e+i)+0]=r.red(),this.brushData.data[4*(t*e+i)+1]=r.green(),this.brushData.data[4*(t*e+i)+2]=r.blue()}else this.brushData.data[4*(t*e+i)+0]=r.red(),this.brushData.data[4*(t*e+i)+1]=r.green(),this.brushData.data[4*(t*e+i)+2]=r.blue();this.opacityness?this.brushData.data[4*(t*e+i)+3]=THREE.Math.randInt(0,255):this.brushData.data[4*(t*e+i)+3]=255,this.round&&(this.brushData.data[4*(t*e+i)+3]=Math.round(255*(1-Math.sqrt((i-e/2)*(i-e/2)+(t-e/2)*(t-e/2))/a)))}t.putImageData(this.brushData,0,0)}drawTo(...t){this.createBrush(),super.drawTo(...t)}}class brush_FxBrush extends Brush{static schema(){return Object.assign({baseBrush:{type:"brush",store:t=>t.fullStore(),restore:t=>Brush.fullRestore(t)},type:{default:"blur"}},super.schema())}constructor(t,e){super(t),void 0===e&&(t=(e=t).baseid);let{baseBrush:n,type:r,previewSrc:a,dragRotate:o=!1,tooltip:c}=e;this.baseBrush=n,this.dragRotate=o,this.type=r,this.fx=new s.CanvasShaderProcessor({source:i(332)(`./${r}.glsl`)}),this.tooltip=c||(n.tooltip?`${n.tooltip} (${r})`:l.Util.titleCase(r));for(let t of["changeColor","changeScale","changeOpacity","drawOutline"])this[t]=this.baseBrush[t].bind(this.baseBrush);this.baseUpdate=this.baseBrush.updateBrush.bind(this.baseBrush),this.baseBrush.updateBrush=this.updateBrush.bind(this),this.previewSrc=a||this.baseBrush.previewSrc}get width(){return this.baseBrush.width}get height(){return this.baseBrush.height}clone(){let t=super.clone(),e=this.baseBrush.clone();t.baseBrush=e,t.fx=new s.CanvasShaderProcessor({source:this.fx.source});for(let e of["changeColor","changeScale","changeOpacity","drawOutline"])t[e]=t.baseBrush[e].bind(t.baseBrush);return t.baseUpdate=Object.getPrototypeOf(this.baseBrush).updateBrush.bind(t.baseBrush),t.baseBrush.updateBrush=t.updateBrush.bind(t),t}store(){let t=super.store();for(let e of this.storableAttributes.filter((t=>"baseid"!==t)))t[e]=this.baseBrush[e];return t}updateBrush(){this.baseUpdate(),this.fx.setCanvasAttribute("u_brush",this.baseBrush.overlayCanvas)}drawTo(t,e,i,n){this.fx.drawBrush(this.baseBrush,t,e,i,n)}}class brush_LineBrush extends Brush{constructor(t,{tooltip:e,mode:i="source-over",previewSrc:n}={}){if(super(t),this.scale=1,this.opacity=1,this.tooltip=e,this.outlineScale=1,this.mode=i,n)this.previewSrc=n;else{let t=document.createElement("canvas");t.width=32,t.height=32;let e=t.getContext("2d");e.strokeStyle="#FFF",e.beginPath(),e.moveTo(0,16),e.lineTo(32,16),e.lineWidth=3,e.stroke(),this.previewSrc=t.toDataURL()}this.unenumerable("color3"),this.unenumerable("ccolor"),this.unenumerable("brushdata"),this.changeColor("#FFF"),this.lineData={}}changeColor(t){this.color=t,this.color3=new THREE.Color(this.color),this.ccolor=o()(t)}changeScale(t){this.scale=t}changeOpacity(t){this.opacity=t}drawTo(t,e,i,n={}){this.lineData.endPoint={x:e,y:i}}startDrawing(t,e,i){this.solo=!0,this.lineData.startPoint={x:e,y:i}}endDrawing(t){this.solo=!1,!this.lineData.startPoint&&this.lineData.endPoint||(t.save(),t.globalCompositeOperation=this.mode,t.beginPath(),t.moveTo(this.lineData.startPoint.x,this.lineData.startPoint.y),t.lineTo(this.lineData.endPoint.x,this.lineData.endPoint.y),t.strokeStyle=this.color,t.globalAlpha*=this.opacity,t.lineWidth=this.scale,t.stroke(),t.restore(),this.lineData={})}drawOutline(t,e,i){if(t.beginPath(),!this.lineData.startPoint||!this.lineData.endPoint)return t.beginPath(),t.arc(e,i,this.scale*this.outlineScale,0,2*Math.PI,!1),t.strokeStyle="#FFFFFF",void t.stroke();if(t.beginPath(),this.lineData.allPoints){t.moveTo(this.lineData.startPoint.x,this.lineData.startPoint.y);for(let e of this.lineData.allPoints)t.lineTo(e.x,e.y)}else t.moveTo(this.lineData.startPoint.x,this.lineData.startPoint.y),t.lineTo(this.lineData.endPoint.x,this.lineData.endPoint.y);t.strokeStyle="#FFFFFF",t.lineWidth=this.scale,t.stroke()}}class brush_StretchBrush extends brush_LineBrush{static schema(){return Object.assign({switchbackAngle:{default:140},textured:{default:!1},width:{default:48},height:{default:48},mode:{default:"source-over"},image:{type:"map",store:t=>t.src,restore:t=>{let e=new Image;return e.src=t,e}}},super.schema())}constructor(t,e,{switchbackAngle:n=140,user:r=!1,...a}={}){let o;void 0===e&&(t=(a=t).baseid,e=a.name,o=a.image),super(t,a),this.user=a.user;let{textured:l}=a;this.switchbackAngle=n,o||(e instanceof Image||e instanceof HTMLCanvasElement?(o=e,e=a.name):o=new Image),this.width=a.width,this.height=a.height,this.outlineScale=5,o.decoding="sync",o.loading="eager",o.src||o.getCont||(o.src=i(164)(`./${e}.png`)),this.image=o,this.previewSrc=o,this.image.decode().then((()=>this.updateBrush())),this.textured=l,this.uvStretcher=new s.UVStretcher({fx:l?"uv-stretch-textured":"uv-stretch"}),this.lineData.allPoints=[],c.Pool.init(this)}updateBrush(){this.uvStretcher.setInputCanvas(this.image,{resize:!1}),this.uvStretcher.setUniform("u_color","uniform3fv",this.color3.clone().convertLinearToSRGB().toArray())}drawTo(t,e,i,{scale:n=1,pressure:r=1}={}){if(!this.lineData.endPoint||Math.abs(this.lineData.endPoint-e)>1||Math.abs(this.lineData.endPoint.y-i)>1){if(this.lineData.allPoints.length>2){let n=this.pool("oldVec",THREE.Vector3),r=this.pool("newVec",THREE.Vector3),a=this.lineData.allPoints.length;n.set(this.lineData.allPoints[a-1].x-this.lineData.allPoints[a-2].x,this.lineData.allPoints[a-1].y-this.lineData.allPoints[a-2].y,0),r.set(e-this.lineData.allPoints[a-1].x,i-this.lineData.allPoints[a-1].y,0),n.normalize(),r.normalize();let o=180*n.angleTo(r)/Math.PI;(o>this.switchbackAngle||o<-this.switchbackAngle)&&(this.endDrawing(t),this.startDrawing(t,e,i))}this.lineData.endPoint={x:e,y:i},this.lineData.allPoints.push({x:e,y:i,scale:this.scale*n,opacity:r})}}startDrawing(t,e,i){this.lineData.startPoint={x:e,y:i},this.solo=!0,this.direct=!0,this.uvStretcher.canvas.width===2*t.canvas.width&&this.uvStretcher.canvas.height===2*t.canvas.height||(this.uvStretcher.canvas.width=2*t.canvas.width,this.uvStretcher.canvas.height=2*t.canvas.height),this.updateBrush()}endDrawing(t){if(this.solo=!1,this.direct=!1,this.lineData.allPoints.length<2)return this.lineData.allPoints.length=0,void(this.lineData.endPoint=void 0);for(let e of this.lineData.allPoints)e.x/=t.canvas.width,e.y/=t.canvas.height,e.x=2*e.x-1,e.y=-2*e.y+1;this.uvStretcher.createMesh(this.lineData.allPoints),this.uvStretcher.initialUpdate(),this.uvStretcher.update();let e=t.globalAlpha;t.globalAlpha=Math.sqrt(this.opacity),t.globalCompositeOperation=this.mode,t.drawImage(this.uvStretcher.canvas,0,0,this.uvStretcher.canvas.width,this.uvStretcher.canvas.height,0,0,t.canvas.width,t.canvas.height),this.lineData.allPoints.length=0,this.lineData.endPoint=void 0,t.globalAlpha=e,t.canvas.touch&&t.canvas.touch()}drawOutline(t,e,i){if(!this.lineData.startPoint||!this.lineData.endPoint)return t.beginPath(),t.arc(e,i,this.scale*this.outlineScale,0,2*Math.PI,!1),t.strokeStyle="#FFFFFF",void t.stroke();for(let e of this.lineData.allPoints)e.nx=e.x,e.ny=e.y,e.x/=t.canvas.width,e.y/=t.canvas.height,e.x=2*e.x-1,e.y=-2*e.y+1;this.uvStretcher.createMesh(this.lineData.allPoints),this.uvStretcher.initialUpdate(),this.uvStretcher.setUniform("u_color","uniform3fv",this.color3.clone().convertLinearToSRGB().toArray()),this.uvStretcher.update();let n=t.globalAlpha;t.globalAlpha=Math.sqrt(this.opacity),t.drawImage(this.uvStretcher.canvas,0,0,this.uvStretcher.canvas.width,this.uvStretcher.canvas.height,0,0,t.canvas.width,t.canvas.height),t.globalAlpha=n;for(let t of this.lineData.allPoints)t.x=t.nx,t.y=t.ny}}class brush_VectorBrush extends Brush{constructor(t,{tooltip:e,previewSrc:i}={}){if(super(t),this.opacity=1,this.tooltip=e,this.outlineScale=1,i)this.previewSrc=i;else{let t=document.createElement("canvas");t.width=32,t.height=32;let e=t.getContext("2d");e.strokeStyle="#FFF",e.beginPath(),e.moveTo(0,0),e.arcTo(32,16,32,32,12),e.lineWidth=3,e.stroke(),this.previewSrc=t.toDataURL()}this.endPoint=new THREE.Vector2}changeColor(t){this.color=t,this.color3=new THREE.Color(this.color),this.ccolor=o()(t)}changeScale(t){this.scale=t}changeOpacity(t){this.opacity=t}drawTo(t,e,i,n={}){this.endPoint.set(e,-i),this.shape.currentPoint.distanceTo(this.endPoint)>5&&this.shape.lineTo(e,-i)}startDrawing(t,e,i){this.solo=!0,this.shape=new THREE.Shape,t.moveTo(e,i),this.shape.moveTo(e,-i)}endDrawing(t){this.solo=!1,Compositor.el.emit("shapecreated",this.shape),console.log("Shape",this.shape),this.shape=void 0}drawOutline(t,e,i){if(!this.shape||0===this.shape.curves.length)return t.beginPath(),t.arc(e,i,this.scale*this.outlineScale,0,2*Math.PI,!1),t.strokeStyle="#FFFFFF",t.lineWidth=1,void t.stroke();t.strokeStyle="#FFFFFF",t.lineWidth=1,t.moveTo(this.shape.curves[0].v1.x,-this.shape.curves[0].v1.y);for(let e of this.shape.curves)t.lineTo(e.v2.x,-e.v2.y);t.stroke()}}class FillShapeBrush extends brush_VectorBrush{endDrawing(t){this.solo=!1,t.beginPath();let e=t.globalAlpha;t.globalAlpha=Math.sqrt(this.opacity),t.fillStyle="#"+this.color3.getHexString(),t.moveTo(this.shape.curves[0].v1.x,-this.shape.curves[0].v1.y);for(let e of this.shape.curves)t.lineTo(e.v2.x,-e.v2.y);t.fill(),t.globalAlpha=e,this.shape=void 0}}class brush_FloodFillBrush extends brush_VectorBrush{drawTo(t,e,i,n={}){this.lastPos={x:e,y:i}}endDrawing(t){let e=u.getBlobOutlinePoints(t.canvas,void 0,0,10);console.log("Found",e),this.solo=!1,t.beginPath();let i=t.globalAlpha;t.globalAlpha=Math.sqrt(this.opacity),t.fillStyle="#"+this.color3.getHexString(),t.moveTo(e[0].x,e[0].y);for(let i of e)t.lineTo(i.x,i.y);t.fill(),t.globalAlpha=i,this.shape=void 0}}const h={Brush:Brush,ProceduralBrush:brush_ProceduralBrush,ImageBrush:brush_ImageBrush,LambdaBrush:LambdaBrush,FillBrush:FillBrush,NoiseBrush:NoiseBrush,FxBrush:brush_FxBrush,LineBrush:brush_LineBrush,StretchBrush:brush_StretchBrush,FillShapeBrush:FillShapeBrush,FloodFillBrush:brush_FloodFillBrush}},function(t,e){const i=["source-over","source-in","source-out","source-atop","destination-over","destination-in","destination-out"],n=["screen","overlay","darken","lighten","color-dodge","color-burn","soft-light","hard-light"],r=["multiply","difference","exclusion","hue","saturation","color","luminosity"],a=["bumpMap","displacementMap","normalMap","emissiveMap","metalnessMap","roughnessMap","envMap","aoMap","matcap"],o=[].concat(i,n,r,a);t.exports={LAYER_MODES:o,BLEND_MODES:i,COLOR_MODES:n,MATH_MODES:r,THREED_MODES:a,FX:["blur","noise","dither","dilate","erode","flip-x","flip-y","grayscale-to-alpha","alpha-to-grayscale","invert","uv-offset","show-uv","srgb-to-linear","linear-to-srgb","swizzle","bump-to-normal"],CAMERA_LAYERS:{DEFAULT:0,LEFT_EYE:1,RIGHT_EYE:2,SPECTATOR:4,SPRAY_PAINT_MASK:5,PROJECTOR_MASK:6},BRUSH_FX:["blur","nudge","scatter","noise","drip","dilate","hq-blending","oklab-blend"]}},function(t,e,i){"use strict";i.r(e),i.d(e,"Pool",(function(){return a}));function n(t,e){return this.system._pool[t]||(this.system._pool[t]=new e),this.system._pool[t]}function r(t,e){return this._pool[t]||(this._pool[t]=new e),this._pool[t]}class a{static init(t,{useSystem:e=!1}={}){e?(t.system||console.error("No system for system pool",t.attrName),t.system._pool||(t.system._pool={}),t.pool=n):(t._pool={},t.pool=r)}}},function(t,e,i){"use strict";i.r(e),i.d(e,"Undo",(function(){return a})),i.d(e,"UndoStack",(function(){return r}));var n=i(0);class r{constructor({maxSize:t=10}={}){this.stack=[],this.maxSize=t,this.pushAllowed=!0,this._enabled=!0,this.canvasIndex=0,this.canvas=[];for(let t=0;t<this.maxSize;++t)this.canvas[t]=document.createElement("canvas"),this.canvas[t].width=2048,this.canvas[t].height=2048;this.maxSize<0&&(this.maxSize=99999)}set enabled(t){this._enabled=!!t,this.enabled||(this.stack=[],this.pushAllowed=!0)}get enabled(){return this._enabled}clearAndResize(t,e){this.stack=[];for(let i=0;i<this.maxSize;++i)this.canvas[i].width=t,this.canvas[i].height=e}pushCanvas(t){if(!this.enabled)return;let e=this.canvasIndex;this.canvasIndex=(this.canvasIndex+1)%this.maxSize;let i=this.canvas[e];i||(this.canvas[e]=document.createElement("canvas"),i=this.canvas[e]),i.width===t.width&&i.height===t.height||(console.log("Need to resize undo canvas"),i.width=t.width,i.height=t.height);let n=i.getContext("2d");n.globalCompositeOperation="copy",n.drawImage(t,0,0),this.push((()=>{let e=t.getContext("2d"),n=e.globalCompositeOperation;e.globalCompositeOperation="copy",e.drawImage(i,0,0),e.globalCompositeOperation=n,t.touch&&t.touch()}))}push(t,{whenSafe:e}={}){if(this.pushAllowed&&(this.stack.push(t),e&&(t.whenSafe=e),this.stack.length>this.maxSize)){let t=this.stack.splice(0,1);t.length&&t[0].whenSafe&&this.block(t[0].whenSafe)}}pushObjectMatrix(t){let e=new THREE.Matrix4;e.copy(t.matrix),this.push((()=>{n.Util.applyMatrix(e,t)}))}collect(t){if(!this.pushAllowed)return t();var e=this.stack,i=this.maxSize;this.stack=[],this.maxSize=9999;try{t()}finally{var n=this.stack;this.stack=e,this.maxSize=i}n.reverse(),this.push((()=>{for(let t of n)t()}))}undo(){0!==this.stack.length&&this.block(this.stack.pop())}block(t){try{this.pushAllowed=!1,t(),this.pushAllowed=!0}catch(t){throw this.pushAllowed=!0,t}}clear(){for(let t of this.stack)t.whenSafe&&t.whenSafe();this.stack=[]}}const a=new r},function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));const n=[new(i(1).ProceduralBrush)("default",{connected:!0,hqBlending:!0,tooltip:"Default"})]},function(t,e,i){"use strict";i.r(e),i.d(e,"Layer",(function(){return Layer})),i.d(e,"CanvasNode",(function(){return CanvasNode})),i.d(e,"GreatLayerNode",(function(){return GreatLayerNode})),i.d(e,"MaterialNode",(function(){return MaterialNode})),i.d(e,"PassthroughNode",(function(){return PassthroughNode})),i.d(e,"FxNode",(function(){return FxNode})),i.d(e,"OutputNode",(function(){return OutputNode})),i.d(e,"GroupNode",(function(){return GroupNode})),i.d(e,"NetworkInputNode",(function(){return NetworkInputNode})),i.d(e,"NetworkOutputNode",(function(){return NetworkOutputNode}));var n,r=i(9),a=i.n(r),o=(i(2),i(10));class Layer{constructor(t,e){if(this.width=t,this.height=e,n=Compositor.el.sceneEl,!(Number.isInteger(t)&&t>0))throw new Error(`Invalid layer width ${t}`);if(!(Number.isInteger(e)&&e>0))throw new Error(`Invalid layer width ${e}`);this.transform=this.constructor.EmptyTransform(),this.mode="source-over",this.visible=!0,this.active=!1,this.grabbed=!1,this.opacity=1,this.id=a.a.generate(),this.shelfMatrix=new THREE.Matrix4,this.updateTime=0;let i=document.createElement("canvas");i.width=this.width,i.height=this.height,i.id=`layer-${this.id}`,document.body.append(i),this.canvas=i,this.canvas.touch=()=>this.touch(),this.canvas.getUpdateTime=()=>this.updateTime,this.shapes=[],this.clear()}touch(){this.updateTime=n.time}draw(t,e=0,{mode:i,canvas:n}={}){void 0===i&&(i=this.mode),t.save(),t.globalCompositeOperation=i,t.globalAlpha=this.opacity;let{translation:r,scale:a}=this.transform;try{n||(n=this.frame(e)),t.translate(r.x+this.width/2,r.y+this.height/2),t.scale(a.x,a.y),t.rotate(this.transform.rotation),t.drawImage(n,-this.width/2,-this.height/2)}catch(t){console.warn(e%this.frames.length,this.frames[e%this.frames.length]),console.error(t)}t.restore()}clear(){this.canvas.getContext("2d").clearRect(0,0,this.width,this.height),this.frames=[this.canvas]}resize(t,e){this.canvas.width=t,this.canvas.height=e,this.width=t,this.height=e}insertFrame(t,{canvas:e}={}){void 0===e&&(e=document.createElement("canvas")),e.width=this.width,e.height=this.height,e.touch=()=>this.updateTime=document.querySelector("a-scene").time,e.getUpdateTime=()=>this.updateTime,this.frames.splice(t+1,0,e)}deleteFrame(t){this.frames.splice(t,1)}frameIdx(t){return(t%=this.frames.length)<0&&(t=this.frames.length+t),t}frame(t){return this.frames[this.frameIdx(t)]}static EmptyTransform(){return{translation:{x:0,y:0},scale:{x:1,y:1},rotation:0}}static clearTransform(t){t.translation.x=0,t.translation.y=0,t.scale.x=1,t.scale.y=1,t.rotation=0}}class CanvasNode{constructor(t,{useCanvas:e=!0}={}){this.id=a.a.generate(),this.compositor=t,this.compositor.allNodes.push(this),this.updateTime=0,this.transform=Layer.EmptyTransform(),this.grabbed=!1,this.opacity=1,this.id=a.a.generate(),e&&(this.canvas=document.createElement("canvas"),this.canvas.width=t.width,this.canvas.height=t.height,this.canvas.touch=()=>this.touch(),this.canvas.getUpdateTime=()=>this.updateTime),this.mode="source-over",this.sources=[],this.shelfMatrix=new THREE.Matrix4}touch(){this.updateTime=0}toJSON(){let t=Object.assign({},this);return t.compositor=void 0,t.canvas=void 0,t.sources=void 0,t.destination=void 0,t.type=this.constructor.name,t.connections=this.getConnections().map((t=>(t.to=t.to?t.to.id:void 0,t))),t}getConnections(){return[{type:"destination",to:this.destination,index:0}].concat(this.sources.map(((t,e)=>({type:"source",index:e,to:t})))).filter((t=>t.to))}resize(t,e){this.canvas&&(this.canvas.width=t,this.canvas.height=e)}connectInput(t,{type:e,index:i}){this.touch(),"source"===e?this.sources[i]=t:"destination"==e&&this.connectDestination(t)}disconnectInput({type:t,index:e}){this.touch(),"source"===t?this.sources[e]=void 0:"destination"===t&&this.disconnectDestination()}connectDestination(t){this.touch(),this.destination=t}disconnectDestination(){if(this.touch(),this.destination=void 0,this.canvas){let t=this.canvas.getContext("2d");t.clearRect(0,0,t.canvas.width,t.canvas.height)}}checkIfUpdateNeeded(t){let e=!1;for(let i of this.sources.concat(this.destination))i&&(i.updateCanvas&&i.updateCanvas(t),i.frameIdx&&i.updateFrame!==i.frameIdx(t)&&(e=!0),i.updateTime>=this.updateTime&&(e=!0));return e}updateCanvas(t){if(!this.destination)return;if(!this.checkIfUpdateNeeded(t))return;this.updateTime=document.querySelector("a-scene").time;let e=this.canvas.getContext("2d");e.clearRect(0,0,e.canvas.width,e.canvas.height),this.destination.draw(e,t,{mode:"copy"});for(let i of this.sources)i&&i.draw(e,t,{mode:this.mode})}draw(t,e,{mode:i}={}){void 0===i&&(i="source-over"),this.updateCanvas(e);let n=t.globalCompositeOperation,r=t.globalAlpha;t.globalCompositeOperation=i,t.globalAlpha=this.opacity;let{translation:a,scale:o}=this.transform,{width:s,height:l}=this.canvas,c=this.canvas;t.drawImage(c,0,0,s,l,a.x-s/2*o.x+s/2,a.y-l/2*o.y+l/2,s*o.x,l*o.y),t.globalCompositeOperation=n,t.globalAlpha=r}}class GreatLayerNode extends CanvasNode{updateCanvas(t){let e=this.mode;try{this.mode=void 0,super.updateCanvas(t)}finally{this.mode=e}}}class MaterialNode extends CanvasNode{constructor(t){super(t,{useCanvas:!1}),this.inputs={}}touch(){console.log("Touch MaterialNode",this.updateTime,Compositor.component.drawnT),this.updateTime=Compositor.component.drawnT+.01}toJSON(){let t=super.toJSON();return t.inputs=void 0,t}updateCanvas(t){let e=!1;for(let i of Object.values(this.inputs))i.updateCanvas&&i.updateCanvas(t),i.updateTime>=this.updateTime&&(e=!0)}getConnections(){let t=[];for(let e in this.inputs)t.push({type:e,to:this.inputs[e],index:0});return t}connectInput(t,{type:e,index:i}){this.touch(),this.inputs[e]=t}disconnectInput({type:t,index:e}){this.touch(),delete this.inputs[t]}}class PassthroughNode extends CanvasNode{constructor(t){super(t,{useCanvas:!1})}updateCanvas(t){this.destination&&(this.destination.updateCanvas&&this.destination.updateCanvas(t),this.updateTime=this.destination.updateTime)}draw(...t){this.destination&&this.destination.draw(...t)}}class FxNode extends CanvasNode{constructor(t,{shader:e="blur",...i}={}){super(t,i),Object.defineProperty(this,"glData",{enumerable:!1,value:{}}),this.shader=e}disconnectDestination(){this.destination=void 0}touch(){this.updateTime=0}changeShader(t){if(this.touch(),this.shader=t,this.glData.program){this.canvas.getContext("webgl").deleteProgram(this.glData.program),delete this.glData.program}}createShader(t,e,i){let n=t.createShader(e);if(t.shaderSource(n,i),t.compileShader(n),!t.getShaderParameter(n,t.COMPILE_STATUS))throw new Error(t.getShaderInfoLog(n));return n}getProgram(t){if(this.glData.program)return this.glData.program;let e=this.createShader(t,t.VERTEX_SHADER,i(162)),n=this.createShader(t,t.FRAGMENT_SHADER,i(163)(`./${this.shader}.glsl`)),r=t.createProgram();if(t.attachShader(r,e),t.attachShader(r,n),t.linkProgram(r),!t.getProgramParameter(r,t.LINK_STATUS))throw new Error(t.getProgramInfoLog(r));return t.useProgram(r),this.glData.program=r,this.glData.program}setupTexture(t,e){let i=this.getProgram(t);this.glData.texture||(this.glData.texture=t.createTexture()),this.destination.updateCanvas&&this.destination.updateCanvas(e);let n=this.destination.frame?this.destination.frame(e):this.destination.canvas;if(!n)throw new Error("No canvas");t.activeTexture(t.TEXTURE0+0),t.bindTexture(t.TEXTURE_2D,this.glData.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST);var r=t.getUniformLocation(i,"u_input");t.uniform1i(r,0),this.setProgramUniform("u_width","uniform1f",n.width),this.setProgramUniform("u_height","uniform1f",n.height);for(let t in this.sources){let i=this.sources[t];i&&(i.updateCanvas&&i.updateCanvas(e))}}setProgramUniform(t,e,i){let n=this.glData.program,r=this.glData.gl.getUniformLocation(n,t);r&&("function"==typeof i&&(i=i()),this.glData.gl[e](r,i))}updateCanvas(t){if(!this.destination)return;let e=this.canvas;if(!this.checkIfUpdateNeeded(t))return;this.updateTime=document.querySelector("a-scene").time;let i=e.getContext("webgl")||e.getContext("experimental-webgl");this.glData.gl=i,i.viewport(0,0,i.drawingBufferWidth,i.drawingBufferHeight),i.clearColor(0,0,0,0),i.clear(i.COLOR_BUFFER_BIT);let n=this.getProgram(i),r=i.getAttribLocation(n,"a_position"),a=i.createBuffer();i.bindBuffer(i.ARRAY_BUFFER,a);i.bufferData(i.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,1,1,1,1,-1,1,-1,-1]),i.STATIC_DRAW),i.viewport(0,0,i.canvas.width,i.canvas.height),this.setupTexture(i,t),i.enableVertexAttribArray(r),i.bindBuffer(i.ARRAY_BUFFER,a);var o=i.FLOAT,s=0;i.vertexAttribPointer(r,2,o,!1,0,s);var l=i.TRIANGLES;s=0;i.drawArrays(l,s,6)}}class OutputNode extends MaterialNode{constructor(t){super(t),this.name=this.id,this.solo=!1}}class GroupNode extends PassthroughNode{constructor(t){}}class NetworkInputNode extends CanvasNode{constructor(...t){super(...t),this._name=this.id,Object.defineProperty(this,"networkData",{enumerable:!1,value:{}}),this.networkData.alphaProcessor=new o.CanvasShaderProcessor({fx:"grayscale-to-alpha"}),this.networkData.needsConnection=!0}get needsConnection(){return this.networkData.needsConnection}get name(){return this._name}set name(t){console.log("Set name"),t!==this._name&&(this.networkData.peer&&this.networkData.peer.destroy,this._name=t,this.connectNetwork())}get receivingBroadcast(){return!!this.networkData.video}connectNetwork(){this.networkData.needsConnection=!1,this.compositor.el.sceneEl.systems.networking.callFor(this._name,{onvideo:t=>this.networkData.video=t,onalpha:t=>this.networkData.alphaVideo=t,onpeer:t=>this.networkData.peer=t,onsize:t=>{this.canvas.width=t.width,this.canvas.height=t.height},onerror:t=>{console.log("Clearing receive layer",this.name),delete this.networkData.video,delete this.networkData.alphaVideo,this.networkData.peer&&(this.networkData.peer.destroy(),delete this.networkData.peer),this.networkData.needsConnection=!0}})}updateCanvas(t){if(!this.networkData.video)return;if(this.updateTime=Compositor.el.sceneEl.time,0===this.canvas.width||0===this.canvas.height)return this.canvas.width=10,void(this.canvas.height=10);let e=this.canvas.getContext("2d");this.networkData.alphaVideo&&this.networkData.alphaVideo.paused?this.networkData.alphaVideo.play():this.networkData.video&&this.networkData.video.paused?this.networkData.video.play():this.networkData.alphaVideo&&(this.networkData.alphaVideo.width===this.canvas.width&&this.networkData.alphaVideo.height===this.canvas.height||(this.networkData.alphaVideo.width=this.canvas.width,this.networkData.alphaVideo.height=this.canvas.height,this.networkData.alphaProcessor.canvas.width=this.canvas.width,this.networkData.alphaProcessor.canvas.height=this.canvas.height),e.drawImage(this.networkData.video,0,0,e.canvas.width,e.canvas.height),this.networkData.alphaVideo&&this.networkData.alphaVideo.width&&this.networkData.alphaVideo.readyState>=3&&(this.networkData.alphaProcessor.setInputCanvas(this.networkData.alphaVideo),this.networkData.alphaProcessor.update(),e.globalCompositeOperation="destination-in",e.drawImage(this.networkData.alphaProcessor.canvas,0,0,e.canvas.width,e.canvas.height),e.globalCompositeOperation="source-over"))}touch(){this.updateTime=Compositor.el.sceneEl.time}}class NetworkOutputNode extends CanvasNode{constructor(...t){super(...t),this._name=this.id,Object.defineProperty(this,"networkData",{enumerable:!1,value:{}});let e=document.createElement("canvas");e.width=1024,e.height=512,this.networkData.alphaProcessor=new o.CanvasShaderProcessor({fx:"alpha-to-grayscale",canvas:e}),this.networkData.alphaProcessor.setInputCanvas(this.canvas),this.networkData.needsConnection=!0}get name(){return this._name}set name(t){console.log("Set name"),t!==this._name&&(this.networkData.peer&&(this.networkData.peer.destroy(),this.networkData.needsConnection=!0),this._name=t)}get broadcasting(){return!0}get needsConnection(){return this.networkData.needsConnection}connectNetwork(){this.networkData.needsConnection=!1;try{this.networkData.peer=this.compositor.el.sceneEl.systems.networking.answerTo(this._name,this.canvas,this.networkData.alphaProcessor.canvas,{onerror:t=>{this.networkData.needsConnection=!0,delete this.networkData.peer}})}catch(t){console.error(t),this.networkData.needsConnection=!0,delete this.networkData.peer}}checkIfUpdateNeeded(){return!0}updateCanvas(t){if(!this.destination)return;if(!this.checkIfUpdateNeeded(t))return;this.updateTime=Compositor.el.sceneEl.time;let e=this.canvas.getContext("2d");this.destination.draw(e,t,{mode:"copy"}),this.networkData.alphaProcessor.setInputCanvas(this.canvas),this.networkData.alphaProcessor.update(),e.globalCompositeOperation="destination-over",e.fillStyle="#fff",e.fillRect(0,0,e.canvas.width,e.canvas.height),e.globalCompositeOperation="source-over"}}},function(t,e,i){t.exports={Controller:i(349),Frame:i(41),Gesture:i(42),Hand:i(28),Pointable:i(16),Finger:i(29),InteractionBox:i(166),CircularBuffer:i(168),UI:i(354),JSONProtocol:i(170).JSONProtocol,glMatrix:i(15),mat3:i(15).mat3,vec3:i(15).vec3,loopController:void 0,version:i(357),_:i(12),EventEmitter:i(20).EventEmitter,loop:function(t,e){return t&&void 0===e&&"[object Function]"==={}.toString.call(t)&&(e=t,t={}),this.loopController?t&&this.loopController.setupFrameEvents(t):this.loopController=new this.Controller(t),this.loopController.loop(e),this.loopController},plugin:function(t,e){this.Controller.plugin(t,e)}}},function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var n=i(0);AFRAME.registerSystem("sfx-system",{init(){let t=document.createElement("a-entity");t.id="sfx-container",this.el.append(t);for(let e of document.querySelectorAll("a-assets audio")){let i=document.createElement("a-entity");i.setAttribute("sound",`src: #${e.id}; distanceModel: inverse; volume: 0.0; refDistance: 0.3; rolloffFactor: 1; positional: false`),i.id=`sfx-${e.id.slice("asset-".length)}`,t.append(i)}n.Util.whenLoaded(t,(()=>{this.el.audioListener&&Object.defineProperty(this.el.audioListener.context.listener,"positionX",{value:void 0})}))}});const r=new class{constructor(){const t={click:"navigation_hover-tap",clock:!1,joystick:"navigation_backward-selection",bang:"sfx-clock",recognition:"navigation_forward-selection",listening:"sfx-click",recognitionerror:"error"};for(let e in t)this[e]=t[e]?this.play.bind(this,t[e]):function(){}}play(t,e,{volume:i=1}={}){let n=document.getElementById(`sfx-${t.sfx||t}`);n?(e.object3D.getWorldPosition(n.object3D.position),n.setAttribute("sound",{volume:i}),n.components.sound.playSound()):console.warn("No sound asset for",t)}draw(t){}endDraw(t){t.sfxAlreadyDrawing=!1,this.play("ui_tap-variant-01",t,{volume:.2})}}},function(t,e,i){"use strict";t.exports=i(300)},function(t,e,i){"use strict";let n;i.r(e),i.d(e,"CanvasShaderProcessor",(function(){return a})),i.d(e,"UVStretcher",(function(){return l}));const r=i(162);class a{constructor({source:t,canvas:e,fx:a,vertexShader:o=r}){a&&(t=i(163)(`./${a}.glsl`)),this.source=t,this.vertSource=o,this.canvas=e,e||(n||(n=document.createElement("canvas"),n.width=2048,n.height=2048),this.canvas=n),this.textures={},this.textureIdx={}}getContext(){return this.canvas.getContext("webgl")||this.canvas.getContext("experimental-webgl")}createShader(t,e,i){let n=t.createShader(e);if(t.shaderSource(n,i),t.compileShader(n),!t.getShaderParameter(n,t.COMPILE_STATUS))throw new Error(t.getShaderInfoLog(n));return n}getProgram(t){if(this.program)return t.useProgram(this.program),this.program;let e=this.createShader(t,t.VERTEX_SHADER,this.vertSource),i=this.createShader(t,t.FRAGMENT_SHADER,this.source),n=t.createProgram();if(t.attachShader(n,e),t.attachShader(n,i),t.linkProgram(n),!t.getProgramParameter(n,t.LINK_STATUS))throw new Error(t.getProgramInfoLog(n));return t.useProgram(n),this.program=n,this.initialUpdate(),this.program}setInputCanvas(t,{resize:e=!0}={}){!e||this.canvas.width===t.width&&this.canvas.height===t.height||(this.canvas.width=t.width,this.canvas.height=t.height),this.setupTexture(this.getContext(),"u_input",t),this.setUniform("u_width","uniform1f",t.width),this.setUniform("u_height","uniform1f",t.height)}setCanvasAttribute(t,e){this.setupTexture(this.getContext(),t,e),this.setUniform(`${t}_width`,"uniform1f",e.width),this.setUniform(`${t}_height`,"uniform1f",e.height)}setUniform(t,e,i,...n){let r=this.getContext(),a=this.getProgram(r),o=r.getUniformLocation(a,t);o&&("function"==typeof i&&(i=i()),r[e](o,i,...n))}setUniforms(t,e){for(let i in e)this.setUniform(i,t,e[i])}setupTexture(t,e,i){let n=this.getProgram(t);this.textures[e]||(console.log("Creating texture for",e),this.textures[e]=t.createTexture(),this.textureIdx[e]=Object.values(this.textures).length-1);let r=this.textures[e],a=this.textureIdx[e];if(!i)throw new Error("No canvas");t.activeTexture(t.TEXTURE0+a),t.bindTexture(t.TEXTURE_2D,r),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,i),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST);var o=t.getUniformLocation(n,e);t.uniform1i(o,a)}initialUpdate(){let t=this.getContext();t.viewport(0,0,t.drawingBufferWidth,t.drawingBufferHeight),t.clearColor(0,0,0,0);let e=this.getProgram(t),i=t.getAttribLocation(e,"a_position"),n=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,n);var r=this.vertexPositions||[-1,-1,1,-1,1,1,1,1,-1,1,-1,-1];let a=new Float32Array(r);this.positionLength=r.length,t.bufferData(t.ARRAY_BUFFER,a,t.STATIC_DRAW),t.viewport(0,0,t.canvas.width,t.canvas.height),t.enableVertexAttribArray(i),t.bindBuffer(t.ARRAY_BUFFER,n);var o=t.FLOAT;t.vertexAttribPointer(i,2,o,!1,0,0),this.hasDoneInitialUpdate=!0}createVertexBuffer({name:t,list:e,size:i,type:n,normalize:r=!1,stride:a=0,offset:o=0}){let s=this.getContext(),l=this.getProgram(s),c=s.getAttribLocation(l,t);if((n=void 0===n?s.FLOAT:n)!==s.FLOAT)throw new Error("TODO: Update to support other types");let u=s.createBuffer();s.bindBuffer(s.ARRAY_BUFFER,u),s.bufferData(s.ARRAY_BUFFER,new Float32Array(e),s.STATIC_DRAW),s.enableVertexAttribArray(c),s.bindBuffer(s.ARRAY_BUFFER,u),s.vertexAttribPointer(c,i,n,r,a,o)}update(){this.canvas;let t=this.getContext();t.clear(t.COLOR_BUFFER_BIT);this.getProgram(t);var e=t.TRIANGLES,i=this.positionLength/2;t.drawArrays(e,0,i)}drawBrush(t,e,i,n,{rotation:r=0,pressure:a=1,distance:o=0,eraser:s=!1,scale:l=1,reupdate:c=!0}={}){let{width:u,height:h,autoRotate:d}=t;u=Math.floor(u),h=Math.floor(h),this.setInputCanvas(e.canvas),this.initialUpdate(),"u_brush"in this.textures||this.setCanvasAttribute("u_brush",t.overlayCanvas),this.setUniform("u_color","uniform3fv",t.color3.toArray()),this.setUniforms("uniform1f",{u_x:i,u_y:n,u_brush_width:t.width*l,u_brush_height:t.height*l,u_brush_rotation:d?2*Math.PI*Math.random():r,u_opacity:t.opacity*a,u_t:document.querySelector("a-scene").time%1}),this.update(),e.globalAlpha=1;let p=e.globalCompositeOperation;e.globalCompositeOperation="copy",e.drawImage(this.canvas,0,0,this.canvas.width,this.canvas.height,0,0,e.canvas.width,e.canvas.height),e.globalCompositeOperation=p}}const o=new THREE.Vector3(0,0,1);let s;class l extends a{constructor(t){s||(s=document.createElement("canvas"),s.width=2048,s.height=2048),super(Object.assign({vertexShader:i(295),canvas:s},t)),this.vertexPositions=[],this.uvs=[],this.opacities=[],this.point1=new THREE.Vector3,this.point2=new THREE.Vector3,this.point3=new THREE.Vector3,this.direction=new THREE.Vector3,this.direction2=new THREE.Vector3}reset(){this.vertexPositions.length=0,this.uvs.length=0,this.opacities.length=0,this.accumDistance=0}updatePoints(t){0!==t.length&&this.createMesh(t)}createMesh(t,{maxDistance:e=.3}={}){let{point1:i,point2:n,point3:r,direction:a,direction2:s}=this;this.vertexPositions.length=0,this.uvs.length=0,this.opacities.length=0;let l=0,c=0,u=0,h=!1;for(let e=0;e<t.length-1;++e)i.set(t[e].x,t[e].y,0),n.set(t[e+1].x,t[e+1].y,0),n.sub(i),l+=n.length();for(let d=0;d<t.length-1;++d){i.set(t[d].x,t[d].y,0),n.set(t[d+1].x,t[d+1].y,0),a.subVectors(n,i),c=a.length();const p=.03;if(c>e){h=!0;continue}0===d||h?(a.normalize(),a.cross(o),a.multiplyScalar(t[d].scale*p)):a.copy(s),d<t.length-2?(r.set(t[d+2].x,t[d+2].y,0),s.subVectors(r,n),s.normalize(),s.cross(o),s.multiplyScalar(t[d+1].scale*p),s.lerp(a,.5)):s.copy(a),h=!1;let f=u;u+=c/l;let m=u;this.vertexPositions.push(i.x+a.x,i.y+a.y),this.vertexPositions.push(n.x-s.x,n.y-s.y),this.vertexPositions.push(i.x-a.x,i.y-a.y),this.uvs.push(f,0,m,1,f,1),this.opacities.push(t[d].opacity,t[d+1].opacity,t[d].opacity),this.vertexPositions.push(n.x-s.x,n.y-s.y),this.vertexPositions.push(i.x+a.x,i.y+a.y),this.vertexPositions.push(n.x+s.x,n.y+s.y),this.uvs.push(m,1,f,0,m,0),this.opacities.push(t[d+1].opacity,t[d].opacity,t[d+1].opacity)}this.startPoint=null,this.endPoint=null,this.hasDoneInitialUpdate=!1}initialUpdate(){super.initialUpdate(),this.createVertexBuffer({name:"a_uv",list:this.uvs,size:2}),this.createVertexBuffer({name:"a_opacity",list:this.opacities,size:1});let t=this.getContext();t.enable(t.BLEND),t.blendFunc(t.SRC_COLOR,t.ONE_MINUS_SRC_ALPHA)}}window.CanvasShaderProcessor=a},function(t,e,i){"use strict";function n(t){for(var e,i="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=new Uint8Array(t),a=r.byteLength,o=a%3,s=a-o,l=0;l<s;l+=3)i+=n[(16515072&(e=r[l]<<16|r[l+1]<<8|r[l+2]))>>18]+n[(258048&e)>>12]+n[(4032&e)>>6]+n[63&e];return 1==o?i+=n[(252&(e=r[s]))>>2]+n[(3&e)<<4]+"==":2==o&&(i+=n[(64512&(e=r[s]<<8|r[s+1]))>>10]+n[(1008&e)>>4]+n[(15&e)<<2]+"="),i}i.d(e,"a",(function(){return n}))},function(t,e,i){(function(){var i=this,n=i._,r={},a=Array.prototype,o=Object.prototype,s=Function.prototype,l=a.push,c=a.slice,u=a.concat,h=o.toString,d=o.hasOwnProperty,p=a.forEach,f=a.map,m=a.reduce,g=a.reduceRight,y=a.filter,b=a.every,A=a.some,v=a.indexOf,w=a.lastIndexOf,E=Array.isArray,_=Object.keys,x=s.bind,T=function(t){return t instanceof T?t:this instanceof T?void(this._wrapped=t):new T(t)};t.exports&&(e=t.exports=T),e._=T,T.VERSION="1.4.4";var M=T.each=T.forEach=function(t,e,i){if(null!=t)if(p&&t.forEach===p)t.forEach(e,i);else if(t.length===+t.length){for(var n=0,a=t.length;n<a;n++)if(e.call(i,t[n],n,t)===r)return}else for(var o in t)if(T.has(t,o)&&e.call(i,t[o],o,t)===r)return};T.map=T.collect=function(t,e,i){var n=[];return null==t?n:f&&t.map===f?t.map(e,i):(M(t,(function(t,r,a){n[n.length]=e.call(i,t,r,a)})),n)};var C="Reduce of empty array with no initial value";T.reduce=T.foldl=T.inject=function(t,e,i,n){var r=arguments.length>2;if(null==t&&(t=[]),m&&t.reduce===m)return n&&(e=T.bind(e,n)),r?t.reduce(e,i):t.reduce(e);if(M(t,(function(t,a,o){r?i=e.call(n,i,t,a,o):(i=t,r=!0)})),!r)throw new TypeError(C);return i},T.reduceRight=T.foldr=function(t,e,i,n){var r=arguments.length>2;if(null==t&&(t=[]),g&&t.reduceRight===g)return n&&(e=T.bind(e,n)),r?t.reduceRight(e,i):t.reduceRight(e);var a=t.length;if(a!==+a){var o=T.keys(t);a=o.length}if(M(t,(function(s,l,c){l=o?o[--a]:--a,r?i=e.call(n,i,t[l],l,c):(i=t[l],r=!0)})),!r)throw new TypeError(C);return i},T.find=T.detect=function(t,e,i){var n;return k(t,(function(t,r,a){if(e.call(i,t,r,a))return n=t,!0})),n},T.filter=T.select=function(t,e,i){var n=[];return null==t?n:y&&t.filter===y?t.filter(e,i):(M(t,(function(t,r,a){e.call(i,t,r,a)&&(n[n.length]=t)})),n)},T.reject=function(t,e,i){return T.filter(t,(function(t,n,r){return!e.call(i,t,n,r)}),i)},T.every=T.all=function(t,e,i){e||(e=T.identity);var n=!0;return null==t?n:b&&t.every===b?t.every(e,i):(M(t,(function(t,a,o){if(!(n=n&&e.call(i,t,a,o)))return r})),!!n)};var k=T.some=T.any=function(t,e,i){e||(e=T.identity);var n=!1;return null==t?n:A&&t.some===A?t.some(e,i):(M(t,(function(t,a,o){if(n||(n=e.call(i,t,a,o)))return r})),!!n)};T.contains=T.include=function(t,e){return null!=t&&(v&&t.indexOf===v?-1!=t.indexOf(e):k(t,(function(t){return t===e})))},T.invoke=function(t,e){var i=c.call(arguments,2),n=T.isFunction(e);return T.map(t,(function(t){return(n?e:t[e]).apply(t,i)}))},T.pluck=function(t,e){return T.map(t,(function(t){return t[e]}))},T.where=function(t,e,i){return T.isEmpty(e)?i?null:[]:T[i?"find":"filter"](t,(function(t){for(var i in e)if(e[i]!==t[i])return!1;return!0}))},T.findWhere=function(t,e){return T.where(t,e,!0)},T.max=function(t,e,i){if(!e&&T.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);if(!e&&T.isEmpty(t))return-1/0;var n={computed:-1/0,value:-1/0};return M(t,(function(t,r,a){var o=e?e.call(i,t,r,a):t;o>=n.computed&&(n={value:t,computed:o})})),n.value},T.min=function(t,e,i){if(!e&&T.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);if(!e&&T.isEmpty(t))return 1/0;var n={computed:1/0,value:1/0};return M(t,(function(t,r,a){var o=e?e.call(i,t,r,a):t;o<n.computed&&(n={value:t,computed:o})})),n.value},T.shuffle=function(t){var e,i=0,n=[];return M(t,(function(t){e=T.random(i++),n[i-1]=n[e],n[e]=t})),n};var R=function(t){return T.isFunction(t)?t:function(e){return e[t]}};T.sortBy=function(t,e,i){var n=R(e);return T.pluck(T.map(t,(function(t,e,r){return{value:t,index:e,criteria:n.call(i,t,e,r)}})).sort((function(t,e){var i=t.criteria,n=e.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(i<n||void 0===n)return-1}return t.index<e.index?-1:1})),"value")};var S=function(t,e,i,n){var r={},a=R(e||T.identity);return M(t,(function(e,o){var s=a.call(i,e,o,t);n(r,s,e)})),r};T.groupBy=function(t,e,i){return S(t,e,i,(function(t,e,i){(T.has(t,e)?t[e]:t[e]=[]).push(i)}))},T.countBy=function(t,e,i){return S(t,e,i,(function(t,e){T.has(t,e)||(t[e]=0),t[e]++}))},T.sortedIndex=function(t,e,i,n){for(var r=(i=null==i?T.identity:R(i)).call(n,e),a=0,o=t.length;a<o;){var s=a+o>>>1;i.call(n,t[s])<r?a=s+1:o=s}return a},T.toArray=function(t){return t?T.isArray(t)?c.call(t):t.length===+t.length?T.map(t,T.identity):T.values(t):[]},T.size=function(t){return null==t?0:t.length===+t.length?t.length:T.keys(t).length},T.first=T.head=T.take=function(t,e,i){if(null!=t)return null==e||i?t[0]:c.call(t,0,e)},T.initial=function(t,e,i){return c.call(t,0,t.length-(null==e||i?1:e))},T.last=function(t,e,i){if(null!=t)return null==e||i?t[t.length-1]:c.call(t,Math.max(t.length-e,0))},T.rest=T.tail=T.drop=function(t,e,i){return c.call(t,null==e||i?1:e)},T.compact=function(t){return T.filter(t,T.identity)};var D=function(t,e,i){return M(t,(function(t){T.isArray(t)?e?l.apply(i,t):D(t,e,i):i.push(t)})),i};T.flatten=function(t,e){return D(t,e,[])},T.without=function(t){return T.difference(t,c.call(arguments,1))},T.uniq=T.unique=function(t,e,i,n){T.isFunction(e)&&(n=i,i=e,e=!1);var r=i?T.map(t,i,n):t,a=[],o=[];return M(r,(function(i,n){(e?n&&o[o.length-1]===i:T.contains(o,i))||(o.push(i),a.push(t[n]))})),a},T.union=function(){return T.uniq(u.apply(a,arguments))},T.intersection=function(t){var e=c.call(arguments,1);return T.filter(T.uniq(t),(function(t){return T.every(e,(function(e){return T.indexOf(e,t)>=0}))}))},T.difference=function(t){var e=u.apply(a,c.call(arguments,1));return T.filter(t,(function(t){return!T.contains(e,t)}))},T.zip=function(){for(var t=c.call(arguments),e=T.max(T.pluck(t,"length")),i=new Array(e),n=0;n<e;n++)i[n]=T.pluck(t,""+n);return i},T.object=function(t,e){if(null==t)return{};for(var i={},n=0,r=t.length;n<r;n++)e?i[t[n]]=e[n]:i[t[n][0]]=t[n][1];return i},T.indexOf=function(t,e,i){if(null==t)return-1;var n=0,r=t.length;if(i){if("number"!=typeof i)return t[n=T.sortedIndex(t,e)]===e?n:-1;n=i<0?Math.max(0,r+i):i}if(v&&t.indexOf===v)return t.indexOf(e,i);for(;n<r;n++)if(t[n]===e)return n;return-1},T.lastIndexOf=function(t,e,i){if(null==t)return-1;var n=null!=i;if(w&&t.lastIndexOf===w)return n?t.lastIndexOf(e,i):t.lastIndexOf(e);for(var r=n?i:t.length;r--;)if(t[r]===e)return r;return-1},T.range=function(t,e,i){arguments.length<=1&&(e=t||0,t=0),i=arguments[2]||1;for(var n=Math.max(Math.ceil((e-t)/i),0),r=0,a=new Array(n);r<n;)a[r++]=t,t+=i;return a},T.bind=function(t,e){if(t.bind===x&&x)return x.apply(t,c.call(arguments,1));var i=c.call(arguments,2);return function(){return t.apply(e,i.concat(c.call(arguments)))}},T.partial=function(t){var e=c.call(arguments,1);return function(){return t.apply(this,e.concat(c.call(arguments)))}},T.bindAll=function(t){var e=c.call(arguments,1);return 0===e.length&&(e=T.functions(t)),M(e,(function(e){t[e]=T.bind(t[e],t)})),t},T.memoize=function(t,e){var i={};return e||(e=T.identity),function(){var n=e.apply(this,arguments);return T.has(i,n)?i[n]:i[n]=t.apply(this,arguments)}},T.delay=function(t,e){var i=c.call(arguments,2);return setTimeout((function(){return t.apply(null,i)}),e)},T.defer=function(t){return T.delay.apply(T,[t,1].concat(c.call(arguments,1)))},T.throttle=function(t,e){var i,n,r,a,o=0,s=function(){o=new Date,r=null,a=t.apply(i,n)};return function(){var l=new Date,c=e-(l-o);return i=this,n=arguments,c<=0?(clearTimeout(r),r=null,o=l,a=t.apply(i,n)):r||(r=setTimeout(s,c)),a}},T.debounce=function(t,e,i){var n,r;return function(){var a=this,o=arguments,s=function(){n=null,i||(r=t.apply(a,o))},l=i&&!n;return clearTimeout(n),n=setTimeout(s,e),l&&(r=t.apply(a,o)),r}},T.once=function(t){var e,i=!1;return function(){return i||(i=!0,e=t.apply(this,arguments),t=null),e}},T.wrap=function(t,e){return function(){var i=[t];return l.apply(i,arguments),e.apply(this,i)}},T.compose=function(){var t=arguments;return function(){for(var e=arguments,i=t.length-1;i>=0;i--)e=[t[i].apply(this,e)];return e[0]}},T.after=function(t,e){return t<=0?e():function(){if(--t<1)return e.apply(this,arguments)}},T.keys=_||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var e=[];for(var i in t)T.has(t,i)&&(e[e.length]=i);return e},T.values=function(t){var e=[];for(var i in t)T.has(t,i)&&e.push(t[i]);return e},T.pairs=function(t){var e=[];for(var i in t)T.has(t,i)&&e.push([i,t[i]]);return e},T.invert=function(t){var e={};for(var i in t)T.has(t,i)&&(e[t[i]]=i);return e},T.functions=T.methods=function(t){var e=[];for(var i in t)T.isFunction(t[i])&&e.push(i);return e.sort()},T.extend=function(t){return M(c.call(arguments,1),(function(e){if(e)for(var i in e)t[i]=e[i]})),t},T.pick=function(t){var e={},i=u.apply(a,c.call(arguments,1));return M(i,(function(i){i in t&&(e[i]=t[i])})),e},T.omit=function(t){var e={},i=u.apply(a,c.call(arguments,1));for(var n in t)T.contains(i,n)||(e[n]=t[n]);return e},T.defaults=function(t){return M(c.call(arguments,1),(function(e){if(e)for(var i in e)null==t[i]&&(t[i]=e[i])})),t},T.clone=function(t){return T.isObject(t)?T.isArray(t)?t.slice():T.extend({},t):t},T.tap=function(t,e){return e(t),t};var O=function(t,e,i,n){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof T&&(t=t._wrapped),e instanceof T&&(e=e._wrapped);var r=h.call(t);if(r!=h.call(e))return!1;switch(r){case"[object String]":return t==String(e);case"[object Number]":return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object RegExp]":return t.source==e.source&&t.global==e.global&&t.multiline==e.multiline&&t.ignoreCase==e.ignoreCase}if("object"!=typeof t||"object"!=typeof e)return!1;for(var a=i.length;a--;)if(i[a]==t)return n[a]==e;i.push(t),n.push(e);var o=0,s=!0;if("[object Array]"==r){if(s=(o=t.length)==e.length)for(;o--&&(s=O(t[o],e[o],i,n)););}else{var l=t.constructor,c=e.constructor;if(l!==c&&!(T.isFunction(l)&&l instanceof l&&T.isFunction(c)&&c instanceof c))return!1;for(var u in t)if(T.has(t,u)&&(o++,!(s=T.has(e,u)&&O(t[u],e[u],i,n))))break;if(s){for(u in e)if(T.has(e,u)&&!o--)break;s=!o}}return i.pop(),n.pop(),s};T.isEqual=function(t,e){return O(t,e,[],[])},T.isEmpty=function(t){if(null==t)return!0;if(T.isArray(t)||T.isString(t))return 0===t.length;for(var e in t)if(T.has(t,e))return!1;return!0},T.isElement=function(t){return!(!t||1!==t.nodeType)},T.isArray=E||function(t){return"[object Array]"==h.call(t)},T.isObject=function(t){return t===Object(t)},M(["Arguments","Function","String","Number","Date","RegExp"],(function(t){T["is"+t]=function(e){return h.call(e)=="[object "+t+"]"}})),T.isArguments(arguments)||(T.isArguments=function(t){return!(!t||!T.has(t,"callee"))}),T.isFunction=function(t){return"function"==typeof t},T.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},T.isNaN=function(t){return T.isNumber(t)&&t!=+t},T.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"==h.call(t)},T.isNull=function(t){return null===t},T.isUndefined=function(t){return void 0===t},T.has=function(t,e){return d.call(t,e)},T.noConflict=function(){return i._=n,this},T.identity=function(t){return t},T.times=function(t,e,i){for(var n=Array(t),r=0;r<t;r++)n[r]=e.call(i,r);return n},T.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))};var P={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};P.unescape=T.invert(P.escape);var F={escape:new RegExp("["+T.keys(P.escape).join("")+"]","g"),unescape:new RegExp("("+T.keys(P.unescape).join("|")+")","g")};T.each(["escape","unescape"],(function(t){T[t]=function(e){return null==e?"":(""+e).replace(F[t],(function(e){return P[t][e]}))}})),T.result=function(t,e){if(null==t)return null;var i=t[e];return T.isFunction(i)?i.call(t):i},T.mixin=function(t){M(T.functions(t),(function(e){var i=T[e]=t[e];T.prototype[e]=function(){var t=[this._wrapped];return l.apply(t,arguments),L.call(this,i.apply(T,t))}}))};var U=0;T.uniqueId=function(t){var e=++U+"";return t?t+e:e},T.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var B=/(.)^/,I={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},j=/\\|'|\r|\n|\t|\u2028|\u2029/g;T.template=function(t,e,i){var n;i=T.defaults({},i,T.templateSettings);var r=new RegExp([(i.escape||B).source,(i.interpolate||B).source,(i.evaluate||B).source].join("|")+"|$","g"),a=0,o="__p+='";t.replace(r,(function(e,i,n,r,s){return o+=t.slice(a,s).replace(j,(function(t){return"\\"+I[t]})),i&&(o+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'"),n&&(o+="'+\n((__t=("+n+"))==null?'':__t)+\n'"),r&&(o+="';\n"+r+"\n__p+='"),a=s+e.length,e})),o+="';\n",i.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{n=new Function(i.variable||"obj","_",o)}catch(t){throw t.source=o,t}if(e)return n(e,T);var s=function(t){return n.call(this,t,T)};return s.source="function("+(i.variable||"obj")+"){\n"+o+"}",s},T.chain=function(t){return T(t).chain()};var L=function(t){return this._chain?T(t).chain():t};T.mixin(T),M(["pop","push","reverse","shift","sort","splice","unshift"],(function(t){var e=a[t];T.prototype[t]=function(){var i=this._wrapped;return e.apply(i,arguments),"shift"!=t&&"splice"!=t||0!==i.length||delete i[0],L.call(this,i)}})),M(["concat","join","slice"],(function(t){var e=a[t];T.prototype[t]=function(){return L.call(this,e.apply(this._wrapped,arguments))}})),T.extend(T.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this)},function(t,e,i){"use strict";var n=i(186),r=i(189),a=[].slice,o=["keyword","gray","hex"],s={};Object.keys(r).forEach((function(t){s[a.call(r[t].labels).sort().join("")]=t}));var l={};function c(t,e){if(!(this instanceof c))return new c(t,e);if(e&&e in o&&(e=null),e&&!(e in r))throw new Error("Unknown model: "+e);var i,u;if(null==t)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(t instanceof c)this.model=t.model,this.color=t.color.slice(),this.valpha=t.valpha;else if("string"==typeof t){var h=n.get(t);if(null===h)throw new Error("Unable to parse color from string: "+t);this.model=h.model,u=r[this.model].channels,this.color=h.value.slice(0,u),this.valpha="number"==typeof h.value[u]?h.value[u]:1}else if(t.length){this.model=e||"rgb",u=r[this.model].channels;var d=a.call(t,0,u);this.color=p(d,u),this.valpha="number"==typeof t[u]?t[u]:1}else if("number"==typeof t)t&=16777215,this.model="rgb",this.color=[t>>16&255,t>>8&255,255&t],this.valpha=1;else{this.valpha=1;var f=Object.keys(t);"alpha"in t&&(f.splice(f.indexOf("alpha"),1),this.valpha="number"==typeof t.alpha?t.alpha:0);var m=f.sort().join("");if(!(m in s))throw new Error("Unable to parse color from object: "+JSON.stringify(t));this.model=s[m];var g=r[this.model].labels,y=[];for(i=0;i<g.length;i++)y.push(t[g[i]]);this.color=p(y)}if(l[this.model])for(u=r[this.model].channels,i=0;i<u;i++){var b=l[this.model][i];b&&(this.color[i]=b(this.color[i]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}function u(t,e,i){return(t=Array.isArray(t)?t:[t]).forEach((function(t){(l[t]||(l[t]=[]))[e]=i})),t=t[0],function(n){var r;return arguments.length?(i&&(n=i(n)),(r=this[t]()).color[e]=n,r):(r=this[t]().color[e],i&&(r=i(r)),r)}}function h(t){return function(e){return Math.max(0,Math.min(t,e))}}function d(t){return Array.isArray(t)?t:[t]}function p(t,e){for(var i=0;i<e;i++)"number"!=typeof t[i]&&(t[i]=0);return t}c.prototype={toString:function(){return this.string()},toJSON:function(){return this[this.model]()},string:function(t){var e=this.model in n.to?this:this.rgb(),i=1===(e=e.round("number"==typeof t?t:1)).valpha?e.color:e.color.concat(this.valpha);return n.to[e.model](i)},percentString:function(t){var e=this.rgb().round("number"==typeof t?t:1),i=1===e.valpha?e.color:e.color.concat(this.valpha);return n.to.rgb.percent(i)},array:function(){return 1===this.valpha?this.color.slice():this.color.concat(this.valpha)},object:function(){for(var t={},e=r[this.model].channels,i=r[this.model].labels,n=0;n<e;n++)t[i[n]]=this.color[n];return 1!==this.valpha&&(t.alpha=this.valpha),t},unitArray:function(){var t=this.rgb().color;return t[0]/=255,t[1]/=255,t[2]/=255,1!==this.valpha&&t.push(this.valpha),t},unitObject:function(){var t=this.rgb().object();return t.r/=255,t.g/=255,t.b/=255,1!==this.valpha&&(t.alpha=this.valpha),t},round:function(t){return t=Math.max(t||0,0),new c(this.color.map(function(t){return function(e){return function(t,e){return Number(t.toFixed(e))}(e,t)}}(t)).concat(this.valpha),this.model)},alpha:function(t){return arguments.length?new c(this.color.concat(Math.max(0,Math.min(1,t))),this.model):this.valpha},red:u("rgb",0,h(255)),green:u("rgb",1,h(255)),blue:u("rgb",2,h(255)),hue:u(["hsl","hsv","hsl","hwb","hcg"],0,(function(t){return(t%360+360)%360})),saturationl:u("hsl",1,h(100)),lightness:u("hsl",2,h(100)),saturationv:u("hsv",1,h(100)),value:u("hsv",2,h(100)),chroma:u("hcg",1,h(100)),gray:u("hcg",2,h(100)),white:u("hwb",1,h(100)),wblack:u("hwb",2,h(100)),cyan:u("cmyk",0,h(100)),magenta:u("cmyk",1,h(100)),yellow:u("cmyk",2,h(100)),black:u("cmyk",3,h(100)),x:u("xyz",0,h(100)),y:u("xyz",1,h(100)),z:u("xyz",2,h(100)),l:u("lab",0,h(100)),a:u("lab",1),b:u("lab",2),keyword:function(t){return arguments.length?new c(t):r[this.model].keyword(this.color)},hex:function(t){return arguments.length?new c(t):n.to.hex(this.rgb().round().color)},rgbNumber:function(){var t=this.rgb().color;return(255&t[0])<<16|(255&t[1])<<8|255&t[2]},luminosity:function(){for(var t=this.rgb().color,e=[],i=0;i<t.length;i++){var n=t[i]/255;e[i]=n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4)}return.2126*e[0]+.7152*e[1]+.0722*e[2]},contrast:function(t){var e=this.luminosity(),i=t.luminosity();return e>i?(e+.05)/(i+.05):(i+.05)/(e+.05)},level:function(t){var e=this.contrast(t);return e>=7.1?"AAA":e>=4.5?"AA":""},isDark:function(){var t=this.rgb().color;return(299*t[0]+587*t[1]+114*t[2])/1e3<128},isLight:function(){return!this.isDark()},negate:function(){for(var t=this.rgb(),e=0;e<3;e++)t.color[e]=255-t.color[e];return t},lighten:function(t){var e=this.hsl();return e.color[2]+=e.color[2]*t,e},darken:function(t){var e=this.hsl();return e.color[2]-=e.color[2]*t,e},saturate:function(t){var e=this.hsl();return e.color[1]+=e.color[1]*t,e},desaturate:function(t){var e=this.hsl();return e.color[1]-=e.color[1]*t,e},whiten:function(t){var e=this.hwb();return e.color[1]+=e.color[1]*t,e},blacken:function(t){var e=this.hwb();return e.color[2]+=e.color[2]*t,e},grayscale:function(){var t=this.rgb().color,e=.3*t[0]+.59*t[1]+.11*t[2];return c.rgb(e,e,e)},fade:function(t){return this.alpha(this.valpha-this.valpha*t)},opaquer:function(t){return this.alpha(this.valpha+this.valpha*t)},rotate:function(t){var e=this.hsl(),i=e.color[0];return i=(i=(i+t)%360)<0?360+i:i,e.color[0]=i,e},mix:function(t,e){if(!t||!t.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof t);var i=t.rgb(),n=this.rgb(),r=void 0===e?.5:e,a=2*r-1,o=i.alpha()-n.alpha(),s=((a*o==-1?a:(a+o)/(1+a*o))+1)/2,l=1-s;return c.rgb(s*i.red()+l*n.red(),s*i.green()+l*n.green(),s*i.blue()+l*n.blue(),i.alpha()*r+n.alpha()*(1-r))}},Object.keys(r).forEach((function(t){if(-1===o.indexOf(t)){var e=r[t].channels;c.prototype[t]=function(){if(this.model===t)return new c(this);if(arguments.length)return new c(arguments,t);var i="number"==typeof arguments[e]?e:this.valpha;return new c(d(r[this.model][t].raw(this.color)).concat(i),t)},c[t]=function(i){return"number"==typeof i&&(i=p(a.call(arguments),e)),new c(i,t)}}})),t.exports=c},function(t,e,i){"use strict";i.r(e),i.d(e,"MeshBVH",(function(){return Ct})),i.d(e,"Visualizer",(function(){return St})),i.d(e,"MeshBVHVisualizer",(function(){return St})),i.d(e,"MeshBVHDebug",(function(){return It})),i.d(e,"acceleratedRaycast",(function(){return Ht})),i.d(e,"computeBoundsTree",(function(){return zt})),i.d(e,"disposeBoundsTree",(function(){return Vt})),i.d(e,"CENTER",(function(){return A})),i.d(e,"AVERAGE",(function(){return v})),i.d(e,"SAH",(function(){return w})),i.d(e,"NOT_INTERSECTED",(function(){return E})),i.d(e,"INTERSECTED",(function(){return _})),i.d(e,"CONTAINED",(function(){return x})),i.d(e,"estimateMemoryInBytes",(function(){return Pt})),i.d(e,"getBVHExtremes",(function(){return Ot}));THREE;const{Box3:n,BufferAttribute:r,Vector3:a,Vector2:o,Plane:s,Line3:l,Triangle:c,Sphere:u,Matrix4:h,BackSide:d,DoubleSide:p,Mesh:f,LineSegments:m,Group:g,LineBasicMaterial:y,Ray:b}=THREE,A=0,v=1,w=2,E=0,_=1,x=2;class MeshBVHNode{constructor(){}}function T(t,e){return e.min.x=t[0],e.min.y=t[1],e.min.z=t[2],e.max.x=t[3],e.max.y=t[4],e.max.z=t[5],e}function M(t){let e=-1,i=-1/0;for(let n=0;n<3;n++){const r=t[n+3]-t[n];r>i&&(i=r,e=n)}return e}const C=Math.pow(2,-24),k=["x","y","z"],R=new n;function S(t,e,i,n,r=null){let a=1/0,o=1/0,s=1/0,l=-1/0,c=-1/0,u=-1/0,h=1/0,d=1/0,p=1/0,f=-1/0,m=-1/0,g=-1/0;const y=null!==r;for(let n=6*e,r=6*(e+i);n<r;n+=6){const e=t[n+0],i=t[n+1],r=e-i,b=e+i;r<a&&(a=r),b>l&&(l=b),y&&e<h&&(h=e),y&&e>f&&(f=e);const A=t[n+2],v=t[n+3],w=A-v,E=A+v;w<o&&(o=w),E>c&&(c=E),y&&A<d&&(d=A),y&&A>m&&(m=A);const _=t[n+4],x=t[n+5],T=_-x,M=_+x;T<s&&(s=T),M>u&&(u=M),y&&_<p&&(p=_),y&&_>g&&(g=_)}n[0]=a,n[1]=o,n[2]=s,n[3]=l,n[4]=c,n[5]=u,y&&(r[0]=h,r[1]=d,r[2]=p,r[3]=f,r[4]=m,r[5]=g)}function D(t,e){function i(e,r,p,f=null,m=0){if(!d&&m>=l&&(d=!0,c&&(console.warn(`MeshBVH: Max depth of ${l} reached when generating BVH. Consider increasing maxDepth.`),console.warn(this,t))),p<=u||m>=l)return e.offset=r,e.count=p,e;const g=function(t,e,i,n,r,a,o){let s=-1,l=0;if(o===A)s=M(e),-1!==s&&(l=(e[s]+e[s+3])/2);else if(o===v)s=M(t),-1!==s&&(l=function(t,e,i,n){let r=0;for(let a=e,o=e+i;a<o;a++)r+=t[6*a+2*n];return r/i}(i,r,a,s));else if(o===w){const e=3,i=1,o=T(t,R),c=[o.max.x-o.min.x,o.max.y-o.min.y,o.max.z-o.min.z],u=2*(c[0]*c[1]+c[0]*c[2]+c[1]*c[2]),h=[[],[],[]];for(let t=r,e=r+a;t<e;t++)for(let e=0;e<3;e++)h[e].push(n[e][t]);h.forEach((t=>t.sort(((t,e)=>t.p-e.p))));const d=(t,n,r,a,o)=>e+i*(n/t*r+a/t*o);s=-1;let p=i*a;for(let t=0;t<3;t++){const e=(t+1)%3,i=(t+2)%3,n=o.min[k[t]],r=o.max[k[t]],f=h[t];let m=0,g=a;for(let a=0;a<f.length;a++){const o=f[a];m++,g--;const h=o.p-n,y=r-o.p;let b=c[e],A=c[e],v=c[i],w=c[i];const E=d(u,2*(b*v+b*h+v*h),m,2*(A*w+A*y+w*y),g);E<p&&(s=t,l=o.p,p=E)}}}return{axis:s,pos:l}}(e.boundingData,f,a,o,r,p,h);if(-1===g.axis)return e.offset=r,e.count=p,e;const y=function(t,e,i,n,r,a){let o=n,s=n+r-1;const l=a.pos,c=2*a.axis;for(;;){for(;o<=s&&e[6*o+c]<l;)o++;for(;o<=s&&e[6*s+c]>=l;)s--;if(!(o<s))return o;for(let i=0;i<3;i++){let n=t[3*o+i];t[3*o+i]=t[3*s+i],t[3*s+i]=n;let r=e[6*o+2*i+0];e[6*o+2*i+0]=e[6*s+2*i+0],e[6*s+2*i+0]=r;let a=e[6*o+2*i+1];e[6*o+2*i+1]=e[6*s+2*i+1],e[6*s+2*i+1]=a}if(i)for(let t=0;t<3;t++){let e=i[t][o];i[t][o]=i[t][s],i[t][s]=e}o++,s--}}(s,a,o,r,p,g);if(y===r||y===r+p)e.offset=r,e.count=p;else{e.splitAxis=g.axis;const t=new MeshBVHNode,o=r,s=y-r;e.left=t,t.boundingData=new Float32Array(6),S(a,o,s,t.boundingData,n),i(t,o,s,n,m+1);const l=new MeshBVHNode,c=y,u=p-s;e.right=l,l.boundingData=new Float32Array(6),S(a,c,u,l.boundingData,n),i(l,c,u,n,m+1)}return e}!function(t){if(!t.index){const e=t.attributes.position.count,i=new(e>65535?Uint32Array:Uint16Array)(e);t.setIndex(new r(i,1));for(let t=0;t<e;t++)i[t]=t}}(t);const n=new Float32Array(6),a=function(t){const e=t.attributes.position,i=e.array,n=t.index.array,r=n.length/3,a=new Float32Array(6*r),o=e.offset||0;let s=3;e.isInterleavedBufferAttribute&&(s=e.data.stride);for(let t=0;t<r;t++){const e=3*t,r=6*t,l=n[e+0]*s+o,c=n[e+1]*s+o,u=n[e+2]*s+o;for(let t=0;t<3;t++){const e=i[l+t],n=i[c+t],o=i[u+t];let s=e;n<s&&(s=n),o<s&&(s=o);let h=e;n>h&&(h=n),o>h&&(h=o);const d=(h-s)/2,p=2*t;a[r+p+0]=s+d,a[r+p+1]=d+(Math.abs(s)+d)*C}}return a}(t),o=e.strategy===w?function(t){const e=t.length/6,i=[new Array(e),new Array(e),new Array(e)];for(let n=0;n<e;n++)for(let e=0;e<3;e++)i[e][n]={p:t[6*n+2*e],tri:n};return i}(a):null,s=t.index.array,l=e.maxDepth,c=e.verbose,u=e.maxLeafTris,h=e.strategy;let d=!1;const p=[],f=function(t){if(!t.groups||!t.groups.length)return[{offset:0,count:t.index.count/3}];const e=[],i=new Set;for(const e of t.groups)i.add(e.start),i.add(e.start+e.count);const n=Array.from(i.values()).sort(((t,e)=>t-e));for(let t=0;t<n.length-1;t++){const i=n[t],r=n[t+1];e.push({offset:i/3,count:(r-i)/3})}return e}(t);if(1===f.length){const e=new MeshBVHNode,r=f[0];null!=t.boundingBox?(e.boundingData=function(t){const e=new Float32Array(6);return e[0]=t.min.x,e[1]=t.min.y,e[2]=t.min.z,e[3]=t.max.x,e[4]=t.max.y,e[5]=t.max.z,e}(t.boundingBox),function(t,e,i,n){let r=1/0,a=1/0,o=1/0,s=-1/0,l=-1/0,c=-1/0;for(let n=6*e,u=6*(e+i);n<u;n+=6){const e=t[n+0];e<r&&(r=e),e>s&&(s=e);const i=t[n+2];i<a&&(a=i),i>l&&(l=i);const u=t[n+4];u<o&&(o=u),u>c&&(c=u)}n[0]=r,n[1]=a,n[2]=o,n[3]=s,n[4]=l,n[5]=c}(a,r.offset,r.count,n)):(e.boundingData=new Float32Array(6),S(a,r.offset,r.count,e.boundingData,n)),i(e,r.offset,r.count,n),p.push(e)}else for(let t of f){const e=new MeshBVHNode;e.boundingData=new Float32Array(6),S(a,t.offset,t.count,e.boundingData,n),i(e,t.offset,t.count,n),p.push(e)}return p}const O=65535;class P{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(t,e){let i=1/0,n=-1/0;for(let r=0,a=t.length;r<a;r++){const a=t[r][e];i=Math.min(a,i),n=Math.max(a,n)}this.min=i,this.max=n}setFromPoints(t,e){let i=1/0,n=-1/0;for(let r=0,a=e.length;r<a;r++){const a=e[r],o=t.dot(a);i=Math.min(o,i),n=Math.max(o,n)}this.min=i,this.max=n}isSeparated(t){return this.min>t.max||t.min>this.max}}P.prototype.setFromBox=function(){const t=new a;return function(e,i){const n=i.min,r=i.max;let a=1/0,o=-1/0;for(let i=0;i<=1;i++)for(let s=0;s<=1;s++)for(let l=0;l<=1;l++){t.x=n.x*i+r.x*(1-i),t.y=n.y*s+r.y*(1-s),t.z=n.z*l+r.z*(1-l);const c=e.dot(t);a=Math.min(c,a),o=Math.max(c,o)}this.min=a,this.max=o}}();!function(){const t=new P}();const F=function(){const t=new a,e=new a,i=new a;return function(n,r,a){const o=n.start,s=t,l=r.start,c=e;i.subVectors(o,l),t.subVectors(n.end,r.start),e.subVectors(r.end,r.start);const u=i.dot(c),h=c.dot(s),d=c.dot(c),p=i.dot(s),f=s.dot(s)*d-h*h;let m,g;m=0!==f?(u*h-p*d)/f:0,g=(u+m*h)/d,a.x=m,a.y=g}}(),U=function(){const t=new o,e=new a,i=new a;return function(n,r,a,o){F(n,r,t);let s=t.x,l=t.y;if(s>=0&&s<=1&&l>=0&&l<=1)return n.at(s,a),void r.at(l,o);if(s>=0&&s<=1)return l<0?r.at(0,o):r.at(1,o),void n.closestPointToPoint(o,!0,a);if(l>=0&&l<=1)return s<0?n.at(0,a):n.at(1,a),void r.closestPointToPoint(a,!0,o);{let t,c;t=s<0?n.start:n.end,c=l<0?r.start:r.end;const u=e,h=i;return n.closestPointToPoint(c,!0,e),r.closestPointToPoint(t,!0,i),u.distanceToSquared(c)<=h.distanceToSquared(t)?(a.copy(u),void o.copy(c)):(a.copy(t),void o.copy(h))}}}(),B=function(){const t=new a,e=new a,i=new s,n=new l;return function(r,a){const{radius:o,center:s}=r,{a:l,b:c,c:u}=a;n.start=l,n.end=c;if(n.closestPointToPoint(s,!0,t).distanceTo(s)<=o)return!0;n.start=l,n.end=u;if(n.closestPointToPoint(s,!0,t).distanceTo(s)<=o)return!0;n.start=c,n.end=u;if(n.closestPointToPoint(s,!0,t).distanceTo(s)<=o)return!0;const h=a.getPlane(i);if(Math.abs(h.distanceToPoint(s))<=o){const t=h.projectPoint(s,e);if(a.containsPoint(t))return!0}return!1}}();class I extends c{constructor(...t){super(...t),this.isSeparatingAxisTriangle=!0,this.satAxes=new Array(4).fill().map((()=>new a)),this.satBounds=new Array(4).fill().map((()=>new P)),this.points=[this.a,this.b,this.c],this.sphere=new u,this.needsUpdate=!1}intersectsSphere(t){return B(t,this)}update(){const t=this.a,e=this.b,i=this.c,n=this.points,r=this.satAxes,a=this.satBounds,o=r[0],s=a[0];this.getNormal(o),s.setFromPoints(o,n);const l=r[1],c=a[1];l.subVectors(t,e),c.setFromPoints(l,n);const u=r[2],h=a[2];u.subVectors(e,i),h.setFromPoints(u,n);const d=r[3],p=a[3];d.subVectors(i,t),p.setFromPoints(d,n),this.sphere.setFromPoints(this.points),this.needsUpdate=!1}}I.prototype.closestPointToSegment=function(){const t=new a,e=new a,i=new l;return function(n,r=null,a=null){const{start:o,end:s}=n,l=this.points;let c,u=1/0;for(let o=0;o<3;o++){const s=(o+1)%3;i.start.copy(l[o]),i.end.copy(l[s]),U(i,n,t,e),c=t.distanceToSquared(e),c<u&&(u=c,r&&r.copy(t),a&&a.copy(e))}return this.closestPointToPoint(o,t),c=o.distanceToSquared(t),c<u&&(u=c,r&&r.copy(t),a&&a.copy(o)),this.closestPointToPoint(s,t),c=s.distanceToSquared(t),c<u&&(u=c,r&&r.copy(t),a&&a.copy(s)),Math.sqrt(u)}}(),I.prototype.intersectsTriangle=function(){const t=new I,e=new Array(3),i=new Array(3),n=new P,r=new P,o=new a;return function(a){this.needsUpdate&&this.update(),a.isSeparatingAxisTriangle?a.needsUpdate&&a.update():(t.copy(a),t.update(),a=t);const s=this.satBounds,l=this.satAxes;i[0]=a.a,i[1]=a.b,i[2]=a.c;for(let t=0;t<4;t++){const e=s[t],r=l[t];if(n.setFromPoints(r,i),e.isSeparated(n))return!1}const c=a.satBounds,u=a.satAxes;e[0]=this.a,e[1]=this.b,e[2]=this.c;for(let t=0;t<4;t++){const i=c[t],r=u[t];if(n.setFromPoints(r,e),i.isSeparated(n))return!1}for(let t=0;t<4;t++){const a=l[t];for(let t=0;t<4;t++){const s=u[t];if(o.crossVectors(a,s),n.setFromPoints(o,e),r.setFromPoints(o,i),n.isSeparated(r))return!1}}return!0}}(),I.prototype.distanceToPoint=function(){const t=new a;return function(e){return this.closestPointToPoint(e,t),e.distanceTo(t)}}(),I.prototype.distanceToTriangle=function(){const t=new a,e=new a,i=["a","b","c"],n=new l,r=new l;return function(a,o=null,s=null){if(this.intersectsTriangle(a))return(o||s)&&(this.getMidpoint(t),a.closestPointToPoint(t,e),this.closestPointToPoint(e,t),o&&o.copy(t),s&&s.copy(e)),0;let l=1/0;for(let e=0;e<3;e++){let n;const r=i[e],c=a[r];this.closestPointToPoint(c,t),n=c.distanceToSquared(t),n<l&&(l=n,o&&o.copy(t),s&&s.copy(c));const u=this[r];a.closestPointToPoint(u,t),n=u.distanceToSquared(t),n<l&&(l=n,o&&o.copy(u),s&&s.copy(t))}for(let c=0;c<3;c++){const u=i[c],h=i[(c+1)%3];n.set(this[u],this[h]);for(let c=0;c<3;c++){const u=i[c],h=i[(c+1)%3];r.set(a[u],a[h]),U(n,r,t,e);const d=t.distanceToSquared(e);d<l&&(l=d,o&&o.copy(t),s&&s.copy(e))}}return Math.sqrt(l)}}();class j extends n{constructor(...t){super(...t),this.isOrientedBox=!0,this.matrix=new h,this.invMatrix=new h,this.points=new Array(8).fill().map((()=>new a)),this.satAxes=new Array(3).fill().map((()=>new a)),this.satBounds=new Array(3).fill().map((()=>new P)),this.alignedSatBounds=new Array(3).fill().map((()=>new P)),this.sphere=new u,this.needsUpdate=!1}set(t,e,i){super.set(t,e),this.matrix=i,this.needsUpdate=!0}copy(t){super.copy(t),this.matrix.copy(t.matrix),this.needsUpdate=!0}}function L(t,e,i,n){const r=t.a,a=t.b,o=t.c;let s=e,l=e+1,c=e+2;i&&(s=i.getX(e),l=i.getX(e+1),c=i.getX(e+2)),r.x=n.getX(s),r.y=n.getY(s),r.z=n.getZ(s),a.x=n.getX(l),a.y=n.getY(l),a.z=n.getZ(l),o.x=n.getX(c),o.y=n.getY(c),o.z=n.getZ(c)}j.prototype.update=function(){const t=this.matrix,e=this.min,i=this.max,n=this.points;for(let r=0;r<=1;r++)for(let a=0;a<=1;a++)for(let o=0;o<=1;o++){const s=n[1*r|2*a|4*o];s.x=r?i.x:e.x,s.y=a?i.y:e.y,s.z=o?i.z:e.z,s.applyMatrix4(t)}this.sphere.setFromPoints(this.points);const r=this.satBounds,a=this.satAxes,o=n[0];for(let t=0;t<3;t++){const e=a[t],i=r[t],s=n[1<<t];e.subVectors(o,s),i.setFromPoints(e,n)}const s=this.alignedSatBounds;s[0].setFromPointsField(n,"x"),s[1].setFromPointsField(n,"y"),s[2].setFromPointsField(n,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1},j.prototype.intersectsBox=function(){const t=new P;return function(e){if(this.needsUpdate&&this.update(),!e.intersectsSphere(this.sphere))return!1;const i=e.min,n=e.max,r=this.satBounds,a=this.satAxes,o=this.alignedSatBounds;if(t.min=i.x,t.max=n.x,o[0].isSeparated(t))return!1;if(t.min=i.y,t.max=n.y,o[1].isSeparated(t))return!1;if(t.min=i.z,t.max=n.z,o[2].isSeparated(t))return!1;for(let i=0;i<3;i++){const n=a[i],o=r[i];if(t.setFromBox(n,e),o.isSeparated(t))return!1}return!0}}(),j.prototype.intersectsTriangle=function(){const t=new I,e=new Array(3),i=new P,n=new P,r=new a;return function(a){this.needsUpdate&&this.update(),a.isSeparatingAxisTriangle?a.needsUpdate&&a.update():(t.copy(a),t.update(),a=t);const o=this.satBounds,s=this.satAxes;e[0]=a.a,e[1]=a.b,e[2]=a.c;for(let t=0;t<3;t++){const n=o[t],r=s[t];if(i.setFromPoints(r,e),n.isSeparated(i))return!1}const l=a.satBounds,c=a.satAxes,u=this.points;for(let t=0;t<3;t++){const e=l[t],n=c[t];if(i.setFromPoints(n,u),e.isSeparated(i))return!1}for(let t=0;t<3;t++){const a=s[t];for(let t=0;t<4;t++){const o=c[t];if(r.crossVectors(a,o),i.setFromPoints(r,e),n.setFromPoints(r,u),i.isSeparated(n))return!1}}return!0}}(),j.prototype.closestPointToPoint=function(t,e){return this.needsUpdate&&this.update(),e.copy(t).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),e},j.prototype.distanceToPoint=function(){const t=new a;return function(e){return this.closestPointToPoint(e,t),e.distanceTo(t)}}(),j.prototype.distanceToBox=function(){const t=["x","y","z"],e=new Array(12).fill().map((()=>new l)),i=new Array(12).fill().map((()=>new l)),n=new a,r=new a;return function(a,o=0,s=null,l=null){if(this.needsUpdate&&this.update(),this.intersectsBox(a))return(s||l)&&(a.getCenter(r),this.closestPointToPoint(r,n),a.closestPointToPoint(n,r),s&&s.copy(n),l&&l.copy(r)),0;const c=o*o,u=a.min,h=a.max,d=this.points;let p=1/0;for(let t=0;t<8;t++){const e=d[t];r.copy(e).clamp(u,h);const i=e.distanceToSquared(r);if(i<p&&(p=i,s&&s.copy(e),l&&l.copy(r),i<c))return Math.sqrt(i)}let f=0;for(let n=0;n<3;n++)for(let r=0;r<=1;r++)for(let a=0;a<=1;a++){const o=(n+1)%3,s=(n+2)%3,l=1<<n|r<<o|a<<s,c=d[r<<o|a<<s],p=d[l];e[f].set(c,p);const m=t[n],g=t[o],y=t[s],b=i[f],A=b.start,v=b.end;A[m]=u[m],A[g]=r?u[g]:h[g],A[y]=a?u[y]:h[g],v[m]=h[m],v[g]=r?u[g]:h[g],v[y]=a?u[y]:h[g],f++}for(let t=0;t<=1;t++)for(let e=0;e<=1;e++)for(let i=0;i<=1;i++){r.x=t?h.x:u.x,r.y=e?h.y:u.y,r.z=i?h.z:u.z,this.closestPointToPoint(r,n);const a=r.distanceToSquared(n);if(a<p&&(p=a,s&&s.copy(n),l&&l.copy(r),a<c))return Math.sqrt(a)}for(let t=0;t<12;t++){const a=e[t];for(let t=0;t<12;t++){const e=i[t];U(a,e,n,r);const o=n.distanceToSquared(r);if(o<p&&(p=o,s&&s.copy(n),l&&l.copy(r),o<c))return Math.sqrt(o)}}return Math.sqrt(p)}}();var N=new a,H=new a,z=new a,V=new o,G=new o,W=new o,X=new a,Y=new a;function Q(t,e,i,n,r,s,l,u){N.fromBufferAttribute(n,s),H.fromBufferAttribute(n,l),z.fromBufferAttribute(n,u);var h=function(t,e,i,n,r,a,o,s){if(null===(e.side===d?n.intersectTriangle(o,a,r,!0,s):n.intersectTriangle(r,a,o,e.side!==p,s)))return null;Y.copy(s),Y.applyMatrix4(t.matrixWorld);var l=i.ray.origin.distanceTo(Y);return l<i.near||l>i.far?null:{localPoint:s,distance:l,point:Y.clone(),object:t}}(t,t.material,e,i,N,H,z,X);if(h){r&&(V.fromBufferAttribute(r,s),G.fromBufferAttribute(r,l),W.fromBufferAttribute(r,u),h.uv=c.getUV(X,N,H,z,V,G,W,new o));const t={a:s,b:l,c:u,normal:new a,materialIndex:0};c.getNormal(N,H,z,t.normal),h.face=t,h.faceIndex=s}return h}function q(t,e,i,n,r,a){const o=3*r,s=e.index.getX(o),l=e.index.getX(o+1),c=e.index.getX(o+2),u=Q(t,i,n,e.attributes.position,e.attributes.uv,s,l,c);return u?(u.faceIndex=r,a&&a.push(u),u):null}function Z(t,e,i){i.min.x=e[t],i.min.y=e[t+1],i.min.z=e[t+2],i.max.x=e[t+3],i.max.y=e[t+4],i.max.z=e[t+5]}function K(t,e,i,n,r,a,o){const s=i.index,l=i.attributes.position;for(let i=t,c=e+t;i<c;i++)if(L(o,3*i,s,l),o.needsUpdate=!0,n(o,i,r,a))return!0;return!1}const J=new n,$=new a,tt=["x","y","z"];function et(t,e){return 65535===e[t+15]}function it(t,e){return e[t+6]}function nt(t,e){return e[t+14]}function rt(t){return t+8}function at(t,e){return e[t+6]}function ot(t,e,i,n,r,a){let o=2*t,s=pt,l=ft,c=mt;if(et(o,l)){!function(t,e,i,n,r,a,o){for(let s=r,l=r+a;s<l;s++)q(t,e,i,n,s,o)}(e,i,n,r,it(t,c),nt(o,l),a)}else{const o=rt(t);ut(o,s,r,$)&&ot(o,e,i,n,r,a);const l=at(t,c);ut(l,s,r,$)&&ot(l,e,i,n,r,a)}}function st(t,e,i,n,r){let a=2*t,o=pt,s=ft,l=mt;if(et(a,s)){return function(t,e,i,n,r,a){let o=1/0,s=null;for(let l=r,c=r+a;l<c;l++){const r=q(t,e,i,n,l);r&&r.distance<o&&(s=r,o=r.distance)}return s}(e,i,n,r,it(t,l),nt(a,s))}{const a=function(t,e){return e[t+7]}(t,l),s=tt[a],c=r.direction[s]>=0;let u,h;c?(u=rt(t),h=at(t,l)):(u=at(t,l),h=rt(t));const d=ut(u,o,r,$)?st(u,e,i,n,r):null;if(d){const t=d.localPoint[s];if(c?t<=o[h+a]:t>=o[h+a+3])return d}const p=ut(h,o,r,$)?st(h,e,i,n,r):null;return d&&p?d.distance<=p.distance?d:p:d||p||null}}const lt=function(){const t=new n,e=new n;return function i(n,r,a,o,s=null,l=0,c=0){function u(t){let e=2*t,i=ft,n=mt;for(;!et(e,i);)e=2*(t=rt(t));return it(t,n)}function h(t){let e=2*t,i=ft,n=mt;for(;!et(e,i);)e=2*(t=at(t,n));return it(t,n)+nt(e,i)}let d=2*n,p=pt,f=ft,m=mt;if(et(d,f)){return o(it(n,m),nt(d,f),!1,c,l+n)}{const d=rt(n),g=at(n,m);let y,b,A,v,w=d,E=g;if(s&&(A=t,v=e,Z(w,p,A),Z(E,p,v),y=s(A),b=s(v),b<y)){w=g,E=d;const t=y;y=b,b=t,A=v}A||(A=t,Z(w,p,A));const _=a(A,et(2*w,f),y,c+1,l+w);let T;if(_===x){const t=u(w);T=o(t,h(w)-t,!0,c+1,l+w)}else T=_&&i(w,r,a,o,s,l,c+1);if(T)return!0;v=e,Z(E,p,v);const M=a(v,et(2*E,f),b,c+1,l+E);let C;if(M===x){const t=u(E);C=o(t,h(E)-t,!0,c+1,l+E)}else C=M&&i(E,r,a,o,s,l,c+1);return!!C}}}(),ct=function(){const t=new I,e=new I,i=new f,n=new h,r=new j,a=new j;return function o(s,l,c,u,h,d=null){let p=2*s,f=pt,m=ft,g=mt;null===d&&(u.boundingBox||u.computeBoundingBox(),r.set(u.boundingBox.min,u.boundingBox.max,h),d=r);if(!et(p,m)){const t=s+8,e=g[s+6];Z(t,f,J);if(d.intersectsBox(J)&&o(t,l,c,u,h,d))return!0;Z(e,f,J);return!!(d.intersectsBox(J)&&o(e,l,c,u,h,d))}{const r=c,o=r.index,l=r.attributes.position,d=u.index,y=u.attributes.position,b=it(s,g),A=nt(p,m);if(n.copy(h).invert(),u.boundsTree){Z(s,f,a),a.matrix.copy(n),a.needsUpdate=!0,i.geometry=u;const t=u.boundsTree.shapecast(i,{intersectsBounds:t=>a.intersectsBox(t),intersectsTriangle:t=>{t.a.applyMatrix4(h),t.b.applyMatrix4(h),t.c.applyMatrix4(h),t.needsUpdate=!0;for(let i=3*b,n=3*(A+b);i<n;i+=3)if(L(e,i,o,l),e.needsUpdate=!0,t.intersectsTriangle(e))return!0;return!1}});return i.geometry=null,t}for(let i=3*b,r=A+3*b;i<r;i+=3){L(t,i,o,l),t.a.applyMatrix4(n),t.b.applyMatrix4(n),t.c.applyMatrix4(n),t.needsUpdate=!0;for(let i=0,n=d.count;i<n;i+=3)if(L(e,i,d,y),e.needsUpdate=!0,t.intersectsTriangle(e))return!0}}}}();function ut(t,e,i,n){return Z(t,e,J),i.intersectBox(J,n)}const ht=[];let dt,pt,ft,mt;function gt(t){dt&&ht.push(dt),dt=t,pt=new Float32Array(t),ft=new Uint16Array(t),mt=new Uint32Array(t)}function yt(){dt=null,pt=null,ft=null,mt=null,ht.length&&gt(ht.pop())}const bt=Symbol("skip tree generation"),At=new j,vt=new j,wt=new a,Et=new a,_t=new a,xt=new n,Tt=new I,Mt=new I;class Ct{static serialize(t,e,i=!0){const n=t._roots,r=e.getIndex();return{roots:n,index:i?r.array.slice():r.array}}static deserialize(t,e,i=!0){const{index:n,roots:a}=t,o=new Ct(e,{[bt]:!0});if(o._roots=a,i){const i=e.getIndex();if(null===i){const i=new r(t.index,1,!1);e.setIndex(i)}else i.array!==n&&(i.array.set(n),i.needsUpdate=!0)}return o}constructor(t,e={}){if(!t.isBufferGeometry)throw new Error("MeshBVH: Only BufferGeometries are supported.");if(t.index&&t.index.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.");(e=Object.assign({strategy:A,maxDepth:40,maxLeafTris:10,verbose:!0,setBoundingBox:!0,[bt]:!1},e)).strategy=Math.max(0,Math.min(2,e.strategy)),this._roots=null,e[bt]||(this._roots=function(t,e){const i=D(t,e);let n,r,a;const o=[];for(let t=0;t<i.length;t++){const e=i[t];let c=s(e);const u=new ArrayBuffer(32*c);n=new Float32Array(u),r=new Uint32Array(u),a=new Uint16Array(u),l(0,e),o.push(u)}return o;function s(t){return t.count?1:1+s(t.left)+s(t.right)}function l(t,e){const i=t/4,o=t/2,s=!!e.count,c=e.boundingData;for(let t=0;t<6;t++)n[i+t]=c[t];if(s){const n=e.offset,s=e.count;return r[i+6]=n,a[o+14]=s,a[o+15]=O,t+32}{const n=e.left,a=e.right,o=e.splitAxis;let s;if(s=l(t+32,n),s/4>Math.pow(2,32))throw new Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return r[i+6]=s/4,s=l(s,a),r[i+7]=o,s}}}(t,e),!t.boundingBox&&e.setBoundingBox&&(t.boundingBox=this.getBoundingBox(new n))),this.geometry=t}refit(t=null,e=null){t&&Array.isArray(t)&&(t=new Set(t)),e&&Array.isArray(e)&&(e=new Set(e));const i=this.geometry,n=i.index.array,r=i.attributes.position,a=r.array,o=r.offset||0;let s,l,c,u,h=3;r.isInterleavedBufferAttribute&&(h=r.data.stride);let d=0;const p=this._roots;for(let t=0,e=p.length;t<e;t++)s=p[t],l=new Uint32Array(s),c=new Uint16Array(s),u=new Float32Array(s),f(0,d),d+=s.byteLength;function f(i,r,s=!1){const d=2*i;if(c[d+15]===O){const t=l[i+6];let e=1/0,r=1/0,s=1/0,p=-1/0,f=-1/0,m=-1/0;for(let i=3*t,l=3*(t+c[d+14]);i<l;i++){const t=n[i]*h+o,l=a[t+0],c=a[t+1],u=a[t+2];l<e&&(e=l),l>p&&(p=l),c<r&&(r=c),c>f&&(f=c),u<s&&(s=u),u>m&&(m=u)}return(u[i+0]!==e||u[i+1]!==r||u[i+2]!==s||u[i+3]!==p||u[i+4]!==f||u[i+5]!==m)&&(u[i+0]=e,u[i+1]=r,u[i+2]=s,u[i+3]=p,u[i+4]=f,u[i+5]=m,!0)}{const n=i+8,a=l[i+6],o=n+r,c=a+r;let h=!1,d=s||e&&e.has(o);(d||!t||t.has(o))&&(h=f(n,r,d));let p=!1,m=s||e&&e.has(c);(m||!t||t.has(c))&&(p=f(a,r,m));const g=h||p;if(g)for(let t=0;t<3;t++){const e=n+t,r=a+t,o=u[e],s=u[e+3],l=u[r],c=u[r+3];u[i+t]=o<l?o:l,u[i+t+3]=s>c?s:c}return g}}}traverse(t,e=0){const i=this._roots[e],n=new Uint32Array(i),r=new Uint16Array(i);!function e(a,o=0){const s=2*a,l=r[s+15]===O;if(l){const e=n[a+6],c=r[s+14];t(o,l,new Float32Array(i,4*a,6),e,c)}else{const r=a+8,s=n[a+6],c=n[a+7];t(o,l,new Float32Array(i,4*a,6),c)||(e(r,o+1),e(s,o+1))}}(0)}raycast(t,e,i,n){const r=this.geometry,a=n?[]:null;for(const n of this._roots)gt(n),ot(0,t,r,e,i,a),yt();if(n){for(let t=0,e=a.length;t<e;t++)delete a[t].localPoint;n.push(...a)}}raycastFirst(t,e,i){const n=this.geometry;let r=null;for(const a of this._roots){gt(a);const o=st(0,t,n,e,i);yt(),null!=o&&(null==r||o.distance<r.distance)&&(r=o)}return r&&delete r.localPoint,r}intersectsGeometry(t,e,i){const n=this.geometry;let r=!1;for(const a of this._roots)if(gt(a),r=ct(0,t,n,e,i),yt(),r)break;return r}shapecast(t,e,i,n){const r=this.geometry;if(e instanceof Function){if(i){const t=i;i=(e,i,n,r)=>{const a=3*i;return t(e,a,a+1,a+2,n,r)}}e={boundsTraverseOrder:n,intersectsBounds:e,intersectsTriangle:i,intersectsRange:null},console.warn("MeshBVH: Shapecast function signature has changed and now takes an object of callbacks as a second argument. See docs for new signature.")}let{boundsTraverseOrder:a,intersectsBounds:o,intersectsRange:s,intersectsTriangle:l}=e;if(s&&l){const t=s;s=(e,i,n,a,o)=>!!t(e,i,n,a,o)||K(e,i,r,l,n,a,Tt)}else s||(s=l?(t,e,i,n)=>K(t,e,r,l,i,n,Tt):(t,e,i)=>i);let c=!1,u=0;for(const t of this._roots){if(gt(t),c=lt(0,r,o,s,a,u),yt(),c)break;u+=t.byteLength}return c}intersectsBox(t,e,i){return At.set(e.min,e.max,i),At.needsUpdate=!0,this.shapecast(t,{intersectsBounds:t=>At.intersectsBox(t),intersectsTriangle:t=>At.intersectsTriangle(t)})}intersectsSphere(t,e){return this.shapecast(t,{intersectsBounds:t=>e.intersectsBox(t),intersectsTriangle:t=>t.intersectsSphere(e)})}closestPointToGeometry(t,e,i,n=null,r=null,a=0,o=1/0){e.boundingBox||e.computeBoundingBox(),At.set(e.boundingBox.min,e.boundingBox.max,i),At.needsUpdate=!0;const s=this.geometry,l=s.attributes.position,c=s.index,u=e.attributes.position,h=e.index;let d=null,p=null;n&&(d=Et),r&&(p=_t);let f=1/0;return vt.matrix.copy(i).invert(),this.shapecast(t,{boundsTraverseOrder:t=>At.distanceToBox(t,Math.min(f,o)),intersectsBounds:(t,e,i)=>i<f&&i<o&&(e&&(vt.min.copy(t.min),vt.max.copy(t.max),vt.needsUpdate=!0),!0),intersectsRange:(t,s)=>{if(e.boundsTree)return e.boundsTree.shapecast(null,{boundsTraverseOrder:t=>vt.distanceToBox(t,Math.min(f,o)),intersectsBounds:(t,e,i)=>i<f&&i<o,intersectsRange:(e,o)=>{for(let m=3*e,g=3*(e+o);m<g;m+=3){L(Mt,m,h,u),Mt.a.applyMatrix4(i),Mt.b.applyMatrix4(i),Mt.c.applyMatrix4(i),Mt.needsUpdate=!0;for(let e=3*t,i=3*(t+s);e<i;e+=3){L(Tt,e,c,l),Tt.needsUpdate=!0;const t=Tt.distanceToTriangle(Mt,d,p);if(t<f&&(n&&n.copy(d),r&&r.copy(p),f=t),t<a)return!0}}}});for(let e=0,o=h?h.count:u.count;e<o;e+=3){L(Mt,e,h,u),Mt.a.applyMatrix4(i),Mt.b.applyMatrix4(i),Mt.c.applyMatrix4(i),Mt.needsUpdate=!0;for(let e=3*t,i=3*(t+s);e<i;e+=3){L(Tt,e,c,l),Tt.needsUpdate=!0;const t=Tt.distanceToTriangle(Mt,d,p);if(t<f&&(n&&n.copy(d),r&&r.copy(p),f=t),t<a)return!0}}}}),f}distanceToGeometry(t,e,i,n,r){return this.closestPointToGeometry(t,e,i,null,null,n,r)}closestPointToPoint(t,e,i,n=0,r=1/0){const a=n*n,o=r*r;let s=1/0;return this.shapecast(t,{boundsTraverseOrder:t=>(wt.copy(e).clamp(t.min,t.max),wt.distanceToSquared(e)),intersectsBounds:(t,e,i)=>i<s&&i<o,intersectsTriangle:t=>{t.closestPointToPoint(e,wt);const n=e.distanceToSquared(wt);return n<s&&(i&&i.copy(wt),s=n),n<a}}),Math.sqrt(s)}distanceToPoint(t,e,i,n){return this.closestPointToPoint(t,e,null,i,n)}getBoundingBox(t){t.makeEmpty();return this._roots.forEach((e=>{Z(0,new Float32Array(e),xt),t.union(xt)})),t}}const kt=new n;class Rt extends m{constructor(t,e,i=10,n=0){super(void 0,e),this.material=e,this.name="MeshBVHRootVisualizer",this.depth=i,this.mesh=t,this._group=n,this.update()}raycast(){}update(){const t=this.geometry,e=this.mesh.geometry.boundsTree,i=this._group;if(t.dispose(),this.visible=!1,e){const n=this.depth-1;let a=0;e.traverse(((t,e)=>{if(t===n||e)return a++,!0}),i);let o=0;const s=new Float32Array(24*a);e.traverse(((t,e,i)=>{if(t===n||e){T(i,kt);const{min:t,max:e}=kt;for(let i=-1;i<=1;i+=2){const n=i<0?t.x:e.x;for(let i=-1;i<=1;i+=2){const r=i<0?t.y:e.y;for(let i=-1;i<=1;i+=2){const a=i<0?t.z:e.z;s[o+0]=n,s[o+1]=r,s[o+2]=a,o+=3}}}return!0}}),i);const l=new Uint8Array([0,4,1,5,2,6,3,7,0,2,1,3,4,6,5,7,0,1,2,3,4,5,6,7]);let c;c=s.length>65535?new Uint32Array(24*a):new Uint16Array(24*a);for(let t=0;t<a;t++){const e=8*t,i=24*t;for(let t=0;t<24;t++)c[i+t]=e+l[t]}t.setIndex(new r(c,1,!1)),t.setAttribute("position",new r(s,3,!1)),this.visible=!0}}}class St extends g{get color(){return this._material.color}get opacity(){return this._material.opacity}set opacity(t){this._material.opacity=t}constructor(t,e=10){super(),this.name="MeshBVHVisualizer",this.depth=e,this.mesh=t,this._roots=[],this._material=new y({color:65416,transparent:!0,opacity:.3,depthWrite:!1}),this.update()}update(){const t=this.mesh.geometry.boundsTree,e=t?t._roots.length:0;for(;this._roots.length>e;)this._roots.pop();for(let t=0;t<e;t++)if(t>=this._roots.length){const e=new Rt(this.mesh,this._material,this.depth,t);this.add(e),this._roots.push(e)}else{let e=this._roots[t];e.depth=this.depth,e.mesh=this.mesh,e.update()}}updateMatrixWorld(...t){this.position.copy(this.mesh.position),this.rotation.copy(this.mesh.rotation),this.scale.copy(this.mesh.scale),super.updateMatrixWorld(...t)}copy(t){this.depth=t.depth,this.mesh=t.mesh}clone(){return new St(this.mesh,this.depth)}dispose(){this._material.dispose()}}function Dt(t){switch(typeof t){case"number":return 8;case"string":return 2*t.length;case"boolean":return 4;default:return 0}}function Ot(t){return t._roots.map(((e,i)=>function(t,e){const i={total:0,depth:{min:1/0,max:-1/0},tris:{min:1/0,max:-1/0},splits:[0,0,0]};return t.traverse(((t,e,n,r,a)=>{i.total++,e?(i.depth.min=Math.min(t,i.depth.min),i.depth.max=Math.max(t,i.depth.max),i.tris.min=Math.min(a,i.tris.min),i.tris.max=Math.max(a,i.tris.max)):i.splits[r]++}),e),i.tris.min===1/0&&(i.tris.min=0,i.tris.max=0),i.depth.min===1/0&&(i.depth.min=0,i.depth.max=0),i}(t,i)))}function Pt(t){const e=new Set,i=[t];let n=0;for(;i.length;){const t=i.pop();if(!e.has(t)){e.add(t);for(let e in t){if(!t.hasOwnProperty(e))continue;n+=Dt(e);const r=t[e];!r||"object"!=typeof r&&"function"!=typeof r?n+=Dt(r):/(Uint|Int|Float)(8|16|32)Array/.test(r.constructor.name)||r instanceof ArrayBuffer?n+=r.byteLength:i.push(r)}}}return n}const Ft=new n,Ut=new n,Bt=new a;class It{constructor(t,e){this.bvh=t,this.geometry=e}getJSONStructure(){const{bvh:t}=this,e=[];return t.traverse(((t,i,r,a,o)=>{const s={bounds:T(r,new n)};i?(s.count=o,s.offset=a):(s.left=null,s.right=null),e[t]=s;const l=e[t-1];l&&(null===l.left?l.left=s:l.right=s)})),e[0]}validateBounds(){const{bvh:t,geometry:e}=this,i=[],n=e.index,r=e.getAttribute("position");let a=!0;return t.traverse(((t,e,o,s,l)=>{const c={depth:t,isLeaf:e,boundingData:o,offset:s,count:l};i[t]=c,T(o,Ft);const u=i[t-1];if(e)for(let t=3*s,e=3*(s+l);t<e;t+=3){const e=n.getX(t),i=n.getX(t+1),o=n.getX(t+2);let s;Bt.fromBufferAttribute(r,e),s=Ft.containsPoint(Bt),Bt.fromBufferAttribute(r,i),s=s&&Ft.containsPoint(Bt),Bt.fromBufferAttribute(r,o),s=s&&Ft.containsPoint(Bt),console.assert(s,"Leaf bounds does not fully contain triangle."),a=a&&s}if(u){T(o,Ut);const t=Ut.containsBox(Ft);console.assert(t,"Parent bounds does not fully contain child."),a=a&&t}})),a}}const jt=new b,Lt=new h,Nt=f.prototype.raycast;function Ht(t,e){if(this.geometry.boundsTree){if(void 0===this.material)return;if(Lt.copy(this.matrixWorld).invert(),jt.copy(t.ray).applyMatrix4(Lt),!0===t.firstHitOnly){const i=this.geometry.boundsTree.raycastFirst(this,t,jt);i&&e.push(i)}else this.geometry.boundsTree.raycast(this,t,jt,e)}else Nt.call(this,t,e)}function zt(t){return this.boundsTree=new Ct(this,t),this.boundsTree}function Vt(){this.boundsTree=null}},function(t,e,i){!function(t){"use strict";var i={};i.exports=e,function(t){if(!e)var e=1e-6;if(!i)var i="undefined"!=typeof Float32Array?Float32Array:Array;if(!n)var n=Math.random;var r={setMatrixArrayType:function(t){i=t}};void 0!==t&&(t.glMatrix=r);var a=Math.PI/180;r.toRadian=function(t){return t*a};var o,s={};s.create=function(){var t=new i(2);return t[0]=0,t[1]=0,t},s.clone=function(t){var e=new i(2);return e[0]=t[0],e[1]=t[1],e},s.fromValues=function(t,e){var n=new i(2);return n[0]=t,n[1]=e,n},s.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},s.set=function(t,e,i){return t[0]=e,t[1]=i,t},s.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t},s.subtract=function(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t},s.sub=s.subtract,s.multiply=function(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t},s.mul=s.multiply,s.divide=function(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t},s.div=s.divide,s.min=function(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t},s.max=function(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t},s.scale=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t},s.scaleAndAdd=function(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t},s.distance=function(t,e){var i=e[0]-t[0],n=e[1]-t[1];return Math.sqrt(i*i+n*n)},s.dist=s.distance,s.squaredDistance=function(t,e){var i=e[0]-t[0],n=e[1]-t[1];return i*i+n*n},s.sqrDist=s.squaredDistance,s.length=function(t){var e=t[0],i=t[1];return Math.sqrt(e*e+i*i)},s.len=s.length,s.squaredLength=function(t){var e=t[0],i=t[1];return e*e+i*i},s.sqrLen=s.squaredLength,s.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},s.normalize=function(t,e){var i=e[0],n=e[1],r=i*i+n*n;return r>0&&(r=1/Math.sqrt(r),t[0]=e[0]*r,t[1]=e[1]*r),t},s.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},s.cross=function(t,e,i){var n=e[0]*i[1]-e[1]*i[0];return t[0]=t[1]=0,t[2]=n,t},s.lerp=function(t,e,i,n){var r=e[0],a=e[1];return t[0]=r+n*(i[0]-r),t[1]=a+n*(i[1]-a),t},s.random=function(t,e){e=e||1;var i=2*n()*Math.PI;return t[0]=Math.cos(i)*e,t[1]=Math.sin(i)*e,t},s.transformMat2=function(t,e,i){var n=e[0],r=e[1];return t[0]=i[0]*n+i[2]*r,t[1]=i[1]*n+i[3]*r,t},s.transformMat2d=function(t,e,i){var n=e[0],r=e[1];return t[0]=i[0]*n+i[2]*r+i[4],t[1]=i[1]*n+i[3]*r+i[5],t},s.transformMat3=function(t,e,i){var n=e[0],r=e[1];return t[0]=i[0]*n+i[3]*r+i[6],t[1]=i[1]*n+i[4]*r+i[7],t},s.transformMat4=function(t,e,i){var n=e[0],r=e[1];return t[0]=i[0]*n+i[4]*r+i[12],t[1]=i[1]*n+i[5]*r+i[13],t},s.forEach=(o=s.create(),function(t,e,i,n,r,a){var s,l;for(e||(e=2),i||(i=0),l=n?Math.min(n*e+i,t.length):t.length,s=i;s<l;s+=e)o[0]=t[s],o[1]=t[s+1],r(o,o,a),t[s]=o[0],t[s+1]=o[1];return t}),s.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},void 0!==t&&(t.vec2=s);var l={create:function(){var t=new i(3);return t[0]=0,t[1]=0,t[2]=0,t},clone:function(t){var e=new i(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},fromValues:function(t,e,n){var r=new i(3);return r[0]=t,r[1]=e,r[2]=n,r},copy:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},set:function(t,e,i,n){return t[0]=e,t[1]=i,t[2]=n,t},add:function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t},subtract:function(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t}};l.sub=l.subtract,l.multiply=function(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t},l.mul=l.multiply,l.divide=function(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t[2]=e[2]/i[2],t},l.div=l.divide,l.min=function(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t[2]=Math.min(e[2],i[2]),t},l.max=function(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t[2]=Math.max(e[2],i[2]),t},l.scale=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t},l.scaleAndAdd=function(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t[2]=e[2]+i[2]*n,t},l.distance=function(t,e){var i=e[0]-t[0],n=e[1]-t[1],r=e[2]-t[2];return Math.sqrt(i*i+n*n+r*r)},l.dist=l.distance,l.squaredDistance=function(t,e){var i=e[0]-t[0],n=e[1]-t[1],r=e[2]-t[2];return i*i+n*n+r*r},l.sqrDist=l.squaredDistance,l.length=function(t){var e=t[0],i=t[1],n=t[2];return Math.sqrt(e*e+i*i+n*n)},l.len=l.length,l.squaredLength=function(t){var e=t[0],i=t[1],n=t[2];return e*e+i*i+n*n},l.sqrLen=l.squaredLength,l.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},l.normalize=function(t,e){var i=e[0],n=e[1],r=e[2],a=i*i+n*n+r*r;return a>0&&(a=1/Math.sqrt(a),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a),t},l.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},l.cross=function(t,e,i){var n=e[0],r=e[1],a=e[2],o=i[0],s=i[1],l=i[2];return t[0]=r*l-a*s,t[1]=a*o-n*l,t[2]=n*s-r*o,t},l.lerp=function(t,e,i,n){var r=e[0],a=e[1],o=e[2];return t[0]=r+n*(i[0]-r),t[1]=a+n*(i[1]-a),t[2]=o+n*(i[2]-o),t},l.random=function(t,e){e=e||1;var i=2*n()*Math.PI,r=2*n()-1,a=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(i)*a,t[1]=Math.sin(i)*a,t[2]=r*e,t},l.transformMat4=function(t,e,i){var n=e[0],r=e[1],a=e[2];return t[0]=i[0]*n+i[4]*r+i[8]*a+i[12],t[1]=i[1]*n+i[5]*r+i[9]*a+i[13],t[2]=i[2]*n+i[6]*r+i[10]*a+i[14],t},l.transformMat3=function(t,e,i){var n=e[0],r=e[1],a=e[2];return t[0]=n*i[0]+r*i[3]+a*i[6],t[1]=n*i[1]+r*i[4]+a*i[7],t[2]=n*i[2]+r*i[5]+a*i[8],t},l.transformQuat=function(t,e,i){var n=e[0],r=e[1],a=e[2],o=i[0],s=i[1],l=i[2],c=i[3],u=c*n+s*a-l*r,h=c*r+l*n-o*a,d=c*a+o*r-s*n,p=-o*n-s*r-l*a;return t[0]=u*c+p*-o+h*-l-d*-s,t[1]=h*c+p*-s+d*-o-u*-l,t[2]=d*c+p*-l+u*-s-h*-o,t},l.rotateX=function(t,e,i,n){var r=[],a=[];return r[0]=e[0]-i[0],r[1]=e[1]-i[1],r[2]=e[2]-i[2],a[0]=r[0],a[1]=r[1]*Math.cos(n)-r[2]*Math.sin(n),a[2]=r[1]*Math.sin(n)+r[2]*Math.cos(n),t[0]=a[0]+i[0],t[1]=a[1]+i[1],t[2]=a[2]+i[2],t},l.rotateY=function(t,e,i,n){var r=[],a=[];return r[0]=e[0]-i[0],r[1]=e[1]-i[1],r[2]=e[2]-i[2],a[0]=r[2]*Math.sin(n)+r[0]*Math.cos(n),a[1]=r[1],a[2]=r[2]*Math.cos(n)-r[0]*Math.sin(n),t[0]=a[0]+i[0],t[1]=a[1]+i[1],t[2]=a[2]+i[2],t},l.rotateZ=function(t,e,i,n){var r=[],a=[];return r[0]=e[0]-i[0],r[1]=e[1]-i[1],r[2]=e[2]-i[2],a[0]=r[0]*Math.cos(n)-r[1]*Math.sin(n),a[1]=r[0]*Math.sin(n)+r[1]*Math.cos(n),a[2]=r[2],t[0]=a[0]+i[0],t[1]=a[1]+i[1],t[2]=a[2]+i[2],t},l.forEach=function(){var t=l.create();return function(e,i,n,r,a,o){var s,l;for(i||(i=3),n||(n=0),l=r?Math.min(r*i+n,e.length):e.length,s=n;s<l;s+=i)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],a(t,t,o),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2];return e}}(),l.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},void 0!==t&&(t.vec3=l);var c={create:function(){var t=new i(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},clone:function(t){var e=new i(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},fromValues:function(t,e,n,r){var a=new i(4);return a[0]=t,a[1]=e,a[2]=n,a[3]=r,a},copy:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},set:function(t,e,i,n,r){return t[0]=e,t[1]=i,t[2]=n,t[3]=r,t},add:function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t},subtract:function(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t}};c.sub=c.subtract,c.multiply=function(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t[3]=e[3]*i[3],t},c.mul=c.multiply,c.divide=function(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t[2]=e[2]/i[2],t[3]=e[3]/i[3],t},c.div=c.divide,c.min=function(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t[2]=Math.min(e[2],i[2]),t[3]=Math.min(e[3],i[3]),t},c.max=function(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t[2]=Math.max(e[2],i[2]),t[3]=Math.max(e[3],i[3]),t},c.scale=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t},c.scaleAndAdd=function(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t[2]=e[2]+i[2]*n,t[3]=e[3]+i[3]*n,t},c.distance=function(t,e){var i=e[0]-t[0],n=e[1]-t[1],r=e[2]-t[2],a=e[3]-t[3];return Math.sqrt(i*i+n*n+r*r+a*a)},c.dist=c.distance,c.squaredDistance=function(t,e){var i=e[0]-t[0],n=e[1]-t[1],r=e[2]-t[2],a=e[3]-t[3];return i*i+n*n+r*r+a*a},c.sqrDist=c.squaredDistance,c.length=function(t){var e=t[0],i=t[1],n=t[2],r=t[3];return Math.sqrt(e*e+i*i+n*n+r*r)},c.len=c.length,c.squaredLength=function(t){var e=t[0],i=t[1],n=t[2],r=t[3];return e*e+i*i+n*n+r*r},c.sqrLen=c.squaredLength,c.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},c.normalize=function(t,e){var i=e[0],n=e[1],r=e[2],a=e[3],o=i*i+n*n+r*r+a*a;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t[3]=e[3]*o),t},c.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},c.lerp=function(t,e,i,n){var r=e[0],a=e[1],o=e[2],s=e[3];return t[0]=r+n*(i[0]-r),t[1]=a+n*(i[1]-a),t[2]=o+n*(i[2]-o),t[3]=s+n*(i[3]-s),t},c.random=function(t,e){return e=e||1,t[0]=n(),t[1]=n(),t[2]=n(),t[3]=n(),c.normalize(t,t),c.scale(t,t,e),t},c.transformMat4=function(t,e,i){var n=e[0],r=e[1],a=e[2],o=e[3];return t[0]=i[0]*n+i[4]*r+i[8]*a+i[12]*o,t[1]=i[1]*n+i[5]*r+i[9]*a+i[13]*o,t[2]=i[2]*n+i[6]*r+i[10]*a+i[14]*o,t[3]=i[3]*n+i[7]*r+i[11]*a+i[15]*o,t},c.transformQuat=function(t,e,i){var n=e[0],r=e[1],a=e[2],o=i[0],s=i[1],l=i[2],c=i[3],u=c*n+s*a-l*r,h=c*r+l*n-o*a,d=c*a+o*r-s*n,p=-o*n-s*r-l*a;return t[0]=u*c+p*-o+h*-l-d*-s,t[1]=h*c+p*-s+d*-o-u*-l,t[2]=d*c+p*-l+u*-s-h*-o,t},c.forEach=function(){var t=c.create();return function(e,i,n,r,a,o){var s,l;for(i||(i=4),n||(n=0),l=r?Math.min(r*i+n,e.length):e.length,s=n;s<l;s+=i)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],t[3]=e[s+3],a(t,t,o),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=t[3];return e}}(),c.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},void 0!==t&&(t.vec4=c);var u={create:function(){var t=new i(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},clone:function(t){var e=new i(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},copy:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},identity:function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},transpose:function(t,e){if(t===e){var i=e[1];t[1]=e[2],t[2]=i}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},invert:function(t,e){var i=e[0],n=e[1],r=e[2],a=e[3],o=i*a-r*n;return o?(o=1/o,t[0]=a*o,t[1]=-n*o,t[2]=-r*o,t[3]=i*o,t):null},adjoint:function(t,e){var i=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=i,t},determinant:function(t){return t[0]*t[3]-t[2]*t[1]},multiply:function(t,e,i){var n=e[0],r=e[1],a=e[2],o=e[3],s=i[0],l=i[1],c=i[2],u=i[3];return t[0]=n*s+a*l,t[1]=r*s+o*l,t[2]=n*c+a*u,t[3]=r*c+o*u,t}};u.mul=u.multiply,u.rotate=function(t,e,i){var n=e[0],r=e[1],a=e[2],o=e[3],s=Math.sin(i),l=Math.cos(i);return t[0]=n*l+a*s,t[1]=r*l+o*s,t[2]=n*-s+a*l,t[3]=r*-s+o*l,t},u.scale=function(t,e,i){var n=e[0],r=e[1],a=e[2],o=e[3],s=i[0],l=i[1];return t[0]=n*s,t[1]=r*s,t[2]=a*l,t[3]=o*l,t},u.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},u.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},u.LDU=function(t,e,i,n){return t[2]=n[2]/n[0],i[0]=n[0],i[1]=n[1],i[3]=n[3]-t[2]*i[1],[t,e,i]},void 0!==t&&(t.mat2=u);var h={create:function(){var t=new i(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},clone:function(t){var e=new i(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},copy:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},identity:function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},invert:function(t,e){var i=e[0],n=e[1],r=e[2],a=e[3],o=e[4],s=e[5],l=i*a-n*r;return l?(l=1/l,t[0]=a*l,t[1]=-n*l,t[2]=-r*l,t[3]=i*l,t[4]=(r*s-a*o)*l,t[5]=(n*o-i*s)*l,t):null},determinant:function(t){return t[0]*t[3]-t[1]*t[2]},multiply:function(t,e,i){var n=e[0],r=e[1],a=e[2],o=e[3],s=e[4],l=e[5],c=i[0],u=i[1],h=i[2],d=i[3],p=i[4],f=i[5];return t[0]=n*c+a*u,t[1]=r*c+o*u,t[2]=n*h+a*d,t[3]=r*h+o*d,t[4]=n*p+a*f+s,t[5]=r*p+o*f+l,t}};h.mul=h.multiply,h.rotate=function(t,e,i){var n=e[0],r=e[1],a=e[2],o=e[3],s=e[4],l=e[5],c=Math.sin(i),u=Math.cos(i);return t[0]=n*u+a*c,t[1]=r*u+o*c,t[2]=n*-c+a*u,t[3]=r*-c+o*u,t[4]=s,t[5]=l,t},h.scale=function(t,e,i){var n=e[0],r=e[1],a=e[2],o=e[3],s=e[4],l=e[5],c=i[0],u=i[1];return t[0]=n*c,t[1]=r*c,t[2]=a*u,t[3]=o*u,t[4]=s,t[5]=l,t},h.translate=function(t,e,i){var n=e[0],r=e[1],a=e[2],o=e[3],s=e[4],l=e[5],c=i[0],u=i[1];return t[0]=n,t[1]=r,t[2]=a,t[3]=o,t[4]=n*c+a*u+s,t[5]=r*c+o*u+l,t},h.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},h.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},void 0!==t&&(t.mat2d=h);var d={create:function(){var t=new i(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},fromMat4:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},clone:function(t){var e=new i(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},copy:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},identity:function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},transpose:function(t,e){if(t===e){var i=e[1],n=e[2],r=e[5];t[1]=e[3],t[2]=e[6],t[3]=i,t[5]=e[7],t[6]=n,t[7]=r}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},invert:function(t,e){var i=e[0],n=e[1],r=e[2],a=e[3],o=e[4],s=e[5],l=e[6],c=e[7],u=e[8],h=u*o-s*c,d=-u*a+s*l,p=c*a-o*l,f=i*h+n*d+r*p;return f?(f=1/f,t[0]=h*f,t[1]=(-u*n+r*c)*f,t[2]=(s*n-r*o)*f,t[3]=d*f,t[4]=(u*i-r*l)*f,t[5]=(-s*i+r*a)*f,t[6]=p*f,t[7]=(-c*i+n*l)*f,t[8]=(o*i-n*a)*f,t):null},adjoint:function(t,e){var i=e[0],n=e[1],r=e[2],a=e[3],o=e[4],s=e[5],l=e[6],c=e[7],u=e[8];return t[0]=o*u-s*c,t[1]=r*c-n*u,t[2]=n*s-r*o,t[3]=s*l-a*u,t[4]=i*u-r*l,t[5]=r*a-i*s,t[6]=a*c-o*l,t[7]=n*l-i*c,t[8]=i*o-n*a,t},determinant:function(t){var e=t[0],i=t[1],n=t[2],r=t[3],a=t[4],o=t[5],s=t[6],l=t[7],c=t[8];return e*(c*a-o*l)+i*(-c*r+o*s)+n*(l*r-a*s)},multiply:function(t,e,i){var n=e[0],r=e[1],a=e[2],o=e[3],s=e[4],l=e[5],c=e[6],u=e[7],h=e[8],d=i[0],p=i[1],f=i[2],m=i[3],g=i[4],y=i[5],b=i[6],A=i[7],v=i[8];return t[0]=d*n+p*o+f*c,t[1]=d*r+p*s+f*u,t[2]=d*a+p*l+f*h,t[3]=m*n+g*o+y*c,t[4]=m*r+g*s+y*u,t[5]=m*a+g*l+y*h,t[6]=b*n+A*o+v*c,t[7]=b*r+A*s+v*u,t[8]=b*a+A*l+v*h,t}};d.mul=d.multiply,d.translate=function(t,e,i){var n=e[0],r=e[1],a=e[2],o=e[3],s=e[4],l=e[5],c=e[6],u=e[7],h=e[8],d=i[0],p=i[1];return t[0]=n,t[1]=r,t[2]=a,t[3]=o,t[4]=s,t[5]=l,t[6]=d*n+p*o+c,t[7]=d*r+p*s+u,t[8]=d*a+p*l+h,t},d.rotate=function(t,e,i){var n=e[0],r=e[1],a=e[2],o=e[3],s=e[4],l=e[5],c=e[6],u=e[7],h=e[8],d=Math.sin(i),p=Math.cos(i);return t[0]=p*n+d*o,t[1]=p*r+d*s,t[2]=p*a+d*l,t[3]=p*o-d*n,t[4]=p*s-d*r,t[5]=p*l-d*a,t[6]=c,t[7]=u,t[8]=h,t},d.scale=function(t,e,i){var n=i[0],r=i[1];return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=r*e[3],t[4]=r*e[4],t[5]=r*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},d.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},d.fromQuat=function(t,e){var i=e[0],n=e[1],r=e[2],a=e[3],o=i+i,s=n+n,l=r+r,c=i*o,u=n*o,h=n*s,d=r*o,p=r*s,f=r*l,m=a*o,g=a*s,y=a*l;return t[0]=1-h-f,t[3]=u-y,t[6]=d+g,t[1]=u+y,t[4]=1-c-f,t[7]=p-m,t[2]=d-g,t[5]=p+m,t[8]=1-c-h,t},d.normalFromMat4=function(t,e){var i=e[0],n=e[1],r=e[2],a=e[3],o=e[4],s=e[5],l=e[6],c=e[7],u=e[8],h=e[9],d=e[10],p=e[11],f=e[12],m=e[13],g=e[14],y=e[15],b=i*s-n*o,A=i*l-r*o,v=i*c-a*o,w=n*l-r*s,E=n*c-a*s,_=r*c-a*l,x=u*m-h*f,T=u*g-d*f,M=u*y-p*f,C=h*g-d*m,k=h*y-p*m,R=d*y-p*g,S=b*R-A*k+v*C+w*M-E*T+_*x;return S?(S=1/S,t[0]=(s*R-l*k+c*C)*S,t[1]=(l*M-o*R-c*T)*S,t[2]=(o*k-s*M+c*x)*S,t[3]=(r*k-n*R-a*C)*S,t[4]=(i*R-r*M+a*T)*S,t[5]=(n*M-i*k-a*x)*S,t[6]=(m*_-g*E+y*w)*S,t[7]=(g*v-f*_-y*A)*S,t[8]=(f*E-m*v+y*b)*S,t):null},d.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},d.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},void 0!==t&&(t.mat3=d);var p={create:function(){var t=new i(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},clone:function(t){var e=new i(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},copy:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},identity:function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},transpose:function(t,e){if(t===e){var i=e[1],n=e[2],r=e[3],a=e[6],o=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=i,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=a,t[11]=e[14],t[12]=r,t[13]=o,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},invert:function(t,e){var i=e[0],n=e[1],r=e[2],a=e[3],o=e[4],s=e[5],l=e[6],c=e[7],u=e[8],h=e[9],d=e[10],p=e[11],f=e[12],m=e[13],g=e[14],y=e[15],b=i*s-n*o,A=i*l-r*o,v=i*c-a*o,w=n*l-r*s,E=n*c-a*s,_=r*c-a*l,x=u*m-h*f,T=u*g-d*f,M=u*y-p*f,C=h*g-d*m,k=h*y-p*m,R=d*y-p*g,S=b*R-A*k+v*C+w*M-E*T+_*x;return S?(S=1/S,t[0]=(s*R-l*k+c*C)*S,t[1]=(r*k-n*R-a*C)*S,t[2]=(m*_-g*E+y*w)*S,t[3]=(d*E-h*_-p*w)*S,t[4]=(l*M-o*R-c*T)*S,t[5]=(i*R-r*M+a*T)*S,t[6]=(g*v-f*_-y*A)*S,t[7]=(u*_-d*v+p*A)*S,t[8]=(o*k-s*M+c*x)*S,t[9]=(n*M-i*k-a*x)*S,t[10]=(f*E-m*v+y*b)*S,t[11]=(h*v-u*E-p*b)*S,t[12]=(s*T-o*C-l*x)*S,t[13]=(i*C-n*T+r*x)*S,t[14]=(m*A-f*w-g*b)*S,t[15]=(u*w-h*A+d*b)*S,t):null},adjoint:function(t,e){var i=e[0],n=e[1],r=e[2],a=e[3],o=e[4],s=e[5],l=e[6],c=e[7],u=e[8],h=e[9],d=e[10],p=e[11],f=e[12],m=e[13],g=e[14],y=e[15];return t[0]=s*(d*y-p*g)-h*(l*y-c*g)+m*(l*p-c*d),t[1]=-(n*(d*y-p*g)-h*(r*y-a*g)+m*(r*p-a*d)),t[2]=n*(l*y-c*g)-s*(r*y-a*g)+m*(r*c-a*l),t[3]=-(n*(l*p-c*d)-s*(r*p-a*d)+h*(r*c-a*l)),t[4]=-(o*(d*y-p*g)-u*(l*y-c*g)+f*(l*p-c*d)),t[5]=i*(d*y-p*g)-u*(r*y-a*g)+f*(r*p-a*d),t[6]=-(i*(l*y-c*g)-o*(r*y-a*g)+f*(r*c-a*l)),t[7]=i*(l*p-c*d)-o*(r*p-a*d)+u*(r*c-a*l),t[8]=o*(h*y-p*m)-u*(s*y-c*m)+f*(s*p-c*h),t[9]=-(i*(h*y-p*m)-u*(n*y-a*m)+f*(n*p-a*h)),t[10]=i*(s*y-c*m)-o*(n*y-a*m)+f*(n*c-a*s),t[11]=-(i*(s*p-c*h)-o*(n*p-a*h)+u*(n*c-a*s)),t[12]=-(o*(h*g-d*m)-u*(s*g-l*m)+f*(s*d-l*h)),t[13]=i*(h*g-d*m)-u*(n*g-r*m)+f*(n*d-r*h),t[14]=-(i*(s*g-l*m)-o*(n*g-r*m)+f*(n*l-r*s)),t[15]=i*(s*d-l*h)-o*(n*d-r*h)+u*(n*l-r*s),t},determinant:function(t){var e=t[0],i=t[1],n=t[2],r=t[3],a=t[4],o=t[5],s=t[6],l=t[7],c=t[8],u=t[9],h=t[10],d=t[11],p=t[12],f=t[13],m=t[14],g=t[15];return(e*o-i*a)*(h*g-d*m)-(e*s-n*a)*(u*g-d*f)+(e*l-r*a)*(u*m-h*f)+(i*s-n*o)*(c*g-d*p)-(i*l-r*o)*(c*m-h*p)+(n*l-r*s)*(c*f-u*p)},multiply:function(t,e,i){var n=e[0],r=e[1],a=e[2],o=e[3],s=e[4],l=e[5],c=e[6],u=e[7],h=e[8],d=e[9],p=e[10],f=e[11],m=e[12],g=e[13],y=e[14],b=e[15],A=i[0],v=i[1],w=i[2],E=i[3];return t[0]=A*n+v*s+w*h+E*m,t[1]=A*r+v*l+w*d+E*g,t[2]=A*a+v*c+w*p+E*y,t[3]=A*o+v*u+w*f+E*b,A=i[4],v=i[5],w=i[6],E=i[7],t[4]=A*n+v*s+w*h+E*m,t[5]=A*r+v*l+w*d+E*g,t[6]=A*a+v*c+w*p+E*y,t[7]=A*o+v*u+w*f+E*b,A=i[8],v=i[9],w=i[10],E=i[11],t[8]=A*n+v*s+w*h+E*m,t[9]=A*r+v*l+w*d+E*g,t[10]=A*a+v*c+w*p+E*y,t[11]=A*o+v*u+w*f+E*b,A=i[12],v=i[13],w=i[14],E=i[15],t[12]=A*n+v*s+w*h+E*m,t[13]=A*r+v*l+w*d+E*g,t[14]=A*a+v*c+w*p+E*y,t[15]=A*o+v*u+w*f+E*b,t}};p.mul=p.multiply,p.translate=function(t,e,i){var n,r,a,o,s,l,c,u,h,d,p,f,m=i[0],g=i[1],y=i[2];return e===t?(t[12]=e[0]*m+e[4]*g+e[8]*y+e[12],t[13]=e[1]*m+e[5]*g+e[9]*y+e[13],t[14]=e[2]*m+e[6]*g+e[10]*y+e[14],t[15]=e[3]*m+e[7]*g+e[11]*y+e[15]):(n=e[0],r=e[1],a=e[2],o=e[3],s=e[4],l=e[5],c=e[6],u=e[7],h=e[8],d=e[9],p=e[10],f=e[11],t[0]=n,t[1]=r,t[2]=a,t[3]=o,t[4]=s,t[5]=l,t[6]=c,t[7]=u,t[8]=h,t[9]=d,t[10]=p,t[11]=f,t[12]=n*m+s*g+h*y+e[12],t[13]=r*m+l*g+d*y+e[13],t[14]=a*m+c*g+p*y+e[14],t[15]=o*m+u*g+f*y+e[15]),t},p.scale=function(t,e,i){var n=i[0],r=i[1],a=i[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},p.rotate=function(t,i,n,r){var a,o,s,l,c,u,h,d,p,f,m,g,y,b,A,v,w,E,_,x,T,M,C,k,R=r[0],S=r[1],D=r[2],O=Math.sqrt(R*R+S*S+D*D);return Math.abs(O)<e?null:(R*=O=1/O,S*=O,D*=O,a=Math.sin(n),s=1-(o=Math.cos(n)),l=i[0],c=i[1],u=i[2],h=i[3],d=i[4],p=i[5],f=i[6],m=i[7],g=i[8],y=i[9],b=i[10],A=i[11],v=R*R*s+o,w=S*R*s+D*a,E=D*R*s-S*a,_=R*S*s-D*a,x=S*S*s+o,T=D*S*s+R*a,M=R*D*s+S*a,C=S*D*s-R*a,k=D*D*s+o,t[0]=l*v+d*w+g*E,t[1]=c*v+p*w+y*E,t[2]=u*v+f*w+b*E,t[3]=h*v+m*w+A*E,t[4]=l*_+d*x+g*T,t[5]=c*_+p*x+y*T,t[6]=u*_+f*x+b*T,t[7]=h*_+m*x+A*T,t[8]=l*M+d*C+g*k,t[9]=c*M+p*C+y*k,t[10]=u*M+f*C+b*k,t[11]=h*M+m*C+A*k,i!==t&&(t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15]),t)},p.rotateX=function(t,e,i){var n=Math.sin(i),r=Math.cos(i),a=e[4],o=e[5],s=e[6],l=e[7],c=e[8],u=e[9],h=e[10],d=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*r+c*n,t[5]=o*r+u*n,t[6]=s*r+h*n,t[7]=l*r+d*n,t[8]=c*r-a*n,t[9]=u*r-o*n,t[10]=h*r-s*n,t[11]=d*r-l*n,t},p.rotateY=function(t,e,i){var n=Math.sin(i),r=Math.cos(i),a=e[0],o=e[1],s=e[2],l=e[3],c=e[8],u=e[9],h=e[10],d=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*r-c*n,t[1]=o*r-u*n,t[2]=s*r-h*n,t[3]=l*r-d*n,t[8]=a*n+c*r,t[9]=o*n+u*r,t[10]=s*n+h*r,t[11]=l*n+d*r,t},p.rotateZ=function(t,e,i){var n=Math.sin(i),r=Math.cos(i),a=e[0],o=e[1],s=e[2],l=e[3],c=e[4],u=e[5],h=e[6],d=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*r+c*n,t[1]=o*r+u*n,t[2]=s*r+h*n,t[3]=l*r+d*n,t[4]=c*r-a*n,t[5]=u*r-o*n,t[6]=h*r-s*n,t[7]=d*r-l*n,t},p.fromRotationTranslation=function(t,e,i){var n=e[0],r=e[1],a=e[2],o=e[3],s=n+n,l=r+r,c=a+a,u=n*s,h=n*l,d=n*c,p=r*l,f=r*c,m=a*c,g=o*s,y=o*l,b=o*c;return t[0]=1-(p+m),t[1]=h+b,t[2]=d-y,t[3]=0,t[4]=h-b,t[5]=1-(u+m),t[6]=f+g,t[7]=0,t[8]=d+y,t[9]=f-g,t[10]=1-(u+p),t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,t},p.fromQuat=function(t,e){var i=e[0],n=e[1],r=e[2],a=e[3],o=i+i,s=n+n,l=r+r,c=i*o,u=n*o,h=n*s,d=r*o,p=r*s,f=r*l,m=a*o,g=a*s,y=a*l;return t[0]=1-h-f,t[1]=u+y,t[2]=d-g,t[3]=0,t[4]=u-y,t[5]=1-c-f,t[6]=p+m,t[7]=0,t[8]=d+g,t[9]=p-m,t[10]=1-c-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},p.frustum=function(t,e,i,n,r,a,o){var s=1/(i-e),l=1/(r-n),c=1/(a-o);return t[0]=2*a*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*a*l,t[6]=0,t[7]=0,t[8]=(i+e)*s,t[9]=(r+n)*l,t[10]=(o+a)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*a*2*c,t[15]=0,t},p.perspective=function(t,e,i,n,r){var a=1/Math.tan(e/2),o=1/(n-r);return t[0]=a/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(r+n)*o,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*r*n*o,t[15]=0,t},p.ortho=function(t,e,i,n,r,a,o){var s=1/(e-i),l=1/(n-r),c=1/(a-o);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+i)*s,t[13]=(r+n)*l,t[14]=(o+a)*c,t[15]=1,t},p.lookAt=function(t,i,n,r){var a,o,s,l,c,u,h,d,f,m,g=i[0],y=i[1],b=i[2],A=r[0],v=r[1],w=r[2],E=n[0],_=n[1],x=n[2];return Math.abs(g-E)<e&&Math.abs(y-_)<e&&Math.abs(b-x)<e?p.identity(t):(h=g-E,d=y-_,f=b-x,a=v*(f*=m=1/Math.sqrt(h*h+d*d+f*f))-w*(d*=m),o=w*(h*=m)-A*f,s=A*d-v*h,(m=Math.sqrt(a*a+o*o+s*s))?(a*=m=1/m,o*=m,s*=m):(a=0,o=0,s=0),l=d*s-f*o,c=f*a-h*s,u=h*o-d*a,(m=Math.sqrt(l*l+c*c+u*u))?(l*=m=1/m,c*=m,u*=m):(l=0,c=0,u=0),t[0]=a,t[1]=l,t[2]=h,t[3]=0,t[4]=o,t[5]=c,t[6]=d,t[7]=0,t[8]=s,t[9]=u,t[10]=f,t[11]=0,t[12]=-(a*g+o*y+s*b),t[13]=-(l*g+c*y+u*b),t[14]=-(h*g+d*y+f*b),t[15]=1,t)},p.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},p.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},void 0!==t&&(t.mat4=p);var f,m,g,y,b={};b.create=function(){var t=new i(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},b.rotationTo=(f=l.create(),m=l.fromValues(1,0,0),g=l.fromValues(0,1,0),function(t,e,i){var n=l.dot(e,i);return n<-.999999?(l.cross(f,m,e),l.length(f)<1e-6&&l.cross(f,g,e),l.normalize(f,f),b.setAxisAngle(t,f,Math.PI),t):n>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(l.cross(f,e,i),t[0]=f[0],t[1]=f[1],t[2]=f[2],t[3]=1+n,b.normalize(t,t))}),b.setAxes=(y=d.create(),function(t,e,i,n){return y[0]=i[0],y[3]=i[1],y[6]=i[2],y[1]=n[0],y[4]=n[1],y[7]=n[2],y[2]=-e[0],y[5]=-e[1],y[8]=-e[2],b.normalize(t,b.fromMat3(t,y))}),b.clone=c.clone,b.fromValues=c.fromValues,b.copy=c.copy,b.set=c.set,b.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},b.setAxisAngle=function(t,e,i){i*=.5;var n=Math.sin(i);return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=Math.cos(i),t},b.add=c.add,b.multiply=function(t,e,i){var n=e[0],r=e[1],a=e[2],o=e[3],s=i[0],l=i[1],c=i[2],u=i[3];return t[0]=n*u+o*s+r*c-a*l,t[1]=r*u+o*l+a*s-n*c,t[2]=a*u+o*c+n*l-r*s,t[3]=o*u-n*s-r*l-a*c,t},b.mul=b.multiply,b.scale=c.scale,b.rotateX=function(t,e,i){i*=.5;var n=e[0],r=e[1],a=e[2],o=e[3],s=Math.sin(i),l=Math.cos(i);return t[0]=n*l+o*s,t[1]=r*l+a*s,t[2]=a*l-r*s,t[3]=o*l-n*s,t},b.rotateY=function(t,e,i){i*=.5;var n=e[0],r=e[1],a=e[2],o=e[3],s=Math.sin(i),l=Math.cos(i);return t[0]=n*l-a*s,t[1]=r*l+o*s,t[2]=a*l+n*s,t[3]=o*l-r*s,t},b.rotateZ=function(t,e,i){i*=.5;var n=e[0],r=e[1],a=e[2],o=e[3],s=Math.sin(i),l=Math.cos(i);return t[0]=n*l+r*s,t[1]=r*l-n*s,t[2]=a*l+o*s,t[3]=o*l-a*s,t},b.calculateW=function(t,e){var i=e[0],n=e[1],r=e[2];return t[0]=i,t[1]=n,t[2]=r,t[3]=-Math.sqrt(Math.abs(1-i*i-n*n-r*r)),t},b.dot=c.dot,b.lerp=c.lerp,b.slerp=function(t,e,i,n){var r,a,o,s,l,c=e[0],u=e[1],h=e[2],d=e[3],p=i[0],f=i[1],m=i[2],g=i[3];return(a=c*p+u*f+h*m+d*g)<0&&(a=-a,p=-p,f=-f,m=-m,g=-g),1-a>1e-6?(r=Math.acos(a),o=Math.sin(r),s=Math.sin((1-n)*r)/o,l=Math.sin(n*r)/o):(s=1-n,l=n),t[0]=s*c+l*p,t[1]=s*u+l*f,t[2]=s*h+l*m,t[3]=s*d+l*g,t},b.invert=function(t,e){var i=e[0],n=e[1],r=e[2],a=e[3],o=i*i+n*n+r*r+a*a,s=o?1/o:0;return t[0]=-i*s,t[1]=-n*s,t[2]=-r*s,t[3]=a*s,t},b.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},b.length=c.length,b.len=b.length,b.squaredLength=c.squaredLength,b.sqrLen=b.squaredLength,b.normalize=c.normalize,b.fromMat3=function(t,e){var i,n=e[0]+e[4]+e[8];if(n>0)i=Math.sqrt(n+1),t[3]=.5*i,i=.5/i,t[0]=(e[7]-e[5])*i,t[1]=(e[2]-e[6])*i,t[2]=(e[3]-e[1])*i;else{var r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);var a=(r+1)%3,o=(r+2)%3;i=Math.sqrt(e[3*r+r]-e[3*a+a]-e[3*o+o]+1),t[r]=.5*i,i=.5/i,t[3]=(e[3*o+a]-e[3*a+o])*i,t[a]=(e[3*a+r]+e[3*r+a])*i,t[o]=(e[3*o+r]+e[3*r+o])*i}return t},b.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},void 0!==t&&(t.quat=b)}(i.exports)}()},function(t,e,i){i(15).vec3;var n=t.exports=function(t){this.valid=!0,this.id=t.id,this.handId=t.handId,this.length=t.length,this.tool=t.tool,this.width=t.width,this.direction=t.direction,this.stabilizedTipPosition=t.stabilizedTipPosition,this.tipPosition=t.tipPosition,this.tipVelocity=t.tipVelocity,this.touchZone=t.touchZone,this.touchDistance=t.touchDistance,this.timeVisible=t.timeVisible};n.prototype.toString=function(){return"Pointable [ id:"+this.id+" "+this.length+"mmx | width:"+this.width+"mm | direction:"+this.direction+" ]"},n.prototype.hand=function(){return this.frame.hand(this.handId)},n.Invalid={valid:!1}},function(t,e,i){"use strict";i.r(e),i.d(e,"JoystickDirections",(function(){return o})),i.d(e,"ButtonMaps",(function(){return a})),i.d(e,"Axes",(function(){return n}));i(0);const n={LEFT_RIGHT:0,UP_DOWN:1,up_down(t){if(t.hasAttribute("webxr-motion-controller"))return this.UP_DOWN;let e=4===t.components["tracked-controls"].axis.length?2:0;return this.UP_DOWN+e},left_right(t){if(t.hasAttribute("webxr-motion-controller"))return this.LEFT_RIGHT;let e=4===t.components["tracked-controls"].axis.length?2:0;return this.LEFT_RIGHT+e}};class r{constructor(t,{targetEl:e,whenGrabbing:i=!1}={}){this.dirX=0,this.dirY=0,void 0===e&&(e=t.el),this.rightClick=this.leftClick=this.upClick=this.downClick=function(){},this.handleX=!1,this.handleY=!1;for(let e of["leftClick","rightClick"])e in t&&(this[e]=t[e].bind(t),this.handleX=!0);for(let e of["upClick","downClick"])e in t&&(this[e]=t[e].bind(t),this.handleY=!0);(this.handleX||this.handleY)&&e.addEventListener("axismove",(t=>{if(e.is("grabbing")&&!i)return;const{detail:r}=t;if(this.handleX)if(r.axis[n.left_right(e)]>.8&&1!==this.dirX)this.dirX=1,this.rightClick(r);else{if(-.8<r.axis[n.left_right(e)]&&r.axis[n.left_right(e)]<.8&&0!==this.dirX)return this.dirX=0;r.axis[n.left_right(e)]<-.8&&-1!==this.dirX&&(this.dirX=-1,this.leftClick(r))}if(this.handleY)if(r.axis[n.up_down(e)]>.8&&1!==this.dirY)console.log("Clicking up",r.axis[n.up_down(e)],this.dirY),this.dirY=1,this.upClick(r);else{if(-.8<r.axis[n.up_down(e)]&&r.axis[n.up_down(e)]<.8&&0!==this.dirY)return console.log("Clicking reset",r.axis[n.up_down(e)],this.dirY),this.dirY=0;r.axis[n.up_down(e)]<-.8&&-1!==this.dirY&&(console.log("Clicking down",r.axis[n.up_down(e)],this.dirY),this.dirY=-1,this.downClick(r))}}))}}class a{constructor(){this.maps={},this.buttons=[]}toggle(t){return{state:t,toggle:!0}}setMap(t,e=""){this.maps[e]=t,this.buttons=this.buttons.concat(Object.keys(t))}install(t){let e,i=new Set(this.buttons);t.el.hasAttribute("button-caster")?e=t.el:(e=t.el.sceneEl,t.el.sceneEl.systems["button-caster"].install(i));for(let n of i)console.log("Installing",n),e.addEventListener(n+"down",(e=>{for(let e of Object.keys(this.maps))if(""!==e&&t.el.is(e)&&n in this.maps[e]){let i=this.maps[e][n],r=i.toggle;return"object"==typeof i&&(i=i.state),r&&t.el.is(i)?void t.el.removeState(i):void t.el.addState(i)}this.maps[""]&&this.maps[""][n]&&t.el.addState(this.maps[""][n])})),t.el.addEventListener(n+"up",(e=>{for(let e of Object.keys(this.maps)){let i=this.maps[e][n];if(!i)return;let r=i.toggle;if("object"==typeof i&&(i=i.state),r)return;t.el.removeState(this.maps[e][n])}}))}}const o={install(t,e){new r(t,e)}};AFRAME.registerComponent("joystick-turn",{schema:{amount:{type:"number",default:.785},target:{type:"selector"}},init(){o.install(this)},leftClick(){const{amount:t}=this.data;this.data.target.object3D.rotation.y+=t},rightClick(){const{amount:t}=this.data;this.data.target.object3D.rotation.y-=t}}),AFRAME.registerComponent("action-tooltips",{multiple:!0,schema:{label:{type:"string",default:null,parse:t=>t},updown:{type:"string",default:null,parse:t=>t},leftright:{type:"string",default:null,parse:t=>t},a:{type:"string",default:null,parse:t=>t},b:{type:"string",default:null,parse:t=>t},trigger:{type:"string",default:null,parse:t=>t},grip:{type:"string",default:null,parse:t=>t},shelf:{type:"string",default:null,parse:t=>t}}}),AFRAME.registerComponent("hand-action-tooltip",{dependencies:["raycaster","action-tooltips"],schema:{throttle:{default:150},position:{type:"vec3",default:new THREE.Vector3(-.006549004823841076,-.11940164556557661,.10084264804121343)}},init(){let t=document.createElement("a-entity");t.setAttribute("geometry","primitive: plane; height: 0; width: 0"),t.setAttribute("material","color: #abe; shader: flat"),t.setAttribute("position",this.data.position),t.setAttribute("rotation","-47.22767925743924 -1.2047588819680946 -2.40270564492676"),t.setAttribute("scale","0.15 0.15 0.15"),t.setAttribute("text","color: #000; width: 1; align: left; value: ...; wrapCount: 20; baseline: top"),this.el.append(t),this.container=t,this.tick=AFRAME.utils.throttleTick(this.tick,this.data.throttle,this),this.buttons=["label","trigger","updown","leftright","a","b","grip"],this.names={label:"",updown:"Up/Down",leftright:"Left/Right",a:"A",b:"B",trigger:"Trigger",grip:"Grip"},this.message={},this.messageString=[];for(let t of this.buttons)this.message[t]=null;this.lastMessage=Object.assign({},this.message),this.thisTooltipAttr="action-tooltips__"+this.el.id},setMessage(){if(Object.assign(this.message,this.el.getAttribute("action-tooltips")),0==this.el.components.raycaster.intersectedEls.length)return;let t=this.el.components.raycaster.intersectedEls[0];for(;t;){let e=t.getAttribute(this.thisTooltipAttr)||t.getAttribute("action-tooltips")||t.actionTooltips;if(e)for(let t in e)null===this.message[t]&&(this.message[t]=e[t]);t=t["redirect-grab"]}this.el.is("grabbing")?(this.message.updown="Push / Pull",this.message.leftright="Smaller / Bigger",this.message.a=this.el.is("rotating")?"Lock Rotation":"Unlock Rotation"):this.message.grip="Grab"},tick(t,e){if(!this.el.getObject3D("mesh"))return;this.setMessage();let i=!0;for(let t in this.message)if(this.message[t]!==this.lastMessage[t]){i=!1;break}if(i)return;let n=this.messageString,r=0;for(let t of this.buttons)null!==this.message[t]&&(this.names[t].length>0?n[r++]=`> ${this.names[t]}: ${this.message[t]}`:n[r++]=`${this.message[t]}`);n.length=r,Object.assign(this.lastMessage,this.message),this.container.getObject3D("mesh").visible=n.length>0,this.container.setAttribute("geometry","width",0),this.container.setAttribute("geometry","height",0),this.container.setAttribute("text","value",n.join("\n")),this.container.getObject3D("mesh").position.y=.8*-this.container.getAttribute("geometry").height/2,this.container.getObject3D("mesh").scale.set(1.2,1.2,1.2)}})},function(t,e,i){"use strict";i.r(e),i.d(e,"toSrcString",(function(){return b})),i.d(e,"addImageReferenceViewer",(function(){return A})),i.d(e,"importModelToMesh",(function(){return w})),i.d(e,"setupGlbReferenceEntity",(function(){return E}));var n=i(6),r=i(9),a=i.n(r),o=i(2),s=i(32),l=i(0),c=i(3),u=i(33),h=i(179),d=i.n(h);i(11);const{createFFmpeg:p,fetchFile:f}=i(379),m=p({log:!0});m.fetchFile=f;const g=/\.(glb|obj|vrm|gltf|fbx)$/i;class y{constructor(t){this.url=t,this.name=t}async text(){let t=await fetch(this.url);return await t.text()}async arrayBuffer(){let t=await fetch(this.url);return await t.arrayBuffer()}}function b(t){return t instanceof File?URL.createObjectURL(t):t instanceof y?t.url:t instanceof Blob?URL.createObjectURL(t):t}function A(t){let e=document.createElement("a-entity");return e.setAttribute("geometry","primitive: plane; width: 1; height: "+t.height/t.width),e.setAttribute("material",{src:t,shader:"flat",transparent:!0,side:"double"}),e.setAttribute("position"),e.setAttribute("frame","closable: true; autoHide: true"),e.classList.add("clickable"),e.classList.add("reference-image"),document.querySelector("#reference-spawn").append(e),l.Util.whenLoaded(e,(()=>{let i=e.components.frame.addButton("#asset-archive-arrow-down-outline");i.setAttribute("tooltip","Convert To Layer"),i.addEventListener("click",(()=>{let e=new n.Layer(t.width,t.height);e.canvas.getContext("2d").drawImage(t,0,0),Compositor.component.addLayer(Compositor.component.layers.length-1,{layer:e})}))})),e}var v=new THREE.MeshStandardMaterial;async function w(t,{postProcessMesh:e=!0,sceneName:i,format:r,combineMaterials:a,importMaterial:s,replaceMesh:c}={}){let u=Compositor.component,h=u.layers.length,d=u.activeLayer;void 0===a&&(a=u.el.sceneEl.components["file-upload"].data.combineMaterials),void 0===s&&(s=u.el.sceneEl.components["file-upload"].data.importMaterial),void 0===c&&(s=u.el.sceneEl.components["file-upload"].data.replaceMesh);let p={},f=t=>t.map?t.map.uuid:t.uuid,m=[];t.scene.traverse((t=>{t.userData.vartisteUI?m.push(t):t.geometry&&(l.Util.deinterleaveAttributes(t.geometry),e&&t.geometry.index&&(t.geometry=t.geometry.toNonIndexed()),t.geometry.attributes.normal||t.geometry.computeVertexNormals())}));for(let t of m)t.parent.remove(t);let g,y={opaqueMeshes:[],transparentMeshes:[]};t.scene.traverse((t=>{(t.materials||t.material&&t.material.length)&&console.warn("Multimaterial!",t,t.material),t.material&&(p[f(t.material)]=t.material,e&&(t.material.transparent?y.transparentMeshes.push(t):y.opaqueMeshes.push(t)))})),a&&(g=l.Util.divideCanvasRegions(Object.keys(p).length));let b=0,A=new THREE.Box2(new THREE.Vector2(0,0),new THREE.Vector2(1,1)),w={},E="standard"===Compositor.el.getAttribute("material").shader,_=Compositor.component.data.doubleSided;if(s){for(let t of Object.values(p)){a&&(A=g[b++],w[f(t)]=A),t.side!==THREE.DoubleSide&&t.side!==THREE.BackSide||(_=!0);for(let i of["map"].concat(o.THREED_MODES))if(t[i]||"map"===i){E=!0;let r=t[i]?t[i].image:void 0,{width:a,height:o}=u,s=new n.Layer(a,o),l=s.canvas.getContext("2d");if(l.save(),console.log("Material",t),(!t.transparent||!r&&e)&&"map"===i&&t.color){console.log("coloring",t.color);let e=l.globalAlpha;l.fillStyle=t.color.convertLinearToSRGB().getStyle(),l.globalAlpha=t.opacity,l.fillRect(0,0,a,o),l.globalAlpha=e}if("metalnessMap"===i||"roughnessMap"===i){let e=i.slice(0,-3);t[e]!==v[e]&&(console.log("Applying scalar for",i),l.fillStyle=`rgba(${t[e]}, ${t[e]}, ${t[e]}, 255)`,l.fillRect(0,0,a,o))}if(r){l.translate(a/2,o/2);try{l.drawImage(r,-a/2,-o/2,a,o),"map"===i&&(l.fillStyle=t.color.convertLinearToSRGB().getStyle(),l.globalCompositeOperation="multiply",l.fillRect(-a/2,-o/2,a,o),l.globalCompositeOperation="destination-in",l.drawImage(r,-a/2,-o/2,a,o),l.globalCompositeOperation="source-over")}catch(e){console.log("Could not draw image for texture",i,t)}}l.restore(),"map"!==i&&(s.mode=i),s.transform.scale.x=A.max.x-A.min.x,s.transform.scale.y=A.max.y-A.min.y,s.transform.translation.x=a*((A.min.x+A.max.x)/2-.5),s.transform.translation.y=o*((A.min.y+A.max.y)/2-.5),u.addLayer(0,{layer:s})}}let i={},r=new Set;if(a){t.scene.traverse((t=>{if(t.material&&t.geometry.attributes.uv){if(i[t.geometry.uuid])return;let e=t.geometry.attributes.uv,n=t.geometry,a=w[f(t.material)];if(e.data){if(r.has(e.data))return;l.Util.applyUVBox(a,n),r.add(e.data)}else{if(r.has(n.attributes.uv.array))return;l.Util.applyUVBox(a,n),n.index||r.add(n.attributes.uv.array)}n.attributes.uv.needsUpdate=!0,i[n.uuid]=!0}}));for(let t of o.THREED_MODES){let{width:e,height:i}=u,r=new n.Layer(e,i);r.mode=t;let a=[],o=r.canvas.getContext("2d");l.Util.fillDefaultCanvasForMap(o.canvas,t,{replace:!0});for(let e of u.layers)e.mode===t&&(r?(u.mergeLayers(e,r),a.push(e)):r=e);if(0!==a.length){u.addLayer(0,{layer:r});for(let t of a)t!==d&&u.deleteLayer(t)}}}}console.log("Materials imported"),AFRAME.utils.extendDeep(t.scene.userData,t.userData),document.getElementsByTagName("a-scene")[0].systems["settings-system"].addModelView(t,{replace:c}),"flat"===Compositor.el.getAttribute("material").shader&&Compositor.el.setAttribute("material","shader",E?"standard":"matcap"),Compositor.el.setAttribute("compositor","doubleSided",_),u.activateLayer(d),e&&(async()=>{if(l.Util.traverseFind(t.scene,(t=>t.geometry&&t.geometry.attributes.uv))||await u.el.sceneEl.systems["uv-unwrapper"].quickBoundingBoxUnwrap(),s&&Compositor.meshes.some((t=>t.geometry&&t.geometry.attributes.uv&&t.geometry.attributes.color)))try{let t=new n.Layer(Compositor.component.width,Compositor.component.height);for(Compositor.component.addLayer(0,{layer:t}),u.el.sceneEl.systems["mesh-tools"].bakeVertexColorsToTexture({layer:t});u.layers.indexOf(u.activeLayer)>h;)u.swapLayers(u.activeLayer,u.layers[u.layers.indexOf(u.activeLayer)-1])}catch(t){console.error("Could not bake vertex colors",t)}y.transparentMeshes.length>0&&console.log("transparentCollisions",y);for(let t of y.transparentMeshes)y.opaqueMeshes.some((e=>e.parent===t.parent&&e.position.equals(t.position)))&&(t.position.z-=.001);"vrm"===r&&Compositor.meshRoot.parent.rotation.set(0,Math.PI,0),Compositor.meshRoot.traverse((t=>{t.geometry&&t.geometry&&t.geometry.attributes.position&&t.geometry.attributes.position.count>6&&t.geometry.computeBoundsTree()})),u.activateLayer(d)})()}function E(t){t.classList.add("clickable"),t.setAttribute("reference-glb",""),document.querySelector("a-scene").getAttribute("renderer").colorManagement||t.getObject3D("mesh").traverse((t=>{"Mesh"!=t.type&&"SkinnedMesh"!=t.type||t.material&&t.material.map&&(t.material.map.encoding=THREE.LinearEncoding,t.material.needsUpdate=!0)})),t.getObject3D("mesh").traverse((t=>{t.geometry&&(l.Util.deinterleaveAttributes(t.geometry),t.geometry.computeBoundsTree())})),t.setAttribute("uv-scroll","requireGltfExtension: true"),t.setAttribute("shadow","cast: true; receive: true")}l.Util.registerComponentSystem("file-upload",{schema:{importMaterial:{default:!0},combineMaterials:{default:!0},autoscaleModel:{default:!0},setMapFromFilename:{default:!0},postProcessMesh:{default:!0},replaceMesh:{default:!0}},init(){this.importModelToMesh=w,this.fileInterceptors=[],this.dragIndicator=document.querySelector("#drag-and-drop"),this.dragSet=new Set,document.body.ondragover=t=>{t.preventDefault(),this.dragIndicator&&(this.dragIndicator.className=""),this.dragSet.add(t.target)},document.body.ondragleave=t=>{t.preventDefault(),this.dragSet.delete(t.target),this.clearTimeout&&window.clearTimeout(this.clearTimeout),this.clearTimeout=window.setTimeout((()=>{0===this.dragSet.size&&this.dragIndicator&&(this.dragIndicator.className="minimized")}),100)},document.body.ondrop=async t=>{console.log("Drop",t.detail),t.preventDefault(),this.dragIndicator&&(this.dragIndicator.className="minimized");let e=Array.from(t.dataTransfer.items);for(let t=this.fileInterceptors.length-1;t>=0;t--)if(this.fileInterceptors[t](e))return;if(e){let t=[];for(let i of e)t.push({kind:i.kind,type:i.type,handle:i.getAsFileSystemHandle()});for(let e of t){if("file"!==e.kind){console.warn("Not a file: ",e.kind,e);continue}let t=await e.handle;if(console.log("handle",t),"directory"===t.kind){let e=t.values();console.log(e);let i,n=[];do{if(i=await e.next(),!i)break;if(!i.value)continue;let t=await i.value.getFile();n.push({kind:"file",getAsFile:()=>t})}while(!i.done);let r=!1;for(let t=this.fileInterceptors.length-1;t>=0;t--)if(this.fileInterceptors[t](n)){r=!0;break}if(r)continue;for(let t of n)this.handleFile(t.getAsFile());continue}let i=await t.getFile();console.log("dropping",e.type,e.kind,i.name),this.handleFile(i,{itemType:e.type})}}else console.log("length",t.dataTransfer.files.length)},document.onpaste=t=>{console.log("Paste",t);var e=(t.clipboardData||t.originalEvent.clipboardData).items;for(let t=this.fileInterceptors.length-1;t>=0;t--)if(this.fileInterceptors[t](e))return;if(e)for(let t of e){if("file"!==t.kind)continue;let e=t.getAsFile();console.log("dropping",t.type,t.kind,e.name),this.handleFile(e,{itemType:t.type})}},this.inputEl=document.createElement("input"),this.inputEl.setAttribute("type","file"),this.inputEl.style="display: none",this.inputEl.addEventListener("change",(t=>{this.handleBrowse(t)})),document.body.append(this.inputEl)},async handleFile(t,{itemType:e,positionIdx:r,loadingManager:o,busy:c,sceneName:h,forceReference:p}={}){let f=document.querySelector("a-scene").systems["settings-system"],y=e?/image\//.test(e):/\.(png|jpg|jpeg|bmp|svg)$/i.test(t.name);c||(c=this.el.systems["busy-indicator"].busy({title:`Handle ${t.name}`})),/\.(mp4|mov|avi|m4v|webm|mkv|gif)$/.test(t.name)?p||f.data.addReferences?await async function(t){let e=document.createElement("video");return e.src=b(t),console.log("Waiting for video to load",e),await e.play(),e.width=e.videoWidth,e.height=e.videoHeight,e.loop=!0,e.onload=void 0,A(e)}(t).then((()=>c.done())):await async function(t){m.isLoaded()||await m.load();let e,i=t.name.match(/\.([^\.]*)$/)[1];await m.FS("writeFile",`input.${i}`,await m.fetchFile(t)),console.log("Video Info ---\x3e");let r,a,o,s,l=!1;m.setLogger((({type:t,message:e})=>{if("fferr"===t){if(/^Input \#/.test(e))return void(l=!0);if(!l)return;let t;(t=e.match(/Duration: (\d+):(\d+):([\d\.]+),/))?r=60*parseFloat(t[1])*60+60*parseFloat(t[2])+parseFloat(t[3]):(t=e.match(/Stream #.*: Video:.*, (\d+)x(\d+).* ([\d\.]+) fps,/))&&(o=parseInt(t[1]),s=parseInt(t[2]),a=parseFloat(t[3]))}})),await m.run("-i",`input.${i}`);let c=a*r;if(console.log("Info",{durationSeconds:r,fps:a,width:o,height:s,numberOfFrames:c}),[r,a,o,s,c].some((t=>!t)))return void console.error("Missing Info!");m.setLogger((function(){})),c>100?await m.run("-i",`input.${i}`,"-r",""+100/r,"%01d.bmp"):await m.run("-i",`input.${i}`,"-r","1/1","%01d.bmp");let u=1;for(;;){let t;try{t=await m.FS("readFile",`${u}.bmp`),m.FS("unlink",`${u}.bmp`),console.log("Read frame",u)}catch(t){console.log("Done reading",t);break}let i,r=new Blob([t],{type:"image/bmp"}),a=new Image;a.src=b(r),await a.decode(),e?(Compositor.component.addFrameAfter(),i=e.frame(u-1)):(e=new n.Layer(a.width,a.height),Compositor.component.addLayer(void 0,{layer:e}),i=e.canvas),i.getContext("2d").drawImage(a,0,0),u++}}(t).then((()=>c.done())):/\.(svg)$/i.test(t.name)?await async function(t){let e=new THREE.SVGLoader,i=await t.text();console.log("Loading svg",t);let n=e.parse(i);console.log("Shapes loaded",n);for(let t of n.paths)for(let e of t.toShapes())Compositor.el.emit("shapecreated",e)}(t).then((()=>c.done())):y?p||f.data.addReferences?await async function(t){let e=new Image;return e.src=b(t),e.crossOrigin="anonymous",e.id="img",await new Promise(((t,i)=>e.onload=t)),e.onload=void 0,A(e)}(t).then((t=>{void 0===r&&(r=document.querySelectorAll(".reference-image").length),t.setAttribute("position",`${.1*r} 0 ${-.02*r}`),c.done()})):await async function(t,{setMapFromFilename:e=!1}={}){let i=new Image;i.src=b(t),i.id="img",i.crossOrigin="anonymous",await new Promise(((t,e)=>i.onload=t)),i.onload=void 0;let r=new n.Layer(i.width,i.height);if(r.canvas.getContext("2d").drawImage(i,0,0),t.name&&e){let e=l.Util.mapFromFilename(t.name);e&&(r.mode=e)}let a=document.getElementById("canvas-view").components.compositor;a.addLayer(a.layers.length-1,{layer:r})}(t,{setMapFromFilename:this.data.setMapFromFilename}).then((()=>c.done())):/\.(hdri?|exr)$/i.test(t.name)?await async function(t){await new Promise(((e,i)=>{(new s.a).setDataType(THREE.UnsignedByteType).load(b(t),(function(t,i){document.querySelector("a-scene").systems["environment-manager"].installHDREnvironment(t),e()}))}))}(t).then(c.done()):/\.materialpack$/i.test(t.name)?await(async()=>{let e=new THREE.GLTFLoader(o);e.register((t=>(console.log("Switching texture loader",t),t.textureLoader=new THREE.TextureLoader(o),{name:"NoBitmap"})));let i,n=await t.arrayBuffer();try{i=await new Promise(((t,i)=>e.parse(n,"",t,i)))}catch(t){return console.error("Could not load model",t),void(window.loadErrorBuffer=n)}f.el.systems["material-pack-system"].addPacksFromObjects(i.scenes[0]),c.done()})():g.test(t.name)?p||f.data.addReferences?await async function(t,{loadingManager:e}={}){let i=a.a.generate();document.createElement("a-asset-item").id=`asset-model-${i}`;let n=new THREE.GLTFLoader(e),r=await t.arrayBuffer(),o=await new Promise(((t,e)=>n.parse(r,"",t,e))),s=document.createElement("a-entity");document.querySelector("#reference-spawn").append(s),s.setObject3D("mesh",o.scene||o.scenes[0]),E(s),document.querySelector("a-scene").components["file-upload"].data.autoscaleModel&&(l.Util.autoScaleViewer(s.getObject3D("mesh"),s),s.object3D.position.z+=.25),s.emit("model-loaded",{format:"gltf",model:o})}(t,{loadingManager:o}).then((()=>c.done())):await async function(t,{postProcessMesh:e=!0,loadingManager:n,sceneName:r}={}){let o=a.a.generate();document.createElement("a-asset-item").id=`asset-model-${o}`,"vartiste-project"===document.querySelector("a-scene").systems["settings-system"].projectName&&document.querySelector("a-scene").systems["settings-system"].setProjectName((r||t.name).replace(g,""));let s,l="glb";switch(t.name.slice(-4).toLowerCase()){case".obj":l="obj";break;case".fbx":l="fbx";break;case".vrm":l="vrm"}if("obj"===l){let e=new THREE.OBJLoader(n);s=new THREE.Object3D;let i=await t.text();s.scene=e.parse(i),s.add(s.scene)}else if("fbx"===l){const{FBXLoader:e}=await i.e(5).then(i.bind(null,419));let r=new e(n),a=await t.arrayBuffer();s=new THREE.Object3D,s.scene=r.parse(a),s.add(s.scene)}else{let e=new THREE.GLTFLoader(n),i=await t.arrayBuffer();try{s=await new Promise(((t,n)=>e.parse(i,"",t,n)))}catch(t){return console.error("Could not load model",t),void(window.loadErrorBuffer=i)}}console.log("loaded",s),await w(s,{postProcessMesh:e,sceneName:r,format:l})}(t,{postProcessMesh:this.data.postProcessMesh,loadingManager:o,sceneName:h}).then((()=>c.done())):/\.(mtl)$/i.test(t.name)?c.done():/\.(vartiste-brushes)$/i.test(t.name)?await t.text().then((t=>{this.el.sceneEl.systems["brush-system"].addUserBrushes(JSON.parse(t)),c.done()})):/\.(vartiste-brushez)$/i.test(t.name)?await t.arrayBuffer().then((t=>{let e=u.a.inflate(t),i=new TextDecoder("utf-8").decode(e);this.el.sceneEl.systems["brush-system"].addUserBrushes(JSON.parse(i)),c.done()})):/\.zip$/i.test(t.name)?await t.arrayBuffer().then((async e=>{let i=new d.a;i=await i.loadAsync(e),console.log("New zip",i);let n,r={};for(let t in i.files){g.test(t)&&(n=t),console.log("Blobbing",t);let e=await i.file(t);if(!e)continue;let a=await e.async("blob");r[t]=a,a.name=t}const a=new THREE.LoadingManager,o=[];if(a.setURLModifier((t=>{let e=t;if(t.startsWith("blob:http")){let e=t.replace("blob:http","http");console.log("Blobless",e),t=new URL(e).pathname.slice(1)}return t in r?(console.log("Modifying url",t,r[t]),t=URL.createObjectURL(r[t]),o.push(t),t):(console.log("No blob for",t,e),e)})),n){let e=r[n];return e.name=n,await this.handleFile(e,{loadingManager:a,sceneName:t.name.replace(/\.zip$/i,""),forceReference:p}),void c.done()}let s=Object.values(r);for(let t=this.fileInterceptors.length-1;t>=0;t--)if(this.fileInterceptors[t](s))return void c.done();for(let t of s)await this.handleFile(t,{loadingManager:a,forceReference:p});c.done()})):/\.vartistez$/i.test(t.name)?await t.arrayBuffer().then((t=>{console.time("decompressProject");let e=u.a.inflate(t);e=new TextDecoder("utf-8").decode(e),console.timeEnd("decompressProject"),f.load(e),c.done()})).catch((t=>console.error("Couldn't load",t))):/\.vartiste$/i.test(t.name)?await t.text().then((t=>{f.load(t),c.done()})).catch((t=>console.error("Couldn't load",t))):console.warn("Unknown file",t.name)},handleURL(t,e){this.handleFile(new y(t),e)},handleBrowse(t){let e=Array.from(this.inputEl.files);console.log("browse items",e);for(let t=this.fileInterceptors.length-1;t>=0;t--)if(this.fileInterceptors[t](e))return;for(let t of e)this.handleFile(t,{itemType:t.type})},browse(){this.inputEl.click()}}),AFRAME.registerComponent("reference-glb",{dependencies:["mesh-can-be-clipped"],events:{bbuttondown:function(t){this.el.is("grabbed")&&this.makeClone()}},init(){c.Pool.init(this),this.el.classList.add("reference-glb"),this.el.setAttribute("frame","closeable: true; autoHide: true; useBounds: true"),this.el.setAttribute("action-tooltips","b: Clone"),l.Util.whenComponentInitialized(this.el,"frame",(()=>{let t=this.el.components.frame.addButton("#asset-shape-outline");t.setAttribute("tooltip","Decompose to shape constructs"),t.setAttribute("tooltip-style",this.el.components.frame.data.tooltipStyle),t.addEventListener("click",(()=>{this.el.sceneEl.systems["primitive-constructs"].decomposeReferences([this.el])}));let e=this.el.components.frame.addButton("#asset-newspaper-variant-outline");e.setAttribute("tooltip","Scene Organizer"),e.addEventListener("click",(()=>{this.el.sceneEl.systems["scene-organizer"].inspect(this.el)}))}))},remove(){this.el.getObject3D("mesh").traverse((t=>{t.material&&t.material.dispose(),t.geometry&&t.geometry.dispose()}))},makeClone(){let t=document.createElement("a-entity");this.el.parentEl.append(t),l.Util.whenLoaded(t,(()=>{t.setObject3D("mesh",this.el.getObject3D("mesh").clone()),t.setAttribute("reference-glb",this.data),l.Util.positionObject3DAtTarget(t.object3D,this.el.object3D)}))}})},function(t,e){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(t){"object"==typeof window&&(i=window)}t.exports=i},function(t,e,i){"use strict";var n,r="object"==typeof Reflect?Reflect:null,a=r&&"function"==typeof r.apply?r.apply:function(t,e,i){return Function.prototype.apply.call(t,e,i)};n=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var o=Number.isNaN||function(t){return t!=t};function s(){s.init.call(this)}t.exports=s,t.exports.once=function(t,e){return new Promise((function(i,n){function r(){void 0!==a&&t.removeListener("error",a),i([].slice.call(arguments))}var a;"error"!==e&&(a=function(i){t.removeListener(e,r),n(i)},t.once("error",a)),t.once(e,r)}))},s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var l=10;function c(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function u(t){return void 0===t._maxListeners?s.defaultMaxListeners:t._maxListeners}function h(t,e,i,n){var r,a,o,s;if(c(i),void 0===(a=t._events)?(a=t._events=Object.create(null),t._eventsCount=0):(void 0!==a.newListener&&(t.emit("newListener",e,i.listener?i.listener:i),a=t._events),o=a[e]),void 0===o)o=a[e]=i,++t._eventsCount;else if("function"==typeof o?o=a[e]=n?[i,o]:[o,i]:n?o.unshift(i):o.push(i),(r=u(t))>0&&o.length>r&&!o.warned){o.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=t,l.type=e,l.count=o.length,s=l,console&&console.warn&&console.warn(s)}return t}function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(t,e,i){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:i},r=d.bind(n);return r.listener=i,n.wrapFn=r,r}function f(t,e,i){var n=t._events;if(void 0===n)return[];var r=n[e];return void 0===r?[]:"function"==typeof r?i?[r.listener||r]:[r]:i?function(t){for(var e=new Array(t.length),i=0;i<e.length;++i)e[i]=t[i].listener||t[i];return e}(r):g(r,r.length)}function m(t){var e=this._events;if(void 0!==e){var i=e[t];if("function"==typeof i)return 1;if(void 0!==i)return i.length}return 0}function g(t,e){for(var i=new Array(e),n=0;n<e;++n)i[n]=t[n];return i}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(t){if("number"!=typeof t||t<0||o(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");l=t}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||o(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},s.prototype.getMaxListeners=function(){return u(this)},s.prototype.emit=function(t){for(var e=[],i=1;i<arguments.length;i++)e.push(arguments[i]);var n="error"===t,r=this._events;if(void 0!==r)n=n&&void 0===r.error;else if(!n)return!1;if(n){var o;if(e.length>0&&(o=e[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var l=r[t];if(void 0===l)return!1;if("function"==typeof l)a(l,this,e);else{var c=l.length,u=g(l,c);for(i=0;i<c;++i)a(u[i],this,e)}return!0},s.prototype.addListener=function(t,e){return h(this,t,e,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(t,e){return h(this,t,e,!0)},s.prototype.once=function(t,e){return c(e),this.on(t,p(this,t,e)),this},s.prototype.prependOnceListener=function(t,e){return c(e),this.prependListener(t,p(this,t,e)),this},s.prototype.removeListener=function(t,e){var i,n,r,a,o;if(c(e),void 0===(n=this._events))return this;if(void 0===(i=n[t]))return this;if(i===e||i.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete n[t],n.removeListener&&this.emit("removeListener",t,i.listener||e));else if("function"!=typeof i){for(r=-1,a=i.length-1;a>=0;a--)if(i[a]===e||i[a].listener===e){o=i[a].listener,r=a;break}if(r<0)return this;0===r?i.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(i,r),1===i.length&&(n[t]=i[0]),void 0!==n.removeListener&&this.emit("removeListener",t,o||e)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(t){var e,i,n;if(void 0===(i=this._events))return this;if(void 0===i.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==i[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete i[t]),this;if(0===arguments.length){var r,a=Object.keys(i);for(n=0;n<a.length;++n)"removeListener"!==(r=a[n])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=i[t]))this.removeListener(t,e);else if(void 0!==e)for(n=e.length-1;n>=0;n--)this.removeListener(t,e[n]);return this},s.prototype.listeners=function(t){return f(this,t,!0)},s.prototype.rawListeners=function(t){return f(this,t,!1)},s.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):m.call(t,e)},s.prototype.listenerCount=m,s.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]}},function(t,e){var i,n,r=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(t){if(i===setTimeout)return setTimeout(t,0);if((i===a||!i)&&setTimeout)return i=setTimeout,setTimeout(t,0);try{return i(t,0)}catch(e){try{return i.call(null,t,0)}catch(e){return i.call(this,t,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:a}catch(t){i=a}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(t){n=o}}();var l,c=[],u=!1,h=-1;function d(){u&&l&&(u=!1,l.length?c=l.concat(c):h=-1,c.length&&p())}function p(){if(!u){var t=s(d);u=!0;for(var e=c.length;e;){for(l=c,c=[];++h<e;)l&&l[h].run();h=-1,e=c.length}l=null,u=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function f(t,e){this.fun=t,this.array=e}function m(){}r.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];c.push(new f(t,e)),1!==c.length||u||s(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=m,r.addListener=m,r.once=m,r.off=m,r.removeListener=m,r.removeAllListeners=m,r.emit=m,r.prependListener=m,r.prependOnceListener=m,r.listeners=function(t){return[]},r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(t,e,i){"use strict";i.d(e,"a",(function(){return c}));var n=i(6),r=i(11);async function a(t){var e="data:application/octet-binary;base64,"+t;return await new Promise(((t,i)=>{fetch(e).then((e=>t(e.arrayBuffer())))}))}var o=i(18),s=i(0),l=i(5);class c{static update(t){"_fileVersion"in t||(t._fileVersion=0),"width"in t||(t.width=1024),"height"in t||(t.height=512),"layers"in t||(t.layers=[]),"projectName"in t||(t.projectName="project"),"shader"in t||(t.shader="flat"),"frameRate"in t||(t.frameRate=10),"palette"in t||(t.palette=[]),"useNodes"in t||(t.useNodes=!1),"allNodes"in t||(t.allNodes=[]),"flipY"in t||(t.flipY=!0),"flipNormal"in t||(t.flipNormal=!1),"referenceImages"in t||(t.referenceImages=[]),"referenceModels"in t||(t.referenceModels=[]),"referenceGLBs"in t||(t.referenceGLBs=[]),"environment"in t||(t.environment={state:"reset"}),"backgroundColor"in t||(t.backgroundColor="#333"),"tools"in t||(t.tools=[]),"exportJPEG"in t||(t.exportJPEG=!1),"userBrushes"in t||(t.userBrushes=[]),"primitiveConstructs"in t||(t.primitiveConstructs=[]),"shapeWands"in t||(t.shapeWands=[]),"tracksForElId"in t||(t.tracksForElId={}),"showFloor"in t.environment||(t.environment.showFloor=!1),"skeletonator"in t&&("frameCount"in t.skeletonator||(t.skeletonator.frameCount=50));for(let e in t.layers){let i=t.layers[e];if("transform"in i||(i.transform=n.Layer.EmptyTransform()),"rotation"in i.transform||(i.transform.rotation=0),"updateTime"in i&&delete i.updateTime,!("shelfMatrix"in i)){let t=new THREE.Matrix4;t.scale({x:.3,y:.3,z:.3}),t.setPosition(0,e,0),i.shelfMatrix={elements:t.elements}}t._fileVersion<1&&"bumpMap"===i.mode&&(console.log("Updating old bump map"),i.opacity=Math.pow(i.opacity,1/2.2))}for(let e in t.canvases)t._fileVersion<2&&(console.log("Reconstituting old canvases"),t.canvases[e]=[t.canvases[e]]);for(let e of t.allNodes)"updateTime"in e&&delete e.updateTime}static async load(t,{compositor:e}){console.log("Loading"),c.update(t);let i=document.getElementsByTagName("a-scene")[0].components["settings-system"];i.setProjectName(t.projectName),i.el.setAttribute("settings-system",{exportJPEG:t.exportJPEG});let n=Compositor.el.sceneEl.systems["animation-3d"];document.querySelector("#project-palette")&&document.querySelector("#project-palette").setAttribute("palette",{colors:t.palette});let r=e.el.sceneEl.systems["environment-manager"];if(document.querySelector("a-sky")&&r)if("reset"===t.environment.state)r.reset(),document.querySelector("a-sky").setAttribute("material","color",t.backgroundColor);else if("preset-hdri"===t.environment.state)r.usePresetHDRI();else if("STATE_HDRI"==t.environment.state){console.log("Reloading HDRI");let e=new THREE.DataTexture(await new Uint8Array(await a(t.environment.image.data)),t.environment.image.width,t.environment.image.height,t.environment.image.format,t.environment.image.type,t.environment.image.mapping,!1,!1,void 0,void 0,!1,t.environment.image.encoding);e.flipY=t.environment.image.flipY,e.needsUpdate=!0,r.installHDREnvironment(e)}else"STATE_ENVIROPACK"===t.environment.state&&r.useEnviropack(t.environment.substate);if(document.querySelector("#environment-place")&&document.querySelector("#environment-place").setAttribute("visible",t.environment.showFloor),await e.load(t),e.el.setAttribute("material",{shader:t.shader}),t.glb){let e=new THREE.GLTFLoader,n=await a(t.glb),r=await new Promise(((t,i)=>e.parse(n,"",t,i)));i.addModelView(r)}for(let e of t.referenceImages){console.log("Loading reference image...");let t=new Image;await new Promise(((i,n)=>{t.onload=i,t.src=e.src})),t.onload=void 0;let i=Object(o.addImageReferenceViewer)(t);i.object3D.matrix.fromArray(e.matrix),i.object3D.matrix.decompose(i.object3D.position,i.object3D.quaternion,i.object3D.scale)}let l=document.querySelector("#reference-spawn"),u=new THREE.ObjectLoader;if(l){for(let e of t.referenceModels){console.log("Loading reference model");let t=document.createElement("a-entity");l.append(t),t.object3D.copy(u.parse(e)),t.setObject3D("mesh",t.object3D.children[0]),Object(o.setupGlbReferenceEntity)(t),n&&n.readTracksFromUserData(t.object3D)}let e=new THREE.GLTFLoader;for(let i of t.referenceGLBs){console.log("Loading reference glb");let t=await a(i),r=await new Promise(((i,n)=>e.parse(t,"",i,n))),s=document.createElement("a-entity");l.append(s),s.object3D.copy(r.scenes[0].children[0]),s.setObject3D("mesh",r.scenes[0].children[0].children[0]),Object(o.setupGlbReferenceEntity)(s),n&&n.readTracksFromUserData(s.object3D)}}let h=t.constructObjRoot?u.parse(t.constructObjRoot):null;console.log("Loading constructs",h,t.primitiveConstructs);let d=new THREE.GLTFLoader,p=new THREE.Object3D;e.el.sceneEl.object3D.add(p);for(let i of t.primitiveConstructs){let t;if(i.glb){let e=await a(i.glb),n=await new Promise(((t,i)=>d.parse(e,"",t,i)));t=(n.scene||n.scenes[0]).getObjectByProperty("type","Mesh")}else if(i.json)t=await new Promise(((t,e)=>u.parse(i.json,t)));else{if(!i.uuid||!h){console.warn("No mesh for",i);continue}t=h.getObjectByProperty("uuid",i.uuid)}p.matrix.fromArray(i.matrix),s.Util.applyMatrix(p.matrix,p);let r=document.createElement("a-entity");e.el.sceneEl.systems["primitive-constructs"].data.container.append(r),r.classList.add("clickable"),t.el=r,r.object3D.add(t),r.setObject3D("mesh",t),await s.Util.whenLoaded(r),s.Util.positionObject3DAtTarget(r.object3D,p),r.setAttribute("primitive-construct-placeholder","manualMesh: true; detached: true;"),n&&n.readObjectTracks(r.object3D,i.track)}console.log("Loading skeletonator"),"skeletonator"in t&&(e.el.skeletonatorSavedSettings=t.skeletonator),i.el.sceneEl.systems["brush-system"].addUserBrushes(t.userBrushes);for(let i of t.tools){let t=document.createElement("a-entity");if(e.el.sceneEl.append(t),t.setAttribute("six-dof-tool",{lockedClone:!0,lockedComponent:i.component}),t.setAttribute(i.component,i.componentData),"tooltip"in i&&t.setAttribute("preactivate-tooltip",i.tooltip),"componentDependencies"in i)for(let e in i.componentDependencies)t.setAttribute(e,i.componentDependencies[e]);let n=new THREE.Matrix4;n.fromArray(i.matrix),s.Util.whenLoaded(t,(()=>{s.Util.applyMatrix(n,t.object3D)}))}let f=new THREE.Matrix4;if(Compositor.el.sceneEl.systems["shape-creation"])for(let e of t.shapeWands){let t=(new THREE.Shape).fromJSON(e.shape);Compositor.el.sceneEl.systems["shape-creation"].handleShape(t,{matrix:f.fromArray(e.matrix)})}if(t.materialPack){let e=await a(t.materialPack[0]),n=new THREE.GLTFLoader;n.register((t=>(console.log("Switching texture loader",t),t.textureLoader=new THREE.TextureLoader,{name:"NoBitmap"})));let r=await new Promise(((t,i)=>n.parse(e,"",t,i)));i.el.systems["material-pack-system"].addPacksFromObjects(r.scenes[0])}for(let[e,i]of Object.entries(t.tracksForElId)){if(console.log("Entries",e,i),!i)continue;let t=document.getElementById(e);t?n&&n.readObjectTracks(t.object3D,i):console.warn("Could not find id for saved tracks",e)}}async _save(){let t={_fileVersion:2},e=document.querySelector("a-scene").systems["settings-system"],i=document.querySelector("a-scene").systems["animation-3d"];t.projectName=e.projectName,t.exportJPEG=e.data.exportJPEG,Object.assign(t,this.saveCompositor()),t.tracksForElId={};let n=document.querySelector("#canvas-root");n&&i&&(t.tracksForElId["canvas-root"]=i.writeableTracks(n.object3D));let a=document.getElementById("composition-view");if(a){let e=a.getObject3D("mesh");if(e){i&&i.addTracksToUserData(e);let n=new THREE.MeshBasicMaterial;e.traverse((t=>{"Mesh"==t.type&&(t.material=n)}));let a=new THREE.GLTFExporter,o=await new Promise(((t,i)=>{a.parse(e,t,{binary:!0})}));t.glb=Object(r.a)(o)}i&&(t.tracksForElId["composition-view"]=i.writeableTracks(a.object3D))}t.palette=document.querySelector("#project-palette")?document.querySelector("#project-palette").getAttribute("palette").colors:[],t.referenceImages=[];let o=document.createElement("canvas");document.querySelectorAll(".reference-image").forEach((i=>{if(!i.getObject3D("mesh").material.map||!i.getObject3D("mesh").material.map.image)return;let n=i.getObject3D("mesh").material.map.image;o.width=n.width,o.height=n.height,o.getContext("2d").drawImage(n,0,0);let r=s.Util.isCanvasFullyOpaque(o)?e.imageURLType():"image/png";t.referenceImages.push({src:o.toDataURL(r,e.compressionQuality()),matrix:i.object3D.matrix.elements})})),t.referenceGLBs=[],t.referenceModels=[];let c=Array.from(document.querySelectorAll(".reference-glb"));for(let n of c){i&&i.addTracksToUserData(n.object3D);try{let i=await e.getExportableGLB(n.object3D),a=Object(r.a)(i);t.referenceGLBs.push(a)}catch(e){console.warn("Error exporting",n,"as GLB. Saving as JSON"),t.referenceModels.push(n.object3D.toJSON())}}t.primitiveConstructs=[];let u=Array.from(document.querySelectorAll("*[primitive-construct-placeholder]")).filter((t=>t.getAttribute("primitive-construct-placeholder").detached)),h=new THREE.Object3D;for(let n of u){let a=n.getObject3D("mesh");a.updateMatrixWorld(),console.log("Exporting construct"),i&&i.addTracksToUserData(n.object3D);const o=!1;new THREE.MeshBasicMaterial;if(o){let o=await e.getExportableGLB(a),s=Object(r.a)(o);t.primitiveConstructs.push({glb:s,matrix:a.matrixWorld.elements,track:i?i.writeableTracks(n.object3D):null})}else{a.material.normalScale&&a.material.normalScale.toArray||(a.material.normalScale=new THREE.Vector2(1,1));let e=new THREE.Mesh;e.copy(a),h.add(e),t.primitiveConstructs.push({uuid:e.uuid,matrix:a.matrixWorld.elements,track:i?i.writeableTracks(n.object3D):null})}}t.constructObjRoot=h.toJSON();let d=document.querySelector("*[skeletonator]");d?this.saveSkeletonator(t,d.components.skeletonator):Compositor.el.skeletonatorSavedSettings&&(t.skeletonator=Compositor.el.skeletonatorSavedSettings);let p=Compositor.el.sceneEl.systems["environment-manager"]||{};if("preset-hdri"==p.substate)t.environment={state:"preset-hdri"};else if("STATE_HDRI"==p.state){const e=!1;t.environment=e?{state:"STATE_HDRI",image:{format:p.hdriTexture.format,type:p.hdriTexture.type,mapping:p.hdriTexture.mapping,encoding:p.hdriTexture.encoding,flipY:p.hdriTexture.flipY,data:Object(r.a)(p.hdriTexture.image.data.buffer),width:p.hdriTexture.image.width,height:p.hdriTexture.image.height}}:{state:"preset-hdri"}}else"STATE_ENVIROPACK"==p.state?t.environment={state:"STATE_ENVIROPACK",substate:p.substate}:t.environment={state:"reset"};t.environment.showFloor=!!document.querySelector("#environment-place")&&document.querySelector("#environment-place").getAttribute("visible"),t.backgroundColor=document.querySelector("a-sky")?document.querySelector("a-sky").getAttribute("material").color:"#eee",t.userBrushes=[];for(let e of l.a)e.user&&t.userBrushes.push(e.fullStore());if(t.tools=[],document.querySelectorAll("a-entity[pencil-tool],a-entity[camera-tool]").forEach((e=>{let i=e.getAttribute("six-dof-tool");if(!i.lockedClone)return;let n=e.components[i.lockedComponent];e.object3D.updateMatrixWorld();let r={};for(let t of i.lockedComponentDependencies)e.hasAttribute(t)&&(r[t]=e.getAttribute(t));t.tools.push({component:i.lockedComponent,componentData:n.stringify(n.data),matrix:e.object3D.matrixWorld.elements,componentDependencies:r})})),t.shapeWands=[],Compositor.el.sceneEl.systems["shape-creation"])for(let[e,i]of Compositor.el.sceneEl.systems["shape-creation"].wandShapes.entries())t.shapeWands.push({shape:i.toJSON(),matrix:e.object3D.matrix.elements});let f=new THREE.Object3D;if(document.querySelectorAll(".user[material-pack] .view").forEach((t=>{f.add(t.getObject3D("mesh").clone())})),f.children.length){let i=e.data.exportJPEG;e.data.exportJPEG=!0,t.materialPack=[await Object(r.a)(await e.getExportableGLB(f))],e.data.exportJPEG=i}return t}constructor({compositor:t}){this.compositor=t}static async save(...t){return await new c(...t)._save()}saveCompositor(){let{compositor:t}=this,{layers:e,allNodes:i}=t,n=t.el.sceneEl.systems["settings-system"];return{layers:e,allNodes:i,useNodes:t.data.useNodes,width:t.width,height:t.height,shader:t.el.getAttribute("material").shader,frameRate:t.data.frameRate,flipY:t.data.flipY,flipNormal:t.data.flipNormal,canvases:e.map((t=>t.frames.map((t=>t.toDataURL(n.imageURLType(t),n.compressionQuality())))))}}saveSkeletonator(t,e){let i={};i.boneTracks=e.boneTracks,i.frameCount=e.data.frameCount,t.skeletonator=i}}},function(t,e,i){t.exports=i.p+"asset/d683bfb394f888c5820ce11fc4770fd8.woff"},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAQAAAD9CzEMAAACBElEQVR42u2WvXGDQBCF3QLxNUB8BVADOQUQ0wLpVUBOTOwSXIBzx8rISJh5Pj2dd71zxrLAytg3sjUa5nvs7v3syxlnPC9QwKGEo4r/RnvUUQ3apAY1PIr/gjfo0CNgEAX06NCgOmiCMsEHjJjwKpowYqBJDbcbz3cnPCLfqPeo+Jffow1NYh578S36K1zQHyIaMZeRFn5fcYgX+MVITUaEhy1QoBa8wuek+E1MogUL9VgvUKHDgEnxBC+iObPoUD1WnmDwAs9MaMEy1Sgeen+Wx+LXL4kFs5AcvBBW1L8ZsP7y/rOBGxOTQ/9VJLzjGpfNBpsCzRsGUqZkMHEtORJGLLRYUfzcgVYLRITiwY/NQYvUwkmR5/Rk+MEgdSAvEIzRYop060KpnGi63vLYyEAN7mSgBi1KQ+qx3J43v8PlGeTvT+UZeLioMsqjQo1GStV9M9jsAeQjYW0zQf/nq0gN7CraF6vdaPk+sFkg68QHl2qX7rp0qWLi03N2UB/ZyRoYiV/yhep4VE+aw8ZZdDH7uIEzlIHbbX3SaYqA2eCzHPL7YFbduw/gcSH+3pGtFlHmPqPkRrNbLB1461/u5IAhv5MVLnh/bKqYzFSRZgqZKiL+6FwUria0IVbmosC5qNzH1nZXm5NdjUpae9DEy2TayWwa4c+YrqN4EJxxxhlnPDM+AbLctkxSAP6aAAAAAElFTkSuQmCC"},function(t,e,i){var n={"./about-shelf.html.slm":199,"./advanced-drawing-shelf.html.slm":200,"./airendernode-view.html.slm":201,"./artist-root.html.slm":156,"./brush-editor.html.slm":202,"./brush-packs.html.slm":203,"./brush-shelf.html.slm":157,"./busy-indicator.html.slm":158,"./canvasnode-view.html.slm":204,"./color-selection-shelf.html.slm":205,"./compact-layer-shelf.html.slm":206,"./constraints-popup.html.slm":207,"./controller-proxy.html.slm":208,"./controller-setup-shelf.html.slm":209,"./crash-handler.html.slm":210,"./desktop-controls.html.slm":211,"./dropdown-popup.html.slm":212,"./enter-vr-failed-handler.html.slm":213,"./environment-manager-shelf.html.slm":214,"./environment-selector-popup.html.slm":215,"./export-shelf.html.slm":216,"./extra-keys.html.slm":217,"./extras-popup.html.slm":218,"./extras-shelf.html.slm":219,"./framenode-view.html.slm":220,"./fx-brush-popup.html.slm":221,"./fx-popup.html.slm":222,"./fxnode-view.html.slm":223,"./grid-options-shelf.html.slm":224,"./hand-menu.html.slm":159,"./hubs-connector-shelf.html.slm":225,"./keyboard.html.slm":226,"./kromophone-shelf.html.slm":227,"./language-shelf.html.slm":228,"./layer-view.html.slm":229,"./load-project-row.html.slm":230,"./load-shelf.html.slm":231,"./loading-page.html.slm":232,"./manipulator-info-shelf.html.slm":233,"./manipulator-omni-tool.html.slm":234,"./material-pack.html.slm":235,"./materialnode-view.html.slm":236,"./mesh-tools-shelf.html.slm":237,"./mode-shelf.html.slm":238,"./morph-target-shelf.html.slm":239,"./networkinputnode-view.html.slm":240,"./networkoutputnode-view.html.slm":241,"./node-control-panel.html.slm":242,"./numpad-float.html.slm":243,"./numpad.html.slm":244,"./object-animation-popup.html.slm":245,"./object-graph-node.html.slm":246,"./object3d-view.html.slm":247,"./outputnode-view.html.slm":248,"./passthroughnode-view.html.slm":249,"./popup-shelf.html.slm":250,"./quick-menu.html.slm":251,"./remote-avatar.html.slm":160,"./settings-shelf.html.slm":252,"./shelf.html.slm":155,"./six-dof-shelf.html.slm":253,"./skeletonator-control-panel.html.slm":254,"./skeletonator-keyframes.html.slm":255,"./sketchfab-confirm-popup.html.slm":256,"./sketchfab-shelf.html.slm":257,"./standard-sizes.html.slm":258,"./styletransfernode-view.html.slm":259,"./timeline-keyframe.html.slm":260,"./timeline-shelf.html.slm":261,"./timer-shelf.html.slm":262,"./toolbox-shelf.html.slm":263,"./tools-menu.html.slm":264,"./volumetrics.html.slm":265,"./welcome-shelf.html.slm":266};function r(t){var e=a(t);return i(e)}function a(t){if(!i.o(n,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return n[t]}r.keys=function(){return Object.keys(n)},r.resolve=a,t.exports=r,r.id=25},function(t,e,i){"use strict";var n,r,a,o=i(301),s="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_-";function l(){a=!1}function c(t){if(t){if(t!==n){if(t.length!==s.length)throw new Error("Custom alphabet for shortid must be "+s.length+" unique characters. You submitted "+t.length+" characters: "+t);var e=t.split("").filter((function(t,e,i){return e!==i.lastIndexOf(t)}));if(e.length)throw new Error("Custom alphabet for shortid must be "+s.length+" unique characters. These characters were not unique: "+e.join(", "));n=t,l()}}else n!==s&&(n=s,l())}function u(){return a||(a=function(){n||c(s);for(var t,e=n.split(""),i=[],r=o.nextValue();e.length>0;)r=o.nextValue(),t=Math.floor(r*e.length),i.push(e.splice(t,1)[0]);return i.join("")}())}t.exports={get:function(){return n||s},characters:function(t){return c(t),n},seed:function(t){o.seed(t),r!==t&&(l(),r=t)},lookup:function(t){return u()[t]},shuffled:u}},function(t,e){t.exports="varying vec2 vUv;\nvarying vec3 vClipPosition;\nvoid main() {\n\tvUv = uv;\n\tvec4 mvPosition = modelViewMatrix * vec4(position, 1.0);\n\tvClipPosition = -mvPosition.xyz;\n\tgl_Position = projectionMatrix * mvPosition;\n}\n"},function(t,e,i){var n=i(16),r=i(165),a=i(15),o=a.mat3,s=a.vec3,l=i(12),c=t.exports=function(t){this.id=t.id,this.palmPosition=t.palmPosition,this.direction=t.direction,this.palmVelocity=t.palmVelocity,this.palmNormal=t.palmNormal,this.sphereCenter=t.sphereCenter,this.sphereRadius=t.sphereRadius,this.valid=!0,this.pointables=[],this.fingers=[],t.armBasis?this.arm=new r(this,{type:4,width:t.armWidth,prevJoint:t.elbow,nextJoint:t.wrist,basis:t.armBasis}):this.arm=null,this.tools=[],this._translation=t.t,this._rotation=l.flatten(t.r),this._scaleFactor=t.s,this.timeVisible=t.timeVisible,this.stabilizedPalmPosition=t.stabilizedPalmPosition,this.type=t.type,this.grabStrength=t.grabStrength,this.pinchStrength=t.pinchStrength,this.confidence=t.confidence};c.prototype.finger=function(t){var e=this.frame.finger(t);return e&&e.handId==this.id?e:n.Invalid},c.prototype.rotationAngle=function(t,e){if(!this.valid||!t.valid)return 0;if(!t.hand(this.id).valid)return 0;var i=this.rotationMatrix(t),n=.5*(i[0]+i[4]+i[8]-1),r=Math.acos(n);if(r=isNaN(r)?0:r,void 0!==e){var a=this.rotationAxis(t);r*=s.dot(a,s.normalize(s.create(),e))}return r},c.prototype.rotationAxis=function(t){if(!this.valid||!t.valid)return s.create();var e=t.hand(this.id);return e.valid?s.normalize(s.create(),[this._rotation[7]-e._rotation[5],this._rotation[2]-e._rotation[6],this._rotation[3]-e._rotation[1]]):s.create()},c.prototype.rotationMatrix=function(t){if(!this.valid||!t.valid)return o.create();var e=t.hand(this.id);if(!e.valid)return o.create();var i=o.transpose(o.create(),this._rotation);return o.multiply(o.create(),e._rotation,i)},c.prototype.scaleFactor=function(t){if(!this.valid||!t.valid)return 1;var e=t.hand(this.id);return e.valid?Math.exp(this._scaleFactor-e._scaleFactor):1},c.prototype.translation=function(t){if(!this.valid||!t.valid)return s.create();var e=t.hand(this.id);return e.valid?[this._translation[0]-e._translation[0],this._translation[1]-e._translation[1],this._translation[2]-e._translation[2]]:s.create()},c.prototype.toString=function(){return"Hand ("+this.type+") [ id: "+this.id+" | palm velocity:"+this.palmVelocity+" | sphere center:"+this.sphereCenter+" ] "},c.prototype.pitch=function(){return Math.atan2(this.direction[1],-this.direction[2])},c.prototype.yaw=function(){return Math.atan2(this.direction[0],-this.direction[2])},c.prototype.roll=function(){return Math.atan2(this.palmNormal[0],-this.palmNormal[1])},c.Invalid={valid:!1,fingers:[],tools:[],pointables:[],left:!1,pointable:function(){return n.Invalid},finger:function(){return n.Invalid},toString:function(){return"invalid frame"},dump:function(){return this.toString()},rotationAngle:function(){return 0},rotationMatrix:function(){return o.create()},rotationAxis:function(){return s.create()},scaleFactor:function(){return 1},translation:function(){return s.create()}}},function(t,e,i){var n=i(16),r=i(165),a=i(167),o=i(12),s=t.exports=function(t){n.call(this,t),this.dipPosition=t.dipPosition,this.pipPosition=t.pipPosition,this.mcpPosition=t.mcpPosition,this.carpPosition=t.carpPosition,this.extended=t.extended,this.type=t.type,this.finger=!0,this.positions=[this.carpPosition,this.mcpPosition,this.pipPosition,this.dipPosition,this.tipPosition],t.bases?this.addBones(t):a.warnBones()};o.extend(s.prototype,n.prototype),s.prototype.addBones=function(t){this.metacarpal=new r(this,{type:0,width:this.width,prevJoint:this.carpPosition,nextJoint:this.mcpPosition,basis:t.bases[0]}),this.proximal=new r(this,{type:1,width:this.width,prevJoint:this.mcpPosition,nextJoint:this.pipPosition,basis:t.bases[1]}),this.medial=new r(this,{type:2,width:this.width,prevJoint:this.pipPosition,nextJoint:this.dipPosition,basis:t.bases[2]}),this.distal=new r(this,{type:3,width:this.width,prevJoint:this.dipPosition,nextJoint:t.btipPosition,basis:t.bases[3]}),this.bones=[this.metacarpal,this.proximal,this.medial,this.distal]},s.prototype.toString=function(){return"Finger [ id:"+this.id+" "+this.length+"mmx | width:"+this.width+"mm | direction:"+this.direction+" ]"},s.Invalid={valid:!1}},function(t,e,i){"use strict";i.r(e),i.d(e,"prepareModelForExport",(function(){return l})),i.d(e,"bumpCanvasToNormalCanvas",(function(){return c})),i.d(e,"checkTransparency",(function(){return u})),i.d(e,"MaterialTransformations",(function(){return s}));var n=i(0),r=i(4),a=i(11),o=(i(362),i(10));class s{static bumpCanvasToNormalCanvas(t,{normalCanvas:e,bumpScale:i,invert:n=!1,alphaOnly:r=!1}={}){let a=t.getContext("2d").getImageData(0,0,t.width,t.height),o=r?(e,i)=>a.data[4*(i*t.width+e)+3]/255+.5:(e,i)=>a.data[4*(i*t.width+e)+0]/255*a.data[4*(i*t.width+e)+3]/255+.5;void 0===e&&((e=document.createElement("canvas")).width=t.width,e.height=t.height);let s=e.getContext("2d"),l=s.getImageData(0,0,e.width,e.height),c=(i,n,r)=>{let a=Math.floor(i/t.width*e.width),o=Math.floor(n/t.height*e.height);l.data[4*(o*e.width+a)+0]=255*r.x,l.data[4*(o*e.width+a)+1]=255*r.y,l.data[4*(o*e.width+a)+2]=255*r.z,l.data[4*(o*e.width+a)+3]=255};n&&(c=(i,n,r)=>{let a=Math.floor(i/t.width*e.width),o=Math.floor(n/t.height*e.height);l.data[4*(o*e.width+a)+0]=255*r.x,l.data[4*(o*e.width+a)+1]=255*(1-r.y),l.data[4*(o*e.width+a)+2]=255*r.z,l.data[4*(o*e.width+a)+3]=255});let u=new THREE.Vector3,h=i?1.5-i:.1;console.log("Using bump scale",h);for(let e=0;e<t.width;++e)for(let i=0;i<t.height;++i){if(0==e||e==t.width-1||0==i||i==t.height-1){u.set(.5,.5,1),c(e,i,u);continue}let n=o(e+1,i),r=o(e-1,i),a=o(e,i+1),s=r-n,l=o(e,i-1)-a;u.set(s,l,h).normalize(),u.x+=.5,u.y+=.5,u.clampScalar(0,1),c(e,i,u)}return s.putImageData(l,0,0),e}static putRoughnessInMetal(t,e){if(e&&e.id&&e.id.startsWith("default-")&&(e=void 0),t&&t.id&&t.id.startsWith("default-")&&(t=void 0),e){if(!t){(t=document.createElement("canvas")).width=e.width,t.height=e.height;let i=t.getContext("2d");i.fillStyle="#000",i.fillRect(0,0,t.width,t.height)}}else{(e=document.createElement("canvas")).width=t?t.width:24,e.height=t?t.height:24;let i=e.getContext("2d");if(!t)return i.fillStyle="#FFFF00",i.fillRect(0,0,e.width,e.height),e;i.fillStyle="#000",i.fillRect(0,0,e.width,e.height)}e.width===t.width&&e.height===t.height||console.warn("Metalness and roughness are not same dimensions",e,t);let r=new o.CanvasShaderProcessor({source:i(363)});return r.setInputCanvas(e),r.setCanvasAttribute("u_roughness",t),r.update(),n.Util.cloneCanvas(r.canvas)}static checkTransparency(t){if(!t.map||!t.map.image)return;let e=t.map.image,i=e.getContext("2d").getImageData(0,0,e.width,e.height);for(let t=0;t<e.height;++t)for(let n=0;n<e.width;++n)if(i.data[4*(t*e.width+n)+3]<245)return;t.transparent=!1}static vec2toVec3Attribute(t){let e=t.geometry.attributes.position,i=[];i.length=Math.floor(e.array.length/2*3);let n=0;for(let t=0;t<e.array.length;++t)i[n++]=e.array[t],t%2==0&&(i[n++]=0);t.geometry.removeAttribute("position"),t.geometry.addAttribute("position",new THREE.Float32BufferAttribute(i,3))}static prepareModelForExport(t,e,{undoStack:i}={}){if(e||(e=t.material),t.geometry&&t.geometry.attributes&&n.Util.deinterleaveAttributes(t.geometry),t.geometry&&t.geometry.attributes&&t.geometry.attributes.position&&3!==t.geometry.attributes.position.itemSize&&(i&&i.push((()=>t.visible=!0)),t.visible=!1),t.geometry&&!t.geometry.getAttribute&&(i&&i.push((()=>t.visible=!0)),t.visible=!1),e){if(e.bumpMap&&e.bumpMap.image){if(console.log("Bumping into normal"),e.normalMap&&console.warn("Ignoring existing normal map"),e.normalMap=new THREE.Texture,e.normalMap.flipY=e.bumpMap.flipY,"CANVAS"!==e.bumpMap.image.nodeName){if(i){let t=e.bumpMap.image;i.push((()=>e.bumpMap.image=t))}e.bumpMap.image=n.Util.cloneCanvas(e.bumpMap.image)}else i&&i.pushCanvas(e.bumpMap.image);e.normalMap.image=s.bumpCanvasToNormalCanvas(e.bumpMap.image),e.normalMap.wrapS=e.bumpMap.wrapS,e.normalMap.wrapT=e.bumpMap.wrapT}if(e.roughnessMap&&e.roughnessMap.image&&e.metalnessMap&&e.metalnessMap.image&&e.metalnessMap===e.roughnessMap)console.log("Not combining metallic roughness. Not needed");else if(e.roughnessMap&&e.roughnessMap.image){if(console.log("Combining roughness into metalness"),i){let t=e.roughnessMap,n=e.metalnessMap,r=n?n.image:null;i.push((()=>{e.roughnessMap=t,e.metalnessMap=n,r&&(e.metalnessMap.image=r),e.metalnessMap&&(e.metalnessMap.needsUpdate=!0),e.needsUpdate=!0,console.log("Restored original metall / roughness")}))}e.metalnessMap||(e.metalnessMap=new THREE.Texture,e.metalnessMap.wrapS=e.roughnessMap.wrapS,e.metalnessMap.wrapT=e.roughnessMap.wrapT),e.metalnessMap.image=s.putRoughnessInMetal(e.roughnessMap.image,e.metalnessMap.image),e.metalnessMap.needsUpdate=!0,e.roughnessMap=e.metalnessMap,e.needsUpdate=!0}else if(e.metalnessMap){let t=document.createElement("canvas");t.width=e.metalnessMap.image.width,t.height=e.metalnessMap.image.height;let r=t.getContext("2d");if(r.fillStyle="#000",r.fillRect(0,0,t.width,t.height),"CANVAS"!==e.metalnessMap.image.nodeName){if(i){let t=e.metalnessMap.image;i.push((()=>e.metalnessMap.image=t))}e.metalnessMap.image=n.Util.cloneCanvas(e.metalnessMap.image)}else i&&i.pushCanvas(e.metalnessMap.image);s.putRoughnessInMetal(t,e.metalnessMap.image),e.roughnessMap=e.metalnessMap,e.needsUpdate=!0}if(e.map&&e.map.image){if("CANVAS"!==e.map.image.nodeName&&"IMG"!==e.map.image.nodeName){if(i){let t=e.map.image;i.push((()=>e.map.image=t))}try{e.map.image=n.Util.cloneCanvas(e.map.image)}catch(n){if(i){let t=e.map;i.push((()=>e.map=t))}return e.map=null,void console.warn("Can't use texture, skipping: ",t,e.map,n)}}"IMG"!==e.map.image.nodeName&&s.checkTransparency(e)}}}}const{prepareModelForExport:l,bumpCanvasToNormalCanvas:c,checkTransparency:u}=s;n.Util.registerComponentSystem("glb-exporter",{init(){},async getExportableGLB(t,{restoreAfterExport:e=!0}={}){t||(t=this.el.object3D),t instanceof AFRAME.AEntity&&(t=t.el);let i=e?new r.UndoStack({maxSize:-1}):null;t.traverse((t=>{t.material&&l(t,t.material,{undoStack:i})}));let n=new THREE.GLTFExporter,a=await new Promise(((e,i)=>{n.parse(t,e,{binary:!0,animations:t.animations||[],includeCustomExtensions:!0,onlyVisible:!0})}));for(;i&&i.stack.length;)i.undo();return a},async downloadGLB(t,{filename:e,...i}={}){let n=await this.getExportableGLB(t,i);e||(e="vartiste-toolkit-export.glb"),e.endsWith(".glb")||(e+=".glb");let r=document.createElement("a");r.href="data:application:/x-binary;base64,"+Object(a.a)(n),r.style="z-index: 10000; position: absolute; top: 50%; left: 50%; padding: 5px; background-color: #eee; transform: translate(-50%,-50%)",r.innerHTML="Open GLB",r.download=e,r.click()}})},function(t,e,i){"use strict";i.r(e),i.d(e,"STATE_NORMAL",(function(){return s})),i.d(e,"STATE_HOVERED",(function(){return l})),i.d(e,"STATE_PRESSED",(function(){return c})),i.d(e,"STATE_TOGGLED",(function(){return u})),i.d(e,"STATE_UNTOGGLED",(function(){return h}));var n=i(8),r=i(0);const a={color:{type:"color",default:"#abe"},clickColor:{type:"color",default:"#aea"},intersectedColor:{type:"color",default:"#cef"},toggleOnColor:{type:"color",default:"#bea"},togglableColor:{type:"color",default:"#ede5d8"},keepAspect:{type:"bool",default:!0},buttonType:{default:"button"}},o={};for(let t in a)o[t]=a[t].default;AFRAME.registerComponent("button-style",{schema:{color:{type:"color",default:"#b6c5f2"},clickColor:{type:"color",default:"#aea"},intersectedColor:{type:"color",default:"#cef"},toggleOnColor:{type:"color",default:"#bea"},togglableColor:{type:"color",default:"#ede5d8"},keepAspect:{type:"bool",default:!0},buttonType:{default:"button"},autoPosition:{default:!0}}});const[s,l,c,u,h]=["BUTTON_STATE_NORMAL","BUTTON_STATE_HOVERED","BUTTON_STATE_PRESSED","BUTTON_STATE_TOGGLED","BUTTON_STATE_UNTOGGLED"];AFRAME.registerSystem("icon-button",{schema:{shader:{default:"matcap"},iconShader:{default:"flat"},matcap:{default:"#asset-matcap",type:"map"},metalness:{default:.3},roughness:{default:1}},init(){this.width=.4,this.depth=.05,r.Util.isLowPower()?this.geometry=new THREE.BoxBufferGeometry(this.width,this.width,this.depth-.005):(new THREE.GLTFLoader).load(document.getElementById("asset-button").getAttribute("src"),(t=>{let e=(new THREE.Matrix4).makeScale(this.width,this.width,this.depth-.005);this.geometry=t.scene.getObjectByProperty("type","Mesh").geometry,this.geometry.applyMatrix4(e)})),this.frontGeometry=new THREE.PlaneBufferGeometry(this.width-.01,this.width-.01),this.colorManagement=this.el.getAttribute("renderer").colorManagement,this.blankFaceMaterial=new THREE.MeshBasicMaterial({transparent:!0,opacity:0,alphaTest:.01,toneMapped:!1}),this.faceMaterials={},this.bgMaterials={},"matcap"===this.data.shader?(this.bgMaterial=new THREE.MeshMatcapMaterial({toneMapped:!1}),this.bgMaterial.matcap=new THREE.Texture,this.bgMaterial.matcap.image=this.data.matcap,this.bgMaterial.matcap.encoding=THREE.LinearEncoding,this.bgMaterial.matcap.needsUpdate=!0):"standard"===this.data.shader?this.bgMaterial=new THREE.MeshStandardMaterial({metalness:.3,roughness:1}):this.bgMaterial=new THREE.MeshBasicMaterial({toneMapped:!1}),this.tmpColor=new THREE.Color}}),AFRAME.registerComponent("icon-button",{dependencies:["button-style","raycast-bvh"],schema:{type:"string",default:""},events:{stateadded:function(t){this.updateStateColor()},stateremoved:function(t){this.updateStateColor()},componentchanged:function(t){"button-style"===t.detail.name&&this.updateStateColor()},"raycaster-intersected":function(t){this.el.addState(l)},"raycaster-intersected-cleared":function(t){this.el.removeState(l)}},init(){let t,e,i=this.system.width,r=this.system.depth;this.state=s,t=this.el.hasAttribute("button-style")?this.el.getAttribute("button-style"):o,this.style=t,"plane"===t.buttonType&&(r=.001),this.el.setObject3D("mesh",new THREE.Mesh(this.system.frontGeometry,this.system.blankFaceMaterial));for(let t=this.el.parentEl;t;t=t.parentEl)if(t["redirect-grab"]||t.classList.contains("clickable")||t.classList.contains("grab-root")){this.el["redirect-grab"]=t;break}if(this.el.classList.add("clickable"),t.autoPosition){let t=Array.from(this.el.parentEl.children).filter((t=>t.hasAttribute("icon-button"))).indexOf(this.el);this.el.object3D.position.z+=r,this.el.object3D.position.x+=(i+.05)*t}"plane"===t.buttonType?(e=new THREE.Mesh(this.system.frontGeometry,this.system.bgMaterial),e.position.set(0,0,-.01)):(e=new THREE.Mesh(this.system.geometry,this.system.bgMaterial),e.position.set(0,0,-r/2)),this.el.getObject3D("mesh").add(e),this.bg=e,this.fg=this.el.getObject3D("mesh"),this.el.addEventListener("click",(t=>{this.clickTime=this.el.sceneEl.time,t.detail.cursorEl&&n.a.click(t.detail.cursorEl),this.addState(c)})),this.el.addEventListener("object3dset",(t=>{this.updateAspect(),this.updateStateColor()})),this.updateStateColor(),this.el.actionTooltips={trigger:"Click Button"},this.tick=AFRAME.utils.throttleTick(this.tick,80,this)},update(t){if(!this.el.attached)throw new Error("Not attached!");this.system.faceMaterials[this.data]?this.el.getObject3D("mesh").material=this.system.faceMaterials[this.data]:(this.el.setAttribute("material",{alphaTest:.01,color:"#FFF",fog:!1,src:this.data,transparent:!0,shader:this.system.data.iconShader,opacity:""===this.data?0:1}),this.el.components.material.material.toneMapped=!1,this.data instanceof HTMLImageElement||this.data.startsWith("data")||(this.system.faceMaterials[this.data]=this.el.getObject3D("mesh").material)),this.updateAspect()},addState(t){this.el.addState(t)},removeState(t){this.el.removeState(t)},updateStateColor(){this.el.is(c)?this.setColor(this.style.clickColor):this.el.is(l)?this.setColor(this.style.intersectedColor):this.el.is(u)?this.setColor(this.style.toggleOnColor):this.el.is(h)?this.setColor(this.style.togglableColor):this.setColor(this.style.color)},setColor(t){let e=this.system.tmpColor;e.setStyle(t),this.system.colorManagement&&e.convertSRGBToLinear(),this.instanceManager&&this.instanceManager.setColor(this,e),this.system.bgMaterials[e.getHex()]?this.bg.material=this.system.bgMaterials[e.getHex()]:(this.bg.material=this.system.bgMaterial.clone(),this.bg.material.color.copy(e),this.bg.material.needsUpdate=!0,this.system.bgMaterials[e.getHex()]=this.bg.material)},updateAspect(){},tick(t,e){if(this.clickTime&&t-this.clickTime>300){this.el.components["button-style"].data;this.removeState(c)}}}),AFRAME.registerComponent("toggle-button",{dependencies:["icon-button"],schema:{target:{type:"selector"},component:{type:"string"},property:{type:"string"},system:{type:"string"},toggled:{type:"boolean",default:!1},useUntoggledColor:{default:!0},invert:{default:!1}},events:{click:function(){this.data.target?this.data.property?this.data.target.setAttribute(this.data.component,{[this.data.property]:!this.data.target.getAttribute(this.data.component)[this.data.property]}):this.data.target.setAttribute(this.data.component,!this.data.target.getAttribute(this.data.component)):this.data.system?(this.el.sceneEl.systems[this.data.system].data[this.data.property]=!this.el.sceneEl.systems[this.data.system].data[this.data.property],this.setToggle(this.el.sceneEl.systems[this.data.system].data[this.data.property])):(this.data.toggled=!this.data.toggled,this.setToggle(this.data.toggled))}},update(t){this.data.useUntoggledColor!==t.useUntoggledColor&&!this.el.is(h)&&this.data.useUntoggledColor&&this.el.addState(h),this.data.target!==t.target&&(t.target&&t.target.removeEventListener("componentchanged",this.componentchangedlistener),this.data.target?(this.componentchangedlistener=t=>{t.detail.name===this.data.component&&this.setToggle(!!(this.data.property?this.data.target.getAttribute(this.data.component)[this.data.property]:this.data.target.getAttribute(this.data.component)),{update:!1})},this.data.target.addEventListener("componentchanged",this.componentchangedlistener),r.Util.whenLoaded([this.el,this.data.target],(()=>{this.setToggle(!!(this.data.property?this.data.target.getAttribute(this.data.component)[this.data.property]:this.data.target.getAttribute(this.data.component)),{update:!1})}))):this.data.toggled!==t.toggled&&this.setToggle(this.data.toggled))},setToggle(t){this.data.toggled=t,this.data.invert&&(vale=!t),t?(this.el.removeState(u),this.el.addState(u),this.el.components["icon-button"].updateStateColor()):(this.el.removeState(u),this.data.useUntoggledColor&&this.el.addState(h))}}),AFRAME.registerComponent("system-click-action",{schema:{system:{type:"string"},component:{type:"string"},action:{type:"string"}},events:{click:function(){if(this.data.action)if(console.log("Clicking",this),this.data.component.length)this.el.sceneEl.components[this.data.component][this.data.action]();else if(this.data.system.length)this.el.sceneEl.systems[this.data.system][this.data.action]();else try{r.Util.traverseAncestors(this.el,(t=>{if(!t.hasAttribute("system-click-action"))return;let e=t.getAttribute("system-click-action");if(e.component)throw this.el.sceneEl.components[e.component][this.data.action](),0;if(e.system)throw this.el.sceneEl.components[e.system][this.data.action](),0}))}catch(t){0!==t&&console.error(t)}}}}),AFRAME.registerComponent("icon-row",{schema:{mergeButtons:{default:!1},mergeIcons:{default:!0},autoPosition:{default:!0}},events:{object3dset:function(t){this.data.mergeButtons&&this.merge()},materialtextureloaded:function(t){this.data.mergeButtons&&this.merge()}},init(){if(this.data.autoPosition){let t=Array.from(this.el.parentEl.children).filter((t=>t.hasAttribute("icon-row"))).indexOf(this.el);this.el.object3D.position.y-=.5*t}this.system=this.el.sceneEl.systems["icon-button"],this.data.mergeButtons&&r.Util.whenLoaded(this.el,(()=>this.merge()))},async merge(){if(!this.data.mergeButtons)return;if(this.mergeInProgress)return;this.mergeInProgress=!0,this.componentToButton=new Map;let t=Array.from(this.el.getChildEntities()).filter((t=>t.hasAttribute("icon-button")));if(0==t.length)return;let e=new THREE.InstancedMesh(this.system.geometry,this.system.bgMaterial,t.length);await r.Util.whenLoaded(t);for(let e of t){let t=e.components["icon-button"].fg;t.material.map&&this.data.mergeIcons&&t.material.map.image.decode&&await t.material.map.image.decode()}this.mesh&&(this.mesh.parent.remove(this.mesh),this.mesh.dispose&&this.mesh.dispose()),this.mesh=e,e.position.set(0,0,-this.system.depth/2);let i=0,n=this.iconCanvas||document.createElement("canvas");this.iconCanvas=n,n.height=32;let a=n.getContext("2d"),o=!1,s=this.data.mergeIcons&&!t.some((t=>t.hasAttribute("position"))),l=32/this.system.width*(this.system.width+.05);n.width=l*t.length;for(let n of t){let t=n.components["icon-button"];n.object3D.updateMatrix(),e.setMatrixAt(i,n.object3D.matrix),e.setColorAt(i,t.bg.material.color),t.bg.parent&&t.bg.parent.remove(t.bg),t.instanceManager=this,this.componentToButton.set(t,i);let r=t.fg;r.material.map&&s&&(a.drawImage(r.material.map.image,i*l+l-32,0,32,32),o=!0,r.material.cloned||(r.material=r.material.clone(),r.material.cloned=!0,r.material.visible=!1)),i++}if(this.el.object3D.add(e),o){let e=this.fg;e||(e=document.createElement("a-image"),this.el.append(e),e.setAttribute("material",{src:n,color:"#FFF",fog:!1,transparent:!0,shader:this.system.data.iconShader,opacity:""===this.data?0:1})),e.setAttribute("geometry",`width: ${(this.system.width+.05)*t.length}; height: ${this.system.width}`),e.setAttribute("position",`${(this.system.width+.05)*(t.length-1)/2-.025} 0 ${this.system.depth+.001}`),r.Util.whenLoaded(e,(()=>{e.components.material.material.toneMapped=!1,e.components.material.material.needsUpdate=!0})),this.fg=e}this.mergeInProgress=!1},setColor(t,e){this.mesh.setColorAt(this.componentToButton.get(t),e),this.mesh.instanceColor.needsUpdate=!0}}),AFRAME.registerComponent("radio-button",{schema:{value:{type:"string"},target:{type:"selector"},component:{type:"string"},property:{type:"string"},useUntoggledColor:{default:!0}},events:{click:function(){this.data.target?this.data.property?this.data.target.setAttribute(this.data.component,{[this.data.property]:this.data.value}):this.data.target.setAttribute(this.data.component,this.data.value):this.data.system&&(this.el.sceneEl.systems[this.data.system].data[this.data.property]=this.data.value,this.setToggle(!0))}},update(t){this.data.useUntoggledColor!==t.useUntoggledColor&&!this.el.is(h)&&this.data.useUntoggledColor&&this.el.addState(h),this.data.target!==t.target&&(t.target&&t.target.removeEventListener("componentchanged",this.componentchangedlistener),this.data.target&&(this.componentchangedlistener=t=>{t.detail.name===this.data.component&&this.setToggle(this.data.target.getAttribute(this.data.component)[this.data.property]===this.data.value,{update:!1})},this.data.target.addEventListener("componentchanged",this.componentchangedlistener),r.Util.whenLoaded([this.el,this.data.target],(()=>{this.setToggle(this.data.target.getAttribute(this.data.component)[this.data.property]===this.data.value,{update:!1})}))))},setToggle(t){this.data.toggled=t,t?(this.el.removeState(h),this.el.addState(u),this.el.components["icon-button"].updateStateColor()):(this.el.removeState(u),this.data.useUntoggledColor&&this.el.addState(h))}}),AFRAME.registerComponent("icon-row-text",{dependencies:["text"],schema:{default:"",type:"string"},init(){this.el.setAttribute("text",`anchor: left; align: left; value: ${this.data}`),this.el.setAttribute("translate-text","")},update(){this.el.setAttribute("text","value",this.data)}})},function(t,e,i){"use strict";i.d(e,"a",(function(){return p}));const{DataTextureLoader:n,FloatType:r,HalfFloatType:a,LinearEncoding:o,LinearFilter:s,NearestFilter:l,RGBEEncoding:c,RGBEFormat:u,RGBFormat:h,UnsignedByteType:d}=THREE;var p=function(t){n.call(this,t),this.type=d};p.prototype=Object.assign(Object.create(n.prototype),{constructor:p,parse:function(t){var e=function(t,e){switch(t){case 1:console.error("RGBELoader Read Error: "+(e||""));break;case 2:console.error("RGBELoader Write Error: "+(e||""));break;case 3:console.error("RGBELoader Bad File Format: "+(e||""));break;default:case 4:console.error("RGBELoader: Error: "+(e||""))}return-1},i=function(t,e,i){e=e||1024;for(var n=t.pos,r=-1,a=0,o="",s=String.fromCharCode.apply(null,new Uint16Array(t.subarray(n,n+128)));0>(r=s.indexOf("\n"))&&a<e&&n<t.byteLength;)o+=s,a+=s.length,n+=128,s+=String.fromCharCode.apply(null,new Uint16Array(t.subarray(n,n+128)));return-1<r&&(!1!==i&&(t.pos+=a+r+1),o+s.slice(0,r))},n=function(){var t=new Float32Array(1),e=new Int32Array(t.buffer);function i(i){t[0]=i;var n=e[0],r=n>>16&32768,a=n>>12&2047,o=n>>23&255;return o<103?r:o>142?(r|=31744,r|=(255==o?0:1)&&8388607&n):o<113?r|=((a|=2048)>>114-o)+(a>>113-o&1):(r|=o-112<<10|a>>1,r+=1&a)}return function(t,e,n,r){var a=t[e+3],o=Math.pow(2,a-128)/255;n[r+0]=i(t[e+0]*o),n[r+1]=i(t[e+1]*o),n[r+2]=i(t[e+2]*o)}}(),o=new Uint8Array(t);o.pos=0;var s,l,c,p,f,m,g=function(t){var n,r,a=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,o=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,s=/^\s*FORMAT=(\S+)\s*$/,l=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,c={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};if(t.pos>=t.byteLength||!(n=i(t)))return e(1,"no header found");if(!(r=n.match(/^#\?(\S+)$/)))return e(3,"bad initial token");for(c.valid|=1,c.programtype=r[1],c.string+=n+"\n";!1!==(n=i(t));)if(c.string+=n+"\n","#"!==n.charAt(0)){if((r=n.match(a))&&(c.gamma=parseFloat(r[1],10)),(r=n.match(o))&&(c.exposure=parseFloat(r[1],10)),(r=n.match(s))&&(c.valid|=2,c.format=r[1]),(r=n.match(l))&&(c.valid|=4,c.height=parseInt(r[1],10),c.width=parseInt(r[2],10)),2&c.valid&&4&c.valid)break}else c.comments+=n+"\n";return 2&c.valid?4&c.valid?c:e(3,"missing image size specifier"):e(3,"missing format specifier")}(o);if(-1!==g){var y=g.width,b=g.height,A=function(t,i,n){var r,a,o,s,l,c,u,h,d,p,f,m,g,y=i,b=n;if(y<8||y>32767||2!==t[0]||2!==t[1]||128&t[2])return new Uint8Array(t);if(y!==(t[2]<<8|t[3]))return e(3,"wrong scanline width");if(!(r=new Uint8Array(4*i*n)).length)return e(4,"unable to allocate buffer space");for(a=0,o=0,h=4*y,g=new Uint8Array(4),c=new Uint8Array(h);b>0&&o<t.byteLength;){if(o+4>t.byteLength)return e(1);if(g[0]=t[o++],g[1]=t[o++],g[2]=t[o++],g[3]=t[o++],2!=g[0]||2!=g[1]||(g[2]<<8|g[3])!=y)return e(3,"bad rgbe scanline format");for(u=0;u<h&&o<t.byteLength;){if((m=(s=t[o++])>128)&&(s-=128),0===s||u+s>h)return e(3,"bad scanline data");if(m)for(l=t[o++],d=0;d<s;d++)c[u++]=l;else c.set(t.subarray(o,o+s),u),u+=s,o+=s}for(p=y,d=0;d<p;d++)f=0,r[a]=c[d+f],f+=y,r[a+1]=c[d+f],f+=y,r[a+2]=c[d+f],f+=y,r[a+3]=c[d+f],a+=4;b--}return r}(o.subarray(o.pos),y,b);if(-1!==A){switch(this.type){case d:var v=A,w=u,E=d;break;case r:for(var _=A.length/4*3,x=new Float32Array(_),T=0;T<_;T++)c=x,p=3*T,f=void 0,m=void 0,f=(s=A)[(l=4*T)+3],m=Math.pow(2,f-128)/255,c[p+0]=s[l+0]*m,c[p+1]=s[l+1]*m,c[p+2]=s[l+2]*m;v=x,w=h,E=r;break;case a:_=A.length/4*3;var M=new Uint16Array(_);for(T=0;T<_;T++)n(A,4*T,M,3*T);v=M,w=h,E=a;break;default:console.error("THREE.RGBELoader: unsupported type: ",this.type)}return{width:y,height:b,data:v,header:g.string,gamma:g.gamma,exposure:g.exposure,format:w,type:E}}}return null},setDataType:function(t){return this.type=t,this},load:function(t,e,i,u){return n.prototype.load.call(this,t,(function(t,i){switch(t.type){case d:t.encoding=c,t.minFilter=l,t.magFilter=l,t.generateMipmaps=!1,t.flipY=!0;break;case r:case a:t.encoding=o,t.minFilter=s,t.magFilter=s,t.generateMipmaps=!1,t.flipY=!0}e&&e(t,i)}),i,u)}})},function(t,e,i){"use strict";function n(t){let e=t.length;for(;--e>=0;)t[e]=0}const r=256,a=286,o=30,s=15,l=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),c=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),u=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),h=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),d=new Array(576);n(d);const p=new Array(60);n(p);const f=new Array(512);n(f);const m=new Array(256);n(m);const g=new Array(29);n(g);const y=new Array(o);function b(t,e,i,n,r){this.static_tree=t,this.extra_bits=e,this.extra_base=i,this.elems=n,this.max_length=r,this.has_stree=t&&t.length}let A,v,w;function E(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}n(y);const _=t=>t<256?f[t]:f[256+(t>>>7)],x=(t,e)=>{t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255},T=(t,e,i)=>{t.bi_valid>16-i?(t.bi_buf|=e<<t.bi_valid&65535,x(t,t.bi_buf),t.bi_buf=e>>16-t.bi_valid,t.bi_valid+=i-16):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=i)},M=(t,e,i)=>{T(t,i[2*e],i[2*e+1])},C=(t,e)=>{let i=0;do{i|=1&t,t>>>=1,i<<=1}while(--e>0);return i>>>1},k=(t,e,i)=>{const n=new Array(16);let r,a,o=0;for(r=1;r<=s;r++)n[r]=o=o+i[r-1]<<1;for(a=0;a<=e;a++){let e=t[2*a+1];0!==e&&(t[2*a]=C(n[e]++,e))}},R=t=>{let e;for(e=0;e<a;e++)t.dyn_ltree[2*e]=0;for(e=0;e<o;e++)t.dyn_dtree[2*e]=0;for(e=0;e<19;e++)t.bl_tree[2*e]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0},S=t=>{t.bi_valid>8?x(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},D=(t,e,i,n)=>{const r=2*e,a=2*i;return t[r]<t[a]||t[r]===t[a]&&n[e]<=n[i]},O=(t,e,i)=>{const n=t.heap[i];let r=i<<1;for(;r<=t.heap_len&&(r<t.heap_len&&D(e,t.heap[r+1],t.heap[r],t.depth)&&r++,!D(e,n,t.heap[r],t.depth));)t.heap[i]=t.heap[r],i=r,r<<=1;t.heap[i]=n},P=(t,e,i)=>{let n,a,o,s,u=0;if(0!==t.last_lit)do{n=t.pending_buf[t.d_buf+2*u]<<8|t.pending_buf[t.d_buf+2*u+1],a=t.pending_buf[t.l_buf+u],u++,0===n?M(t,a,e):(o=m[a],M(t,o+r+1,e),s=l[o],0!==s&&(a-=g[o],T(t,a,s)),n--,o=_(n),M(t,o,i),s=c[o],0!==s&&(n-=y[o],T(t,n,s)))}while(u<t.last_lit);M(t,256,e)},F=(t,e)=>{const i=e.dyn_tree,n=e.stat_desc.static_tree,r=e.stat_desc.has_stree,a=e.stat_desc.elems;let o,l,c,u=-1;for(t.heap_len=0,t.heap_max=573,o=0;o<a;o++)0!==i[2*o]?(t.heap[++t.heap_len]=u=o,t.depth[o]=0):i[2*o+1]=0;for(;t.heap_len<2;)c=t.heap[++t.heap_len]=u<2?++u:0,i[2*c]=1,t.depth[c]=0,t.opt_len--,r&&(t.static_len-=n[2*c+1]);for(e.max_code=u,o=t.heap_len>>1;o>=1;o--)O(t,i,o);c=a;do{o=t.heap[1],t.heap[1]=t.heap[t.heap_len--],O(t,i,1),l=t.heap[1],t.heap[--t.heap_max]=o,t.heap[--t.heap_max]=l,i[2*c]=i[2*o]+i[2*l],t.depth[c]=(t.depth[o]>=t.depth[l]?t.depth[o]:t.depth[l])+1,i[2*o+1]=i[2*l+1]=c,t.heap[1]=c++,O(t,i,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],((t,e)=>{const i=e.dyn_tree,n=e.max_code,r=e.stat_desc.static_tree,a=e.stat_desc.has_stree,o=e.stat_desc.extra_bits,l=e.stat_desc.extra_base,c=e.stat_desc.max_length;let u,h,d,p,f,m,g=0;for(p=0;p<=s;p++)t.bl_count[p]=0;for(i[2*t.heap[t.heap_max]+1]=0,u=t.heap_max+1;u<573;u++)h=t.heap[u],p=i[2*i[2*h+1]+1]+1,p>c&&(p=c,g++),i[2*h+1]=p,h>n||(t.bl_count[p]++,f=0,h>=l&&(f=o[h-l]),m=i[2*h],t.opt_len+=m*(p+f),a&&(t.static_len+=m*(r[2*h+1]+f)));if(0!==g){do{for(p=c-1;0===t.bl_count[p];)p--;t.bl_count[p]--,t.bl_count[p+1]+=2,t.bl_count[c]--,g-=2}while(g>0);for(p=c;0!==p;p--)for(h=t.bl_count[p];0!==h;)d=t.heap[--u],d>n||(i[2*d+1]!==p&&(t.opt_len+=(p-i[2*d+1])*i[2*d],i[2*d+1]=p),h--)}})(t,e),k(i,u,t.bl_count)},U=(t,e,i)=>{let n,r,a=-1,o=e[1],s=0,l=7,c=4;for(0===o&&(l=138,c=3),e[2*(i+1)+1]=65535,n=0;n<=i;n++)r=o,o=e[2*(n+1)+1],++s<l&&r===o||(s<c?t.bl_tree[2*r]+=s:0!==r?(r!==a&&t.bl_tree[2*r]++,t.bl_tree[32]++):s<=10?t.bl_tree[34]++:t.bl_tree[36]++,s=0,a=r,0===o?(l=138,c=3):r===o?(l=6,c=3):(l=7,c=4))},B=(t,e,i)=>{let n,r,a=-1,o=e[1],s=0,l=7,c=4;for(0===o&&(l=138,c=3),n=0;n<=i;n++)if(r=o,o=e[2*(n+1)+1],!(++s<l&&r===o)){if(s<c)do{M(t,r,t.bl_tree)}while(0!=--s);else 0!==r?(r!==a&&(M(t,r,t.bl_tree),s--),M(t,16,t.bl_tree),T(t,s-3,2)):s<=10?(M(t,17,t.bl_tree),T(t,s-3,3)):(M(t,18,t.bl_tree),T(t,s-11,7));s=0,a=r,0===o?(l=138,c=3):r===o?(l=6,c=3):(l=7,c=4)}};let I=!1;const j=(t,e,i,n)=>{T(t,0+(n?1:0),3),((t,e,i,n)=>{S(t),n&&(x(t,i),x(t,~i)),t.pending_buf.set(t.window.subarray(e,e+i),t.pending),t.pending+=i})(t,e,i,!0)};var L={_tr_init:t=>{I||((()=>{let t,e,i,n,r;const h=new Array(16);for(i=0,n=0;n<28;n++)for(g[n]=i,t=0;t<1<<l[n];t++)m[i++]=n;for(m[i-1]=n,r=0,n=0;n<16;n++)for(y[n]=r,t=0;t<1<<c[n];t++)f[r++]=n;for(r>>=7;n<o;n++)for(y[n]=r<<7,t=0;t<1<<c[n]-7;t++)f[256+r++]=n;for(e=0;e<=s;e++)h[e]=0;for(t=0;t<=143;)d[2*t+1]=8,t++,h[8]++;for(;t<=255;)d[2*t+1]=9,t++,h[9]++;for(;t<=279;)d[2*t+1]=7,t++,h[7]++;for(;t<=287;)d[2*t+1]=8,t++,h[8]++;for(k(d,287,h),t=0;t<o;t++)p[2*t+1]=5,p[2*t]=C(t,5);A=new b(d,l,257,a,s),v=new b(p,c,0,o,s),w=new b(new Array(0),u,0,19,7)})(),I=!0),t.l_desc=new E(t.dyn_ltree,A),t.d_desc=new E(t.dyn_dtree,v),t.bl_desc=new E(t.bl_tree,w),t.bi_buf=0,t.bi_valid=0,R(t)},_tr_stored_block:j,_tr_flush_block:(t,e,i,n)=>{let a,o,s=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=(t=>{let e,i=4093624447;for(e=0;e<=31;e++,i>>>=1)if(1&i&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<r;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0})(t)),F(t,t.l_desc),F(t,t.d_desc),s=(t=>{let e;for(U(t,t.dyn_ltree,t.l_desc.max_code),U(t,t.dyn_dtree,t.d_desc.max_code),F(t,t.bl_desc),e=18;e>=3&&0===t.bl_tree[2*h[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e})(t),a=t.opt_len+3+7>>>3,o=t.static_len+3+7>>>3,o<=a&&(a=o)):a=o=i+5,i+4<=a&&-1!==e?j(t,e,i,n):4===t.strategy||o===a?(T(t,2+(n?1:0),3),P(t,d,p)):(T(t,4+(n?1:0),3),((t,e,i,n)=>{let r;for(T(t,e-257,5),T(t,i-1,5),T(t,n-4,4),r=0;r<n;r++)T(t,t.bl_tree[2*h[r]+1],3);B(t,t.dyn_ltree,e-1),B(t,t.dyn_dtree,i-1)})(t,t.l_desc.max_code+1,t.d_desc.max_code+1,s+1),P(t,t.dyn_ltree,t.dyn_dtree)),R(t),n&&S(t)},_tr_tally:(t,e,i)=>(t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&i,t.last_lit++,0===e?t.dyn_ltree[2*i]++:(t.matches++,e--,t.dyn_ltree[2*(m[i]+r+1)]++,t.dyn_dtree[2*_(e)]++),t.last_lit===t.lit_bufsize-1),_tr_align:t=>{T(t,2,3),M(t,256,d),(t=>{16===t.bi_valid?(x(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)})(t)}};var N=(t,e,i,n)=>{let r=65535&t|0,a=t>>>16&65535|0,o=0;for(;0!==i;){o=i>2e3?2e3:i,i-=o;do{r=r+e[n++]|0,a=a+r|0}while(--o);r%=65521,a%=65521}return r|a<<16|0};const H=new Uint32Array((()=>{let t,e=[];for(var i=0;i<256;i++){t=i;for(var n=0;n<8;n++)t=1&t?3988292384^t>>>1:t>>>1;e[i]=t}return e})());var z=(t,e,i,n)=>{const r=H,a=n+i;t^=-1;for(let i=n;i<a;i++)t=t>>>8^r[255&(t^e[i])];return-1^t},V={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},G={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:W,_tr_stored_block:X,_tr_flush_block:Y,_tr_tally:Q,_tr_align:q}=L,{Z_NO_FLUSH:Z,Z_PARTIAL_FLUSH:K,Z_FULL_FLUSH:J,Z_FINISH:$,Z_BLOCK:tt,Z_OK:et,Z_STREAM_END:it,Z_STREAM_ERROR:nt,Z_DATA_ERROR:rt,Z_BUF_ERROR:at,Z_DEFAULT_COMPRESSION:ot,Z_FILTERED:st,Z_HUFFMAN_ONLY:lt,Z_RLE:ct,Z_FIXED:ut,Z_DEFAULT_STRATEGY:ht,Z_UNKNOWN:dt,Z_DEFLATED:pt}=G,ft=258,mt=262,gt=103,yt=113,bt=666,At=(t,e)=>(t.msg=V[e],e),vt=t=>(t<<1)-(t>4?9:0),wt=t=>{let e=t.length;for(;--e>=0;)t[e]=0};let Et=(t,e,i)=>(e<<t.hash_shift^i)&t.hash_mask;const _t=t=>{const e=t.state;let i=e.pending;i>t.avail_out&&(i=t.avail_out),0!==i&&(t.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+i),t.next_out),t.next_out+=i,e.pending_out+=i,t.total_out+=i,t.avail_out-=i,e.pending-=i,0===e.pending&&(e.pending_out=0))},xt=(t,e)=>{Y(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,_t(t.strm)},Tt=(t,e)=>{t.pending_buf[t.pending++]=e},Mt=(t,e)=>{t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e},Ct=(t,e,i,n)=>{let r=t.avail_in;return r>n&&(r=n),0===r?0:(t.avail_in-=r,e.set(t.input.subarray(t.next_in,t.next_in+r),i),1===t.state.wrap?t.adler=N(t.adler,e,r,i):2===t.state.wrap&&(t.adler=z(t.adler,e,r,i)),t.next_in+=r,t.total_in+=r,r)},kt=(t,e)=>{let i,n,r=t.max_chain_length,a=t.strstart,o=t.prev_length,s=t.nice_match;const l=t.strstart>t.w_size-mt?t.strstart-(t.w_size-mt):0,c=t.window,u=t.w_mask,h=t.prev,d=t.strstart+ft;let p=c[a+o-1],f=c[a+o];t.prev_length>=t.good_match&&(r>>=2),s>t.lookahead&&(s=t.lookahead);do{if(i=e,c[i+o]===f&&c[i+o-1]===p&&c[i]===c[a]&&c[++i]===c[a+1]){a+=2,i++;do{}while(c[++a]===c[++i]&&c[++a]===c[++i]&&c[++a]===c[++i]&&c[++a]===c[++i]&&c[++a]===c[++i]&&c[++a]===c[++i]&&c[++a]===c[++i]&&c[++a]===c[++i]&&a<d);if(n=ft-(d-a),a=d-ft,n>o){if(t.match_start=e,o=n,n>=s)break;p=c[a+o-1],f=c[a+o]}}}while((e=h[e&u])>l&&0!=--r);return o<=t.lookahead?o:t.lookahead},Rt=t=>{const e=t.w_size;let i,n,r,a,o;do{if(a=t.window_size-t.lookahead-t.strstart,t.strstart>=e+(e-mt)){t.window.set(t.window.subarray(e,e+e),0),t.match_start-=e,t.strstart-=e,t.block_start-=e,n=t.hash_size,i=n;do{r=t.head[--i],t.head[i]=r>=e?r-e:0}while(--n);n=e,i=n;do{r=t.prev[--i],t.prev[i]=r>=e?r-e:0}while(--n);a+=e}if(0===t.strm.avail_in)break;if(n=Ct(t.strm,t.window,t.strstart+t.lookahead,a),t.lookahead+=n,t.lookahead+t.insert>=3)for(o=t.strstart-t.insert,t.ins_h=t.window[o],t.ins_h=Et(t,t.ins_h,t.window[o+1]);t.insert&&(t.ins_h=Et(t,t.ins_h,t.window[o+3-1]),t.prev[o&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=o,o++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<mt&&0!==t.strm.avail_in)},St=(t,e)=>{let i,n;for(;;){if(t.lookahead<mt){if(Rt(t),t.lookahead<mt&&e===Z)return 1;if(0===t.lookahead)break}if(i=0,t.lookahead>=3&&(t.ins_h=Et(t,t.ins_h,t.window[t.strstart+3-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==i&&t.strstart-i<=t.w_size-mt&&(t.match_length=kt(t,i)),t.match_length>=3)if(n=Q(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){t.match_length--;do{t.strstart++,t.ins_h=Et(t,t.ins_h,t.window[t.strstart+3-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=Et(t,t.ins_h,t.window[t.strstart+1]);else n=Q(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(n&&(xt(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,e===$?(xt(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(xt(t,!1),0===t.strm.avail_out)?1:2},Dt=(t,e)=>{let i,n,r;for(;;){if(t.lookahead<mt){if(Rt(t),t.lookahead<mt&&e===Z)return 1;if(0===t.lookahead)break}if(i=0,t.lookahead>=3&&(t.ins_h=Et(t,t.ins_h,t.window[t.strstart+3-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==i&&t.prev_length<t.max_lazy_match&&t.strstart-i<=t.w_size-mt&&(t.match_length=kt(t,i),t.match_length<=5&&(t.strategy===st||3===t.match_length&&t.strstart-t.match_start>4096)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){r=t.strstart+t.lookahead-3,n=Q(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=r&&(t.ins_h=Et(t,t.ins_h,t.window[t.strstart+3-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=2,t.strstart++,n&&(xt(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if(n=Q(t,0,t.window[t.strstart-1]),n&&xt(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(n=Q(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,e===$?(xt(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(xt(t,!1),0===t.strm.avail_out)?1:2};function Ot(t,e,i,n,r){this.good_length=t,this.max_lazy=e,this.nice_length=i,this.max_chain=n,this.func=r}const Pt=[new Ot(0,0,0,0,((t,e)=>{let i=65535;for(i>t.pending_buf_size-5&&(i=t.pending_buf_size-5);;){if(t.lookahead<=1){if(Rt(t),0===t.lookahead&&e===Z)return 1;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;const n=t.block_start+i;if((0===t.strstart||t.strstart>=n)&&(t.lookahead=t.strstart-n,t.strstart=n,xt(t,!1),0===t.strm.avail_out))return 1;if(t.strstart-t.block_start>=t.w_size-mt&&(xt(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===$?(xt(t,!0),0===t.strm.avail_out?3:4):(t.strstart>t.block_start&&(xt(t,!1),t.strm.avail_out),1)})),new Ot(4,4,8,4,St),new Ot(4,5,16,8,St),new Ot(4,6,32,32,St),new Ot(4,4,16,16,Dt),new Ot(8,16,32,32,Dt),new Ot(8,16,128,128,Dt),new Ot(8,32,128,256,Dt),new Ot(32,128,258,1024,Dt),new Ot(32,258,258,4096,Dt)];function Ft(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=pt,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),wt(this.dyn_ltree),wt(this.dyn_dtree),wt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),wt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),wt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Ut=t=>{if(!t||!t.state)return At(t,nt);t.total_in=t.total_out=0,t.data_type=dt;const e=t.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?42:yt,t.adler=2===e.wrap?0:1,e.last_flush=Z,W(e),et},Bt=t=>{const e=Ut(t);return e===et&&(t=>{t.window_size=2*t.w_size,wt(t.head),t.max_lazy_match=Pt[t.level].max_lazy,t.good_match=Pt[t.level].good_length,t.nice_match=Pt[t.level].nice_length,t.max_chain_length=Pt[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0})(t.state),e},It=(t,e,i,n,r,a)=>{if(!t)return nt;let o=1;if(e===ot&&(e=6),n<0?(o=0,n=-n):n>15&&(o=2,n-=16),r<1||r>9||i!==pt||n<8||n>15||e<0||e>9||a<0||a>ut)return At(t,nt);8===n&&(n=9);const s=new Ft;return t.state=s,s.strm=t,s.wrap=o,s.gzhead=null,s.w_bits=n,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=r+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+3-1)/3),s.window=new Uint8Array(2*s.w_size),s.head=new Uint16Array(s.hash_size),s.prev=new Uint16Array(s.w_size),s.lit_bufsize=1<<r+6,s.pending_buf_size=4*s.lit_bufsize,s.pending_buf=new Uint8Array(s.pending_buf_size),s.d_buf=1*s.lit_bufsize,s.l_buf=3*s.lit_bufsize,s.level=e,s.strategy=a,s.method=i,Bt(t)};var jt={deflateInit:(t,e)=>It(t,e,pt,15,8,ht),deflateInit2:It,deflateReset:Bt,deflateResetKeep:Ut,deflateSetHeader:(t,e)=>t&&t.state?2!==t.state.wrap?nt:(t.state.gzhead=e,et):nt,deflate:(t,e)=>{let i,n;if(!t||!t.state||e>tt||e<0)return t?At(t,nt):nt;const r=t.state;if(!t.output||!t.input&&0!==t.avail_in||r.status===bt&&e!==$)return At(t,0===t.avail_out?at:nt);r.strm=t;const a=r.last_flush;if(r.last_flush=e,42===r.status)if(2===r.wrap)t.adler=0,Tt(r,31),Tt(r,139),Tt(r,8),r.gzhead?(Tt(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),Tt(r,255&r.gzhead.time),Tt(r,r.gzhead.time>>8&255),Tt(r,r.gzhead.time>>16&255),Tt(r,r.gzhead.time>>24&255),Tt(r,9===r.level?2:r.strategy>=lt||r.level<2?4:0),Tt(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(Tt(r,255&r.gzhead.extra.length),Tt(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(t.adler=z(t.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69):(Tt(r,0),Tt(r,0),Tt(r,0),Tt(r,0),Tt(r,0),Tt(r,9===r.level?2:r.strategy>=lt||r.level<2?4:0),Tt(r,3),r.status=yt);else{let e=pt+(r.w_bits-8<<4)<<8,i=-1;i=r.strategy>=lt||r.level<2?0:r.level<6?1:6===r.level?2:3,e|=i<<6,0!==r.strstart&&(e|=32),e+=31-e%31,r.status=yt,Mt(r,e),0!==r.strstart&&(Mt(r,t.adler>>>16),Mt(r,65535&t.adler)),t.adler=1}if(69===r.status)if(r.gzhead.extra){for(i=r.pending;r.gzindex<(65535&r.gzhead.extra.length)&&(r.pending!==r.pending_buf_size||(r.gzhead.hcrc&&r.pending>i&&(t.adler=z(t.adler,r.pending_buf,r.pending-i,i)),_t(t),i=r.pending,r.pending!==r.pending_buf_size));)Tt(r,255&r.gzhead.extra[r.gzindex]),r.gzindex++;r.gzhead.hcrc&&r.pending>i&&(t.adler=z(t.adler,r.pending_buf,r.pending-i,i)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=73)}else r.status=73;if(73===r.status)if(r.gzhead.name){i=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>i&&(t.adler=z(t.adler,r.pending_buf,r.pending-i,i)),_t(t),i=r.pending,r.pending===r.pending_buf_size)){n=1;break}n=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,Tt(r,n)}while(0!==n);r.gzhead.hcrc&&r.pending>i&&(t.adler=z(t.adler,r.pending_buf,r.pending-i,i)),0===n&&(r.gzindex=0,r.status=91)}else r.status=91;if(91===r.status)if(r.gzhead.comment){i=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>i&&(t.adler=z(t.adler,r.pending_buf,r.pending-i,i)),_t(t),i=r.pending,r.pending===r.pending_buf_size)){n=1;break}n=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,Tt(r,n)}while(0!==n);r.gzhead.hcrc&&r.pending>i&&(t.adler=z(t.adler,r.pending_buf,r.pending-i,i)),0===n&&(r.status=gt)}else r.status=gt;if(r.status===gt&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&_t(t),r.pending+2<=r.pending_buf_size&&(Tt(r,255&t.adler),Tt(r,t.adler>>8&255),t.adler=0,r.status=yt)):r.status=yt),0!==r.pending){if(_t(t),0===t.avail_out)return r.last_flush=-1,et}else if(0===t.avail_in&&vt(e)<=vt(a)&&e!==$)return At(t,at);if(r.status===bt&&0!==t.avail_in)return At(t,at);if(0!==t.avail_in||0!==r.lookahead||e!==Z&&r.status!==bt){let i=r.strategy===lt?((t,e)=>{let i;for(;;){if(0===t.lookahead&&(Rt(t),0===t.lookahead)){if(e===Z)return 1;break}if(t.match_length=0,i=Q(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,i&&(xt(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===$?(xt(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(xt(t,!1),0===t.strm.avail_out)?1:2})(r,e):r.strategy===ct?((t,e)=>{let i,n,r,a;const o=t.window;for(;;){if(t.lookahead<=ft){if(Rt(t),t.lookahead<=ft&&e===Z)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&t.strstart>0&&(r=t.strstart-1,n=o[r],n===o[++r]&&n===o[++r]&&n===o[++r])){a=t.strstart+ft;do{}while(n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&r<a);t.match_length=ft-(a-r),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(i=Q(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(i=Q(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),i&&(xt(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===$?(xt(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(xt(t,!1),0===t.strm.avail_out)?1:2})(r,e):Pt[r.level].func(r,e);if(3!==i&&4!==i||(r.status=bt),1===i||3===i)return 0===t.avail_out&&(r.last_flush=-1),et;if(2===i&&(e===K?q(r):e!==tt&&(X(r,0,0,!1),e===J&&(wt(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),_t(t),0===t.avail_out))return r.last_flush=-1,et}return e!==$?et:r.wrap<=0?it:(2===r.wrap?(Tt(r,255&t.adler),Tt(r,t.adler>>8&255),Tt(r,t.adler>>16&255),Tt(r,t.adler>>24&255),Tt(r,255&t.total_in),Tt(r,t.total_in>>8&255),Tt(r,t.total_in>>16&255),Tt(r,t.total_in>>24&255)):(Mt(r,t.adler>>>16),Mt(r,65535&t.adler)),_t(t),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?et:it)},deflateEnd:t=>{if(!t||!t.state)return nt;const e=t.state.status;return 42!==e&&69!==e&&73!==e&&91!==e&&e!==gt&&e!==yt&&e!==bt?At(t,nt):(t.state=null,e===yt?At(t,rt):et)},deflateSetDictionary:(t,e)=>{let i=e.length;if(!t||!t.state)return nt;const n=t.state,r=n.wrap;if(2===r||1===r&&42!==n.status||n.lookahead)return nt;if(1===r&&(t.adler=N(t.adler,e,i,0)),n.wrap=0,i>=n.w_size){0===r&&(wt(n.head),n.strstart=0,n.block_start=0,n.insert=0);let t=new Uint8Array(n.w_size);t.set(e.subarray(i-n.w_size,i),0),e=t,i=n.w_size}const a=t.avail_in,o=t.next_in,s=t.input;for(t.avail_in=i,t.next_in=0,t.input=e,Rt(n);n.lookahead>=3;){let t=n.strstart,e=n.lookahead-2;do{n.ins_h=Et(n,n.ins_h,n.window[t+3-1]),n.prev[t&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=t,t++}while(--e);n.strstart=t,n.lookahead=2,Rt(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,t.next_in=o,t.input=s,t.avail_in=a,n.wrap=r,et},deflateInfo:"pako deflate (from Nodeca project)"};const Lt=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var Nt=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const i=e.shift();if(i){if("object"!=typeof i)throw new TypeError(i+"must be non-object");for(const e in i)Lt(i,e)&&(t[e]=i[e])}}return t},Ht=t=>{let e=0;for(let i=0,n=t.length;i<n;i++)e+=t[i].length;const i=new Uint8Array(e);for(let e=0,n=0,r=t.length;e<r;e++){let r=t[e];i.set(r,n),n+=r.length}return i};let zt=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){zt=!1}const Vt=new Uint8Array(256);for(let t=0;t<256;t++)Vt[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;Vt[254]=Vt[254]=1;var Gt=t=>{let e,i,n,r,a,o=t.length,s=0;for(r=0;r<o;r++)i=t.charCodeAt(r),55296==(64512&i)&&r+1<o&&(n=t.charCodeAt(r+1),56320==(64512&n)&&(i=65536+(i-55296<<10)+(n-56320),r++)),s+=i<128?1:i<2048?2:i<65536?3:4;for(e=new Uint8Array(s),a=0,r=0;a<s;r++)i=t.charCodeAt(r),55296==(64512&i)&&r+1<o&&(n=t.charCodeAt(r+1),56320==(64512&n)&&(i=65536+(i-55296<<10)+(n-56320),r++)),i<128?e[a++]=i:i<2048?(e[a++]=192|i>>>6,e[a++]=128|63&i):i<65536?(e[a++]=224|i>>>12,e[a++]=128|i>>>6&63,e[a++]=128|63&i):(e[a++]=240|i>>>18,e[a++]=128|i>>>12&63,e[a++]=128|i>>>6&63,e[a++]=128|63&i);return e},Wt=(t,e)=>{let i,n;const r=e||t.length,a=new Array(2*r);for(n=0,i=0;i<r;){let e=t[i++];if(e<128){a[n++]=e;continue}let o=Vt[e];if(o>4)a[n++]=65533,i+=o-1;else{for(e&=2===o?31:3===o?15:7;o>1&&i<r;)e=e<<6|63&t[i++],o--;o>1?a[n++]=65533:e<65536?a[n++]=e:(e-=65536,a[n++]=55296|e>>10&1023,a[n++]=56320|1023&e)}}return((t,e)=>{if(e<65534&&t.subarray&&zt)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let i="";for(let n=0;n<e;n++)i+=String.fromCharCode(t[n]);return i})(a,n)},Xt=(t,e)=>{(e=e||t.length)>t.length&&(e=t.length);let i=e-1;for(;i>=0&&128==(192&t[i]);)i--;return i<0||0===i?e:i+Vt[t[i]]>e?i:e};var Yt=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const Qt=Object.prototype.toString,{Z_NO_FLUSH:qt,Z_SYNC_FLUSH:Zt,Z_FULL_FLUSH:Kt,Z_FINISH:Jt,Z_OK:$t,Z_STREAM_END:te,Z_DEFAULT_COMPRESSION:ee,Z_DEFAULT_STRATEGY:ie,Z_DEFLATED:ne}=G;function re(t){this.options=Nt({level:ee,method:ne,chunkSize:16384,windowBits:15,memLevel:8,strategy:ie},t||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Yt,this.strm.avail_out=0;let i=jt.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(i!==$t)throw new Error(V[i]);if(e.header&&jt.deflateSetHeader(this.strm,e.header),e.dictionary){let t;if(t="string"==typeof e.dictionary?Gt(e.dictionary):"[object ArrayBuffer]"===Qt.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,i=jt.deflateSetDictionary(this.strm,t),i!==$t)throw new Error(V[i]);this._dict_set=!0}}function ae(t,e){const i=new re(e);if(i.push(t,!0),i.err)throw i.msg||V[i.err];return i.result}re.prototype.push=function(t,e){const i=this.strm,n=this.options.chunkSize;let r,a;if(this.ended)return!1;for(a=e===~~e?e:!0===e?Jt:qt,"string"==typeof t?i.input=Gt(t):"[object ArrayBuffer]"===Qt.call(t)?i.input=new Uint8Array(t):i.input=t,i.next_in=0,i.avail_in=i.input.length;;)if(0===i.avail_out&&(i.output=new Uint8Array(n),i.next_out=0,i.avail_out=n),(a===Zt||a===Kt)&&i.avail_out<=6)this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;else{if(r=jt.deflate(i,a),r===te)return i.next_out>0&&this.onData(i.output.subarray(0,i.next_out)),r=jt.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===$t;if(0!==i.avail_out){if(a>0&&i.next_out>0)this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;else if(0===i.avail_in)break}else this.onData(i.output)}return!0},re.prototype.onData=function(t){this.chunks.push(t)},re.prototype.onEnd=function(t){t===$t&&(this.result=Ht(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var oe={Deflate:re,deflate:ae,deflateRaw:function(t,e){return(e=e||{}).raw=!0,ae(t,e)},gzip:function(t,e){return(e=e||{}).gzip=!0,ae(t,e)},constants:G};var se=function(t,e){let i,n,r,a,o,s,l,c,u,h,d,p,f,m,g,y,b,A,v,w,E,_,x,T;const M=t.state;i=t.next_in,x=t.input,n=i+(t.avail_in-5),r=t.next_out,T=t.output,a=r-(e-t.avail_out),o=r+(t.avail_out-257),s=M.dmax,l=M.wsize,c=M.whave,u=M.wnext,h=M.window,d=M.hold,p=M.bits,f=M.lencode,m=M.distcode,g=(1<<M.lenbits)-1,y=(1<<M.distbits)-1;t:do{p<15&&(d+=x[i++]<<p,p+=8,d+=x[i++]<<p,p+=8),b=f[d&g];e:for(;;){if(A=b>>>24,d>>>=A,p-=A,A=b>>>16&255,0===A)T[r++]=65535&b;else{if(!(16&A)){if(0==(64&A)){b=f[(65535&b)+(d&(1<<A)-1)];continue e}if(32&A){M.mode=12;break t}t.msg="invalid literal/length code",M.mode=30;break t}v=65535&b,A&=15,A&&(p<A&&(d+=x[i++]<<p,p+=8),v+=d&(1<<A)-1,d>>>=A,p-=A),p<15&&(d+=x[i++]<<p,p+=8,d+=x[i++]<<p,p+=8),b=m[d&y];i:for(;;){if(A=b>>>24,d>>>=A,p-=A,A=b>>>16&255,!(16&A)){if(0==(64&A)){b=m[(65535&b)+(d&(1<<A)-1)];continue i}t.msg="invalid distance code",M.mode=30;break t}if(w=65535&b,A&=15,p<A&&(d+=x[i++]<<p,p+=8,p<A&&(d+=x[i++]<<p,p+=8)),w+=d&(1<<A)-1,w>s){t.msg="invalid distance too far back",M.mode=30;break t}if(d>>>=A,p-=A,A=r-a,w>A){if(A=w-A,A>c&&M.sane){t.msg="invalid distance too far back",M.mode=30;break t}if(E=0,_=h,0===u){if(E+=l-A,A<v){v-=A;do{T[r++]=h[E++]}while(--A);E=r-w,_=T}}else if(u<A){if(E+=l+u-A,A-=u,A<v){v-=A;do{T[r++]=h[E++]}while(--A);if(E=0,u<v){A=u,v-=A;do{T[r++]=h[E++]}while(--A);E=r-w,_=T}}}else if(E+=u-A,A<v){v-=A;do{T[r++]=h[E++]}while(--A);E=r-w,_=T}for(;v>2;)T[r++]=_[E++],T[r++]=_[E++],T[r++]=_[E++],v-=3;v&&(T[r++]=_[E++],v>1&&(T[r++]=_[E++]))}else{E=r-w;do{T[r++]=T[E++],T[r++]=T[E++],T[r++]=T[E++],v-=3}while(v>2);v&&(T[r++]=T[E++],v>1&&(T[r++]=T[E++]))}break}}break}}while(i<n&&r<o);v=p>>3,i-=v,p-=v<<3,d&=(1<<p)-1,t.next_in=i,t.next_out=r,t.avail_in=i<n?n-i+5:5-(i-n),t.avail_out=r<o?o-r+257:257-(r-o),M.hold=d,M.bits=p};const le=15,ce=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),ue=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),he=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),de=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var pe=(t,e,i,n,r,a,o,s)=>{const l=s.bits;let c,u,h,d,p,f,m=0,g=0,y=0,b=0,A=0,v=0,w=0,E=0,_=0,x=0,T=null,M=0;const C=new Uint16Array(16),k=new Uint16Array(16);let R,S,D,O=null,P=0;for(m=0;m<=le;m++)C[m]=0;for(g=0;g<n;g++)C[e[i+g]]++;for(A=l,b=le;b>=1&&0===C[b];b--);if(A>b&&(A=b),0===b)return r[a++]=20971520,r[a++]=20971520,s.bits=1,0;for(y=1;y<b&&0===C[y];y++);for(A<y&&(A=y),E=1,m=1;m<=le;m++)if(E<<=1,E-=C[m],E<0)return-1;if(E>0&&(0===t||1!==b))return-1;for(k[1]=0,m=1;m<le;m++)k[m+1]=k[m]+C[m];for(g=0;g<n;g++)0!==e[i+g]&&(o[k[e[i+g]]++]=g);if(0===t?(T=O=o,f=19):1===t?(T=ce,M-=257,O=ue,P-=257,f=256):(T=he,O=de,f=-1),x=0,g=0,m=y,p=a,v=A,w=0,h=-1,_=1<<A,d=_-1,1===t&&_>852||2===t&&_>592)return 1;for(;;){R=m-w,o[g]<f?(S=0,D=o[g]):o[g]>f?(S=O[P+o[g]],D=T[M+o[g]]):(S=96,D=0),c=1<<m-w,u=1<<v,y=u;do{u-=c,r[p+(x>>w)+u]=R<<24|S<<16|D|0}while(0!==u);for(c=1<<m-1;x&c;)c>>=1;if(0!==c?(x&=c-1,x+=c):x=0,g++,0==--C[m]){if(m===b)break;m=e[i+o[g]]}if(m>A&&(x&d)!==h){for(0===w&&(w=A),p+=y,v=m-w,E=1<<v;v+w<b&&(E-=C[v+w],!(E<=0));)v++,E<<=1;if(_+=1<<v,1===t&&_>852||2===t&&_>592)return 1;h=x&d,r[h]=A<<24|v<<16|p-a|0}}return 0!==x&&(r[p+x]=m-w<<24|64<<16|0),s.bits=A,0};const{Z_FINISH:fe,Z_BLOCK:me,Z_TREES:ge,Z_OK:ye,Z_STREAM_END:be,Z_NEED_DICT:Ae,Z_STREAM_ERROR:ve,Z_DATA_ERROR:we,Z_MEM_ERROR:Ee,Z_BUF_ERROR:_e,Z_DEFLATED:xe}=G,Te=12,Me=30,Ce=t=>(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24);function ke(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Re=t=>{if(!t||!t.state)return ve;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=1,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(852),e.distcode=e.distdyn=new Int32Array(592),e.sane=1,e.back=-1,ye},Se=t=>{if(!t||!t.state)return ve;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,Re(t)},De=(t,e)=>{let i;if(!t||!t.state)return ve;const n=t.state;return e<0?(i=0,e=-e):(i=1+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?ve:(null!==n.window&&n.wbits!==e&&(n.window=null),n.wrap=i,n.wbits=e,Se(t))},Oe=(t,e)=>{if(!t)return ve;const i=new ke;t.state=i,i.window=null;const n=De(t,e);return n!==ye&&(t.state=null),n};let Pe,Fe,Ue=!0;const Be=t=>{if(Ue){Pe=new Int32Array(512),Fe=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(pe(1,t.lens,0,288,Pe,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;pe(2,t.lens,0,32,Fe,0,t.work,{bits:5}),Ue=!1}t.lencode=Pe,t.lenbits=9,t.distcode=Fe,t.distbits=5},Ie=(t,e,i,n)=>{let r;const a=t.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),n>=a.wsize?(a.window.set(e.subarray(i-a.wsize,i),0),a.wnext=0,a.whave=a.wsize):(r=a.wsize-a.wnext,r>n&&(r=n),a.window.set(e.subarray(i-n,i-n+r),a.wnext),(n-=r)?(a.window.set(e.subarray(i-n,i),0),a.wnext=n,a.whave=a.wsize):(a.wnext+=r,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=r))),0};var je={inflateReset:Se,inflateReset2:De,inflateResetKeep:Re,inflateInit:t=>Oe(t,15),inflateInit2:Oe,inflate:(t,e)=>{let i,n,r,a,o,s,l,c,u,h,d,p,f,m,g,y,b,A,v,w,E,_,x=0;const T=new Uint8Array(4);let M,C;const k=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return ve;i=t.state,i.mode===Te&&(i.mode=13),o=t.next_out,r=t.output,l=t.avail_out,a=t.next_in,n=t.input,s=t.avail_in,c=i.hold,u=i.bits,h=s,d=l,_=ye;t:for(;;)switch(i.mode){case 1:if(0===i.wrap){i.mode=13;break}for(;u<16;){if(0===s)break t;s--,c+=n[a++]<<u,u+=8}if(2&i.wrap&&35615===c){i.check=0,T[0]=255&c,T[1]=c>>>8&255,i.check=z(i.check,T,2,0),c=0,u=0,i.mode=2;break}if(i.flags=0,i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&c)<<8)+(c>>8))%31){t.msg="incorrect header check",i.mode=Me;break}if((15&c)!==xe){t.msg="unknown compression method",i.mode=Me;break}if(c>>>=4,u-=4,E=8+(15&c),0===i.wbits)i.wbits=E;else if(E>i.wbits){t.msg="invalid window size",i.mode=Me;break}i.dmax=1<<i.wbits,t.adler=i.check=1,i.mode=512&c?10:Te,c=0,u=0;break;case 2:for(;u<16;){if(0===s)break t;s--,c+=n[a++]<<u,u+=8}if(i.flags=c,(255&i.flags)!==xe){t.msg="unknown compression method",i.mode=Me;break}if(57344&i.flags){t.msg="unknown header flags set",i.mode=Me;break}i.head&&(i.head.text=c>>8&1),512&i.flags&&(T[0]=255&c,T[1]=c>>>8&255,i.check=z(i.check,T,2,0)),c=0,u=0,i.mode=3;case 3:for(;u<32;){if(0===s)break t;s--,c+=n[a++]<<u,u+=8}i.head&&(i.head.time=c),512&i.flags&&(T[0]=255&c,T[1]=c>>>8&255,T[2]=c>>>16&255,T[3]=c>>>24&255,i.check=z(i.check,T,4,0)),c=0,u=0,i.mode=4;case 4:for(;u<16;){if(0===s)break t;s--,c+=n[a++]<<u,u+=8}i.head&&(i.head.xflags=255&c,i.head.os=c>>8),512&i.flags&&(T[0]=255&c,T[1]=c>>>8&255,i.check=z(i.check,T,2,0)),c=0,u=0,i.mode=5;case 5:if(1024&i.flags){for(;u<16;){if(0===s)break t;s--,c+=n[a++]<<u,u+=8}i.length=c,i.head&&(i.head.extra_len=c),512&i.flags&&(T[0]=255&c,T[1]=c>>>8&255,i.check=z(i.check,T,2,0)),c=0,u=0}else i.head&&(i.head.extra=null);i.mode=6;case 6:if(1024&i.flags&&(p=i.length,p>s&&(p=s),p&&(i.head&&(E=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Uint8Array(i.head.extra_len)),i.head.extra.set(n.subarray(a,a+p),E)),512&i.flags&&(i.check=z(i.check,n,p,a)),s-=p,a+=p,i.length-=p),i.length))break t;i.length=0,i.mode=7;case 7:if(2048&i.flags){if(0===s)break t;p=0;do{E=n[a+p++],i.head&&E&&i.length<65536&&(i.head.name+=String.fromCharCode(E))}while(E&&p<s);if(512&i.flags&&(i.check=z(i.check,n,p,a)),s-=p,a+=p,E)break t}else i.head&&(i.head.name=null);i.length=0,i.mode=8;case 8:if(4096&i.flags){if(0===s)break t;p=0;do{E=n[a+p++],i.head&&E&&i.length<65536&&(i.head.comment+=String.fromCharCode(E))}while(E&&p<s);if(512&i.flags&&(i.check=z(i.check,n,p,a)),s-=p,a+=p,E)break t}else i.head&&(i.head.comment=null);i.mode=9;case 9:if(512&i.flags){for(;u<16;){if(0===s)break t;s--,c+=n[a++]<<u,u+=8}if(c!==(65535&i.check)){t.msg="header crc mismatch",i.mode=Me;break}c=0,u=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),t.adler=i.check=0,i.mode=Te;break;case 10:for(;u<32;){if(0===s)break t;s--,c+=n[a++]<<u,u+=8}t.adler=i.check=Ce(c),c=0,u=0,i.mode=11;case 11:if(0===i.havedict)return t.next_out=o,t.avail_out=l,t.next_in=a,t.avail_in=s,i.hold=c,i.bits=u,Ae;t.adler=i.check=1,i.mode=Te;case Te:if(e===me||e===ge)break t;case 13:if(i.last){c>>>=7&u,u-=7&u,i.mode=27;break}for(;u<3;){if(0===s)break t;s--,c+=n[a++]<<u,u+=8}switch(i.last=1&c,c>>>=1,u-=1,3&c){case 0:i.mode=14;break;case 1:if(Be(i),i.mode=20,e===ge){c>>>=2,u-=2;break t}break;case 2:i.mode=17;break;case 3:t.msg="invalid block type",i.mode=Me}c>>>=2,u-=2;break;case 14:for(c>>>=7&u,u-=7&u;u<32;){if(0===s)break t;s--,c+=n[a++]<<u,u+=8}if((65535&c)!=(c>>>16^65535)){t.msg="invalid stored block lengths",i.mode=Me;break}if(i.length=65535&c,c=0,u=0,i.mode=15,e===ge)break t;case 15:i.mode=16;case 16:if(p=i.length,p){if(p>s&&(p=s),p>l&&(p=l),0===p)break t;r.set(n.subarray(a,a+p),o),s-=p,a+=p,l-=p,o+=p,i.length-=p;break}i.mode=Te;break;case 17:for(;u<14;){if(0===s)break t;s--,c+=n[a++]<<u,u+=8}if(i.nlen=257+(31&c),c>>>=5,u-=5,i.ndist=1+(31&c),c>>>=5,u-=5,i.ncode=4+(15&c),c>>>=4,u-=4,i.nlen>286||i.ndist>30){t.msg="too many length or distance symbols",i.mode=Me;break}i.have=0,i.mode=18;case 18:for(;i.have<i.ncode;){for(;u<3;){if(0===s)break t;s--,c+=n[a++]<<u,u+=8}i.lens[k[i.have++]]=7&c,c>>>=3,u-=3}for(;i.have<19;)i.lens[k[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,M={bits:i.lenbits},_=pe(0,i.lens,0,19,i.lencode,0,i.work,M),i.lenbits=M.bits,_){t.msg="invalid code lengths set",i.mode=Me;break}i.have=0,i.mode=19;case 19:for(;i.have<i.nlen+i.ndist;){for(;x=i.lencode[c&(1<<i.lenbits)-1],g=x>>>24,y=x>>>16&255,b=65535&x,!(g<=u);){if(0===s)break t;s--,c+=n[a++]<<u,u+=8}if(b<16)c>>>=g,u-=g,i.lens[i.have++]=b;else{if(16===b){for(C=g+2;u<C;){if(0===s)break t;s--,c+=n[a++]<<u,u+=8}if(c>>>=g,u-=g,0===i.have){t.msg="invalid bit length repeat",i.mode=Me;break}E=i.lens[i.have-1],p=3+(3&c),c>>>=2,u-=2}else if(17===b){for(C=g+3;u<C;){if(0===s)break t;s--,c+=n[a++]<<u,u+=8}c>>>=g,u-=g,E=0,p=3+(7&c),c>>>=3,u-=3}else{for(C=g+7;u<C;){if(0===s)break t;s--,c+=n[a++]<<u,u+=8}c>>>=g,u-=g,E=0,p=11+(127&c),c>>>=7,u-=7}if(i.have+p>i.nlen+i.ndist){t.msg="invalid bit length repeat",i.mode=Me;break}for(;p--;)i.lens[i.have++]=E}}if(i.mode===Me)break;if(0===i.lens[256]){t.msg="invalid code -- missing end-of-block",i.mode=Me;break}if(i.lenbits=9,M={bits:i.lenbits},_=pe(1,i.lens,0,i.nlen,i.lencode,0,i.work,M),i.lenbits=M.bits,_){t.msg="invalid literal/lengths set",i.mode=Me;break}if(i.distbits=6,i.distcode=i.distdyn,M={bits:i.distbits},_=pe(2,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,M),i.distbits=M.bits,_){t.msg="invalid distances set",i.mode=Me;break}if(i.mode=20,e===ge)break t;case 20:i.mode=21;case 21:if(s>=6&&l>=258){t.next_out=o,t.avail_out=l,t.next_in=a,t.avail_in=s,i.hold=c,i.bits=u,se(t,d),o=t.next_out,r=t.output,l=t.avail_out,a=t.next_in,n=t.input,s=t.avail_in,c=i.hold,u=i.bits,i.mode===Te&&(i.back=-1);break}for(i.back=0;x=i.lencode[c&(1<<i.lenbits)-1],g=x>>>24,y=x>>>16&255,b=65535&x,!(g<=u);){if(0===s)break t;s--,c+=n[a++]<<u,u+=8}if(y&&0==(240&y)){for(A=g,v=y,w=b;x=i.lencode[w+((c&(1<<A+v)-1)>>A)],g=x>>>24,y=x>>>16&255,b=65535&x,!(A+g<=u);){if(0===s)break t;s--,c+=n[a++]<<u,u+=8}c>>>=A,u-=A,i.back+=A}if(c>>>=g,u-=g,i.back+=g,i.length=b,0===y){i.mode=26;break}if(32&y){i.back=-1,i.mode=Te;break}if(64&y){t.msg="invalid literal/length code",i.mode=Me;break}i.extra=15&y,i.mode=22;case 22:if(i.extra){for(C=i.extra;u<C;){if(0===s)break t;s--,c+=n[a++]<<u,u+=8}i.length+=c&(1<<i.extra)-1,c>>>=i.extra,u-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=23;case 23:for(;x=i.distcode[c&(1<<i.distbits)-1],g=x>>>24,y=x>>>16&255,b=65535&x,!(g<=u);){if(0===s)break t;s--,c+=n[a++]<<u,u+=8}if(0==(240&y)){for(A=g,v=y,w=b;x=i.distcode[w+((c&(1<<A+v)-1)>>A)],g=x>>>24,y=x>>>16&255,b=65535&x,!(A+g<=u);){if(0===s)break t;s--,c+=n[a++]<<u,u+=8}c>>>=A,u-=A,i.back+=A}if(c>>>=g,u-=g,i.back+=g,64&y){t.msg="invalid distance code",i.mode=Me;break}i.offset=b,i.extra=15&y,i.mode=24;case 24:if(i.extra){for(C=i.extra;u<C;){if(0===s)break t;s--,c+=n[a++]<<u,u+=8}i.offset+=c&(1<<i.extra)-1,c>>>=i.extra,u-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){t.msg="invalid distance too far back",i.mode=Me;break}i.mode=25;case 25:if(0===l)break t;if(p=d-l,i.offset>p){if(p=i.offset-p,p>i.whave&&i.sane){t.msg="invalid distance too far back",i.mode=Me;break}p>i.wnext?(p-=i.wnext,f=i.wsize-p):f=i.wnext-p,p>i.length&&(p=i.length),m=i.window}else m=r,f=o-i.offset,p=i.length;p>l&&(p=l),l-=p,i.length-=p;do{r[o++]=m[f++]}while(--p);0===i.length&&(i.mode=21);break;case 26:if(0===l)break t;r[o++]=i.length,l--,i.mode=21;break;case 27:if(i.wrap){for(;u<32;){if(0===s)break t;s--,c|=n[a++]<<u,u+=8}if(d-=l,t.total_out+=d,i.total+=d,d&&(t.adler=i.check=i.flags?z(i.check,r,d,o-d):N(i.check,r,d,o-d)),d=l,(i.flags?c:Ce(c))!==i.check){t.msg="incorrect data check",i.mode=Me;break}c=0,u=0}i.mode=28;case 28:if(i.wrap&&i.flags){for(;u<32;){if(0===s)break t;s--,c+=n[a++]<<u,u+=8}if(c!==(4294967295&i.total)){t.msg="incorrect length check",i.mode=Me;break}c=0,u=0}i.mode=29;case 29:_=be;break t;case Me:_=we;break t;case 31:return Ee;case 32:default:return ve}return t.next_out=o,t.avail_out=l,t.next_in=a,t.avail_in=s,i.hold=c,i.bits=u,(i.wsize||d!==t.avail_out&&i.mode<Me&&(i.mode<27||e!==fe))&&Ie(t,t.output,t.next_out,d-t.avail_out),h-=t.avail_in,d-=t.avail_out,t.total_in+=h,t.total_out+=d,i.total+=d,i.wrap&&d&&(t.adler=i.check=i.flags?z(i.check,r,d,t.next_out-d):N(i.check,r,d,t.next_out-d)),t.data_type=i.bits+(i.last?64:0)+(i.mode===Te?128:0)+(20===i.mode||15===i.mode?256:0),(0===h&&0===d||e===fe)&&_===ye&&(_=_e),_},inflateEnd:t=>{if(!t||!t.state)return ve;let e=t.state;return e.window&&(e.window=null),t.state=null,ye},inflateGetHeader:(t,e)=>{if(!t||!t.state)return ve;const i=t.state;return 0==(2&i.wrap)?ve:(i.head=e,e.done=!1,ye)},inflateSetDictionary:(t,e)=>{const i=e.length;let n,r,a;return t&&t.state?(n=t.state,0!==n.wrap&&11!==n.mode?ve:11===n.mode&&(r=1,r=N(r,e,i,0),r!==n.check)?we:(a=Ie(t,e,i,i),a?(n.mode=31,Ee):(n.havedict=1,ye))):ve},inflateInfo:"pako inflate (from Nodeca project)"};var Le=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const Ne=Object.prototype.toString,{Z_NO_FLUSH:He,Z_FINISH:ze,Z_OK:Ve,Z_STREAM_END:Ge,Z_NEED_DICT:We,Z_STREAM_ERROR:Xe,Z_DATA_ERROR:Ye,Z_MEM_ERROR:Qe}=G;function qe(t){this.options=Nt({chunkSize:65536,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Yt,this.strm.avail_out=0;let i=je.inflateInit2(this.strm,e.windowBits);if(i!==Ve)throw new Error(V[i]);if(this.header=new Le,je.inflateGetHeader(this.strm,this.header),e.dictionary&&("string"==typeof e.dictionary?e.dictionary=Gt(e.dictionary):"[object ArrayBuffer]"===Ne.call(e.dictionary)&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(i=je.inflateSetDictionary(this.strm,e.dictionary),i!==Ve)))throw new Error(V[i])}function Ze(t,e){const i=new qe(e);if(i.push(t),i.err)throw i.msg||V[i.err];return i.result}qe.prototype.push=function(t,e){const i=this.strm,n=this.options.chunkSize,r=this.options.dictionary;let a,o,s;if(this.ended)return!1;for(o=e===~~e?e:!0===e?ze:He,"[object ArrayBuffer]"===Ne.call(t)?i.input=new Uint8Array(t):i.input=t,i.next_in=0,i.avail_in=i.input.length;;){for(0===i.avail_out&&(i.output=new Uint8Array(n),i.next_out=0,i.avail_out=n),a=je.inflate(i,o),a===We&&r&&(a=je.inflateSetDictionary(i,r),a===Ve?a=je.inflate(i,o):a===Ye&&(a=We));i.avail_in>0&&a===Ge&&i.state.wrap>0&&0!==t[i.next_in];)je.inflateReset(i),a=je.inflate(i,o);switch(a){case Xe:case Ye:case We:case Qe:return this.onEnd(a),this.ended=!0,!1}if(s=i.avail_out,i.next_out&&(0===i.avail_out||a===Ge))if("string"===this.options.to){let t=Xt(i.output,i.next_out),e=i.next_out-t,r=Wt(i.output,t);i.next_out=e,i.avail_out=n-e,e&&i.output.set(i.output.subarray(t,t+e),0),this.onData(r)}else this.onData(i.output.length===i.next_out?i.output:i.output.subarray(0,i.next_out));if(a!==Ve||0!==s){if(a===Ge)return a=je.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,!0;if(0===i.avail_in)break}}return!0},qe.prototype.onData=function(t){this.chunks.push(t)},qe.prototype.onEnd=function(t){t===Ve&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=Ht(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var Ke={Inflate:qe,inflate:Ze,inflateRaw:function(t,e){return(e=e||{}).raw=!0,Ze(t,e)},ungzip:Ze,constants:G};const{Deflate:Je,deflate:$e,deflateRaw:ti,gzip:ei}=oe,{Inflate:ii,inflate:ni,inflateRaw:ri,ungzip:ai}=Ke;var oi={Deflate:Je,deflate:$e,deflateRaw:ti,gzip:ei,Inflate:ii,inflate:ni,inflateRaw:ri,ungzip:ai,constants:G};e.a=oi},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAQAAAD9CzEMAAADV0lEQVR42u2Y3WrbQBCFz0qO3dKWXjTQ93+40lAoDkn8o9X+dDizu4MjSxaB0JvMoJEqVefbOeuVRFzG+0aHD8CN2MDCo4fD9XCYD7cW0KN7X4vy+1j0tsiSAQM6RPQA4hpAQo81MSDiLFvGo9SEe3gA+zWAWxEwYpAt4ig144Ej/8punnl9ERCwu2UoMyDixL2X7HBPowYEJOyXABG3IiHgxPpC+Uec4aSDhIxPUsflDobbBkmeOdIXHj/DI4j0KHXHbu44KzOAI5Yi0n3AI3KSfbEoiahDj63UhJ1eXw+wH+XIcUZOs8dZaoJnveN66pHgqBfmAI9zY5cM8ER4uj8wR3j20WNkD5F6mbh0DbCfGf1IRCIicNRBjwlO6OColBClah8j8hTw5zqACSIyRyxJsVREOslUnmQ9ERvt+zXg4Zo8R5spPdL5gUdMoiL6gnHVKCIxBfzGJDiltEfyCG8A9hKZmelaNxkC45ZvdECx+nA4SI7EBHj9mfLfNItJTMs8BfyCBS9TWB0fVFAnWI+tA3vtGIC5PMkUpkST99w8xSs81rFXzDzgCSU44g0OxfEXip4kpYNmlC/rIalRZlUBYgoYUcMhwPGWXFZv0L2Zo2coSrGJRXo2d7AIF7BM+SpOU9QWS8orIurMWWXMdUBDDjjiSfIsx56mnYk5EXXCwNfOoFe4TjxxgUDJpTfaScd2YQWrnWGm1kGCjdzNfVVE1LjjQsnavMmrNDfL1BJIyxalBjrhL56xlzzA0xR7XA9a1bZmUeIvLPP/JFvf17+LEjx2vCUj1RtYbZ8uV7Dlmg+vDT5jlLotuGByFLe9ZdbNIKxOLbJwDfsT3/EDW8mdPieJQukJCMQG2hJwYPVIPJ+tNwKuxAZDs0R6IQJtlBHu9diZaWrVHCC0D8NOxRsAFC2rvAIupGGVpmTMxDd8EfwdLdqgLwioTANwxdMuHtscVcAGc+HxCR1v27ADBVgfsb1GeXxhlMUiYESPoNKy9bzRALWqpBmF1iWWLWLwJb5l7SRrH85kq3SzJa6ZZIsIh1AkswKsD8qhYi6mGWsAhgD6CiBKogBytevaDJhFt6NvFlkPrCVRxd8KQAF0bU0YhMLm/FsBKPKGcNOFNQ338beK/w74B3hHEiv6UDgCAAAAAElFTkSuQmCC"},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAAWpJREFUaN7tmD1Ow0AQhb+hx5BQU6cMd6CgRhBuhbgHIFFTUNNSJi2hRSjmAI8CIwHa3WQdmzXSfJKrGT+9/Rk/yeA4jjNYJB1KupVU6++pJd1JmqQ8Wso88ASMC+/jGzA1s2WouJN48WoA5gFGwGWsmDqBGtgt7b6hNrO9UCF1AiHzS+AcqJrnFFhsYWxTvSpbOTBUz5LGgb5RU8slS6+LBZwlemctFpClF+tNzcDvlyoze4/0VsAqc4+y9Mws6DU1AznY9hLt9HIWcJyonbQw2bXeTwJ3di5pFOg7kLRsMQNZel0s4OvLMZNUNc9FS/PZejGfOUNclL6HuBi5CyiVxPlE7qsncVu9WK8n8bqN6FvPk1iexJ7E/xtPYnkSb6YX6/UkXrcRfet5EsuTuL8kHtLP3ZWZ7YcKqRl4KO36G/exQuoEJsAjn//nS/IKHJnZS6gYPQEzWwBT4AaoCxivgeuUecdxnPJ8ALQ5HKjUA36bAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIwLTAxLTExVDIyOjA1OjQyKzAwOjAwhn4ZCQAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMC0wMS0xMVQyMjowNTo0MiswMDowMPcjobUAAAAodEVYdHN2ZzpiYXNlLXVyaQBmaWxlOi8vL3RtcC9tYWdpY2stbGhQSW5sYm9f10WuAAAAAElFTkSuQmCC"},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAAZ1JREFUaN7t1k9KHEEYhvFGQsw2CBExruMFXEsgEE/jMRTiCeLK7NSNIig5RHYiOYGKfwiJmwTi8HORWbTaXdPdVjs1oR7oxdBd37xPf9VVVRQdwQr28aprjbGBj/jtH18nSgLv8cd9DjE97mxNBV7jm8dMTieyRCr8LxLzpRVpsj5svMSBetLtRIPw6UpgGkcVYU+G10OOkplOgTf/HXN4g+MkOzEqfOm59CSahk9Som34pCS6hk9C4qnhxyohvFTOdqg36zmXWGzECt9A4lMfApdPmTaBulXT6aJrvReBe4MHvxeLojhD9JdVFMVt14FTgXtbfSSt4Uv0ioGPODb9nZOeQaIyPFaxGkui6bG5LZV7AJbxF7f4kGon6t78DM5Lz51jJrVO1O6+2Kx4/nMUgUidqP1gsYRBxZgBllKQCK422A6M3Y4mMPyzttNp5KENV4Hxl1EFWnai0TqPm0CNn9EFGko03qSwF6iz04vACIlWOyze4UdFnWu87U2gJLGOM5xirU34Up0F7OLX8NrpPXwmk8lkMplMJtOZOw9MeJncylt3AAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIwLTAxLTE5VDIzOjI4OjM1KzAwOjAwSgtaJQAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMC0wMS0xOVQyMzoyODozNSswMDowMDtW4pkAAAAodEVYdHN2ZzpiYXNlLXVyaQBmaWxlOi8vL3RtcC9tYWdpY2stYndSVGZsc1QpFatYAAAAAElFTkSuQmCC"},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAQAAAD9CzEMAAABaklEQVR42t2W3W3FMAiFO4s3yR5ehJHYxoOww1fVqoV0r0NaU16KlSgKEn/nAP74b0KjV5q/GFihCwQAQ+pcKFPqXRi93oVUAW1QlgX92/x6S030gxbAnTavtAK46R59AdxenBJG0b04IWnz0Ibd3Y/jX2Duj+eXy+BZenaKxqLJQR1mYejKFqWlsoijx4Cx34XzOcjC0Lcg5IUkysAAY6D037nQdzI4oWkM3iQoI3IPLRcuV2DeQ3jMQm43xTXNR8QYIdx7YjJwzTO5Jept3asR12DEYukrGoIwanq/rTO/FfvD7qczMAzme9CdAAkHIe8HbavRc/NKn0dxF1fSAW2392isndfoKZCRu6jQxXvGCU3jSeotaC/NJyeLVcLsOhc4KidX4naHz0Ln0Pyq7r1+DTinQZGDYOGkSnTtGFYAcmwjT9OcIHsAaWiQ3cEkGrT4b94FKDKPHvD+ZFznzccXrQr5ivkncX8CcDemvbdn/GsAAAAASUVORK5CYII="},function(t,e,i){t.exports=i.p+"asset/6b9a3bf11b3ee18980b555eaea5891cc.woff"},function(t,e,i){t.exports=i.p+"asset/e35723cf8743f80d9f71bc5897686933.png"},function(t,e){t.exports="#version 100\nprecision mediump float;\nuniform sampler2D u_input;\nuniform float u_width;\nuniform float u_height;\nuniform sampler2D u_brush;\nuniform float u_brush_width;\nuniform float u_brush_height;\nuniform float u_brush_rotation;\nuniform float u_x;\nuniform float u_y;\nuniform float u_opacity;\nuniform vec3 u_color;\nuniform float u_t;\nvarying vec2 vUv;\nfloat rand(vec2 co) {\n\treturn fract(sin(dot(co.xy + u_t, vec2(12.9898, 78.233))) * 43758.5453);\n}\nvec2 calcBrushUv(float x, float y) {\n\tvec2 point = vec2(((vUv.x - ((x - (u_brush_width / 2.0)) / u_width)) * u_width) / u_brush_width, ((vUv.y - ((y - (u_brush_height / 2.0)) / u_height)) * u_height) / u_brush_height);\n\tvec2 offsetPoint = point - 0.5;\n\tfloat len = length(offsetPoint);\n\tfloat angle = atan(offsetPoint.y, offsetPoint.x);\n\tangle -= u_brush_rotation;\n\tpoint.x = (len * cos(angle)) + 0.5;\n\tpoint.y = (len * sin(angle)) + 0.5;\n\treturn point;\n}\nfloat remix0(vec3 resColor, vec4 canvasBaseColor, float opacity, vec2 brushUv) {\n\tconst int channel = 0;\n\tif (opacity < (1.0 / 256.0))\n\t\treturn resColor[channel];\n\tif ((resColor[channel] - canvasBaseColor[channel]) > (5.0 / 256.0))\n\t\treturn resColor[channel];\n\treturn u_color[channel];\n\tif (u_color[channel] > canvasBaseColor[channel])\n\t\treturn resColor[channel] + ((4.0 * (rand(brushUv) - 0.5)) / 256.0);\n\treturn resColor[channel] - ((2.0 * (rand(brushUv) - 0.5)) / 256.0);\n}\nfloat remix1(vec3 resColor, vec4 canvasBaseColor, float opacity, vec2 brushUv) {\n\tconst int channel = 1;\n\tif (opacity < (1.0 / 256.0))\n\t\treturn resColor[channel];\n\tif ((resColor[channel] - canvasBaseColor[channel]) > (5.0 / 256.0))\n\t\treturn resColor[channel];\n\treturn u_color[channel];\n\tif (u_color[channel] > canvasBaseColor[channel])\n\t\treturn resColor[channel] + ((4.0 * (rand(brushUv) - 0.5)) / 256.0);\n\treturn resColor[channel] - ((4.0 * (rand(brushUv) - 0.5)) / 256.0);\n}\nfloat remix2(vec3 resColor, vec4 canvasBaseColor, float opacity, vec2 brushUv) {\n\tconst int channel = 2;\n\tif (opacity < (1.0 / 256.0))\n\t\treturn resColor[channel];\n\tif ((resColor[channel] - canvasBaseColor[channel]) > (5.0 / 256.0))\n\t\treturn resColor[channel];\n\treturn u_color[channel];\n\tif (u_color[channel] > canvasBaseColor[channel])\n\t\treturn resColor[channel] + ((4.0 * (rand(brushUv) - 0.5)) / 256.0);\n\treturn resColor[channel] - ((4.0 * (rand(brushUv) - 0.5)) / 256.0);\n}\nvoid main() {\n\tvec4 canvasBaseColor = texture2D(u_input, vUv);\n\tvec2 brushUv = calcBrushUv(u_x, u_y);\n\tvec4 brushColor = texture2D(u_brush, brushUv);\n\tvec4 brushUvLast = texture2D(u_brush, calcBrushUv(u_x - 1.0, u_y - 1.0));\n\tfloat opacity = brushColor[3];\n\topacity = opacity * u_opacity;\n\topacity = opacity < 0.000001 ? -99.0 : opacity;\n\topacity += ((4.0 * (rand(brushUv) - 0.5)) / 256.0);\n\topacity = (brushUv.x > 1.0) || (brushUv.y > 1.0) ? 0.0 : opacity;\n\topacity = (brushUv.x < 0.0) || (brushUv.y < 0.0) ? 0.0 : opacity;\n\topacity = clamp(opacity, 0.0, 1.0);\n\tvec3 resColor = mix(canvasBaseColor.xyz, u_color, opacity);\n\tfloat resOpacity = mix(canvasBaseColor[3], 1.0, opacity);\n\tgl_FragColor = opacity < (1.0 / 256.0) ? canvasBaseColor : vec4(resColor, resOpacity);\n}\n"},function(t,e,i){var n=i(28),r=i(16),a=i(42).createGesture,o=i(15),s=o.mat3,l=o.vec3,c=i(166),u=i(29),h=i(12),d=t.exports=function(t){if(this.valid=!0,this.id=t.id,this.timestamp=t.timestamp,this.hands=[],this.handsMap={},this.pointables=[],this.tools=[],this.fingers=[],t.interactionBox&&(this.interactionBox=new c(t.interactionBox)),this.gestures=[],this.pointablesMap={},this._translation=t.t,this._rotation=h.flatten(t.r),this._scaleFactor=t.s,this.data=t,this.type="frame",this.currentFrameRate=t.currentFrameRate,t.gestures)for(var e=0,i=t.gestures.length;e!=i;e++)this.gestures.push(a(t.gestures[e]));this.postprocessData(t)};d.prototype.postprocessData=function(t){t||(t=this.data);for(var e=0,i=t.hands.length;e!=i;e++){var a=new n(t.hands[e]);a.frame=this,this.hands.push(a),this.handsMap[a.id]=a}t.pointables=h.sortBy(t.pointables,(function(t){return t.id}));for(var o=0,s=t.pointables.length;o!=s;o++){var l=t.pointables[o],c=l.dipPosition?new u(l):new r(l);c.frame=this,this.addPointable(c)}},d.prototype.addPointable=function(t){if(this.pointables.push(t),this.pointablesMap[t.id]=t,(t.tool?this.tools:this.fingers).push(t),void 0!==t.handId&&this.handsMap.hasOwnProperty(t.handId)){var e=this.handsMap[t.handId];switch(e.pointables.push(t),(t.tool?e.tools:e.fingers).push(t),t.type){case 0:e.thumb=t;break;case 1:e.indexFinger=t;break;case 2:e.middleFinger=t;break;case 3:e.ringFinger=t;break;case 4:e.pinky=t}}},d.prototype.tool=function(t){var e=this.pointable(t);return e.tool?e:r.Invalid},d.prototype.pointable=function(t){return this.pointablesMap[t]||r.Invalid},d.prototype.finger=function(t){var e=this.pointable(t);return e.tool?r.Invalid:e},d.prototype.hand=function(t){return this.handsMap[t]||n.Invalid},d.prototype.rotationAngle=function(t,e){if(!this.valid||!t.valid)return 0;var i=this.rotationMatrix(t),n=.5*(i[0]+i[4]+i[8]-1),r=Math.acos(n);if(r=isNaN(r)?0:r,void 0!==e){var a=this.rotationAxis(t);r*=l.dot(a,l.normalize(l.create(),e))}return r},d.prototype.rotationAxis=function(t){return this.valid&&t.valid?l.normalize(l.create(),[this._rotation[7]-t._rotation[5],this._rotation[2]-t._rotation[6],this._rotation[3]-t._rotation[1]]):l.create()},d.prototype.rotationMatrix=function(t){if(!this.valid||!t.valid)return s.create();var e=s.transpose(s.create(),this._rotation);return s.multiply(s.create(),t._rotation,e)},d.prototype.scaleFactor=function(t){return this.valid&&t.valid?Math.exp(this._scaleFactor-t._scaleFactor):1},d.prototype.translation=function(t){return this.valid&&t.valid?l.subtract(l.create(),this._translation,t._translation):l.create()},d.prototype.toString=function(){var t="Frame [ id:"+this.id+" | timestamp:"+this.timestamp+" | Hand count:("+this.hands.length+") | Pointable count:("+this.pointables.length+")";return this.gestures&&(t+=" | Gesture count:("+this.gestures.length+")"),t+=" ]"},d.prototype.dump=function(){var t="";t+="Frame Info:<br/>",t+=this.toString(),t+="<br/><br/>Hands:<br/>";for(var e=0,i=this.hands.length;e!=i;e++)t+="  "+this.hands[e].toString()+"<br/>";t+="<br/><br/>Pointables:<br/>";for(var n=0,r=this.pointables.length;n!=r;n++)t+="  "+this.pointables[n].toString()+"<br/>";if(this.gestures){t+="<br/><br/>Gestures:<br/>";for(var a=0,o=this.gestures.length;a!=o;a++)t+="  "+this.gestures[a].toString()+"<br/>"}return t+="<br/><br/>Raw JSON:<br/>",t+=JSON.stringify(this.data)},d.Invalid={valid:!1,hands:[],fingers:[],tools:[],gestures:[],pointables:[],pointable:function(){return r.Invalid},finger:function(){return r.Invalid},hand:function(){return n.Invalid},toString:function(){return"invalid frame"},dump:function(){return this.toString()},rotationAngle:function(){return 0},rotationMatrix:function(){return s.create()},rotationAxis:function(){return l.create()},scaleFactor:function(){return 1},translation:function(){return l.create()}}},function(t,e,i){var n=i(15).vec3,r=i(20).EventEmitter,a=i(12),o=(e.createGesture=function(t){var e;switch(t.type){case"circle":e=new s(t);break;case"swipe":e=new l(t);break;case"screenTap":e=new c(t);break;case"keyTap":e=new u(t);break;default:throw"unknown gesture type"}return e.id=t.id,e.handIds=t.handIds.slice(),e.pointableIds=t.pointableIds.slice(),e.duration=t.duration,e.state=t.state,e.type=t.type,e},e.gestureListener=function(t,e){var i={},n={};t.on("gesture",(function(t,r){if(t.type==e){if(("start"==t.state||"stop"==t.state)&&void 0===n[t.id]){var s=new o(t,r);n[t.id]=s,a.each(i,(function(t,e){s.on(e,t)}))}n[t.id].update(t,r),"stop"==t.state&&delete n[t.id]}}));var r={start:function(t){return i.start=t,r},stop:function(t){return i.stop=t,r},complete:function(t){return i.stop=t,r},update:function(t){return i.update=t,r}};return r},e.Gesture=function(t,e){this.gestures=[t],this.frames=[e]});o.prototype.update=function(t,e){this.lastGesture=t,this.lastFrame=e,this.gestures.push(t),this.frames.push(e),this.emit(t.state,this)},o.prototype.translation=function(){return n.subtract(n.create(),this.lastGesture.startPosition,this.lastGesture.position)},a.extend(o.prototype,r.prototype);var s=function(t){this.center=t.center,this.normal=t.normal,this.progress=t.progress,this.radius=t.radius};s.prototype.toString=function(){return"CircleGesture ["+JSON.stringify(this)+"]"};var l=function(t){this.startPosition=t.startPosition,this.position=t.position,this.direction=t.direction,this.speed=t.speed};l.prototype.toString=function(){return"SwipeGesture ["+JSON.stringify(this)+"]"};var c=function(t){this.position=t.position,this.direction=t.direction,this.progress=t.progress};c.prototype.toString=function(){return"ScreenTapGesture ["+JSON.stringify(this)+"]"};var u=function(t){this.position=t.position,this.direction=t.direction,this.progress=t.progress};u.prototype.toString=function(){return"KeyTapGesture ["+JSON.stringify(this)+"]"}},function(t,e,i){var n,r;void 0===(r="function"==typeof(n=function(){function t(){var t=arguments.length;if(0===t)throw new Error("resolveUrl requires at least one argument; got none.");var e=document.createElement("base");if(e.href=arguments[0],1===t)return e.href;var i=document.getElementsByTagName("head")[0];i.insertBefore(e,i.firstChild);for(var n,r=document.createElement("a"),a=1;a<t;a++)r.href=arguments[a],n=r.href,e.href=n;return i.removeChild(e),n}return t})?n.call(e,i,e,t):n)||(t.exports=r)},function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));class n{constructor({canvas:t,frameRate:e}){this.canvas=t,this.stream=t.captureStream(e),this.recordedChunks=[],this.mediaRecorder=new MediaRecorder(this.stream,{mimeType:"video/webm; codecs=vp9"}),this.mediaRecorder.ondataavailable=t=>this.handleDataAvailable(t)}recordFrames(t,e){for(let e=0;e<t;e++)Compositor.component.jumpToFrame(e),Compositor.component.quickDraw(),this.stream.getVideoTracks()[0].requestFrame()}start(){this.mediaRecorder.start()}async stop(){let t=new Promise(((t,e)=>{this.gotLastData=t}));console.log("Calling stop"),this.mediaRecorder.stop(),console.log("awaiting stop"),await t}handleDataAvailable(t){t.data.size>0?(console.log("Got Chunk",t.data.mimeType),this.recordedChunks.push(t.data),this.gotLastData()):(console.log("No data"),this.gotLastData())}createURL(){console.log("Creating",this.recordedChunks);let t=new Blob(this.recordedChunks,{type:"video/webm"});return URL.createObjectURL(t)}}},function(t,e,i){(function(t){var n=void 0!==t&&t||"undefined"!=typeof self&&self||window,r=Function.prototype.apply;function a(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new a(r.call(setTimeout,n,arguments),clearTimeout)},e.setInterval=function(){return new a(r.call(setInterval,n,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},a.prototype.unref=a.prototype.ref=function(){},a.prototype.close=function(){this._clearFn.call(n,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),e))},i(378),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,i(19))},function(t,e,i){"use strict";t.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},function(t,e,i){var n=i(46),r={};for(var a in n)n.hasOwnProperty(a)&&(r[n[a]]=a);var o=t.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(var s in o)if(o.hasOwnProperty(s)){if(!("channels"in o[s]))throw new Error("missing channels property: "+s);if(!("labels"in o[s]))throw new Error("missing channel labels property: "+s);if(o[s].labels.length!==o[s].channels)throw new Error("channel and label counts mismatch: "+s);var l=o[s].channels,c=o[s].labels;delete o[s].channels,delete o[s].labels,Object.defineProperty(o[s],"channels",{value:l}),Object.defineProperty(o[s],"labels",{value:c})}o.rgb.hsl=function(t){var e,i,n=t[0]/255,r=t[1]/255,a=t[2]/255,o=Math.min(n,r,a),s=Math.max(n,r,a),l=s-o;return s===o?e=0:n===s?e=(r-a)/l:r===s?e=2+(a-n)/l:a===s&&(e=4+(n-r)/l),(e=Math.min(60*e,360))<0&&(e+=360),i=(o+s)/2,[e,100*(s===o?0:i<=.5?l/(s+o):l/(2-s-o)),100*i]},o.rgb.hsv=function(t){var e,i,n,r,a,o=t[0]/255,s=t[1]/255,l=t[2]/255,c=Math.max(o,s,l),u=c-Math.min(o,s,l),h=function(t){return(c-t)/6/u+.5};return 0===u?r=a=0:(a=u/c,e=h(o),i=h(s),n=h(l),o===c?r=n-i:s===c?r=1/3+e-n:l===c&&(r=2/3+i-e),r<0?r+=1:r>1&&(r-=1)),[360*r,100*a,100*c]},o.rgb.hwb=function(t){var e=t[0],i=t[1],n=t[2];return[o.rgb.hsl(t)[0],100*(1/255*Math.min(e,Math.min(i,n))),100*(n=1-1/255*Math.max(e,Math.max(i,n)))]},o.rgb.cmyk=function(t){var e,i=t[0]/255,n=t[1]/255,r=t[2]/255;return[100*((1-i-(e=Math.min(1-i,1-n,1-r)))/(1-e)||0),100*((1-n-e)/(1-e)||0),100*((1-r-e)/(1-e)||0),100*e]},o.rgb.keyword=function(t){var e=r[t];if(e)return e;var i,a,o,s=1/0;for(var l in n)if(n.hasOwnProperty(l)){var c=n[l],u=(a=t,o=c,Math.pow(a[0]-o[0],2)+Math.pow(a[1]-o[1],2)+Math.pow(a[2]-o[2],2));u<s&&(s=u,i=l)}return i},o.keyword.rgb=function(t){return n[t]},o.rgb.xyz=function(t){var e=t[0]/255,i=t[1]/255,n=t[2]/255;return[100*(.4124*(e=e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92)+.3576*(i=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92)+.1805*(n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92)),100*(.2126*e+.7152*i+.0722*n),100*(.0193*e+.1192*i+.9505*n)]},o.rgb.lab=function(t){var e=o.rgb.xyz(t),i=e[0],n=e[1],r=e[2];return n/=100,r/=108.883,i=(i/=95.047)>.008856?Math.pow(i,1/3):7.787*i+16/116,[116*(n=n>.008856?Math.pow(n,1/3):7.787*n+16/116)-16,500*(i-n),200*(n-(r=r>.008856?Math.pow(r,1/3):7.787*r+16/116))]},o.hsl.rgb=function(t){var e,i,n,r,a,o=t[0]/360,s=t[1]/100,l=t[2]/100;if(0===s)return[a=255*l,a,a];e=2*l-(i=l<.5?l*(1+s):l+s-l*s),r=[0,0,0];for(var c=0;c<3;c++)(n=o+1/3*-(c-1))<0&&n++,n>1&&n--,a=6*n<1?e+6*(i-e)*n:2*n<1?i:3*n<2?e+(i-e)*(2/3-n)*6:e,r[c]=255*a;return r},o.hsl.hsv=function(t){var e=t[0],i=t[1]/100,n=t[2]/100,r=i,a=Math.max(n,.01);return i*=(n*=2)<=1?n:2-n,r*=a<=1?a:2-a,[e,100*(0===n?2*r/(a+r):2*i/(n+i)),100*((n+i)/2)]},o.hsv.rgb=function(t){var e=t[0]/60,i=t[1]/100,n=t[2]/100,r=Math.floor(e)%6,a=e-Math.floor(e),o=255*n*(1-i),s=255*n*(1-i*a),l=255*n*(1-i*(1-a));switch(n*=255,r){case 0:return[n,l,o];case 1:return[s,n,o];case 2:return[o,n,l];case 3:return[o,s,n];case 4:return[l,o,n];case 5:return[n,o,s]}},o.hsv.hsl=function(t){var e,i,n,r=t[0],a=t[1]/100,o=t[2]/100,s=Math.max(o,.01);return n=(2-a)*o,i=a*s,[r,100*(i=(i/=(e=(2-a)*s)<=1?e:2-e)||0),100*(n/=2)]},o.hwb.rgb=function(t){var e,i,n,r,a,o,s,l=t[0]/360,c=t[1]/100,u=t[2]/100,h=c+u;switch(h>1&&(c/=h,u/=h),n=6*l-(e=Math.floor(6*l)),0!=(1&e)&&(n=1-n),r=c+n*((i=1-u)-c),e){default:case 6:case 0:a=i,o=r,s=c;break;case 1:a=r,o=i,s=c;break;case 2:a=c,o=i,s=r;break;case 3:a=c,o=r,s=i;break;case 4:a=r,o=c,s=i;break;case 5:a=i,o=c,s=r}return[255*a,255*o,255*s]},o.cmyk.rgb=function(t){var e=t[0]/100,i=t[1]/100,n=t[2]/100,r=t[3]/100;return[255*(1-Math.min(1,e*(1-r)+r)),255*(1-Math.min(1,i*(1-r)+r)),255*(1-Math.min(1,n*(1-r)+r))]},o.xyz.rgb=function(t){var e,i,n,r=t[0]/100,a=t[1]/100,o=t[2]/100;return i=-.9689*r+1.8758*a+.0415*o,n=.0557*r+-.204*a+1.057*o,e=(e=3.2406*r+-1.5372*a+-.4986*o)>.0031308?1.055*Math.pow(e,1/2.4)-.055:12.92*e,i=i>.0031308?1.055*Math.pow(i,1/2.4)-.055:12.92*i,n=n>.0031308?1.055*Math.pow(n,1/2.4)-.055:12.92*n,[255*(e=Math.min(Math.max(0,e),1)),255*(i=Math.min(Math.max(0,i),1)),255*(n=Math.min(Math.max(0,n),1))]},o.xyz.lab=function(t){var e=t[0],i=t[1],n=t[2];return i/=100,n/=108.883,e=(e/=95.047)>.008856?Math.pow(e,1/3):7.787*e+16/116,[116*(i=i>.008856?Math.pow(i,1/3):7.787*i+16/116)-16,500*(e-i),200*(i-(n=n>.008856?Math.pow(n,1/3):7.787*n+16/116))]},o.lab.xyz=function(t){var e,i,n,r=t[0];e=t[1]/500+(i=(r+16)/116),n=i-t[2]/200;var a=Math.pow(i,3),o=Math.pow(e,3),s=Math.pow(n,3);return i=a>.008856?a:(i-16/116)/7.787,e=o>.008856?o:(e-16/116)/7.787,n=s>.008856?s:(n-16/116)/7.787,[e*=95.047,i*=100,n*=108.883]},o.lab.lch=function(t){var e,i=t[0],n=t[1],r=t[2];return(e=360*Math.atan2(r,n)/2/Math.PI)<0&&(e+=360),[i,Math.sqrt(n*n+r*r),e]},o.lch.lab=function(t){var e,i=t[0],n=t[1];return e=t[2]/360*2*Math.PI,[i,n*Math.cos(e),n*Math.sin(e)]},o.rgb.ansi16=function(t){var e=t[0],i=t[1],n=t[2],r=1 in arguments?arguments[1]:o.rgb.hsv(t)[2];if(0===(r=Math.round(r/50)))return 30;var a=30+(Math.round(n/255)<<2|Math.round(i/255)<<1|Math.round(e/255));return 2===r&&(a+=60),a},o.hsv.ansi16=function(t){return o.rgb.ansi16(o.hsv.rgb(t),t[2])},o.rgb.ansi256=function(t){var e=t[0],i=t[1],n=t[2];return e===i&&i===n?e<8?16:e>248?231:Math.round((e-8)/247*24)+232:16+36*Math.round(e/255*5)+6*Math.round(i/255*5)+Math.round(n/255*5)},o.ansi16.rgb=function(t){var e=t%10;if(0===e||7===e)return t>50&&(e+=3.5),[e=e/10.5*255,e,e];var i=.5*(1+~~(t>50));return[(1&e)*i*255,(e>>1&1)*i*255,(e>>2&1)*i*255]},o.ansi256.rgb=function(t){if(t>=232){var e=10*(t-232)+8;return[e,e,e]}var i;return t-=16,[Math.floor(t/36)/5*255,Math.floor((i=t%36)/6)/5*255,i%6/5*255]},o.rgb.hex=function(t){var e=(((255&Math.round(t[0]))<<16)+((255&Math.round(t[1]))<<8)+(255&Math.round(t[2]))).toString(16).toUpperCase();return"000000".substring(e.length)+e},o.hex.rgb=function(t){var e=t.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!e)return[0,0,0];var i=e[0];3===e[0].length&&(i=i.split("").map((function(t){return t+t})).join(""));var n=parseInt(i,16);return[n>>16&255,n>>8&255,255&n]},o.rgb.hcg=function(t){var e,i=t[0]/255,n=t[1]/255,r=t[2]/255,a=Math.max(Math.max(i,n),r),o=Math.min(Math.min(i,n),r),s=a-o;return e=s<=0?0:a===i?(n-r)/s%6:a===n?2+(r-i)/s:4+(i-n)/s+4,e/=6,[360*(e%=1),100*s,100*(s<1?o/(1-s):0)]},o.hsl.hcg=function(t){var e=t[1]/100,i=t[2]/100,n=1,r=0;return(n=i<.5?2*e*i:2*e*(1-i))<1&&(r=(i-.5*n)/(1-n)),[t[0],100*n,100*r]},o.hsv.hcg=function(t){var e=t[1]/100,i=t[2]/100,n=e*i,r=0;return n<1&&(r=(i-n)/(1-n)),[t[0],100*n,100*r]},o.hcg.rgb=function(t){var e=t[0]/360,i=t[1]/100,n=t[2]/100;if(0===i)return[255*n,255*n,255*n];var r,a=[0,0,0],o=e%1*6,s=o%1,l=1-s;switch(Math.floor(o)){case 0:a[0]=1,a[1]=s,a[2]=0;break;case 1:a[0]=l,a[1]=1,a[2]=0;break;case 2:a[0]=0,a[1]=1,a[2]=s;break;case 3:a[0]=0,a[1]=l,a[2]=1;break;case 4:a[0]=s,a[1]=0,a[2]=1;break;default:a[0]=1,a[1]=0,a[2]=l}return r=(1-i)*n,[255*(i*a[0]+r),255*(i*a[1]+r),255*(i*a[2]+r)]},o.hcg.hsv=function(t){var e=t[1]/100,i=e+t[2]/100*(1-e),n=0;return i>0&&(n=e/i),[t[0],100*n,100*i]},o.hcg.hsl=function(t){var e=t[1]/100,i=t[2]/100*(1-e)+.5*e,n=0;return i>0&&i<.5?n=e/(2*i):i>=.5&&i<1&&(n=e/(2*(1-i))),[t[0],100*n,100*i]},o.hcg.hwb=function(t){var e=t[1]/100,i=e+t[2]/100*(1-e);return[t[0],100*(i-e),100*(1-i)]},o.hwb.hcg=function(t){var e=t[1]/100,i=1-t[2]/100,n=i-e,r=0;return n<1&&(r=(i-n)/(1-n)),[t[0],100*n,100*r]},o.apple.rgb=function(t){return[t[0]/65535*255,t[1]/65535*255,t[2]/65535*255]},o.rgb.apple=function(t){return[t[0]/255*65535,t[1]/255*65535,t[2]/255*65535]},o.gray.rgb=function(t){return[t[0]/100*255,t[0]/100*255,t[0]/100*255]},o.gray.hsl=o.gray.hsv=function(t){return[0,0,t[0]]},o.gray.hwb=function(t){return[0,100,t[0]]},o.gray.cmyk=function(t){return[0,0,0,t[0]]},o.gray.lab=function(t){return[t[0],0,0]},o.gray.hex=function(t){var e=255&Math.round(t[0]/100*255),i=((e<<16)+(e<<8)+e).toString(16).toUpperCase();return"000000".substring(i.length)+i},o.rgb.gray=function(t){return[(t[0]+t[1]+t[2])/3/255*100]}},function(t,e,i){t.exports=i.p+"asset/6e5624b204505510ff89bfd4e2115cf4.png"},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAANVJREFUaN7tlzEOwzAIRaHq0hN3tDr21L9LO9SyExyDiJX/pkixBM8Yk4gQQkgm2nsBANnJ/SWq2sz1lp3YLBTI5m5d2DuDUVh7cPkKUCAbcw+cbS78WL4CFCBXZ3e61rdP9EQejbd8D5jnwAi9mRFRveUrQIFsKJDNtACAJyo21taUcENLci0JA+VoPHeBAxJlNp67wIBE8YrnLmCQ2D3z6QIbEqaGPYVAQ8J824zGC/mYExFR1TeAx/f5FRbHsiNVYvwf8GT4CLk0liPLV4AChBBybT4Bit9lbD9RbAAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMC0wMS0wNFQxMzowNToxMiswMDowMJKW/WYAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjAtMDEtMDRUMTM6MDU6MTIrMDA6MDDjy0XaAAAAKHRFWHRzdmc6YmFzZS11cmkAZmlsZTovLy90bXAvbWFnaWNrLWNLYzV4ZG12XvzhOgAAAABJRU5ErkJggg=="},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAAatJREFUaN7tmb1OwzAUhc9FLKjigWiHsiJ4n6oT6Vbeh4ERFt6HiqrjYXGl1HHi/9oWOVPlXsfns6+vHQWYNWtWNpFckVyV9hFqfknyQPKX5GNpP6Hmz2oHwmC+HYgJ8/VDOJivF8LDfH0QAeaTQtwkYFgDuNfadoY4vW0B4CHLrPqK5KY3s6+q7UJjcbG6TfEQEXkjead+72LjvMZO8RCTzrPeM59lLK89oO4224zQ22x3J63a7B3iB3vAEt9lK7EjpXJv6eMM0DPvXWKtKURyCeADw1J5SjhH+rMWAN6jV2LikLKWwIAU2hjGCU+nGPMhAEkhGH49yKVRCDGZhznnS+sI4EVEPvuNY5vYackLyM2XSqGf0nmjpdDaD3UcwnqIqf4XcuzTJTGfAsIXILn5WAgfgBjz1pNYRL4BPAE4aH/lPImPAJ5F5CvZCNpK5DyJ49NmYhDn63TgJva+Tv+vFxqL4c6xOjnFXVVaFdmrtkEKmeKKS+Wtrs6xLdvrqQ9A6LUjX7W5AkQ95gMg6jPvAVGveQeI+s1PQLRj3gDRnvkeRLufWWfNakR/Bik85ghEHJ4AAAAldEVYdGRhdGU6Y3JlYXRlADIwMjAtMDEtMDFUMTU6MjY6NTErMDA6MDBO0+kIAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIwLTAxLTAxVDE1OjI2OjUxKzAwOjAwP45RtAAAACh0RVh0c3ZnOmJhc2UtdXJpAGZpbGU6Ly8vdG1wL21hZ2ljay01bTE4Y1djeAAA8U4AAAAASUVORK5CYII="},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAAQhJREFUaN7t2cEKwjAQhOGNTyUK6ltpT/bq2yoIHsdLhVqi2SY1O8GdmyLh/8BiiyI+338vTN8AgLcPhBD0x9XfyjrAAdYB1AAAHYBNVREmKzinH464A9g1BRjFv3YDsG4CEIkHgGsTAPP4EgBFfC6AJj4HQBU/F0AXPwdAGa8F0MZrANTxKQB9/DcAa7zqiQxALyJny9Bxz/h18naaKT42zfPAwzqyCBBCuIjIyTpUvS8X8TFyEde7zy8FNINQ/JBxI5S3EjFE3WffEgA1QgtIIPZNACgRcwF0iBwAFSIXkEAcmgBQIEoBHxD1vkpLACaIutfBUoDhrA7A9pe9/h+Z9Rzg8/ls9wQgumSjLVTQYQAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMC0wMi0wOFQxMjo0ODoyNiswMDowMHSTqkAAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjAtMDItMDhUMTI6NDg6MjYrMDA6MDAFzhL8AAAAKHRFWHRzdmc6YmFzZS11cmkAZmlsZTovLy90bXAvbWFnaWNrLUgzVmx4dEMxu0pEvQAAAABJRU5ErkJggg=="},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAALBJREFUaN7tmcsOQEAQBK2fduTor9uFBFnGa/RM0nXe2CqHNbJNI7gUrwcDwGajUlz2ar0C/kIBbBTA5nUAgA4VKutq9OwXcBphEEP+YUQs+ZsRMeUvRsSWNyJyyB9E5JJfRQwABraH8MSc0Wtf1V8Fjf8IzUJs0gcINjqF2ChACEfmcXpke7yRX8gVsZPPFXEgnyPCkI8dcVE+ZsRN+VgRD+U/i9AdGRsFsFGAEILLBG4ULi9GBhdyAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIwLTAyLTEyVDAyOjA1OjA5KzAwOjAwa8O1/wAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMC0wMi0xMlQwMjowNTowOSswMDowMBqeDUMAAAAodEVYdHN2ZzpiYXNlLXVyaQBmaWxlOi8vL3RtcC9tYWdpY2stTHhvWTdaVEjuRmTYAAAAAElFTkSuQmCC"},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAAKFJREFUaN7t0LERgzAQRFFEWRDQfznMOP+kDjwI4dOtsPcXoNunaXLOOffPlaiHAJoOlxJye47+kewMUGeAOgPUGaDOAHUGqDNAXRUALMBOpdbDtfeAF7CFKK8iAosbL0DEj09E9BufgOg/viMib3wHRP74QIRufABCP/4LxDjjbyDGG9+AGHf8BcT4408Qzxn/AfG88W+IFVjVO5xzzv1uB7Lc9nWtXhZ0AAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE5LTEyLTMxVDExOjQ4OjUxKzAwOjAwNTPk+AAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxOS0xMi0zMVQxMTo0ODo1MSswMDowMERuXEQAAAAodEVYdHN2ZzpiYXNlLXVyaQBmaWxlOi8vL3RtcC9tYWdpY2stU0ZhNDVORVL3tFKRAAAAAElFTkSuQmCC"},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAALxJREFUaN7tmDEOwjAQBPfo+RC8gCdRpeVJvID/kIZyU5ACRSZYTk53FjttmhlHls4HCCGEEE6QPJO8Rnu0yp9Ijnxzi/bZIk/PiIOHPIA7gOPi08sjYHf5wsmT5BDtJvm0SF7ykpf8f8tbrTzK44G/oNmq489ZKFK+htphjtGizQFm9gBwATBGy25ivsTPwiXu57GiiCwoIguKyIIisqCIBnbfzK3MTvk3c58s/kT+F9uXiH7X60IIIbpgAkbsgqiI2jYPAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIwLTAyLTA0VDIzOjQ1OjQ0KzAwOjAw1kgWyAAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMC0wMi0wNFQyMzo0NTo0NCswMDowMKcVrnQAAAAodEVYdHN2ZzpiYXNlLXVyaQBmaWxlOi8vL3RtcC9tYWdpY2stenNFeGg4NFUrs034AAAAAElFTkSuQmCC"},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAALpJREFUaN7tmD0KwkAQRmfSeiQL0+t9xM5DeQC9U4LlZyGB4F9CdN0ZeK8LBPIeu4HZNQMAACiEpIOkdW2PpfJH3ekktbV9lsqrdERTqOH68Lwys1OqlZC01zO5thMRUSAiCkREgYgo/CLCZ3xEFdp6M9u5+3nqxVKz0LfMnp2iBgxMrn7UgN7Mtu5+qS3ykRfnhuEn3tR2Qz4syCOPPPLIh5L/181cjtlmzOiwkmPbvInIe70OAAApuAEn+YSoE0FvHAAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMC0wMi0wNFQyMzo0NTozMSswMDowMI61MHYAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjAtMDItMDRUMjM6NDU6MzErMDA6MDD/6IjKAAAAKHRFWHRzdmc6YmFzZS11cmkAZmlsZTovLy90bXAvbWFnaWNrLXRQMEZSRUNxGlAOeAAAAABJRU5ErkJggg=="},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAAJZJREFUaN7t0TEKgDAQRFHjsbTx/scR+7GyEzFxNxPh/3oh88g0ERERJSVplbS6d7SOXyTtkg5Jm3tP6/ir/yBuxv8H8TB+fMSL8eMiKsaPh2gYPw7iw3g/ImC8DxE4vj8iYXw/ROL4fESH8XmIjuPjEYbxVYgS+EuquS+lhLw9RwFcAXAHwB0AdwDcAXAHwB0AIiIiZydHPiZwjt5PjwAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxOS0xMi0zMVQxMTo0ODozNCswMDowMKFkwtgAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTktMTItMzFUMTE6NDg6MzQrMDA6MDDQOXpkAAAAKHRFWHRzdmc6YmFzZS11cmkAZmlsZTovLy90bXAvbWFnaWNrLUNTbGJOS2tCGWEFWAAAAABJRU5ErkJggg=="},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAApxJREFUaN7tmT1rFFEYhc9dF9TV1kZUsNhYKGgEIZVioetH0MJC0crGzsZGUNAVRKxUgoKVpZAmYqdBiEZDAtE0Rowx4A+IViqRIPtYzAQ21/m4d2Y3E3FOOcx53/PMnXnnzq5UqtT/LdOtwgDLGhnTlV6VbgGslEqAolUCFK0SoGiVAEWrmscMbJDUJ2mXpB5JdWPM4RTPsKRZSZ8lTUuaMMb8XDFioAe4AYwBi1hqO8/peFhjDGgC9W6FrgDngHFSlAHA1jhwFujM7Q30Ax8cGncKYEnTwPG0fCYheE3SXUkXEvzzkiYlTUmak/TFGDO6FHRZo3A3CuyXtF1SXVKvpH2SNiX0eCjpkjFmweeq14DXMVfmI3AF2J1SI3IFYs7dA1wFZmJ6vgLW+wA8jSjyFjgEOO3rfQDaPCbs8S6i/xPX8P2WsQVc932osgC0eSsEk65llTnmYh61THd8mscANDPWuGfVeeli+mGZtuQEyBQ+rLHVyvLdxTRvmTbnAGhax7xggG1ZAF506Bb6K3yGZ2HAyjLiYjoZMQGawJosIO3hPaZRBbgZ8RAfdTEbYCgCYhI4guMYjQqfBhD2bgBTEf2HfJpuBN4QrRmCsdpLymi1w0cBhKH3AteA2ZieI/i8yMLCa4FHJOsb8IxgZlctfzPGcwA4D9wKvV8T6reAB8A6r/BWkAbwKaHJAtBwDO+j97i8uBwhqsBpYMJq8gvrwcoZvkXwbXAGxze/0xeZMea3pEFJg8AOSacknZC0U/l/X11UsKMdlvTYGDPXkavuuDI1oA9rxKaswnPgPnAROEiwbV99Ai5HpS86V26IojPlhig6T26IorP4hL4dBVF0Lh8AyLmdXg0A2Cvxz8gaPl2DKP+lLFWqVLH6A8EC8mAWBaAfAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIwLTAxLTA1VDIyOjA3OjM4KzAwOjAwf6kYpwAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMC0wMS0wNVQyMjowNzozOCswMDowMA70oBsAAAAodEVYdHN2ZzpiYXNlLXVyaQBmaWxlOi8vL3RtcC9tYWdpY2stWWc1TGdQcXPR/DdkAAAAAElFTkSuQmCC"},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAAkhJREFUaN7tmb1u1EAUhc+Q0EEBZGkokGgoyQNQUCIakBKCBC8FDVQ0gYUkBqXmFeAZUJqAACmK2JIFPgoGybqxPT+2NDHyKcdzveebuXdmdixNmjRp0mgEXAF2gGPKaQHsA9clySWYn0n6IOlq6YH0OpZ0IwWgkrRZ2rVRFQUAbEnaLe22QYsY82vAV5OHO6Uc24KICahMzDfg8igAgAcNq8BGKfNJAC2ps13SfCqATZ3PwMXAy1eAbeBRhrFN4DVwtjdAS+rciTA/931/pkB480sfW3VBBAGAmS/Uup5HmJibmKVffkNxWzXz/zTvA2BT5xC4EDmKP0xs50yYka/HPMwC8KNR12/gdmQmJEHkmO8EoHnVeRprPgUi13wIwKbOAXA+FSAE0cd8KwBw37T/Am7lmK/9UFNxLlvagsXeCtCSOo/7mA/MRNbIdwHsmbaPwLkhAAIQyeabAM4MZTQgl9ieRLQGfDFgT4Zw3VKwJwo78Z3/WRHXHthaOKDfMtq4VJKxY8cCNKXSsyHNmz5ZEK0A/uFd8zznKBG1SeVCdAL4DrumT8phLvVglnMADALMOLmxjec47TvZVAK4FzCyAryMGfnATFTAai8A39Gm0qdQKgGrfiail0UzE/Mu86kATavSi1RjQysawHduSqVxXKvUAmwqjediywc0pdL+aQGIvdzdkPSmlOkOfY86Tjvn3up03k6/S/k+cEnSe0nXSrv2OpK0Hv2Hxjl3JOmmpFf6+3WklBaS9iStO+cOC/qYNGnSJEl/AMwF+H0v6+5uAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIwLTAxLTA0VDAxOjI2OjIyKzAwOjAwUhGsegAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMC0wMS0wNFQwMToyNjoyMiswMDowMCNMFMYAAAAodEVYdHN2ZzpiYXNlLXVyaQBmaWxlOi8vL3RtcC9tYWdpY2stcEE1Z25Oa1q0lv/tAAAAAElFTkSuQmCC"},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAAbVJREFUaN7tmLFKA0EQhr85bEW0NogipEw6fQILO/G5xOcwBiwlhY0WtraCSEBLo+RKLX6LXMBEk7u97O3l4n1wxXEwM/9O/p3NQk3N/8aKCixJE4nMCskVFSUgFLWAsokAJDUkdSXFWpC0hIvGT2q8ktQEMEkN4AHY8rEiY7POMnEWkRn5AFoRcO6r+MBsAmcmKQbWfUUN2AGA2ELt176Yrnc1dqEqU3kBa6ETupo4zZOV70AuAVOTe2IyBifHUaAhafDHiH9PprpTPtejya/vOQR05+TrhF5w50GWMrljM9soWsDPd98m9nlMyEQeATdzvvVCC8jjgWZi2GneJG275gtu4iRIQ1JH0jB5LrIUX4SA4KfRrIs0q56iTRwcp7OQpH3gGDgC9oDx4HoBnhmZ+NrMnmbF8N7hLB6QdCjpzuGneyvpoIgVdzaxpFNJX67mk/Qp6aRoAakmltQHdnLm65vZrm8BE/VmELDQdF00Xr0LLfstxep3wDe+O1r5DtQCysb75W5ghhHz/2EtOz3T6D7nntF9e5UYAO3IzB6BFnAJxGVXlYEY6ABtM3stu5iamrL5BtvwWrj59qrlAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIwLTAyLTE0VDAwOjU3OjQ2KzAwOjAwX65rPAAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMC0wMi0xNFQwMDo1Nzo0NiswMDowMC7z04AAAAAodEVYdHN2ZzpiYXNlLXVyaQBmaWxlOi8vL3RtcC9tYWdpY2stUzJHY0JvRjj9eDwuAAAAAElFTkSuQmCC"},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABaklEQVRo3u2YO07DQBRF3yBEaCIkWpwVsBsKVpHPTqigidgGVNASUiURn4KKgg1AoAMdCjuSecKfCbYnRu9IkZI86c6c+coWMQzDMAwjHG71BeBHwTnnH9c8W6E7YAKhO/BXtusK1ntqDT5E5FlErkTk3Dl3X9hgmioEKuQLOAN21hYAdoERMAXek88tMAQ6NQusuM6UyBMAImCREzwHogYEAE69BJKRX5QInpOaibwBKbkEu8AR8KSiPoFDH4GRx+gMqt5TwD7wouJOfASmqnRBvKQi4FLVJlULJFnHKu7OR2CpSlGq1lO1t5oE9rLaacVF5px7VX91fQQe1e9xMvI9ERmr2kMwy5wlNPTYxP2ivKr7V0agQ3xEFjEjdclsjEBSiwokZsCBV4NNCqRmYgBMiE+mJXAD9Pnlem9KoLYnsqbyWnGM5pE5A5vOv5kBEwhN5jPxpr0XytqjrZ8BEwiNCRiGYRhGSL4BoC6N/XruSAYAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjAtMTItMDlUMTM6MDA6NTkrMDA6MDA9iZOUAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIwLTEyLTA5VDEzOjAwOjU5KzAwOjAwTNQrKAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAASUVORK5CYII="},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAAMVJREFUaN7tmUEOwiAURMFFz2bjwcRzGS/SisfwuWGhCAStBK3ztvPzM9MAs6gxQgjRE5sTAHqbezBqbdLrprexpSiAEGsGGIADcAE84ICht69XAjiecdHMDjgDMzAmdhT11gF8IoCPZuY7bUrsKOph5gQc3/H4Lc/o1Rjz+ebPHKF9NDOGrzwB28SOot6UcIldOEq/d4lFb9QDFXrrAOqBStQDuQDqAbEE9UCF3jqAeqAS9UAugHpArB39H+iNAgghxH9zA6qxfIMWxnJ5AAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE5LTEyLTMxVDExOjUxOjQ1KzAwOjAwME00fwAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxOS0xMi0zMVQxMTo1MTo0NSswMDowMEEQjMMAAAAodEVYdHN2ZzpiYXNlLXVyaQBmaWxlOi8vL3RtcC9tYWdpY2stamp3QkE3U1H82j2/AAAAAElFTkSuQmCC"},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAAilJREFUaN7tmr9OFFEcRr87bCkUdOqaEC1o2QRfwEBixEAInS3GkPA0+gIGrS0QShp7E/UJxCA0uqyNNMQ5FLsQVnZmfnfm7vwh+3WbvfPNOXNnZ2furjRJcoAO0KmaIy/8AvAb6AGPq+bJC3+Z5kiMgG+ORAp8/SUM8PWV8IAPLuEMcFR5cJxzqYxRlXAhMhGoOq3Afb8kfZC0L+m7pCNJsaS2pDlJzyWtSXpQmqHHlQXgPdDO6JsCNoGflsKyBQD+ABuG3mlgt44CADGwbeiOgNd1FLiUsMxElDYTReE7BQSgfzq1DfuZBo4TOvI9TwzguwUFAHaM+3uZsH3XWyIgPMA5cM+wzyngyFciGgUv6UDSbK6pu5mWpBdZg5xz/yTtJrw9K+kgcyYCH/nr2TPO/LOMnuTTaYzwAD+MAvOGrpsS+N/P++bMKHDH2Ndj8DxR1s1cbBznw8PVBs65r5KWJZ2OSaBrHHfXMOZU0hPn3OchY+fcF0lLY5L4Zhz3yAC/NGDVkMCYJT4Zx634wCcm8BXpHMg8NYAWOb7IypB4a9zfq2Dw/0kUifVmbgY4SegotjhcAD4G1g39EfAxqaQQfAGBGNgywr9JK6pCoGc88jPAXlZZ2QLvgPsZfS36H9gTS2EWX+hllaeS/gL7kg41vKzyUP3r/OrgdZBM1karzkTgVoR8P3AsVs2dV6J+8B4S9YU3SNQfPkWiOfAjJJoHf02iuX/2KCsXzevnLJNdGoEAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjAtMDEtMDVUMjI6NDA6MDkrMDA6MDAFVHwLAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIwLTAxLTA1VDIyOjQwOjA5KzAwOjAwdAnEtwAAACh0RVh0c3ZnOmJhc2UtdXJpAGZpbGU6Ly8vdG1wL21hZ2ljay1CTjVWREZZMnby6csAAAAASUVORK5CYII="},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAAWNJREFUaN7t2DFKxEAUxvGXVUmj2NjIgi6WnsFKvIi97iW0sLHYPYC9Z9hmEUGtFAQ7CVtYC25K5W+xEcYQkhkjeaO8r0oRJr8veRNCRCwWi8VSBBgA10AOjIElbVMIfgt45nsugWVt20/xf6NEMTYZ9RlrO9vgAd60rW3wAFfa3jb4DNjWNrv4ug1bzgzY0TYbXj2GN7zhDW/4/40vCkw98Rkw0PZWFfB5AvHd+YASceMbSujjgRQYArcs/hrkxfExkJbOdb/39Wce6AMPNbN9D/QrSkxjwKcNeLdE2v6Kv19g6Pl6BDjS9lYVuAsocNO1L/EoMBeRVc/18iRJ1ros0GvArwfgRUToEt9YQEQOAtebRVMA2BCRs8D1Jl0XqIJvAofAS8DmBXgHdrX9ApwEwr8y0ra7JU6BjwD8BFjRdpdL7AFPHmMzig7vlOgB+8AFi0+FV2AOPALnUcy8xWKxqOYTHyOqDr0GzLQAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTktMTItMjlUMjI6NTA6NDkrMDA6MDAtMSgsAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE5LTEyLTI5VDIyOjUwOjQ5KzAwOjAwXGyQkAAAACh0RVh0c3ZnOmJhc2UtdXJpAGZpbGU6Ly8vdG1wL21hZ2ljay1LQzhoTFpEMoUBmP4AAAAASUVORK5CYII="},function(t,e){t.exports="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAgICAgICAkKCgkMDQwNDBIQDw8QEhsTFRMVExspGR4ZGR4ZKSQsJCEkLCRBMy0tM0FLPzw/S1tRUVtybHKVlckBCAgICAgICQoKCQwNDA0MEhAPDxASGxMVExUTGykZHhkZHhkpJCwkISQsJEEzLS0zQUs/PD9LW1FRW3JscpWVyf/CABEIAEAAQAMBIgACEQEDEQH/xAAbAAADAQEBAQEAAAAAAAAAAAADBAUGBwEAAv/aAAgBAQAAAABunvbYs/iEKXVv2mqqhit/XTQVUTm9BnSJwPPR28gido5RZbnWttvsk8Fyb6/XbJcMjjJTdzStf//EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQIQAAAAAAD/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oACAEDEAAAAAAA/8QALBAAAgIBAQYFBAMBAAAAAAAAAQIAAwQFERIhMUFRBhMUIjIQYXGBI5HRUv/aAAgBAQABPwCabpOXqlhWlQEX52N8V/0zC8M6ZigGyv1D97OX6WKtVQ2IiqOygCWGtwQ6Kw7MAZmaBpeUCa09PZ0av4/tZn6dk6fZu2gFT8XX4n6aVp1mp5a0glUHusf/AJX/AEzHqx8SlKakCVoNgAjZCjpLL9pJj3x8n7zJsrvrauwBlYcRMmk0Wsm3aOh7ieHcYYmnJYR77/e346CPdLMgDrLMod56tQ3HiJdkjeO6eEa/b1mWd9dvaG1aq0QclUAfqXZgHWXagO8fO29YcknrPNJm9LT7TM3U1RA29wIBmVrqFiA8GoNYecS4nrFsivA8ts9pnifPyMbHQL1XYJiald5pW5uJMxcsMBxlV4MS6LbPOisbbAOi8TNRwa9QxXpfgeat2MzdNtxL3rsTdZTMe6ykzHzgQNplWWO8XKHeLkNawRBvMeQlFXkoATtY8WPc/TO0/Gz69y5OI+LDmJl+Gsukk1AWp9uf9T0eRUdjVup+4IlNOQxAVGP4BMxdIzbSDZ/Ev35/1MXEpxF2INpPNjzP0//EABQRAQAAAAAAAAAAAAAAAAAAAED/2gAIAQIBAT8AB//EABQRAQAAAAAAAAAAAAAAAAAAAED/2gAIAQMBAT8AB//Z"},function(t,e,i){t.exports=i.p+"asset/4d9b56c713c5740a5ac679e3f5176a87.glb"},function(t,e,i){t.exports=i.p+"asset/6d3250b65f3d935ac4e6c8de52f9634f.glb"},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAAjZJREFUaN7tmD9vE0EUxOdFwm5iIejA0BBLSZdI8D2ghhrRAA0htJQ0iC8BEnEcOZQUtCQFkV0hUZMWIc5uEgg/ijuky7Kx75/ZK26kLd7Tm92Z273dvZMaNGhQGsBz8uNFaN1lxNfDREnxYU1UJH4xJoDrwACIKhRZFBEwBFZ9Ws0nXtJY0uUgU3s+vktaN7Ov6eSSp/BVDcVL0iVJL92kbwYiSZ3Qas9BZGYX5xkgtMpZMLMzmpeKdlQXVG3gRNK2pLuS1iQtJ20tyfWTmsWhxHY3AG5k6H8F2C06yCIM/AKeFHhQm8BpHQzkFp8aayu0gYGH3wYeAwfANGkHwCOg7akfhjJwjLPmgS4wnsEZAV2H00v6+u8G3nqe/DgDb+TOBNAvaqDMNvrOiR9IWs/A25B0f05fmVHGwKET38vBdWs/FRVR5irRMbNpijdRfGhlwdTMOinusqRJJsE1uUr8duLCOsoYuOrEn3Nw3dorIQzcdOLXObhvnPhWCR1nkWMb3XZ47WSLzLKNthzuTohz4BhYcbjdOSZG+A+ykxAGAHY9/BbwENgHJkn7mORanvq9PANWbQBgs8RyfZZ3sEUYOAWeFhC/RU2u038xBHoZ+u+Rc9nMMlD1R/1PSXuK7zaHko6S/DXF2+4dSbclXSg6gHsSN38lQsNnINOlKhB+ZDHwIbTKGXjvJnzvwKqkfcX/IuuEb5I2zOwonfxnBszsi+Ivqx1JUWjViYa+T3yDBg0aNGjwB9vWky/3vFgXAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIwLTAxLTAxVDIzOjMzOjMzKzAwOjAw5AAfJAAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMC0wMS0wMVQyMzozMzozMyswMDowMJVdp5gAAAAodEVYdHN2ZzpiYXNlLXVyaQBmaWxlOi8vL3RtcC9tYWdpY2stTHNaSjhxOU+9+nJwAAAAAElFTkSuQmCC"},function(t,e,i){t.exports=i.p+"asset/803a0389cc77d2ebff463d00fe7a431a.glb"},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAAbBJREFUaN7tlktOAkEQhkG9g4mJK134PIRLF4qulMRHRAycw0f0AmqiG+POA7k3agJyAhCZz4VjgpPqyUzPQNfEriVUiu/7u7pDqeTLly+1BVSBSdcctvAX/NQTMOWaxxaewkkI8MWRiIHXL5EAXq+EAb4NrAHPqiWAcwP8Uvj9tFoJ4EoAawELkb4Z4EXofdSW/AewLPSuA91I7xew5+Edwe97+MLAA7M5wF/GPZWR3k2gl8vOA/Uwia0M8GeG5FdGnXwdGIRDejYSWuCxkcgJ/iAv+GGJSlHhE0m4hG8AQWTYJ/AgfN4DNoQZ0r9K01Npem1y3fntGLk/J2FIvgOsulibbjRh4MQgWQFOM8IPrODDgbfCj78Dc0JvUzgJ6c50kHfetDZ28OHQMnAtQLwC80L/MfEXPW3yh9bwCSTeDBK1mOTHC59Bogr0VcBnkNgNJdzDRyTuUkjsGOClCztaeNuTUJF8CokWsKga3lbCAB8AjbHDp5VQCZ9UQjX8kMQEcC9ItA2vzZFrZkmiDNwQX7qSTykRAE3XjLYSxYA3SBQLfkji92LXXLP48vVf6xseCACbVzzZawAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMC0wMS0wMVQwMDo0ODowNiswMDowMLXIcXcAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjAtMDEtMDFUMDA6NDg6MDYrMDA6MDDElcnLAAAAKHRFWHRzdmc6YmFzZS11cmkAZmlsZTovLy90bXAvbWFnaWNrLWNoclBjNHJqCw5HxwAAAABJRU5ErkJggg=="},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAAL9JREFUaN7t00EKgkAYhuGfDhB0Fhd2szZC07IjRXeSWrV8W2Rgk5IzxvRL3wMuRBjeT9FMRERERETk3wANUH/hnBpoSscfeLgC2xnnVEDbnXUsFR94lTUiin8KqeesMjbcovu1mZ1SRgCVmZ3NbBM/yuhJB+x4N+lLjLx5gH2R+Dkj3MTnjHAXnzLCbfyUEe7jeyPCQOSlu2Lh171jI4a+hO83nzjCd/yHEcuIHxmxrPjeiOD2hxURERERkcW7A5//DCeoBxYoAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIwLTAyLTEwVDE5OjQ2OjM4KzAwOjAw5bMKnwAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMC0wMi0xMFQxOTo0NjozOCswMDowMJTusiMAAAAodEVYdHN2ZzpiYXNlLXVyaQBmaWxlOi8vL3RtcC9tYWdpY2stOHg5MFBKWkc8QlmxAAAAAElFTkSuQmCC"},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAALVJREFUaN7t0TEKwkAURdE/7kgN6gbEJaU0pVuzcSeKVpbPRmEYiIkZk/yBeyBFIAz3ZcwAAAAAYASSGkmnuTty4j/KGpHElzWiJb6MER3xvke0xN/fT6qZu7dv/E7SWtLV7U18id9G36xcjugT73bEL/HuRgyJdzMiJ36MEYsBG57J+8PMDiGEc98DQggXM9ub2a3j7HFIqqM/v8k4ZxndxHGS+GRE9YdzKkn1pPEAAAAA4MEL3XsQmdLdZMIAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjAtMDItMTBUMTk6NDY6MzErMDA6MDBwK09MAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIwLTAyLTEwVDE5OjQ2OjMxKzAwOjAwAXb38AAAACh0RVh0c3ZnOmJhc2UtdXJpAGZpbGU6Ly8vdG1wL21hZ2ljay1rMzFTQ1d6VNROrskAAAAASUVORK5CYII="},function(t,e,i){t.exports=i.p+"asset/b1b3827ea80449938c78fffc6aad1207.png"},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAAPpJREFUaN7tmEEOgjAQAFHwh4SD/s5IPPBDMRkPlqQhYCzdtYvZORJTZtrAEqvKcRzHcZydANTAFbgorN0Cd+CkKd/z5ikZEeTHsPagEhHJT4xAJ7BuF8lP9BoBLfCY3SjrJGY7H695Fg+Qjvi5vGREMXmJiOLyORFm5LdEmJNPiTAr/02EefkoYmkgjSvXsgegVsTSSdje+YQIFfmjUsch8boNVh7Y5GFXSn6/D/GnV2XKsDMnP/uNvYiUIWUuYsuENROxRd5MRI588QgJ+WIRkvJFIviDv1Vq4Cax8wtrxycxAI14QLhRE05C/FMgnESvJu84juM4jgIvJPHlXUrVOPYAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjAtMDEtMTlUMjI6MTY6MjcrMDA6MDBLg8SlAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIwLTAxLTE5VDIyOjE2OjI3KzAwOjAwOt58GQAAACh0RVh0c3ZnOmJhc2UtdXJpAGZpbGU6Ly8vdG1wL21hZ2ljay1HLXJuVWpNdG+jxMoAAAAASUVORK5CYII="},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAABgAAAAYADwa0LPAAAA6ElEQVRo3u3Z0QnCMBSF4XOLr6Jb1A10QnEadQHfXUGXqMYBji8WFJtg0tJb4XyvheT+pIJtARGRySK5InkkGZipY61cgeSBZN1n+KZg46ECWk0qoko07AAsve+C1wzb2EVLnEAAMC/d1cw+1u46lQzBzBa5AX02HDrga71WlbvQ1CjAmwK8KcCbArwpwNtsrI1i/2X6+vsTUIC30X4Deh6IUIA3BXhTgDcFeFOAt1TAw3u4N/eSgJP31L/Mkno7XQM4o/AbwYBvp28A1mZ27boYPQEzuwDYADgACIWb9xEA7FPDi4j4ewJ/ORwfu1q3ZgAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMS0xMC0yMFQxMTozNDoyNSswMDowMGpif+EAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjEtMTAtMjBUMTE6MzQ6MjUrMDA6MDAbP8ddAAAAAElFTkSuQmCC"},function(t,e,i){t.exports=i.p+"asset/9eaed4c46748027ffec97501ed59d2e3.jpg"},function(t,e,i){t.exports=i.p+"asset/95d9d8661eedc9b13c514be222df1dc7.hdr"},function(t,e,i){t.exports=i.p+"asset/f3b7e667b08daaf0e8135a93e85ec000.wav"},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAAidJREFUaN7t2L9rFEEYxvHd+ANiwFhYqZDEwjR2KoKK2vkXpFSsbP0HLBRSWKSxtLWLKQM2topF/FXZRsGIhTZynlHIfSxujxznzu7cmru9wH7h4Nj3nXeeZ2Z2dmeTpKGhoaGhoQZwBut4jrN16xlG+DE8xLZd/uAxjtetr0j4FG7hqzDfcRcH6tY7KP463ovnA27UrTvBAtYKhG5mvxBrWKhD+BHcx6+AsJ9ZfBqHs2XzI5D7G49wNNRZJQK1UizhU6BZB08xl9P2hO6NvBNou4U7mBqJAZzHi4Imr3ElYvbK6mzg8igMdAKpX3D7n5ErNpHiJj6HZrKXG100gjRw/VCSJLMF8RDbSZLsDNlXdSIm7c0eLaHcFTAOAz3WVbuJx27gAdqB/lu4p7uNTmf/W4HcdlZrvAaya3NYLRjITcUPstXebEUbiF0HMQb6YhfxKrY23uJqbP2RG8jiMS9z3wRe5mo30Jc3i5WckiuYHWaJJknOflroro80TdOidoPxsn6q5h8sEzbp7OWTuDEwUQYwPxG1qu5CSg4iMbuW3YNROyb/fw2EXqe3dPf/tKjuQCzN2mwFanbKdFcxcM4QB5pQPVzAy4I6G7i05wb6Rm4JH0Mjp3uknM+JnVTlSDkKMINl4UN9K/KarMYyZkYuPMfIKTwRvj/KWMfpsQvPMXIN74YQPhkftgZM7N9PiwNG9ufH3Rwji3iW/Rbr1tPQ0NDQsD/5CxOIdNeKa1dBAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIwLTAxLTEyVDE0OjE1OjU2KzAwOjAwilmssAAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMC0wMS0xMlQxNDoxNTo1NiswMDowMPsEFAwAAAAodEVYdHN2ZzpiYXNlLXVyaQBmaWxlOi8vL3RtcC9tYWdpY2stWkR6NG91V3epC+voAAAAAElFTkSuQmCC"},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAQAAAD9CzEMAAAA6ElEQVR42u2X4QrDIBCD++bNiw83oZBtwbaYS+lguT9Cr/k49RSXv+6uhlesb4Etisx3ZGPoFMCI/eNjilSGPbrtt4Fg0CbnfpChmDnAqWypwa1As2cAVLYC/VXXwAAoRHMcgFowKAvQR0eCBejaNWe2AQCnSFqrEAAx9PsgDeiKAahjgN9oAwDHIQDqO5lfY50MtY91MpEuYL3mqMA1RwUrWn8YUNXJXMRsJ2MMYFLgqBCZAL3RKIQufebkjorSK1OnKL9NuyafIGcBsocmahgD0KiSJyC2UAWesJY9EQg8YRUzjOUmegK96kb7n3uW4gAAAABJRU5ErkJggg=="},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAAKFJREFUaN7t2bENwkAQBVEfdUBMm4S0Ah0Q0BFCOlHAEIBjDnN7K2BeAdYfS97E0yRJPwHY0W6fvfeT8V0jyhsjGflSSilN21YjR0UwQP+u+QrNoq9R6/WZff03YEA2A7IZkM2AbAZkMyCbAdkMyGZANgOyGZBtScAtcE8dEXAODDgFPvsB2ALXBT80XrkA6/CAZ8QGOAK1w/AKHIaNl6Su7pskJC0jcnt5AAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE5LTEyLTMxVDEwOjQ1OjE0KzAwOjAwyymXkAAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxOS0xMi0zMVQxMDo0NToxNCswMDowMLp0LywAAAAodEVYdHN2ZzpiYXNlLXVyaQBmaWxlOi8vL3RtcC9tYWdpY2stbHpsN1lFQm27JqnIAAAAAElFTkSuQmCC"},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAAXBJREFUaN7tmDFOw0AQRd+kxxBoSZ0ytNQU1EjAPRDnQNwDkKgpUtOSMnVoIYo5wFDYRRTtjjDYHiPNk1z9tfW//1r2GIIgCAaLqk5U9UlVS+2fUlWfVXVqeRTLPPAGHDrfxzUwE5FVShwZJ94PwDzAGLjLiVYDJbDn7b6mFJH9lGA1kDK/Ai6Boj4ugGUPAYqcYDWgCfMnIvK5s24MLIBJlwlEJOl11OAaN7vm6wuvgdsuzZvBckKigUJEvjJrC2DTqdEWGvjVjeiaJgHODO3cK0CTLbQETus9v73uiOqFd9yp0Ra20BRYqOqVqhb1cd2HeTNYTkg04ErXD7EbEcCbCOBNBPAmAngTAbzxDvDnGdvzY67RjD3Ej7lWZmzPBhrN2ENswOLHM7ZngFZmbM8t1GjGHuIWamXG/i8/dzcicpASrAbm3q63eMkJVgNT4JXq/7wnH1QvvPeUmG1ARJbADHgESgfjJfBgmQ+CIPDnG6VmClOe6RTIAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIwLTAxLTExVDIyOjA1OjE4KzAwOjAwau5IIwAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMC0wMS0xMVQyMjowNToxOCswMDowMBuz8J8AAAAodEVYdHN2ZzpiYXNlLXVyaQBmaWxlOi8vL3RtcC9tYWdpY2stMHlpaVNhQmkIPX+EAAAAAElFTkSuQmCC"},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAAWFJREFUaN7tmDFOw0AQRd/QY0ioqVOGO1BQIwi3QtwDkKgpqGkpSYtpEYo5wKfASIB2F9ZJmBTzJFcz/vrf64kyhiAIgo1F0r6ka0md/p9O0o2kScmjlcwDD8DY+Tm+AlMza1PFrcKNFxtgHmAEnOeKpRPogG1v9z2dme2kCqUTSJlvgVOg6a9jYL6Esb/qNdXKiaF6kjRO9I36Wi1VeqsIcFLonQ0IUKWX6y3NwM+bGjN7y/Q2wKLyGVXpmVnSa2kGarDlJYbp1QQ4LNSOBphctd53Eu/so6RRom9PUjtgBqr0VhHg85djJqnpr7OB5qv1cj5rhtiVdQ+xGxHAmwjgTQTwJgJ4EwG8qQ3gtRPXk/nnGDvxUL1cb+zEvz2IdevFTqzYide3E2/Sx92Fme2mCqUZuPN2/YXbXKF0AhPgno/v8568AAdm9pwqZk/AzObAFLgCOgfjHXBZMh8EQeDPO2cJSEBo+L/pAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIwLTAxLTExVDIyOjA1OjMzKzAwOjAwKswbpAAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMC0wMS0xMVQyMjowNTozMyswMDowMFuRoxgAAAAodEVYdHN2ZzpiYXNlLXVyaQBmaWxlOi8vL3RtcC9tYWdpY2stZUtoSHlxZW6K8iigAAAAAElFTkSuQmCC"},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAABgAAAAYADwa0LPAAAAzElEQVRo3u2YQQ6CQBAEid/Ao/p3QnyBPkkS4QPlBS8a0BnohUNXsieKYftA0pmqMsYYY34AHIEWGMZzBc5b+ZnLd3zTAXVpPxOgZZqmtJ8JMMx84Fna/+TwT4ZoZrEfDnCfeXbbwI8BXIDHxE92Ku1nQ9RAA/TjaeeGq31jTBCUXUU9H3FXUc+XdxX1/MVdRT1f0YXCGZa8rOhCUfbVhfY2//0RaVdxFzJGTLSrqP3M5b0XWsvPBPBeaGU/HMB7oTX9bAjvhYwxxuySF62TQihRFtj+AAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIxLTEwLTIwVDExOjM1OjQ5KzAwOjAwhG93LAAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMS0xMC0yMFQxMTozNTo0OSswMDowMPUyz5AAAAAASUVORK5CYII="},function(t,e,i){t.exports=i.p+"asset/bae7e15e100d6f9768011284b8718b97.png"},function(t,e,i){t.exports=i.p+"asset/94d5346a238c9342e70800e45549fcb9.png"},function(t,e,i){t.exports=i.p+"asset/d368a580eaef8cf5094e34aa77be7df4.wav"},function(t,e,i){t.exports=i.p+"asset/512b902b67861f7dc441840e1c20e6af.png"},function(t,e,i){t.exports=i.p+"asset/8eff8be65a5ea9081c0405c34402fcbd.png"},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAAO1JREFUaN7tmDEOwjAMRb8RKwMHYGaEIzJyFuACDMycgZ21A+UAZgEJOhDTJvlU+m+r5MT/xZ0MCCGSuPvC3Q/u3vpwNozwTYbgHInny5egjkSm34Yn0e2Y6543tmMXKCtRSaCcREWBMhKVBfJLEATySpAE8kkQBUISFmn8ccAseSZyT5RUv0nfF/0XprUaRSf366RGPwEJsJEAGwmwkQAbCbCRABsJsJEAGwmwkQCbyFbiDmD2+hiy3OrBLVUQmcCpYuAux1RBZDO3BHAGMK8cvgGwNrPrt6LkBMzsAmAFYA+grRC8BbCLhBdCAA+MkEeokjDYTgAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMC0wMS0wM1QwMTozMTozNyswMDowMBIov48AAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjAtMDEtMDNUMDE6MzE6MzcrMDA6MDBjdQczAAAAKHRFWHRzdmc6YmFzZS11cmkAZmlsZTovLy90bXAvbWFnaWNrLVdtbHhtYlNBOBH7WwAAAABJRU5ErkJggg=="},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAARtJREFUaN7tly0SwjAQRr9lsAg0VCPhiEjOwBEAyTCDQHMGPBZBOcCHQTCdbkgT2i3DPtn87L6kTbaA4zhObyFZkNyRLFmhhVjvLL+V/I0KLQvkS7xWnrkCseOVbukSda+NgUC6BD/QoQBJrrT5JRQ4lJiICCLQ5qmOT403iF3JvuIC1riANf8rQHIa008UKnMVnQsAWMdKfFiIAsA6dXzyRdY1fpH1lZ8XUAlUhnuSkxbiTUkecqvfGIHskycQs2gq0PgUii2jMyQaxf35b8AFrHEBa1zAGhewxgWsGQbaHgBG1YdGf2p3rSG0AyeDRDWOWkOoGp0BOAMYGyd/A7AQkWtdo7oDInIBMAewBVAaJF4C2ISSdxzHsecJJ1IByn1sSO0AAAAldEVYdGRhdGU6Y3JlYXRlADIwMTktMTItMzBUMDI6MDU6NTIrMDA6MDDPURp+AAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE5LTEyLTMwVDAyOjA1OjUyKzAwOjAwvgyiwgAAACh0RVh0c3ZnOmJhc2UtdXJpAGZpbGU6Ly8vdG1wL21hZ2ljay04VDdzSzZHemzxKBcAAAAASUVORK5CYII="},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAAdlJREFUaN7tmL9rFEEcxT/vUFFIEFFSaWOTzlgoWPgDNH+UZf6B/B2CyX9wXqOoha2NhY0KKjEIZ/BQMM8ie2GczHm3q7uzB/PpZr+zzHszb3Z3FgqFQqFQiLB9xfau7bHrs9UH8fsNhPfDRDXz/4M8JhrGJpsJJQw4y8yd5BswAh5KerOMBqZ8BTYkvU8VB7nVLcAFYHtWcRlWAGAs6XyqcGrenZI0r09OliFCxUCvmbsHQmwPgM/ApdzCgU1Jo7orcL0n4ifAC6gfoQe5lVc8lTRZZgPDmZX4ayy4fsb2QVD6Zbv1ONke2N6LZF1rYuBeVHrVxVTbvhGN+8n28cu1ToTi+DzpwgCwGbWHko4n9l8MjDoyEI87/GvvVIRsr9r+GVye2D7XtnLbZ21/jyRdDvssugJ3gdNB+9n0MdYyd4Bwol5L+tDEQG/js6iBeCNl28Bz70gczNdsHwbtL9U3UavYvli9a6b8sL0S91tEyH3+PLmNJB22bYCj+IT6nks6aGKgt/lPkojQ26h9tQv1iXFvpvqlDvVjYLULkTXYB9ZS0U1FqKuI1OHxrH2XWoF14CVH/2P6wEfglqR3qeKJFah+420AO8A4o/A94BFwe5b4QqFQKBR+A4/PhHYKP7oJAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIwLTA0LTIyVDIyOjI3OjI0KzAwOjAwO4AuhAAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMC0wNC0yMlQyMjoyNzoyNCswMDowMErdljgAAAAodEVYdHN2ZzpiYXNlLXVyaQBmaWxlOi8vL3RtcC9tYWdpY2stRjRDS3ZFZXaljae+AAAAAElFTkSuQmCC"},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAAL1JREFUaN7t1rsSgjAQheENY6WW+P4PgFjqgyG2x0YLMpIbMJGZ/2szu+SECawZAAAAAHgkXSTdJD01b5DUS2p/1E/E1mNKAvQZ/btaAVwgwGhmx8S8o3Pu7G9w8iDnXGg9xq//agI1qZs3MzvlbGZNh6UnsJbS/k1J0T8hQG3Jd8AX+8os7Zfac/dvgAC1Jd+Bonkkwxb/gVdGn3HLcKUBHhl97rUCzJLUSrp+RubQON2tMU7XzgsAAABgf97PvEWqPqcFGwAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMC0wNC0wOVQxNjo0MDozMyswMDowMArbNZkAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjAtMDQtMDlUMTY6NDA6MzMrMDA6MDB7ho0lAAAAKHRFWHRzdmc6YmFzZS11cmkAZmlsZTovLy90bXAvbWFnaWNrLTYwQlRlTVpPnxrKNgAAAABJRU5ErkJggg=="},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAABOElEQVRoge3XsS4lURzH8RMUuKFihajQUHmFfQ2VB9lQbSEKDYlCpVFpRKH1BBoRsRIVxRVbbWfNR+FgEhJciXNH/p9qTjW/751i5qYUQgghhNB9sIC/OMAgejBZete7Yc+DW0xjNZ930VN63wvoxyaW8q+9nwf/xwyO8/kOI6X3voDl2uDZVwJOagGjGMBc6d1PsO7Z/DsCDlFhpfT2lFJHAY+q0ttTSp8KUHp7SikCyvtuATu4yNcVtnFTO291e8CHfPXQPvzEVOMC0Ivf+b5Vvm41KaCFs9q9K1xiERtdH5AjRjx/mNX9a0RAjhjCUaeDiwfkiGGcNzYgR0zgqrEBOWLc555Eu2hAjviB0w4DfpXen1JKCWNof3D8H930/zg/iTVcvzG87eElOFp6cwghhBBCCJ27B0k0XSsZCUVAAAAAAElFTkSuQmCC"},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAACPElEQVRoge3XO2gUQRzH8csDzcMEgknER6OmUFGxsbMR1NrCShAEC0XQWlC0slALLQxEsBAbG7UQEUttLRRBfCSCb4WIghqjIfE+Fjshy3GX56yHMF84uGX/85/fd3ZvZ69USiQSiUQi8Z+BJqzDtnpnmTNoxFE8wDk016jbi6+4i7YwbtUMvTeHnn1FhW/AHjzD2zBZS43aWzLGsTbUwg001hhzB2P4XpTAxhD+C26iK3euBQM4GVb7dgg8gT48Ccd/0F2j/0GUw2df7PBtIdQ3PKq8HXAqF3h9FYGnOYEetGJDlXnGgsBgbIFdeI9P2F3l/EVTbJmFwP0Q9ExFn8eh5kfM8G3h3v2M62iNIDBJuaLPgVAzjqZYAtsxhBfYVKNmvgIq+nSG8BPYEUvgEt7hChYVLNCC32HckRjhO3EvBNg5TV0sgWaMhnHHYwgsQT/Oo6NogdDrZxh3NoZAI1ajd4a6vMA1vArfy7gq2zsmjy/PIDASRAcWLDBbKgTmREWfxtwVuFBE0GbZU2lNQQJd+BWuwKHY4ZtwOsxbDt/bIwtsla3+BFbGFmjHYG7uMj5gv+yHHkOgX7b6o2JtZBUTdJt6McszslAB2Y7/Rrb6D6OHz03UIXuhi0Kubxdey15ZlhYmECbrxMvIAotxDIfRUKhAmHAFPkYUKD50FYnlFnYlhv956CoSvXg+T4ET9c5fKpVKJSzD8BzDD6nx/7guhCtxXvYUmY5h2SbYU+/MiUQikUgkEonE/PkLpk0BAHzxQTsAAAAASUVORK5CYII="},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAAiNJREFUaN7tmb9rFEEcR98GiYeCWigWMRbmLARtFMTCxh+pVDwQEREEQRsL/wCL/AVaaSOChZ3a2sZCLKJYR8EkgpdIVLCxEEV9FhnhctnL3a47t5ewr7md7+zMfd7tLLPLQUVFRVTUhvpO/areVofKzpQl/C71u8u52tK/SR1XD5WdtZNAw5U8DH07w5X5x4M83xH7cm5MqQ2HzxtAvaV+RT1YioC6Vb2rvlTvqFt6GDaWUqv3MG4ZG4oQAO4BF8LxYWA7cDHHPEnWAUUtodNt7TP/O6E6op5SR/ohsLlLO2v4BjADPAVm1LOxBYrmFlALx7XQXlMCe9raY51OHFSBpEt74AV6phIom0qgbCqBssn88JSGakr5CTAKHGmrN4GpUB9t65sK/edXBE2S1KwxBQqlk8CaX0LrW0A9p75SHw3si/cq4a+pv1teuv+oj9XdKedGJ2v4SyFwGt/Um2ptkAW2qa+7zNlUL6tJmQLJKhI7gEngQBffF8DRIpdvatA8+0CQeAbsjx0wr8BQl0FfgBPAdNkCnei6DyRJ8hk4DrwpO2wugSDxKUi8LTtwLoEgsQiMA7Nlh84lECTmgWPAXNnBcwkEiSZwEvjQx5w/CxMIEu9Zuifm+ySwUKhAkJgNEh/7IDAZbWZ1r7oQ8Snilxp3I1X3qYuRBCaihm+RqKvTBf/yE2ohr729Sgyr19XnLv2tmpUf6px6P/qyqahYJ/wFFg6+vN0cQV4AAAAldEVYdGRhdGU6Y3JlYXRlADIwMjAtMDEtMTVUMTI6MDY6MzErMDA6MDD+NNjSAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIwLTAxLTE1VDEyOjA2OjMxKzAwOjAwj2lgbgAAACh0RVh0c3ZnOmJhc2UtdXJpAGZpbGU6Ly8vdG1wL21hZ2ljay1WcE9XcDJ6NJr9ciwAAAAASUVORK5CYII="},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAADPUlEQVRoge3YS2hdVRQG4NubpE17bTDYRivFN/igkU4KDpwoVocWLAiCIDhQfE4FRSc6UAeVYiFVByJCJ8ZBFXWgoBOFgpWK2KYR2vgqpFRtja21N/dzcFbJ5pj7PuE6OP8o9997rfX/e5+91yaVSokSJUqUWEmghvtw/6C1dA1cjTn8g09QHbSmjoFLMYMGFrEfawag41o8geFuA98M4Q0cwvpkbAg34fbCFf9Xx2c4i+PdBG3DmTAwgw3JWBVP4QBebbYyeAC/xae3LuI2t6l7a+TcmXAfW8LTnYgfiaL1ELAlGVuFnTiMH6PYaJM8+6PoBVwfc2G62VnCRziPMzm+HrHnOjEwid/xN17MjW0J8afwPsaTsVFM4flY7Q+jaB034Lv4vZjuaC7/I/HJNvBgwn8QsQ1samdgL87F7TOR8OtC1Gl8k/8c8EIi+OZlDHyfGNiItbhlmfrnQ+jRhBtJjE21El/Dt7ED+dW/Gz/jBHYsE/u6JWztwMAXIejlXJ5DMefPHH865h9sZWA7fsEsrsmt/jRO4j2sLcDARTRyeR6OORcwlPBHwsCxVgZ24zjexUjC3xGmZjDZJLZXA3J5xkJ8HXcl/IEwMNfKwBuya+vOHL8XP+FtrF5hA6OyC6SOJxP+6zBwpJWBe3AvarkV+TwEbG8RW5SBYVnjquPZhD8csc3PQBNhl2APdkm68UoZiFx/RdwrCXcsduDTbg1UZe+RiTbzUgP7oqAo+o6sd1z8/VYbAwthdCrhTgQ33ZWBTpEz0BVyearJDrwW3Bj+0K4PdCh0WHYrXbdCBsZljXQRjwZ3lexJv4jH+xE/hJeibiP+rhVsYJts9eu4LbgdIb6Orf0YqOFoUrsha3wPyQ56EQb2hNizuCK4fVFrAZf1bCCSbbD0MEux0K8BWcefk630weCqsubawGxf4pNC62UPukKQ5B0PsSfFeyu4U7IzsLsQA5F4DD8UbGANnsFjls7WanyJr3BjYQYi+ZX4tUADq5rUmcRmyeOuSBOb9LcT84WL6sHEhOy52wueG7T+SqVSqeByzHcpftb/6X9NsRO7ZLdIK8zLmuDGQWsuUaJEiRIlSpQoUaJ3/Asxv9EjR7dnowAAAABJRU5ErkJggg=="},function(t,e,i){t.exports=i.p+"asset/50c285a075449f4d50a621686af196f4.glb"},function(t,e,i){t.exports=i.p+"asset/77d21d25c79056012b0da69ee2dedf95.glb"},function(t,e,i){t.exports=i.p+"asset/6f95ef7d64cecd4560f9047d65a4dea6.glb"},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAQAAAD9CzEMAAABdElEQVR42u2X243EIAxF04U7oRwKohnaoQnXcPdntKxsksOOMlK0WvhM8Ln4AebQ8dl5/APuARQ1dQ25JMk11NVU7gCYmlxnY6jJAADGxWMNYUCdynG46m8BLRjoqiovpaaiqh4EtH2AqYO6ucuhOfouoIOusNdrxNUCV9lMYp+CCFA1U9BSLQy5XCPVgGm6ql4B7FuLB/MtJyevzIAWnZOjcurxEtEZYPMXUE//WQAk/WtlQ1Um+5mcYacjgAPAl2Fqi6BbMBVTZKwAJeiPquqFqRzqkgEthC7uy4KptZwed5Y/TaV5MqBGmdkVXL3Z0Jwlug5cgYdDpZ3NT6+xpd6T/mTnfUALlQwAcBGY5+BzkPG84SBzmuaq5uzaLDSuaig0Oiq4qumoAH086YQCD/Pk45ovHKgVuHDgygQApDBc+gDAldy2AIDals83Xtw6+g2tIza/47QuLDa/j2nf33qAPPAJNSHj+hH48GfsX3npPxnwBZx3QsSvG+I6AAAAAElFTkSuQmCC"},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAAnZJREFUaN7tmT1rFFEUhs+s8SvaWKuNGLUIomliZ6WLuqRV0f9hJbughZWIoGBjo/WidpIihhi/k0KDYlDsNV0Q1GIfi72Bm+Ps5N65uzmLzAtb3Nn37D7v7Jlh7lmRSpUq9V1AA5gFfrrXM+CcNVcI+CjwmN56BOy05iyCn2NjzQ5lCOBeAPya7lrzaviGAuwAN4F97nXLHfM1HNcEUAPeK7hmju+a8iwBNWt+AS4psHd5YC7ogvJetOYX4JWCOlXgPa28L6zhx1RvfwKyAn8GfFYhDqUwpPbgZRHxgR9kWUYvs3vvoTps10bAS3U2jwbUHFc1z63gdwF/PJDvRe3j1WXAD6/uNzBaliOlhU6IyFZv/baofdbkPAveoW0iMmkRYFytFyNqtXc8orZvAfTd40tErfaOWQTQX/otovarWh9O4CgWcCXiIU2rmU5gF8IG3gO4kRCiqWpbCb/iOsUEKBtiYPBlAsSGGCh82QChIQYOHxQg4lrxQwzH3aZEiBbQsuawCH5SdcbTsp/Vtz0pMBJhP6DWy5seAG/fC9RF5GpEuX4MKR0g5qxpTQJ7RAQRaYvITETthFovJXCUE91J3Crwy/XxCgFjErobmhWv/5M2NKkhXquL8VhAzYSqmUthSL2In6j1VEBNQ62nExnKCziizuZHNh6rLHv+DnDQLICD0oOteoG3rrzzpvAO6ryCegNsyfHVgEXlvWDNL8AI/07b8oa715XnQ8hda7NC6NaA7nh9L7AfuM36EWQHOGvNrUPcJ1x3rHnzAmwH5gPgZ4Ad1ry9QuwG2gXwbYbx/zEVIgOmgGm6M9BVd9bPWLNVqvQ/6i8772ivC/ipNAAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMC0wMS0wNVQyMjowNzo0OSswMDowMNMbGgoAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjAtMDEtMDVUMjI6MDc6NDkrMDA6MDCiRqK2AAAAKHRFWHRzdmc6YmFzZS11cmkAZmlsZTovLy90bXAvbWFnaWNrLUFjdTdLb2hnT74tFQAAAABJRU5ErkJggg=="},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAASNJREFUaN7tljtOw0AURe/QpmYPiPSwnWFP6c12oEQyK8H1obARAWfwfGI/I70jpYo0Ok+59yqS4ziO4ziOswlABKK1R638EfiYPkdrn1L5A9DzTQ8crL1KDuiY01l75cpH0kRrvyX5r9yn2G8fLuQ+xT77kMh9im37sLTnC7m37cPSnmfk3q4PZOz5dMBQccD6fSBzz4GnygPW6wOFew48NxwRyw3/li/ec/JnNOu9FvnqPWcPfaBxz7HsA1facyz6wBX3HLilPkrlfaCtgHCWX+AOeGt468d7a+Q+RccYwZpf8eJ7a+Z+K2Z9CL9zL+lF0v7+3o4Mkh5DCP3sAMaMvUq6t7Zc4F3SQwhhkKSbsy9O/0Bek+PJWsJxHMdxHGcPfAIYY4IxTCaXxwAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMC0wMS0yM1QxNDoyNjoxNiswMDowMIE0tV0AAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjAtMDEtMjNUMTQ6MjY6MTYrMDA6MDDwaQ3hAAAAKHRFWHRzdmc6YmFzZS11cmkAZmlsZTovLy90bXAvbWFnaWNrLUI0TmFYSlFoHLzcmwAAAABJRU5ErkJggg=="},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAAkJJREFUaN7tmLtrFFEUh7+zRjAWKXTxkYiCEOzEKp2uktbS2kaNYiHY+FeoXRTcTRu0tpM1NrEOKOID1KDCKj5AUHyA87OYuzBZZrIzu869I8yvm52dme87e87duwt16tT5r2OhASS1gKPAG+COmf0KzZQXvCFpURvzSNJMaLY88CbpptLzotISQ+CTEtOhWUeF7+d55SQkXc4J389TSXtCcycFJiV1C0o8k7Q3JHRDUlvSGXe8XdL9ghJPJO0MBd9xEH8GJFYKSiyHhFdC4uyIEt8kNXzBm6QbGSCRpIsJibzt1KsC/DgSV6oCP4rEsqQtVYIvIrGksnt/RPg8Ep2qw2dJrCj+7vACf2tM+KTEgrvvpKRyf6v8Y/ikxLFSwRPwi2PCpsVb25QB721ga/gaPpFcS5WkKeA4sB+YBvYBh4C5MZ7dBs6bmUqt/iZSs1Vom4kcoNeBE8Bb4j+f1s3sKvBxxGe2gQtmFvmq9KuB6kWStrq5+F2w8uVvzAbgD2aA7Hbne6Hhh7XQfMbrTeADcAk44I6bwCyQthXoEA+sn7bpR9LtjGq2Mt5/xHfbZC6jineD74FdKacfA6+Bz8AXoGdm1yQ12TjcS8CC98o7gcMF+juStM1d993nwG42A/O57xJ/kjPAS+AdsAqcC1L5fiTdLbhEttx1p70ulRnwE5K+FhQ4FYI1q4XmgKkh134CHgBd4J6ZrVdJIK3/fwAPHXAXWAva4zkEImAtAbxqZj9DA+eKpJOSdoTmqFOnzvD8BQ88Z/0vQxtBAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIwLTAxLTA0VDAxOjQzOjE2KzAwOjAwJk2OjQAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMC0wMS0wNFQwMTo0MzoxNiswMDowMFcQNjEAAAAodEVYdHN2ZzpiYXNlLXVyaQBmaWxlOi8vL3RtcC9tYWdpY2stU3pHR3FHbzO5iYiAAAAAAElFTkSuQmCC"},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAAQBJREFUaN7tmjEOwjAMRb8RK0Iww9yRkyLOAUJiZuAO3IEVgRoO8FkYIEsSya6p5Dcn1v/+lRs1BYIRQXJN8kgyUZ9E8kSya9EkLeIBXAEsjfv0BLARkVvN4klD4d0A4gFgAWBbu7glgQRgNoABAEgiMtc2wJ+NItV7Leu3PEJ/SRjwJgx4M9UqlE+RElpTLBLIKXW2NakSo08gDHgTBrwJA96ovwe053yJ0ScQBryJs5A3YcCbMOBNGPAmzkLeqCWg/bW6ltEnEAa8CQPetEyhF74u+YznfV+7sCWBi6HgnLN6RZIdyYfBDX3OneTKpC2fXw0OJHsD4T3JvZn4wIg3JGNn6fQiSEQAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjAtMDItMjNUMTM6NDY6MzYrMDA6MDD1gfiSAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIwLTAyLTIzVDEzOjQ2OjM2KzAwOjAwhNxALgAAACh0RVh0c3ZnOmJhc2UtdXJpAGZpbGU6Ly8vdG1wL21hZ2ljay11cTA5VTlORZCUaKUAAAAASUVORK5CYII="},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAQAAAD9CzEMAAABH0lEQVR42u3TMU7DMBiG4QikLu0RygpsMFGOgUDQMyG6FK6AIqUSpccJgm4dUanTDtleBuuXlxBT/x6g9bMm8SvF+rJ9QYchOSUbNpTk3NEhi4Yb5gjxwXWUBIeM+MkDB6gDI9rco/45ombMgC5dBjxSI65QXe0ca8EZmcM5C6x3xXUzxKpxx7tEjXUbHsixxjQ9fcJ6Dg+8YV00Bi6xyvDAGqvXGOhhrcMDwvM8BWIHOGVGxbYqXjnhV8d/EWrJEd7ADI2JP1ChYdBdrP+7FEiBlhdl4bLYyAFZuFusOtC+8Ik+0L5wEz9gAGcVPzAFnCJ+4Jgl4pN+3IAkXjAYCvr8y6GlwO4EDBorf2CKRuEJyGJDyMJ9ZLFbkoUnf883msQJ0skP+GIAAAAASUVORK5CYII="},function(t,e,i){t.exports=i.p+"asset/002d4e6a64b981d876bba15011ebe8f3.jpg"},function(t,e,i){t.exports=i.p+"asset/219d54764c13859e7962f385bccbce96.wav"},function(t,e,i){t.exports=i.p+"asset/33754174eaedfcf53badd07d140bfb8a.wav"},function(t,e,i){t.exports=i.p+"asset/50089db6942bfc2398350f67370c34ba.wav"},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABBklEQVRo3u2ZwW0CMRBF/6BcUdIFdMBWiKgmSwOcoYWkCjAFfC572HgNlhWssaX/jiPb+t/j2dHagBBCNAfJLckjyUB/AsmR5Cal1VLiAZwBfHlvZMQVwGBmP/PgKjHw0KB4TJr2cTCVgQBg7a32CcHMPnMG+GeAmeVWrUlOz6psufaQAW8+SifEZzImPqO58bn5ObrPgAx4U1wDpdTuI91nQAa8qV4D6gMy0DjFNVB6RtUHZKBx3v4/8F/UB3qjewPV+0Btus+ADHiTqoE7Zpe7tb/7hdziQCoDJ2+VL1hoS91ObwBc0N4bwRXAzsx+58FFBqYXkAHACCB4q540fKfECyGEPw/0PMxf4Bi9hgAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMC0xMi0wOVQxMzowOTo0MCswMDowMJiu/RMAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjAtMTItMDlUMTM6MDk6NDArMDA6MDDp80WvAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAABJRU5ErkJggg=="},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAB0klEQVRo3u2ZsWpUQRSGv9GFNEENukgKEQWxUJA0MYXoAwiWsRDxEcwLCBYa1C7gE2iTTggWMZXYrYg2tloaMBAtFkEwfBZ7hfHCdbO7d5gNztfs7Dnnzjn/DGfmwoVCoVDISagbVHMX9c+CQ/ir5kO5C5qUIiA3RUDhfycMC8h9L9TP/ToHvgeKgNwUAbnptDTPDvAW6AEfgM/ANtCv/LPAPHAWWAAuA4tAN7lCm/mkrqlX1KHHccPcF9T76rumJMPmGPseGHY+R8/fBLohhKcp8iTrAbWjPgPWgd1UeVI28RPgdjXeO1AC1IvA3ci0lErAfooZubmq5o7ZVU+1nQda3gH1mtoBrtZcc8BL9XSidZ58ZdST6qtqvN3w2Fd1aZI8ddrcgRXgWDXuR/YX0bgLbKrzbSVtU8B14JI6B7yP7M+Be9H/o8DqNAo4A8wAj4Avkf18COEBg2P1DzfGvb1HZoQe+NYQulb5j9Tsx8fJk3IHeg32rep3NrL9Ar6nXPiRV0ZdroX01eXI/zjybYybJ6WAw+rrWlhPfahuRraf6uLUCahiT6hvbOaHemvSPMkERDtxR91Sdxy8Rnx08Hpxrq08hWmhfKHJTRFQKBTy8hs1NuJt4VXIYQAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMC0xMi0wOVQxMzowNTowMyswMDowMDcwCfoAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjAtMTItMDlUMTM6MDU6MDMrMDA6MDBGbbFGAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAABJRU5ErkJggg=="},function(t,e,i){t.exports=i.p+"asset/7871d032e72ff2f075d9fa9ce0bde9ac.png"},function(t,e,i){t.exports=i.p+"asset/2083a2933e830b467798ff73222d9e72.glb"},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAARdJREFUaN7tmL0uBVEURtcWiUSp8AAajyASGqWGTukxtN5APIWorl6iEj+PoOABJFeL5i7V7UTcmWPmHNmrnuz5VjHfmbMhSZIkSZIKUc/VpYLzvqXrc7994URdbVlA9UFdb1lA9VndbFlAdarutiyg+qEetSygOlNPWxaYs1DN1iigC9TsXwn0PagOgRsL1GxXSpy0W8C9PWt2TAGADeDOHjU7tgDAGnBtx5qtQQBgBbjoUrO1CMx5H0pgufC8T+A4Ii5bFHgDDiLidqjwJQVegP2IeBoyPJT5Bh6B7THClxC4AvYi4nWM8D/yn3/mZupJqXlDCzR9oZmqO13C1yDQ9KW+6bXKxIYXW2e2vFpMkiRJkmQAvgCVSs1FX4DCTwAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMC0wMi0wNFQyMzo0NTo1OCswMDowMN1CfCIAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjAtMDItMDRUMjM6NDU6NTgrMDA6MDCsH8SeAAAAKHRFWHRzdmc6YmFzZS11cmkAZmlsZTovLy90bXAvbWFnaWNrLVRhUkNPRDVNlVWkawAAAABJRU5ErkJggg=="},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAASVJREFUaN7tmbFOxDAQRN8iWoSgp6Y8fhTxH4BETUFNS0sNLUKYD5grQnGYSMFOzuvAvnIVJTMee504EARBMZLOJN1KSto/SdKdpPMxLVYjHngCThuP2zuwMbOX3eJBxY2uHMQDnACXebEmgQQcORgASGZ2PNeAnMQPgs2+aa6ZQl1x2OpB+cgtleTfSyAfmXzkemP1CYQBb8KAN4vtA6Xdaur63+4Tq08gDHiz2BqYmrPxLhQGOiUMeBMGvGn2Tbyv04zVJ1Bj4NNR78cSBh4cDdznhR/v5FOnEl+nxI8MZ5UteQMuzOx1t1icgJk9AxvgBkgNhCfgekw8VCTQG/+yC3XF6g2MrQHPHxjFa24sAc8+X244Lzj2+UHQ3AQc+nwQBDPYAn/uv7i6b80MAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE5LTEyLTMwVDAyOjI0OjU3KzAwOjAwKsfnJgAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxOS0xMi0zMFQwMjoyNDo1NyswMDowMFuaX5oAAAAodEVYdHN2ZzpiYXNlLXVyaQBmaWxlOi8vL3RtcC9tYWdpY2stampoWE1tblb7e8sRAAAAAElFTkSuQmCC"},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAAQRJREFUaN7tmTFOw0AQRd9EtAhxgNRJF25JxUUgEjUFLZyBGlqEWA7waVIkUXZJHOyxpf/aWa//93i8u2MwxpjRImkuaS2paHiKpEdJi5bGaIhfAi/AdfJz/AJWEfF+KDhrXHg7AvFsNNzVgq0MFOAyW/2GEhFXpxrQzsCI6tg+OPb+s+OmGy82kM1FXxMPVUOTz4ANZGMD2dhANp3Xgf3v/Lnju64Tk8+ADWTTuQb+eme9F7KBiWAD2dhANr2diYfqI00+AzaQTasGfthq7p66//9nvmuBVgaeEwXv81QLtLrTC+CV/H8En8BNRHwcClYzEBFvwAp4AEqC8ALct8QbY0w+v49kvEZTVzEQAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIwLTAxLTA0VDAwOjM4OjI3KzAwOjAwAvi1KwAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMC0wMS0wNFQwMDozODoyNyswMDowMHOlDZcAAAAodEVYdHN2ZzpiYXNlLXVyaQBmaWxlOi8vL3RtcC9tYWdpY2stcUJCWnc4dlqEQ8RLAAAAAElFTkSuQmCC"},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAAW1JREFUaN7tmDtOw0AURe+wCr5KAgWCKkqLiMQKAgE2A6vKEoBYdIgqSc8voGwgDYciNlhpsPG8sSLmtLbm3fPskd6MFIlEIpFIpD6cz8WAjqSepK6kdUk76aMnSVNJt5IGzrmHusXzoR1wAUwozgQ4B7w28C/hW8B9ieDLJECzrvBHwHuF8Bkz4CR0+C4w9xA+Yw50Q4VvAh8ew+e/xJ51eEe1f/43Eiw3NnBpGD6jXyZTYdu0M2NJ+2YdWjB2zh0WfXmtxMKdAOEl6QBoWwj0AoTPOLUQOA4oULhWGYGtgAKFa5UR2Fh1AQIKfFoIvAUUeLUQeFl1gbuAAjcWAoOAAoVr/Z9RwjmHpGvj8JJ0ZbZyOk4nhpPo0Lw9QAM/R8llZsCuuUAqYXGkDDlrfR/qp546H/ZQn5NoUW1PDIFGLeFzEg7oA6MSwUfAmY/6vq8W2/q5WtyUtJ0+etZiPMiuFh9DNTgSiUQikYglX0N7W4iQ5Cb0AAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIwLTAzLTE1VDAwOjMyOjUyKzAwOjAwEF1ffwAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMC0wMy0xNVQwMDozMjo1MiswMDowMGEA58MAAAAodEVYdHN2ZzpiYXNlLXVyaQBmaWxlOi8vL3RtcC9tYWdpY2steTV5UkI0VVi+7GpOAAAAAElFTkSuQmCC"},function(t,e,i){t.exports=i.p+"asset/db68d4a19ce510e0767a06b8bca1cdbc.jpg"},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAAPNJREFUaN7tmEESgjAMRROHI6oLFh7PhVcE57vVSmlrE9KMeVto+a8hUCAKgv+GWwcAgGlg5o/MJ8swEoSANVPvBOk9KU2p59xXIASs6e6BHL++L1p7yn0FQsAaNQHOQEQXIlrNjJHQOPYMYMEOktcTFQBw3Qi/uBDIrPwKYB5eYC98zXymAqXwQwvUhB9WoDa8hMC0NaBVqOK0JxHdmPnevYIJR7yJ1cITKe5G35iZ+ZE72PtF9zVYpFEEA6Z50vmKFWgNIL0AJWI3ao17AfWnkHZPuK9ACFij3gPa/07dVyAErCn2wNF7m1bcVyAEgiCw5QX5rSzE+JZshwAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMC0wMS0yOFQwMDo0MjowOCswMDowMPuSBPoAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjAtMDEtMjhUMDA6NDI6MDgrMDA6MDCKz7xGAAAAKHRFWHRzdmc6YmFzZS11cmkAZmlsZTovLy90bXAvbWFnaWNrLWN6bFdKZXNyyoB4/wAAAABJRU5ErkJggg=="},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAAldJREFUaN7tmD9rFEEYxp85YlBTxGguKBiIIqiJXkBNa8Q/nd/DQtFKscv6DbQw6ifQeK12BuwVicWZInbGStAiBBII/ixuAst6u97ObG52ZZ9mitvnnee3M8zNu1KtWrX2TEAUOoNXeIDQObzCVxIgHr5yAMnwlQLoFX4QAKao8JIWUn7ekvRT0i87fpb0QdJHSavGmLCrlPbm+9Q34Akw6zp/Iyi9dFzSXUkrwFvgXJAUnqsQ1w7wAhgpE8R+4ChwBrgG3AdeAusZICvAVCkgMp5tAJeBRWCjB8QP4HxwiD49E8BjYCsBsQ40iwo2DAzlhcg5RwtYS0C8LiL8JHAyp8fpMgeMAssxgN/ARZ/wLeC2ozdy9B0CvsQgnrqGbwLv+t06RQqYtscqQMe1SBu4N+jwsflfWYBNF/OcNU8HBLjqA/DMmg8GBBj71xbKugtdseO+UACStu343oV+09LPh0oPzNhj9ELaM1krsNsr3AoFIOmGpLYx5pML/Wrshnh20MmBIXuEj7sWWIz9kXSAUcc6kaPvDj79QewY3dWyC4T15oIATgGTzuFjhdoJiDWg5QDQN4TdOsPe4W2xJn83Htt0+9iJnAC5V6IoiJZtLpLaAJ4D80Ajw08ZIE7QbfPS9B1YAh4A1+1F7BjddpKyQIzYN75DMRo8hAWZAd6UBSL3dyFjTMcYc1PSlKSHkr76vA9fAO9Pi4CRdFrSnKRLkmYlHZF0WNKYpAMp1kfGmMh3/j1XytZZ8K8cDqA64XsAVCt8AqB64WMA1QxvAaLQGWrV+p/1B7DNtLf/yLyzAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIwLTAxLTA0VDE2OjM2OjA3KzAwOjAwY/68TgAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMC0wMS0wNFQxNjozNjowNyswMDowMBKjBPIAAAAodEVYdHN2ZzpiYXNlLXVyaQBmaWxlOi8vL3RtcC9tYWdpY2stamlOZUc3RmmneoMFAAAAAElFTkSuQmCC"},function(t,e,i){t.exports=i.p+"asset/5c8821ef5d02db53cc0a60cef334b35a.png"},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAADw0lEQVRoQ+2Za8hNaRTHf//BIMMQchnNRI2kKKTcPkgUSkM+qDGlRpOUS8yIfBhSSCiXlBq31HyR+GI0KRmaEh9GudRgREQIuTO5rGm9Pee03217Pfs9x9nz1nnqfDh7P5f1X5f/Ws/aooUPtXD5qQMo2oJ1C9QtUKEGol3IzNoBnwGtEmc+kvSyuTKYWYewp2/xWNKLvHtFATCz3sCPwLdADyiz1yxJe/MeWppvZsuB1eH/FmCtpNt59osFsA5YDLRObd4kADObBoxNrdkq6R9/lgLwHNgBrJF0JxZELIC7QPeMTT8EYGMAnlw6VtLxDAD+qARiaaxrxgKw92ik2gBKx2yXNDfGCv9XAEiKki1qkpnV2gJ1AI3cr26BxtHYFAuVZ9YqBuY4d0t6m8UYZjYRGJl6t1vSNTPzjP5z+L2zvFYAfgfmlxJTDO0lsvBQwLPv6Kx1tQLg7PTKk2oe4cPcT0Jmz2TCWgFohtxxS+oAknrKoFEvofcBh4B/43SaOas9MAP4BnCXqhkLXQVGAXckNcf/GwQ1M/f/L4BLgIOpGYCLkgZUoPl0onwK+OWmDiBTqRkxULdAiiRarguFi/09wJsGyfGTM52kG03FWnPvA1VxITNbBKxPdTrS8v4BfCfpZmbJEcMk1Y6BUMj9CYwIpYjngGS7xsU6C3QGvgx35cmlu3QjtioIwMkgvHcnhgH3MzoeXuF2BSYDvwaggyRdLBSAmc0PVWiDG5pZJ+DRexQ5XdIBM3MQvwFP3CrJ8j02BrziTPaEbgHuv3lHW2BPKBu2BtfoA8xMbfQmuNQ1L9fDO2+ADQamSPISpmHEArgADMwr7Uea/1RSx7wAvge2ZVDdx5DRC8UVgHf1PMjHJw75BeibLLVjLdAGmAosA/rFWi4Dnfu7n/k4cQkqPXsA/A2sBI4CuwBvnJVlNLMjwITcAKqlZjNz7XoctJH02vc1M28neiXaKhmcZuZ90tkpAIeBSUUC+AsYAnwl6XoA4LTYH/hcklumYZjZfsBZKGmB08DwIgEsADZXatEiAfQCnIIrGbskzc7FQpWcll5bCkTgB0k7zMxJ4QpwSpKzjrvPBMADdoOkJWbWDfAWv4+Okp4VCaAncDl8WiplWr9Sfu1xELLtCWCMUybgpba/7wIslOS9pPKIotFqWiBo2O/Tx4BPgYPAGWAV4JWnZ95zwHnAeX9ToN7dgZUa3cELARBAuOu44J4HkuNhqELLhAR48G/LaiAUBiCA8PPHAQcygPiUncC8pj43FQqgGq7Z4gH8B15lwUB2iKO3AAAAAElFTkSuQmCC"},function(t,e,i){t.exports=i.p+"asset/a5b10673eae2bcb2c76813c7c285e190.wav"},function(t,e,i){t.exports=i.p+"asset/097cb92106554f7ddd21d2af4e1791ac.wav"},function(t,e,i){t.exports=i.p+"asset/324308266787d5ef652d4faeb3fd9c24.wav"},function(t,e,i){t.exports=i.p+"asset/df28bf1c056441c518187f6ba4f330cc.wav"},function(t,e,i){t.exports=i.p+"asset/11870d60fbe6b4f61d4c25308c14fb0f.wav"},function(t,e,i){t.exports=i.p+"asset/129c1c3a813b3bcf2168024955a25563.wav"},function(t,e,i){t.exports=i.p+"asset/87f78e39962aa27abafcd4ab9123a03b.wav"},function(t,e,i){t.exports=i.p+"asset/9db7b5ddeede1dccaad48f55f295f5a1.wav"},function(t,e,i){t.exports=i.p+"asset/287c352dccaa80725644ab1065e13e19.wav"},function(t,e,i){t.exports=i.p+"asset/91c3a0bdf3184551cbd688bc88680de2.wav"},function(t,e,i){t.exports=i.p+"asset/d132710c9ffc6b2aadaccb0509af20da.wav"},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAQAAABLCVATAAABcklEQVR42uXSvUtbURwGYFtrPyhtKIQWHTOUdu7QMYuzU0szpE7tIrjWjoFC024dWltwS/0bOjRE6NZBEF0lQkD8QBGc/Ep4FAmXKx7Fc+Ok7zvdc37ngXM5fdc6RoxcBnPPkpb7vUNV8LlX5qldsOd5b1ADwD83sjNl0NYG5azMQyvg21FhzaNs0A+wKueBZfA9C/NCG7w5/iqBjpexzE3/QT1Z+QNm9cdBY4ApE91OAcZimCe2EM62wYtDv52X2kWZnKov57Qq13f1ol/RuA/envnLjaoHO5qaKWkB6Jj2OARVhFNJJj7hZFoK0ZASYN1PXzUA8wbCUM1w0poEcksL/JXvzr+2D96HoUp4RRGsy5/an4mDxsGv9AlDYDMO+giq6RPugp04qAwayWZyXYtx0KAOeJXs3jYHJsNQUz1pM02bBvsqhtxR7DIHnsW+o7ym05nI8rILFqRzEGCOx4aDLaRmBrwzY8OuRZNHl7oeOQRi9c1/djL3BQAAAABJRU5ErkJggg=="},function(t,e,i){t.exports=i.p+"asset/e813da642e02e376496b07ba57f56245.png"},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABWUlEQVRo3u2YPUrEQBhAE2FBRNgLbGG1WwjW/sB6APEG3kWP4D2WiJXVaiF4ATuLrSysRDeIjeCzmWIZM8lknZkvwe9BqmRm3ksyKZJliqJEAxgBM6A0xxUwkfZqI//Kb96AsbSfT8AMN4W0n09AWROwDLXOhlRfHwLmNeduI64bBmBiNmw/N7GJGAMFsDRH0Rt5xZO86QIg2BfjT6J5Xukq9RkNhgZI07gH2uK7Z1zvdFt6/wQ0QBoNkEYDpNGAdQHOgU3pG1Al1oYFcCLt7BPwDjzUhFwDO9LuGXBR9QsF2DfnT4FnR8SnGS/zWjXJr1w3BC6BL0fIE7DbSXlrzB5w74h47IL8gcfYHDgDXqzx352Xt+YZ2pNIyX8A0zXnSxcQWj5pQAz5ZAGx5JME1MgfB5o/XgAwAO6sNUrgMOAa0Z/A1kpEsDufLMAssg3cAEdRFlAU5f/xA+c0amO9mpIRAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIwLTEyLTA5VDEzOjE0OjU0KzAwOjAwlDuN7gAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMC0xMi0wOVQxMzoxNDo1NCswMDowMOVmNVIAAAAZdEVYdFNvZnR3YXJlAHd3dy5pbmtzY2FwZS5vcmeb7jwaAAAAAElFTkSuQmCC"},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwBAMAAAClLOS0AAAAG1BMVEUAAAD////////8+fn9+vr8+fn7+vr8+Pj7+PhuKnQnAAAACHRSTlMAEjJYjq3R6ZukXFMAAAFlSURBVHjanZTPT8IwFMc7xsFjIxo81hiTHcWY6VE0YTsCS3R3Ne4OmF0JK+2fbfv2XmkbwoHv6ZUPfb87dr6Su49W/TxyFmlUaNB6Ev3eaNQ+IINSO0nh+c+1pxV3YKgDTd2FMgQdXbnSkV4RvFDYFo0dpoSpqsk1AiV8T8rEvEey8D0trZ17vpLe0xeDQ9FHs3mlYH5zDPgJR0HVrV21KTiYG2sMjnhY7dZYGdytyNUMo1NSqur/P8OuGLu2xq9WS2wzxJDmAMZbASQ30W5gXAa00DYzKrXI7TAuCGA/BzVWBkA50BewEYwAuWKGtHtbsHPVEEiajvmgPgYkFRgDa2UxoJaMj4EttX1+ABmdU8jigcAQ0hdutBsBAOckOd6FGRpAq7Tz12dlQFL66zPABayaLqeFC1ZUaUUremKpTz+D+MqUOT0HT81/nHX8OEkjR2T00C+RyFsWKXkyS/f3zs//6PwDKAkzULJKc/kAAAAASUVORK5CYII="},function(t,e,i){t.exports=i.p+"asset/31542bbba08cdf6ca38eab2aad6049e0.glb"},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAAQVJREFUaN7tmEEOgjAQRalxa7yAXXN2CYlrF95ITcADPDeQKKaWtuAUnLeEDszrJwVaFIry3xjfAIC3AmO8Nb9kI91AKtvYwlySWX8CoTPrS2Z4PvY+PetPwDWjuaxG60/ARS7JLD6B6NkKfQ+4Vp+PhgITXHwCXgEG9MfNAEetBWqgHdsQ0AInoJzE0CUwos4CN+K5A1ZSoE5ovqfy3We2z+nusdklzl9rjNknCcSSIB5Ut/5VKHdUQBoVkEYFpFEBaVRAGhWQRgWkUQFpFi8QvTc6gkfx8lMfsqPxQuMbMGcClwmucZ6xv+8AZbc5FcsVOIgJdBIWqIAmoPEGOIo3rygL4Qk3II4MXqosEgAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMC0wMS0yOVQwMDo1OTowOSswMDowMMrjuugAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjAtMDEtMjlUMDA6NTk6MDkrMDA6MDC7vgJUAAAAKHRFWHRzdmc6YmFzZS11cmkAZmlsZTovLy90bXAvbWFnaWNrLVVmQjFBNlZEnDpgggAAAABJRU5ErkJggg=="},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAAbFJREFUaN7tmDtOAzEURa/5FoggYAPUBFZBgUQVKYIV0LEIsgEQiABLoQCxCT5KS9gBUKGgQ0GQImNEJnkvg6W5nYt5Psd+Ho9GqlKlysgBWmUzjAUPUDbHWPBZCgzCZycQw2clkILPRuA3eKO8AffACbCRG3ycHtAG5oblmyp7d6NMSzqQdFVE4r/twnfOTJcGp0MMLAINoJNop7q7hGHtZaAblT82FUhJGNfejQTuzAViCeO6tUjgxUVgUMK45lJRgZlRJwshtIz5JWk7Gj9ZT+AWYBV4dj/EDuA1YC8B3wPW/3q+cAsBm5L2JW1JWpO04OR2HkJ4tFypeeAC+HC8fb9zDcxaw99OALwHnJrC9wUuHaFfgTvgiCF6fhT4TX62TRdoAovmEzoInCTgV8rmKiLwEAk0jeu3vAVeIgHTtunX9JOYkICfRKKFGk4CPhKJQ9wBlp0E7CWAjf4FE7+JdoGag4CLRNvixioYOwlgDrj5jxJD/RcKIbxL2pHUlvRhur2TDlAHjvn6fnnNooWcFySVw7K5xhHIBz4hkBd8JJAf/IBAnvB9gVbZDFWq5JxPpJqf9FdOe9gAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjAtMDEtMTZUMTk6NTQ6MDkrMDA6MDD49+Z4AAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIwLTAxLTE2VDE5OjU0OjA5KzAwOjAwiapexAAAACh0RVh0c3ZnOmJhc2UtdXJpAGZpbGU6Ly8vdG1wL21hZ2ljay1QcFlQTHF3VXwHHT4AAAAASUVORK5CYII="},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAAXNJREFUaN7tmF9OwkAQh1sT8QkMegvBu5AQOU8vYGMD0cMoXqKY8Iw3oD5iPh/YJjhs/2+zJs6X7AvMbH9fGB6mQaAoiqIoLQDugQTYAF/mbIAnYNryzgiI+g5+BTwD3xRzAFbAoGH4nH4kTPh36rOuIyHC9ycBvDQIn7NsEd69hJl5OTY7YA4MzZkBW8s4TVqEdyth/pwy/I2lbmy+OyVuGd6dBPAhLp2X1D6I2rRDeDcSwF5cOCypHYnafcfwhRJhAwF+NYZh6LM+56LTz/IHUAHfqIBvVMA3KuAbFfCNCvhGBXxzJlC0cFjqqhaOTNSXLUDX4qMs6IKLlY/zFXRW8ryFqE2rMrqWiCz98iXAFhhb6m6BT1Eb1wrpSCIq6J1yfKVyyo7jwj8yZ2EJfwDunAjUkIgqelctRjFxFr5CIqrRNwDeGoR/BS6dC1gkKsMLiaVlnOTYJL2FFxK1w4veCRADKZCZkwKPTmdeURRF+Vf8AExy370xNx1oAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIwLTAxLTE2VDE5OjU0OjE2KzAwOjAwwhWWDwAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMC0wMS0xNlQxOTo1NDoxNiswMDowMLNILrMAAAAodEVYdHN2ZzpiYXNlLXVyaQBmaWxlOi8vL3RtcC9tYWdpY2stRXdaMnREVklnPPTlAAAAAElFTkSuQmCC"},function(t,e,i){t.exports=i.p+"asset/035b45337bee75fd06e341e880197d00.wav"},function(t,e,i){t.exports=i.p+"asset/e3f1f273ffa184e96e4faa420f07ac9d.png"},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAQAAAD9CzEMAAABSklEQVR42u2UwRWDIBBEc6EFa/BMITSQTqiCTiyFOjxaweRAZB8uvIkQ3/PgPyWKM8Du7Ovh/uDLY3CtAQZ5DCj/LXoEAKww1/SUQyJc1bQLEvYa+RmJOCbzRmJp7v89ZmAQkXDFU6v2P3yGCKNsZf8jZDGfnwS1/xFgseOK/xtmvbKrs+CRWDFjwno8kToZEHpLHSG/jFqVrHvSnfctAlM12YI7X4kNOxtsI9nCcjq5xQXM+oz7u7xu6pBXFroRQi6175cXC50WS1JO5D18zUJES7Ofipvk5dCFhZUEVFaEDvmDRTgkYDoU3JyUVxa2SMCiWtb1yItFbMmJZY+8WPjahahLY7nV8iLzNapAvoZn8ioBCpIG+B/lLRi2aUHkJQENaBroTJdibqqYJA0E0o4kDQQiQe05/BJ4GjhsqKkheBYylvUYf7gFH4q4ohyutd1RAAAAAElFTkSuQmCC"},function(t,e,i){t.exports=i.p+"asset/473addb38a6e7d0cd340b440b2708a5c.wav"},function(t,e,i){t.exports=i.p+"asset/8b2e00cf21674367534911d8e1b1179b.wav"},function(t,e,i){t.exports=i.p+"asset/5a1ac966c67b3ed3c25dfb764e8b47c9.wav"},function(t,e,i){t.exports=i.p+"asset/f211e52335d39259ed7249a30a42b9aa.wav"},function(t,e,i){t.exports=i.p+"asset/166ef4200a24064483977508b8351fa5.wav"},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAAaRJREFUaN7tljFrVEEURs9IIpEk2tisFoISCxFRGxs1VTr/iq1phCxpErAQbfwZFlaWCjaKKVJZaBG3WUlAFAzL6uZYZIvs8t6LG2fQwD3lvOF+98x983gQBEEQBEEQBP8N6vq/7uFvBTxOElM168tqL6XUnkB8GrgN3AFuAgtAC5gDfgI7wDbQAd4Ar4GNlNKvrEaOcqiAelV9pu44OV/Vx+pCKYFaCfWK+kLdO0Lj4wyGtS6XEBi5E+q0uqz2MzQ+Tl9dV2dyC6i21QvqRoHGx3mvnvuTflOVQMP+H8Bsw/Nd4BXwEngHfAG6gMBZ9i/1LWARWALmG2p1gHsppc1cE2iiqz5Q5yfIOa3eVz821P2mXispMFDX1FMThYzmzQxfz15NxpbaKiHwXV08auMVudfVTk3WW/VkiQm0cwkMs8+rmzVZD0sIaObfDrWlfq7I2VUvlRAoMYkbVt+J56UESkxitSJjoF4sJZB1Eu5/nT5VZDw6uO9EzlMDVnJJpJR6wJOx5S7QP8w8B1kk1DPqB/WpelfNfeBBEARBEARBEBxjfgO88P8A4ClThgAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMC0wMS0xNlQxNjozMTowNSswMDowMBa7WD4AAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjAtMDEtMTZUMTY6MzE6MDUrMDA6MDBn5uCCAAAAKHRFWHRzdmc6YmFzZS11cmkAZmlsZTovLy90bXAvbWFnaWNrLTB2bEJnV1Q2oEqPrQAAAABJRU5ErkJggg=="},function(t,e,i){t.exports=i.p+"asset/fe5497ee8400d7fbe6d0135c864177bc.png"},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAAmZJREFUaN7tmb+LE0EYht8vxN9k5bQRsVCsLP0bLPS6k+gJB2ehjb2Idmd7KKKglYilpVhYXmUtiJXCKZJcY3MognLnkcciE0xiZrOzO8nuSV5YCJmdmefZ/XaYbKRdHpvGJMAxN9emmW2VLZ0F+BBwA1gDfvI3HeA9cB84VTanD/4K0GZ8fgOPgQNlM/fADXiYAXw471yJTQcypW0lB3wvb4HGJIAT4Brw2pVFB9h2n18AS0AdOOtKokiexIa/DnzNMPE68KEgPO4CnIkBvgd4FgEIoAU0gYY7FsbI3osh8Dwi/JER48+5tlFZLwp/NRI8QDNlnsuePh0Cl1XrG3S/pE+Sjhe+jd0kZvbDI5BI+u7pd9rMPmedpNb3eTkFvi3pkqTEHRclfSwgl7aF+ZVrROBlxFoGWEiZa9HTZxvYl1fAt2TmqWXorjZzI/ocxb/VeJMX3oAdz6CNlH7JmAe55SQTdyySvk+6GcpuDqQuaUuDz0QvaQ/jYUnfcl21f7Mp6aRvLl9qkmRmO5I2POecS+l/PhK8JN0KhR8I8CpiLYfmaWF9YDliLYfkAVCLIXAwIlSetIH5ohJLJQoAtMbw3c0ikedXVbSkwae1959YAx5VSaAHn0mgr1MT+FK2QD98kIDrvLdMgWH4YAE3SCkCo+BHCRRffycQuqvNSpZzKycQAi9leDeaq+4mGDMbYK7cHQjNTKDszATKThUF7uxqATNbDZGonECoRCUFQiQqKxAikZqydqNDDLd33XbaJzH8fT2Dw4akEwWrIWvavgYzWyXPX7LAPNN53dICLkzpQs0yy3+TP5gBYceCXpegAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIwLTAzLTIxVDE1OjMyOjU1KzAwOjAw0nEklwAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMC0wMy0yMVQxNTozMjo1NSswMDowMKMsnCsAAAAodEVYdHN2ZzpiYXNlLXVyaQBmaWxlOi8vL3RtcC9tYWdpY2stWXFJeUxlVGIXA5uNAAAAAElFTkSuQmCC"},function(t,e,i){t.exports=i.p+"asset/897cb55093f67071ed0304972cb509f7.glb"},function(t,e,i){t.exports=i.p+"asset/f53c1a384ae14a1f284cac0a571fc7d8.png"},function(t,e){t.exports='<a-entity><a-entity _shadow="cast: false; receive: false" class="clickable bg" geometry="primitive: plane; width: 4; height: 3" material="shader: flat; src:#asset-shelf; side: double" mixin="shelf-bg" position="0 0 -0.01"><a-entity class="clickable handle" geometry="primitive: cylinder; radius:0.04; segmentsRadial: 7; segmentsHeight: 1" hide-low-power="" material="metalness: 0.8; color: #dff7f4; src: #asset-shelf" mixin="shelf-handle" position="0 -1.6 0" rotation="0 0 90"></a-entity></a-entity></a-entity>'},function(t,e){t.exports='<a-entity _geometry="primitive: sphere; radius: 0.01" id="camera-reset-el" position="0.0130435652091113 1.0412983252490486 0.6600262848245867"></a-entity><a-entity id="artist-root" position="0 0 0"><a-entity between-target-positioner="root: #artist-root; target: #camera-root" id="camera-offsetter"><a-entity desktop-controls="" id="camera-root" look-controls="" reset-transform-on-vr=""><a-entity position-at-target="target: #camera"><a-entity camera-layers="layers: spectator" gltf-model="#asset-headset" id="artist-helmet" position="0 0 0" scale="0.05 0.05 0.05"></a-entity></a-entity><a-entity _reset-transform-on-vr="" camera="active: true" camera-matrix-helper="" id="camera" look-controls="enabled: false" rotation="0 0 0"><a-entity light="type: point; castShadow: false; intensity: 0.3" position="0 0 0"></a-entity><a-entity _hand-action-tooltip="position: 0 1 -2" cursor="rayOrigin: mouse" desktop-button-caster="" hand-draw-tool="" id="mouse" mouse-manipulator="" raycaster="objects: .clickable,.canvas; far: 500; interval: 10" raycaster-layers="layers: default, left-eye, spectator" sound=""></a-entity></a-entity><a-entity id="hand-offset"><a-entity id="hand-root"><a-entity id="hand-rootleft"><a-entity _fix-raycaster="" _hand-helper="hand: left" _laser-controls="hand: left" _leap-hand="hand: left; pinchButton: pinch" button-caster="" fix-oculus-steamvr="" hand-action-tooltip="" hand-draw-tool="" id="left-hand" manipulator="useRay: true; rotateByDefault: true; useIntersections: false; printUpdates: false" mixin="hand left-hand-mixin" raycaster="objects: .clickable, .canvas; interval: 10; lineColor: #74BEC1" raycaster-layers="layers: default, left-eye" scalable-raycaster="" sound="" vartiste-rotation-button-mapping="" webxr-laser="hand: left; hideTrackingMesh: true; originSpace: gripSpace; fallbackToLaserControls: true; highlightButtonPresses: false" xbox-controller="enabled: "></a-entity></a-entity><a-entity id="hand-rootright"><a-entity _fix-raycaster="" _hand-helper="hand: right" _laser-controls="hand: right" _leap-hand="hand: right; pinchButton: pinch" button-caster="" fix-oculus-steamvr="" hand-action-tooltip="" hand-draw-tool="" id="right-hand" manipulator="useRay: true; rotateByDefault: true; useIntersections: false; printUpdates: false" mixin="hand right-hand-mixin" raycaster="objects: .clickable, .canvas; interval: 10; lineColor: #74BEC1" raycaster-layers="layers: default, left-eye" scalable-raycaster="" sound="" vartiste-rotation-button-mapping="" webxr-laser="hand: right; hideTrackingMesh: true; originSpace: gripSpace; fallbackToLaserControls: true; highlightButtonPresses: false" xbox-controller="enabled: true"></a-entity></a-entity></a-entity></a-entity></a-entity></a-entity></a-entity>'},function(t,e){t.exports='<a-entity icon-row="mergeButtons: true" position="-1.5 1.35 0"><a-entity icon-button="#asset-lead-pencil" toggle-button="target: #brush-editor; component: visible; useUntoggledColor: false" tooltip="Brush Editor"></a-entity><a-entity icon-button="#asset-swap-horizontal-variant" toggle-button="system: paint-system; property: wrapX" tooltip="Toggle Wrap X"></a-entity><a-entity icon-button="#asset-swap-vertical-variant" toggle-button="system: paint-system; property: wrapY" tooltip="Toggle Wrap Y"></a-entity><a-entity click-action="increaseBrushSize" icon-button="#asset-chevron-up" tooltip="Increase Brush Size"></a-entity><a-entity click-action="decreaseBrushSize" icon-button="#asset-chevron-down" tooltip="Decrease Brush Size"></a-entity><a-entity click-action="clearLayer" icon-button="#asset-delete" tooltip="Clear Active Layer"></a-entity><a-entity icon-button="#asset-plus-box-outline" tooltip="Load Brush Packs" vartiste-extras-popup="category: brush-packs"></a-entity></a-entity><a-entity class="brushes" position="-1.5 0.55 0"></a-entity><a-entity position="-4 0.0 0"><a-entity brush-editor="" id="brush-editor" propogate-grab="" rotation="0 0 0" shelf="name: Brush Editor; height: 3.5; closeable: true; hideOnly: true" visible="false"><a-plane class="preview" frame="pinnable: false; closable: false; grabbable: false" height="0.65" material="transparent: true; npot: true; shader: flat" position="1.25 1.13 0.005" width="0.65"></a-plane><a-entity position="-1.5 1.35 0"><a-entity icon-row=""><a-entity icon-button="#asset-brush" radio-button="target: #brush-editor; component: brush-editor; property: type; value: ImageBrush" tooltip="Image Brush"></a-entity><a-entity icon-button="#asset-resize" radio-button="target: #brush-editor; component: brush-editor; property: type; value: StretchBrush" tooltip="Stretch Brush"></a-entity><a-entity icon-button="#asset-blur-linear" radio-button="target: #brush-editor; component: brush-editor; property: type; value: FxBrush" tooltip="FX Brush"></a-entity><a-entity position="3.4 0 0"><a-entity click-action="deleteBrush" icon-button="#asset-delete" tooltip="Delete Brush"></a-entity></a-entity></a-entity><a-entity icon-row=""><a-entity icon-button="#asset-folder-open-outline" system-click-action="system: file-upload; action: browse" tooltip="Open Image"></a-entity><a-entity click-action="useLayer" icon-button="#asset-arrow-left" tooltip="Use active layer as brush"></a-entity><a-entity position="0.73 0 0" text="value: Or drag and drop an image here; width: 1.930; wrapCount: 20.340; anchor: left"></a-entity></a-entity><a-entity icon-row=""><a-entity class="image-brush fx-brush"><a-entity icon-button="#asset-brightness-4" toggle-button="target: #brush-editor; component: brush-editor; property: textured" tooltip="Use Image Color Multiplier"></a-entity><a-entity icon-button="#asset-transition" toggle-button="target: #brush-editor; component: brush-editor; property: connected" tooltip="Connected Strokes"></a-entity><a-entity icon-button="#asset-hand-right" toggle-button="target: #brush-editor; component: brush-editor; property: requireMovement" tooltip="Require Movement"></a-entity><a-entity icon-button="#asset-cube-send" toggle-button="target: #brush-editor; component: brush-editor; property: dragRotate" tooltip="Rotation Follows Movement"></a-entity><a-entity icon-button="#asset-rotate-3d-variant" toggle-button="target: #brush-editor; component: brush-editor; property: autoRotate" tooltip="Auto Rotate"></a-entity></a-entity><a-entity class="stretch-brush"><a-entity icon-button="#asset-brightness-4" toggle-button="target: #brush-editor; component: brush-editor; property: textured" tooltip="Use Image Color Multiplier"></a-entity></a-entity></a-entity><a-entity icon-row=""><a-entity class="stretch-brush image-brush"><a-entity icon-button="#asset-blur-linear" popup-button="popup: mode-shelf; deferred: true; tooltip: Change brush blend mode; scale: 0.3 0.3 0.3"></a-entity><a-entity position="0.3 0 0" text="value: source-over; width: 1.5; wrapCount: 20; anchor: left" v-bind="source: #brush-editor; sourceComponent: brush-editor; sourceProperty: mode; component: text; property: value"></a-entity></a-entity><a-entity class="fx-brush"><a-entity dropdown-button="options: blur, nudge, scatter, noise, drip, dilate, hq-blending, oklab-blend; target: #brush-editor; component: brush-editor; property: fx" icon-button="#asset-blur-linear" text="wrapCount: 20; width: 2; anchor: left; xOffset: 0.4"></a-entity></a-entity></a-entity><a-entity icon-row=""><a-entity click-action="addBrush" icon-button="#asset-plus-box-outline" tooltip="Add Brush"></a-entity><a-entity click-action="saveAll" icon-button="#asset-floppy" tooltip="Download Brushes"></a-entity></a-entity></a-entity></a-entity></a-entity>'},function(t,e){t.exports='<a-entity animation="property: scale; from: 0.7 2 1; to: 1.3 0.4 1; loop: true; dir: alternate" class="clickable" geometry="primitive: dodecahedron; radius: 0.3" material="src: #asset-shelf" scale="0.7 2 1"></a-entity>'},function(t,e){t.exports='<a-entity class="menu grip-menu"><a-entity hand-touch-button="icon: #asset-arrow-up-bold" position="0 0.2 0" tooltip="Push Out" zoom-touch-button="direction: out"></a-entity><a-entity hand-touch-button="icon: #asset-arrow-down-bold" position="0 -0.2 0" tooltip="Pull In" zoom-touch-button="direction: in"></a-entity><a-entity hand-touch-button="icon: #asset-arrow-collapse-vertical" position="-0.2 0 0" tooltip="Scale Down" zoom-touch-button="direction: small"></a-entity><a-entity hand-touch-button="icon: #asset-arrow-all" position="0.2 0 0" tooltip="Scale Up" zoom-touch-button="direction: big"></a-entity><a-entity click-action="toggleRotation" hand-touch-button="icon: #asset-rotate-orbit" position="0.2 0.2 0" tooltip="Toggle Grab Rotation Lock"></a-entity><a-entity click-action="hideMenu" hand-touch-button="icon: #asset-close-circle-outline" position="0 0 -0.15" tooltip="Hide Menu"></a-entity></a-entity><a-entity class="menu pinch-menu"><a-entity click-action="click" hand-touch-button="icon: #asset-check-outline; color: #aea" position="0 0.1 0" tooltip="Click"></a-entity></a-entity>'},function(t,e){t.exports='<a-entity class="remote-head"><a-entity class="clickable" gltf-model="#asset-headset" position="0 0 0" propogate-grab="" scale="0.05 0.05 0.05"></a-entity></a-entity><a-entity class="remote-left"><a-entity class="clickable" gltf-model="#asset-hand" propogate-grab="" rotation="0 -90 90" scale="0.1 0.1 0.1"></a-entity></a-entity><a-entity class="remote-right"><a-entity class="clickable" gltf-model="#asset-hand" propogate-grab="" rotation="0 90 -90" scale="0.1 0.1 0.1"></a-entity></a-entity><a-entity class="remote-canvas" composition-view="compositor: #canvas-view" geometry="primitive: plane; width: 80; height: 35" propogate-grab=""></a-entity>'},function(t,e){AFRAME.registerComponent("popup-shelf",{init(){this.el.setAttribute("position","0 -999999 0"),this.el.sceneEl.addEventListener("open-popup",(t=>{this.el.setAttribute("visible",!0),this.el.setAttribute("position","0 0 0"),this.tick=this._tick;for(let t of document.querySelectorAll("*[raycaster]"))t.components.raycaster.refreshObjects()})),this.el.querySelector(".ok").addEventListener("click",(t=>{this.el.setAttribute("visible",!1),this.el.setAttribute("position","0 -999999 0"),this.tick=function(){};for(let t of document.querySelectorAll("*[raycaster]"))t.components.raycaster.refreshObjects()})),this.el.querySelector("*[text]").setAttribute("text",{value:"Attempted to open a popup window. Please take off the headset and check your browser. You may have to disable your popup blocker."}),this.desiredPosition=new THREE.Vector3,this.desiredPosition.copy(this.el.object3D.position),this.shelf=this.el.querySelector("*[shelf]"),this._tick=this.tick.bind(this),this.tick=function(){}},tick(t,e){let i=document.querySelector("*[camera]").object3D;i.getWorldPosition(this.el.object3D.position),this.shelf.object3D.position.copy(this.desiredPosition),i.parent.getWorldQuaternion(this.el.object3D.quaternion),this.el.object3D.quaternion.multiply(i.quaternion)}})},function(t,e){t.exports="attribute vec4 a_position;\nvarying vec2 vUv;\nvoid main() {\n\tgl_Position = a_position;\n\tvUv = vec2((a_position.x + 1.0) / 2.0, 1.0 - ((a_position.y + 1.0) / 2.0));\n}\n"},function(t,e,i){var n={"./alpha-gradient.glsl":275,"./alpha-to-grayscale.glsl":276,"./blur.glsl":277,"./bump-to-normal.glsl":278,"./dilate.glsl":279,"./dither.glsl":280,"./erode.glsl":281,"./flip-x.glsl":282,"./flip-y.glsl":283,"./grayscale-to-alpha.glsl":284,"./invert.glsl":285,"./linear-to-srgb.glsl":286,"./noise.glsl":287,"./show-uv.glsl":288,"./srgb-to-linear.glsl":289,"./swizzle.glsl":290,"./test.glsl":291,"./uv-offset.glsl":292,"./uv-stretch-textured.glsl":293,"./uv-stretch.glsl":294};function r(t){var e=a(t);return i(e)}function a(t){if(!i.o(n,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return n[t]}r.keys=function(){return Object.keys(n)},r.resolve=a,t.exports=r,r.id=163},function(t,e,i){var n={"./angle.png":310,"./cloth.png":311,"./diamond.png":312,"./dots.png":313,"./ink.png":314,"./line_gradient.png":315,"./line_grunge1.png":316,"./line_grunge2.png":317,"./lines2.png":318,"./lines3.png":319,"./lines_condensed.png":320,"./lines_condensed1.png":321,"./pencil-line.png":322,"./pencil-stroke.png":323,"./pencil2.png":324,"./silky_textured.png":325,"./squared_textured.png":326,"./stamp_fur1.png":327,"./stamp_leaf1.png":328,"./thick_paint.png":329,"./triangle-test.png":330,"./watercolor.png":331};function r(t){var e=a(t);return i(e)}function a(t){if(!i.o(n,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return n[t]}r.keys=function(){return Object.keys(n)},r.resolve=a,t.exports=r,r.id=164},function(t,e,i){i(16);var n=i(15),r=n.vec3,a=n.mat3,o=n.mat4,s=(i(12),t.exports=function(t,e){this.finger=t,this._center=null,this._matrix=null,this.type=e.type,this.prevJoint=e.prevJoint,this.nextJoint=e.nextJoint,this.width=e.width;var i=new Array(3);r.sub(i,e.nextJoint,e.prevJoint),this.length=r.length(i),this.basis=e.basis});s.prototype.left=function(){return this._left||(this._left=a.determinant(this.basis[0].concat(this.basis[1]).concat(this.basis[2]))<0),this._left},s.prototype.matrix=function(){if(this._matrix)return this._matrix;var t=this.basis,e=this._matrix=o.create();return e[0]=t[0][0],e[1]=t[0][1],e[2]=t[0][2],e[4]=t[1][0],e[5]=t[1][1],e[6]=t[1][2],e[8]=t[2][0],e[9]=t[2][1],e[10]=t[2][2],e[3]=this.center()[0],e[7]=this.center()[1],e[11]=this.center()[2],this.left()&&(e[0]*=-1,e[1]*=-1,e[2]*=-1),this._matrix},s.prototype.lerp=function(t,e){r.lerp(t,this.prevJoint,this.nextJoint,e)},s.prototype.center=function(){if(this._center)return this._center;var t=r.create();return this.lerp(t,.5),this._center=t,t},s.prototype.direction=function(){return[-1*this.basis[2][0],-1*this.basis[2][1],-1*this.basis[2][2]]}},function(t,e,i){var n=i(15).vec3,r=t.exports=function(t){this.valid=!0,this.center=t.center,this.size=t.size,this.width=t.size[0],this.height=t.size[1],this.depth=t.size[2]};r.prototype.denormalizePoint=function(t){return n.fromValues((t[0]-.5)*this.size[0]+this.center[0],(t[1]-.5)*this.size[1]+this.center[1],(t[2]-.5)*this.size[2]+this.center[2])},r.prototype.normalizePoint=function(t,e){var i=n.fromValues((t[0]-this.center[0])/this.size[0]+.5,(t[1]-this.center[1])/this.size[1]+.5,(t[2]-this.center[2])/this.size[2]+.5);return e&&(i[0]=Math.min(Math.max(i[0],0),1),i[1]=Math.min(Math.max(i[1],0),1),i[2]=Math.min(Math.max(i[2],0),1)),i},r.prototype.toString=function(){return"InteractionBox [ width:"+this.width+" | height:"+this.height+" | depth:"+this.depth+" ]"},r.Invalid={valid:!1}},function(t,e,i){(function(e){var i=t.exports=function(t,e){this.options=e||{},this.message=t,this.createElement()};i.prototype.createElement=function(){this.element=document.createElement("div"),this.element.className="leapjs-dialog",this.element.style.position="fixed",this.element.style.top="8px",this.element.style.left=0,this.element.style.right=0,this.element.style.textAlign="center",this.element.style.zIndex=1e3;var t=document.createElement("div");this.element.appendChild(t),t.style.className="leapjs-dialog",t.style.display="inline-block",t.style.margin="auto",t.style.padding="8px",t.style.color="#222",t.style.background="#eee",t.style.borderRadius="4px",t.style.border="1px solid #999",t.style.textAlign="left",t.style.cursor="pointer",t.style.whiteSpace="nowrap",t.style.transition="box-shadow 1s linear",t.innerHTML=this.message,this.options.onclick&&t.addEventListener("click",this.options.onclick),this.options.onmouseover&&t.addEventListener("mouseover",this.options.onmouseover),this.options.onmouseout&&t.addEventListener("mouseout",this.options.onmouseout),this.options.onmousemove&&t.addEventListener("mousemove",this.options.onmousemove)},i.prototype.show=function(){return document.body.appendChild(this.element),this},i.prototype.hide=function(){return document.body.removeChild(this.element),this},i.warnOutOfDate=function(t){t||(t={});var e="http://developer.leapmotion.com?";for(var n in t.returnTo=window.location.href,t)e+=n+"="+encodeURIComponent(t[n])+"&";var r;return(r=new i("This site requires Leap Motion Tracking V2.<button id='leapjs-accept-upgrade'  style='color: #444; transition: box-shadow 100ms linear; cursor: pointer; vertical-align: baseline; margin-left: 16px;'>Upgrade</button><button id='leapjs-decline-upgrade' style='color: #444; transition: box-shadow 100ms linear; cursor: pointer; vertical-align: baseline; margin-left: 8px; '>Not Now</button>",{onclick:function(t){if("leapjs-decline-upgrade"!=t.target.id){var i=window.open(e,"_blank","height=800,width=1000,location=1,menubar=1,resizable=1,status=1,toolbar=1,scrollbars=1");window.focus&&i.focus()}return r.hide(),!0},onmousemove:function(t){t.target==document.getElementById("leapjs-decline-upgrade")?(document.getElementById("leapjs-decline-upgrade").style.color="#000",document.getElementById("leapjs-decline-upgrade").style.boxShadow="0px 0px 2px #5daa00",document.getElementById("leapjs-accept-upgrade").style.color="#444",document.getElementById("leapjs-accept-upgrade").style.boxShadow="none"):(document.getElementById("leapjs-accept-upgrade").style.color="#000",document.getElementById("leapjs-accept-upgrade").style.boxShadow="0px 0px 2px #5daa00",document.getElementById("leapjs-decline-upgrade").style.color="#444",document.getElementById("leapjs-decline-upgrade").style.boxShadow="none")},onmouseout:function(){document.getElementById("leapjs-decline-upgrade").style.color="#444",document.getElementById("leapjs-decline-upgrade").style.boxShadow="none",document.getElementById("leapjs-accept-upgrade").style.color="#444",document.getElementById("leapjs-accept-upgrade").style.boxShadow="none"}})).show()},i.hasWarnedBones=!1,i.warnBones=function(){this.hasWarnedBones||(this.hasWarnedBones=!0,console.warn("Your Leap Service is out of date"),void 0!==e&&e.versions&&e.versions.node||this.warnOutOfDate({reason:"bones"}))}}).call(this,i(21))},function(t,e){var i=t.exports=function(t){this.pos=0,this._buf=[],this.size=t};i.prototype.get=function(t){if(null==t&&(t=0),!(t>=this.size||t>=this._buf.length))return this._buf[(this.pos-t-1)%this.size]},i.prototype.push=function(t){return this._buf[this.pos%this.size]=t,this.pos++}},function(t,e,i){var n=i(170).chooseProtocol,r=i(20).EventEmitter,a=i(12),o=t.exports=function(t){this.opts=a.defaults(t||{},{host:"127.0.0.1",enableGestures:!1,scheme:this.getScheme(),port:this.getPort(),background:!1,optimizeHMD:!1,requestProtocolVersion:o.defaultProtocolVersion}),this.host=this.opts.host,this.port=this.opts.port,this.scheme=this.opts.scheme,this.protocolVersionVerified=!1,this.background=null,this.optimizeHMD=null,this.on("ready",(function(){this.enableGestures(this.opts.enableGestures),this.setBackground(this.opts.background),this.setOptimizeHMD(this.opts.optimizeHMD),this.opts.optimizeHMD?console.log("Optimized for head mounted display usage."):console.log("Optimized for desktop usage.")}))};o.defaultProtocolVersion=6,o.prototype.getUrl=function(){return this.scheme+"//"+this.host+":"+this.port+"/v"+this.opts.requestProtocolVersion+".json"},o.prototype.getScheme=function(){return"ws:"},o.prototype.getPort=function(){return 6437},o.prototype.setBackground=function(t){this.opts.background=t,this.protocol&&this.protocol.sendBackground&&this.background!==this.opts.background&&(this.background=this.opts.background,this.protocol.sendBackground(this,this.opts.background))},o.prototype.setOptimizeHMD=function(t){this.opts.optimizeHMD=t,this.protocol&&this.protocol.sendOptimizeHMD&&this.optimizeHMD!==this.opts.optimizeHMD&&(this.optimizeHMD=this.opts.optimizeHMD,this.protocol.sendOptimizeHMD(this,this.opts.optimizeHMD))},o.prototype.handleOpen=function(){this.connected||(this.connected=!0,this.emit("connect"))},o.prototype.enableGestures=function(t){this.gesturesEnabled=!!t,this.send(this.protocol.encode({enableGestures:this.gesturesEnabled}))},o.prototype.handleClose=function(t,e){this.connected&&(this.disconnect(),1001===t&&this.opts.requestProtocolVersion>1&&(this.protocolVersionVerified?this.protocolVersionVerified=!1:this.opts.requestProtocolVersion--),this.startReconnection())},o.prototype.startReconnection=function(){var t=this;this.reconnectionTimer||(this.reconnectionTimer=setInterval((function(){t.reconnect()}),500))},o.prototype.stopReconnection=function(){this.reconnectionTimer=clearInterval(this.reconnectionTimer)},o.prototype.disconnect=function(t){if(t||this.stopReconnection(),this.socket)return this.socket.close(),delete this.socket,delete this.protocol,delete this.background,delete this.optimizeHMD,delete this.focusedState,this.connected&&(this.connected=!1,this.emit("disconnect")),!0},o.prototype.reconnect=function(){this.connected?this.stopReconnection():(this.disconnect(!0),this.connect())},o.prototype.handleData=function(t){var e,i=JSON.parse(t);void 0===this.protocol?(e=this.protocol=n(i),this.protocolVersionVerified=!0,this.emit("ready")):e=this.protocol(i),this.emit(e.type,e)},o.prototype.connect=function(){if(!this.socket)return this.socket=this.setupSocket(),!0},o.prototype.send=function(t){this.socket.send(t)},o.prototype.reportFocus=function(t){this.connected&&this.focusedState!==t&&(this.focusedState=t,this.emit(this.focusedState?"focus":"blur"),this.protocol&&this.protocol.sendFocused&&this.protocol.sendFocused(this,this.focusedState))},a.extend(o.prototype,r.prototype)},function(t,e,i){var n=i(41),r=(i(28),i(16),i(29),i(12)),a=i(20).EventEmitter,o=function(t){this.type=t.type,this.state=t.state};e.chooseProtocol=function(t){var e;switch(t.version){case 1:case 2:case 3:case 4:case 5:case 6:(e=s(t)).sendBackground=function(t,i){t.send(e.encode({background:i}))},e.sendFocused=function(t,i){t.send(e.encode({focused:i}))},e.sendOptimizeHMD=function(t,i){t.send(e.encode({optimizeHMD:i}))};break;default:throw"unrecognized version"}return e};var s=e.JSONProtocol=function(t){var e=function(t){if(t.event)return new o(t.event);e.emit("beforeFrameCreated",t);var i=new n(t);return e.emit("afterFrameCreated",i,t),i};return e.encode=function(t){return JSON.stringify(t)},e.version=t.version,e.serviceVersion=t.serviceVersion,e.versionLong="Version "+t.version,e.type="protocol",r.extend(e,a.prototype),e}},function(t,e){let i=!1,n=()=>{};t.exports={logging:i,setLogging:t=>{i=t},setCustomLogger:t=>{n=t},log:(t,e)=>{n({type:t,message:e}),i&&console.log(`[${t}] ${e}`)}}},function(t,e,i){const n=i(385),r=i(386),a=i(387);t.exports={defaultOptions:n,getCreateFFmpegCore:r,fetchFile:a}},function(t){t.exports=JSON.parse('{"_args":[["@ffmpeg/ffmpeg@0.10.0","/builds/zach-geek/vartiste"]],"_from":"@ffmpeg/ffmpeg@0.10.0","_id":"@ffmpeg/ffmpeg@0.10.0","_inBundle":false,"_integrity":"sha512-W+d0ysYTO6d4vue/0KMYrxaprh9wvmnPqh6qyHXavBWLrDcE7gI3cJ/EQVfwe9nrt2e0Pi7873P2I18VEDgRfA==","_location":"/@ffmpeg/ffmpeg","_phantomChildren":{},"_requested":{"type":"version","registry":true,"raw":"@ffmpeg/ffmpeg@0.10.0","name":"@ffmpeg/ffmpeg","escapedName":"@ffmpeg%2fffmpeg","scope":"@ffmpeg","rawSpec":"0.10.0","saveSpec":null,"fetchSpec":"0.10.0"},"_requiredBy":["/"],"_resolved":"https://registry.npmjs.org/@ffmpeg/ffmpeg/-/ffmpeg-0.10.0.tgz","_spec":"0.10.0","_where":"/builds/zach-geek/vartiste","author":{"name":"Jerome Wu","email":"jeromewus@gmail.com"},"browser":{"./src/node/index.js":"./src/browser/index.js"},"bugs":{"url":"https://github.com/ffmpegwasm/ffmpeg.wasm/issues"},"dependencies":{"is-url":"^1.2.4","node-fetch":"^2.6.1","regenerator-runtime":"^0.13.7","resolve-url":"^0.2.1"},"description":"FFmpeg WebAssembly version","devDependencies":{"@babel/core":"^7.12.3","@babel/preset-env":"^7.12.1","@ffmpeg/core":"^0.10.0","@types/emscripten":"^1.39.4","babel-loader":"^8.1.0","chai":"^4.2.0","cors":"^2.8.5","eslint":"^7.12.1","eslint-config-airbnb-base":"^14.1.0","eslint-plugin-import":"^2.22.1","express":"^4.17.1","mocha":"^8.2.1","mocha-headless-chrome":"^2.0.3","npm-run-all":"^4.1.5","wait-on":"^5.3.0","webpack":"^5.3.2","webpack-cli":"^4.1.0","webpack-dev-middleware":"^4.0.0"},"directories":{"example":"examples"},"engines":{"node":">=12.16.1"},"homepage":"https://github.com/ffmpegwasm/ffmpeg.wasm#readme","keywords":["ffmpeg","WebAssembly","video"],"license":"MIT","main":"src/index.js","name":"@ffmpeg/ffmpeg","repository":{"type":"git","url":"git+https://github.com/ffmpegwasm/ffmpeg.wasm.git"},"scripts":{"build":"rimraf dist && webpack --config scripts/webpack.config.prod.js","lint":"eslint src","prepublishOnly":"npm run build","start":"node scripts/server.js","test":"npm-run-all -p -r start test:all","test:all":"npm-run-all wait test:browser:ffmpeg test:node:all","test:browser":"mocha-headless-chrome -a allow-file-access-from-files -a incognito -a no-sandbox -a disable-setuid-sandbox -a disable-logging -t 300000","test:browser:ffmpeg":"npm run test:browser -- -f ./tests/ffmpeg.test.html","test:node":"node --experimental-wasm-threads --experimental-wasm-bulk-memory node_modules/.bin/_mocha --exit --bail --require ./scripts/test-helper.js","test:node:all":"npm run test:node -- ./tests/*.test.js","wait":"rimraf dist && wait-on http://localhost:3000/dist/ffmpeg.dev.js"},"types":"src/index.d.ts","version":"0.10.0"}')},function(t,e,i){t.exports=i.p+"6d5e3ac459333ef3dff496de13bc75bd.vartiste-brushez"},function(t,e,i){t.exports=i.p+"69b6efe34cdfa12f943b09a7373f1b29.vartiste-brushez"},function(t,e,i){t.exports=i.p+"fc213f3a0efbeb50c16422253d1a3f63.vartiste-brushez"},function(t,e){function i(t){if(!(this instanceof i))return new i(t);if(!t)throw new TypeError("convolution matrix required");this.matrix=t,this.factor(1),this.bias(0)}t.exports=i,i.prototype.width=function(t){return this.w=t,this},i.prototype.height=function(t){return this.h=t,this},i.prototype.factor=function(t){return this._factor=t,this},i.prototype.bias=function(t){return this._bias=t,this},i.prototype.apply=function(t,e){for(var i=t.data,n=e.data,r=this.w,a=this.h,o=this.matrix,s=o[0].length,l=o.length,c=Math.floor(l/2),u=this._factor,h=this._bias,d=0;d<a-1;d++)for(var p=0;p<r-1;p++){for(var f=4*(d*r+p),m=0,g=0,y=0,b=0;b<s;++b)for(var A=0;A<l;++A){var v=4*((d+(b-c))*r+(p+(A-c)));m+=i[v+0]*o[b][A],g+=i[v+1]*o[b][A],y+=i[v+2]*o[b][A]}n[f+0]=u*m+h,n[f+1]=u*g+h,n[f+2]=u*y+h,n[f+3]=i[f+3]}},i.prototype.canvas=function(t){var e=t.width,i=t.height,n=t.getContext("2d"),r=n.getImageData(0,0,e,i),a=n.createImageData(e,i);this.width(e),this.height(i),this.apply(r,a),n.putImageData(a,0,0)}},function(t,e,i){(function(){"use strict";var i=window.THREE;if(!i)throw new Error("CubemapToEquirectangular requires three.js");function n(t,e){this.width=1,this.height=1,this.renderer=t,this.material=new i.RawShaderMaterial({uniforms:{map:{type:"t",value:null}},vertexShader:"\nattribute vec3 position;\nattribute vec2 uv;\n\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\n\nvarying vec2 vUv;\n\nvoid main()  {\n\n\tvUv = vec2( 1.- uv.x, uv.y );\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n}\n",fragmentShader:"\nprecision mediump float;\n\nuniform samplerCube map;\n\nvarying vec2 vUv;\n\n#define M_PI 3.1415926535897932384626433832795\n\nvoid main()  {\n\n\tvec2 uv = vUv;\n\n\tfloat longitude = uv.x * 2. * M_PI - M_PI + M_PI / 2.;\n\tfloat latitude = uv.y * M_PI;\n\n\tvec3 dir = vec3(\n\t\t- sin( longitude ) * sin( latitude ),\n\t\tcos( latitude ),\n\t\t- cos( longitude ) * sin( latitude )\n\t);\n\tnormalize( dir );\n\n\t// vec3 dir;\n\t// float x;\n\t//\n\t// if (uv.x < 0.3333)\n\t// {\n\t// \tx = uv.x / 0.3333;\n\t// \t dir = vec3(\n\t// \t\t1.0,\n\t// \t\t- 2.0 * uv.y + 1.0,\n\t// \t\t- 2.0 * x + 1.0\n\t// \t);\n\t// \tnormalize( dir );\n\t// }\n\t// else if (uv.x < 0.6667)\n\t// {\n\t// \tx = (uv.x - 0.3333) / 0.3333;\n\t// \tdir = vec3(\n\t// \t 2.0 * x - 1.0,\n\t// \t - 2.0 * uv.y + 1.0,\n\t// \t -1.0\n\t//  );\n\t//  normalize( dir );\n\t// }\n\t// else\n\t// {\n\t// \tx = (uv.x - 0.6667) / 0.3333;\n\t// \tdir = vec3(\n\t// \t -1.0,\n\t// \t - 2.0 * uv.y + 1.0,\n\t// \t 2.0 * x - 1.0\n\t//  );\n\t//  normalize( dir );\n\t// }\n\n\tgl_FragColor = textureCube( map, dir );\n\n}\n",side:i.DoubleSide,transparent:!0}),this.scene=new i.Scene,this.quad=new i.Mesh(new i.PlaneBufferGeometry(1,1),this.material),this.scene.add(this.quad),this.camera=new i.OrthographicCamera(-.5,.5,.5,-.5,-1e4,1e4),this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.cubeCamera=null,this.attachedCamera=null,this.setSize(4096,2048);var n=this.renderer.getContext();this.cubeMapSize=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),e&&this.getCubeCamera(2048)}n.prototype.setSize=function(t,e){this.width=t,this.height=e,this.quad.scale.set(this.width,this.height,1),this.camera.left=this.width/-2,this.camera.right=this.width/2,this.camera.top=this.height/2,this.camera.bottom=this.height/-2,this.camera.updateProjectionMatrix(),this.output=new i.WebGLRenderTarget(this.width,this.height,{minFilter:i.LinearFilter,magFilter:i.LinearFilter,wrapS:i.ClampToEdgeWrapping,wrapT:i.ClampToEdgeWrapping,format:i.RGBAFormat,type:i.UnsignedByteType}),this.canvas.width=this.width,this.canvas.height=this.height},n.prototype.getCubeCamera=function(t){var e=Math.min(this.cubeMapSize,t);this.cubeCamera=new i.CubeCamera(.1,1e3,e);var n={format:i.RGBAFormat,magFilter:i.LinearFilter,minFilter:i.LinearFilter};return this.cubeCamera.renderTarget=new i.WebGLRenderTargetCube(e,e,n),this.cubeCamera},n.prototype.attachCubeCamera=function(t){this.getCubeCamera(),this.attachedCamera=t},n.prototype.convert=function(t,e){this.quad.material.uniforms.map.value=t.renderTarget.texture,this.renderer.render(this.scene,this.camera,this.output,!0);var i=new Uint8Array(4*this.width*this.height);this.renderer.readRenderTargetPixels(this.output,0,0,this.width,this.height,i);var n=new ImageData(new Uint8ClampedArray(i),this.width,this.height);return!1!==e&&this.download(n),n},n.prototype.download=function(t){this.ctx.putImageData(t,0,0),this.canvas.toBlob((function(t){var e=URL.createObjectURL(t),i="pano-"+document.title+"-"+Date.now()+".png",n=document.createElement("a");n.href=e,n.setAttribute("download",i),n.className="download-js-link",n.innerHTML="downloading...",n.style.display="none",document.body.appendChild(n),setTimeout((function(){n.click(),document.body.removeChild(n)}),1)}),"image/png")},n.prototype.update=function(t,e){var i=this.renderer.autoClear;this.renderer.autoClear=!0,this.cubeCamera.position.copy(t.position),this.cubeCamera.updateCubeMap(this.renderer,e),this.renderer.autoClear=i,this.convert(this.cubeCamera)},t.exports&&(e=t.exports=n),e.CubemapToEquirectangular=n}).call(this)},function(t,e,i){(function(e,i,n){t.exports=function t(e,i,n){function r(o,s){if(!i[o]){if(!e[o]){if(a)return a(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var c=i[o]={exports:{}};e[o][0].call(c.exports,(function(t){return r(e[o][1][t]||t)}),c,c.exports,t,e,i,n)}return i[o].exports}for(var a=!1,o=0;o<n.length;o++)r(n[o]);return r}({1:[function(t,e,i){"use strict";var n=t("./utils"),r=t("./support"),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(t){for(var e,i,r,o,s,l,c,u=[],h=0,d=t.length,p=d,f="string"!==n.getTypeOf(t);h<t.length;)p=d-h,r=f?(e=t[h++],i=h<d?t[h++]:0,h<d?t[h++]:0):(e=t.charCodeAt(h++),i=h<d?t.charCodeAt(h++):0,h<d?t.charCodeAt(h++):0),o=e>>2,s=(3&e)<<4|i>>4,l=1<p?(15&i)<<2|r>>6:64,c=2<p?63&r:64,u.push(a.charAt(o)+a.charAt(s)+a.charAt(l)+a.charAt(c));return u.join("")},i.decode=function(t){var e,i,n,o,s,l,c=0,u=0,h="data:";if(t.substr(0,h.length)===h)throw new Error("Invalid base64 input, it looks like a data url.");var d,p=3*(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length/4;if(t.charAt(t.length-1)===a.charAt(64)&&p--,t.charAt(t.length-2)===a.charAt(64)&&p--,p%1!=0)throw new Error("Invalid base64 input, bad content length.");for(d=r.uint8array?new Uint8Array(0|p):new Array(0|p);c<t.length;)e=a.indexOf(t.charAt(c++))<<2|(o=a.indexOf(t.charAt(c++)))>>4,i=(15&o)<<4|(s=a.indexOf(t.charAt(c++)))>>2,n=(3&s)<<6|(l=a.indexOf(t.charAt(c++))),d[u++]=e,64!==s&&(d[u++]=i),64!==l&&(d[u++]=n);return d}},{"./support":30,"./utils":32}],2:[function(t,e,i){"use strict";var n=t("./external"),r=t("./stream/DataWorker"),a=t("./stream/DataLengthProbe"),o=t("./stream/Crc32Probe");function s(t,e,i,n,r){this.compressedSize=t,this.uncompressedSize=e,this.crc32=i,this.compression=n,this.compressedContent=r}a=t("./stream/DataLengthProbe"),s.prototype={getContentWorker:function(){var t=new r(n.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new a("data_length")),e=this;return t.on("end",(function(){if(this.streamInfo.data_length!==e.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")})),t},getCompressedWorker:function(){return new r(n.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},s.createWorkerFrom=function(t,e,i){return t.pipe(new o).pipe(new a("uncompressedSize")).pipe(e.compressWorker(i)).pipe(new a("compressedSize")).withStreamInfo("compression",e)},e.exports=s},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,e,i){"use strict";var n=t("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(t){return new n("STORE compression")},uncompressWorker:function(){return new n("STORE decompression")}},i.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,e,i){"use strict";var n=t("./utils"),r=function(){for(var t,e=[],i=0;i<256;i++){t=i;for(var n=0;n<8;n++)t=1&t?3988292384^t>>>1:t>>>1;e[i]=t}return e}();e.exports=function(t,e){return void 0!==t&&t.length?"string"!==n.getTypeOf(t)?function(t,e,i,n){var a=r,o=n+i;t^=-1;for(var s=n;s<o;s++)t=t>>>8^a[255&(t^e[s])];return-1^t}(0|e,t,t.length,0):function(t,e,i,n){var a=r,o=n+i;t^=-1;for(var s=n;s<o;s++)t=t>>>8^a[255&(t^e.charCodeAt(s))];return-1^t}(0|e,t,t.length,0):0}},{"./utils":32}],5:[function(t,e,i){"use strict";i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(t,e,i){"use strict";var n=null;n="undefined"!=typeof Promise?Promise:t("lie"),e.exports={Promise:n}},{lie:37}],7:[function(t,e,i){"use strict";var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,r=t("pako"),a=t("./utils"),o=t("./stream/GenericWorker"),s=n?"uint8array":"array";function l(t,e){o.call(this,"FlateWorker/"+t),this._pako=null,this._pakoAction=t,this._pakoOptions=e,this.meta={}}i.magic="\b\0",a.inherits(l,o),l.prototype.processChunk=function(t){this.meta=t.meta,null===this._pako&&this._createPako(),this._pako.push(a.transformTo(s,t.data),!1)},l.prototype.flush=function(){o.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},l.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this._pako=null},l.prototype._createPako=function(){this._pako=new r[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var t=this;this._pako.onData=function(e){t.push({data:e,meta:t.meta})}},i.compressWorker=function(t){return new l("Deflate",t)},i.uncompressWorker=function(){return new l("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,e,i){"use strict";function n(t,e){var i,n="";for(i=0;i<e;i++)n+=String.fromCharCode(255&t),t>>>=8;return n}function r(t,e,i,r,o,u){var h,d,p=t.file,f=t.compression,m=u!==s.utf8encode,g=a.transformTo("string",u(p.name)),y=a.transformTo("string",s.utf8encode(p.name)),b=p.comment,A=a.transformTo("string",u(b)),v=a.transformTo("string",s.utf8encode(b)),w=y.length!==p.name.length,E=v.length!==b.length,_="",x="",T="",M=p.dir,C=p.date,k={crc32:0,compressedSize:0,uncompressedSize:0};e&&!i||(k.crc32=t.crc32,k.compressedSize=t.compressedSize,k.uncompressedSize=t.uncompressedSize);var R=0;e&&(R|=8),m||!w&&!E||(R|=2048);var S=0,D=0;M&&(S|=16),"UNIX"===o?(D=798,S|=function(t,e){var i=t;return t||(i=e?16893:33204),(65535&i)<<16}(p.unixPermissions,M)):(D=20,S|=function(t){return 63&(t||0)}(p.dosPermissions)),h=C.getUTCHours(),h<<=6,h|=C.getUTCMinutes(),h<<=5,h|=C.getUTCSeconds()/2,d=C.getUTCFullYear()-1980,d<<=4,d|=C.getUTCMonth()+1,d<<=5,d|=C.getUTCDate(),w&&(x=n(1,1)+n(l(g),4)+y,_+="up"+n(x.length,2)+x),E&&(T=n(1,1)+n(l(A),4)+v,_+="uc"+n(T.length,2)+T);var O="";return O+="\n\0",O+=n(R,2),O+=f.magic,O+=n(h,2),O+=n(d,2),O+=n(k.crc32,4),O+=n(k.compressedSize,4),O+=n(k.uncompressedSize,4),O+=n(g.length,2),O+=n(_.length,2),{fileRecord:c.LOCAL_FILE_HEADER+O+g+_,dirRecord:c.CENTRAL_FILE_HEADER+n(D,2)+O+n(A.length,2)+"\0\0\0\0"+n(S,4)+n(r,4)+g+_+A}}var a=t("../utils"),o=t("../stream/GenericWorker"),s=t("../utf8"),l=t("../crc32"),c=t("../signature");function u(t,e,i,n){o.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=e,this.zipPlatform=i,this.encodeFileName=n,this.streamFiles=t,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}a.inherits(u,o),u.prototype.push=function(t){var e=t.meta.percent||0,i=this.entriesCount,n=this._sources.length;this.accumulate?this.contentBuffer.push(t):(this.bytesWritten+=t.data.length,o.prototype.push.call(this,{data:t.data,meta:{currentFile:this.currentFile,percent:i?(e+100*(i-n-1))/i:100}}))},u.prototype.openedSource=function(t){this.currentSourceOffset=this.bytesWritten,this.currentFile=t.file.name;var e=this.streamFiles&&!t.file.dir;if(e){var i=r(t,e,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:i.fileRecord,meta:{percent:0}})}else this.accumulate=!0},u.prototype.closedSource=function(t){this.accumulate=!1;var e=this.streamFiles&&!t.file.dir,i=r(t,e,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(i.dirRecord),e)this.push({data:function(t){return c.DATA_DESCRIPTOR+n(t.crc32,4)+n(t.compressedSize,4)+n(t.uncompressedSize,4)}(t),meta:{percent:100}});else for(this.push({data:i.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},u.prototype.flush=function(){for(var t=this.bytesWritten,e=0;e<this.dirRecords.length;e++)this.push({data:this.dirRecords[e],meta:{percent:100}});var i=this.bytesWritten-t,r=function(t,e,i,r,o){var s=a.transformTo("string",o(r));return c.CENTRAL_DIRECTORY_END+"\0\0\0\0"+n(t,2)+n(t,2)+n(e,4)+n(i,4)+n(s.length,2)+s}(this.dirRecords.length,i,t,this.zipComment,this.encodeFileName);this.push({data:r,meta:{percent:100}})},u.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},u.prototype.registerPrevious=function(t){this._sources.push(t);var e=this;return t.on("data",(function(t){e.processChunk(t)})),t.on("end",(function(){e.closedSource(e.previous.streamInfo),e._sources.length?e.prepareNextSource():e.end()})),t.on("error",(function(t){e.error(t)})),this},u.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},u.prototype.error=function(t){var e=this._sources;if(!o.prototype.error.call(this,t))return!1;for(var i=0;i<e.length;i++)try{e[i].error(t)}catch(t){}return!0},u.prototype.lock=function(){o.prototype.lock.call(this);for(var t=this._sources,e=0;e<t.length;e++)t[e].lock()},e.exports=u},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,e,i){"use strict";var n=t("../compressions"),r=t("./ZipFileWorker");i.generateWorker=function(t,e,i){var a=new r(e.streamFiles,i,e.platform,e.encodeFileName),o=0;try{t.forEach((function(t,i){o++;var r=function(t,e){var i=t||e,r=n[i];if(!r)throw new Error(i+" is not a valid compression method !");return r}(i.options.compression,e.compression),s=i.options.compressionOptions||e.compressionOptions||{},l=i.dir,c=i.date;i._compressWorker(r,s).withStreamInfo("file",{name:t,dir:l,date:c,comment:i.comment||"",unixPermissions:i.unixPermissions,dosPermissions:i.dosPermissions}).pipe(a)})),a.entriesCount=o}catch(t){a.error(t)}return a}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,e,i){"use strict";function n(){if(!(this instanceof n))return new n;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files={},this.comment=null,this.root="",this.clone=function(){var t=new n;for(var e in this)"function"!=typeof this[e]&&(t[e]=this[e]);return t}}(n.prototype=t("./object")).loadAsync=t("./load"),n.support=t("./support"),n.defaults=t("./defaults"),n.version="3.5.0",n.loadAsync=function(t,e){return(new n).loadAsync(t,e)},n.external=t("./external"),e.exports=n},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,e,i){"use strict";var n=t("./utils"),r=t("./external"),a=t("./utf8"),o=(n=t("./utils"),t("./zipEntries")),s=t("./stream/Crc32Probe"),l=t("./nodejsUtils");function c(t){return new r.Promise((function(e,i){var n=t.decompressed.getContentWorker().pipe(new s);n.on("error",(function(t){i(t)})).on("end",(function(){n.streamInfo.crc32!==t.decompressed.crc32?i(new Error("Corrupted zip : CRC32 mismatch")):e()})).resume()}))}e.exports=function(t,e){var i=this;return e=n.extend(e||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:a.utf8decode}),l.isNode&&l.isStream(t)?r.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):n.prepareContent("the loaded zip file",t,!0,e.optimizedBinaryString,e.base64).then((function(t){var i=new o(e);return i.load(t),i})).then((function(t){var i=[r.Promise.resolve(t)],n=t.files;if(e.checkCRC32)for(var a=0;a<n.length;a++)i.push(c(n[a]));return r.Promise.all(i)})).then((function(t){for(var n=t.shift(),r=n.files,a=0;a<r.length;a++){var o=r[a];i.file(o.fileNameStr,o.decompressed,{binary:!0,optimizedBinaryString:!0,date:o.date,dir:o.dir,comment:o.fileCommentStr.length?o.fileCommentStr:null,unixPermissions:o.unixPermissions,dosPermissions:o.dosPermissions,createFolders:e.createFolders})}return n.zipComment.length&&(i.comment=n.zipComment),i}))}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,e,i){"use strict";var n=t("../utils"),r=t("../stream/GenericWorker");function a(t,e){r.call(this,"Nodejs stream input adapter for "+t),this._upstreamEnded=!1,this._bindStream(e)}n.inherits(a,r),a.prototype._bindStream=function(t){var e=this;(this._stream=t).pause(),t.on("data",(function(t){e.push({data:t,meta:{percent:0}})})).on("error",(function(t){e.isPaused?this.generatedError=t:e.error(t)})).on("end",(function(){e.isPaused?e._upstreamEnded=!0:e.end()}))},a.prototype.pause=function(){return!!r.prototype.pause.call(this)&&(this._stream.pause(),!0)},a.prototype.resume=function(){return!!r.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},e.exports=a},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,e,i){"use strict";var n=t("readable-stream").Readable;function r(t,e,i){n.call(this,e),this._helper=t;var r=this;t.on("data",(function(t,e){r.push(t)||r._helper.pause(),i&&i(e)})).on("error",(function(t){r.emit("error",t)})).on("end",(function(){r.push(null)}))}t("../utils").inherits(r,n),r.prototype._read=function(){this._helper.resume()},e.exports=r},{"../utils":32,"readable-stream":16}],14:[function(t,i,n){"use strict";i.exports={isNode:void 0!==e,newBufferFrom:function(t,i){if(e.from&&e.from!==Uint8Array.from)return e.from(t,i);if("number"==typeof t)throw new Error('The "data" argument must not be a number');return new e(t,i)},allocBuffer:function(t){if(e.alloc)return e.alloc(t);var i=new e(t);return i.fill(0),i},isBuffer:function(t){return e.isBuffer(t)},isStream:function(t){return t&&"function"==typeof t.on&&"function"==typeof t.pause&&"function"==typeof t.resume}}},{}],15:[function(t,e,i){"use strict";function n(t,e,i){var n,r=a.getTypeOf(e),s=a.extend(i||{},l);s.date=s.date||new Date,null!==s.compression&&(s.compression=s.compression.toUpperCase()),"string"==typeof s.unixPermissions&&(s.unixPermissions=parseInt(s.unixPermissions,8)),s.unixPermissions&&16384&s.unixPermissions&&(s.dir=!0),s.dosPermissions&&16&s.dosPermissions&&(s.dir=!0),s.dir&&(t=m(t)),s.createFolders&&(n=f(t))&&g.call(this,n,!0);var h="string"===r&&!1===s.binary&&!1===s.base64;i&&void 0!==i.binary||(s.binary=!h),(e instanceof c&&0===e.uncompressedSize||s.dir||!e||0===e.length)&&(s.base64=!1,s.binary=!0,e="",s.compression="STORE",r="string");var y=null;y=e instanceof c||e instanceof o?e:d.isNode&&d.isStream(e)?new p(t,e):a.prepareContent(t,e,s.binary,s.optimizedBinaryString,s.base64);var b=new u(t,y,s);this.files[t]=b}var r=t("./utf8"),a=t("./utils"),o=t("./stream/GenericWorker"),s=t("./stream/StreamHelper"),l=t("./defaults"),c=t("./compressedObject"),u=t("./zipObject"),h=t("./generate"),d=t("./nodejsUtils"),p=t("./nodejs/NodejsStreamInputAdapter"),f=function(t){"/"===t.slice(-1)&&(t=t.substring(0,t.length-1));var e=t.lastIndexOf("/");return 0<e?t.substring(0,e):""},m=function(t){return"/"!==t.slice(-1)&&(t+="/"),t},g=function(t,e){return e=void 0!==e?e:l.createFolders,t=m(t),this.files[t]||n.call(this,t,null,{dir:!0,createFolders:e}),this.files[t]};function y(t){return"[object RegExp]"===Object.prototype.toString.call(t)}var b={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(t){var e,i,n;for(e in this.files)this.files.hasOwnProperty(e)&&(n=this.files[e],(i=e.slice(this.root.length,e.length))&&e.slice(0,this.root.length)===this.root&&t(i,n))},filter:function(t){var e=[];return this.forEach((function(i,n){t(i,n)&&e.push(n)})),e},file:function(t,e,i){if(1!==arguments.length)return t=this.root+t,n.call(this,t,e,i),this;if(y(t)){var r=t;return this.filter((function(t,e){return!e.dir&&r.test(t)}))}var a=this.files[this.root+t];return a&&!a.dir?a:null},folder:function(t){if(!t)return this;if(y(t))return this.filter((function(e,i){return i.dir&&t.test(e)}));var e=this.root+t,i=g.call(this,e),n=this.clone();return n.root=i.name,n},remove:function(t){t=this.root+t;var e=this.files[t];if(e||("/"!==t.slice(-1)&&(t+="/"),e=this.files[t]),e&&!e.dir)delete this.files[t];else for(var i=this.filter((function(e,i){return i.name.slice(0,t.length)===t})),n=0;n<i.length;n++)delete this.files[i[n].name];return this},generate:function(t){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(t){var e,i={};try{if((i=a.extend(t||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:r.utf8encode})).type=i.type.toLowerCase(),i.compression=i.compression.toUpperCase(),"binarystring"===i.type&&(i.type="string"),!i.type)throw new Error("No output type specified.");a.checkSupport(i.type),"darwin"!==i.platform&&"freebsd"!==i.platform&&"linux"!==i.platform&&"sunos"!==i.platform||(i.platform="UNIX"),"win32"===i.platform&&(i.platform="DOS");var n=i.comment||this.comment||"";e=h.generateWorker(this,i,n)}catch(t){(e=new o("error")).error(t)}return new s(e,i.type||"string",i.mimeType)},generateAsync:function(t,e){return this.generateInternalStream(t).accumulate(e)},generateNodeStream:function(t,e){return(t=t||{}).type||(t.type="nodebuffer"),this.generateInternalStream(t).toNodejsStream(e)}};e.exports=b},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,e,i){e.exports=t("stream")},{stream:void 0}],17:[function(t,e,i){"use strict";var n=t("./DataReader");function r(t){n.call(this,t);for(var e=0;e<this.data.length;e++)t[e]=255&t[e]}t("../utils").inherits(r,n),r.prototype.byteAt=function(t){return this.data[this.zero+t]},r.prototype.lastIndexOfSignature=function(t){for(var e=t.charCodeAt(0),i=t.charCodeAt(1),n=t.charCodeAt(2),r=t.charCodeAt(3),a=this.length-4;0<=a;--a)if(this.data[a]===e&&this.data[a+1]===i&&this.data[a+2]===n&&this.data[a+3]===r)return a-this.zero;return-1},r.prototype.readAndCheckSignature=function(t){var e=t.charCodeAt(0),i=t.charCodeAt(1),n=t.charCodeAt(2),r=t.charCodeAt(3),a=this.readData(4);return e===a[0]&&i===a[1]&&n===a[2]&&r===a[3]},r.prototype.readData=function(t){if(this.checkOffset(t),0===t)return[];var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e},e.exports=r},{"../utils":32,"./DataReader":18}],18:[function(t,e,i){"use strict";var n=t("../utils");function r(t){this.data=t,this.length=t.length,this.index=0,this.zero=0}r.prototype={checkOffset:function(t){this.checkIndex(this.index+t)},checkIndex:function(t){if(this.length<this.zero+t||t<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+t+"). Corrupted zip ?")},setIndex:function(t){this.checkIndex(t),this.index=t},skip:function(t){this.setIndex(this.index+t)},byteAt:function(t){},readInt:function(t){var e,i=0;for(this.checkOffset(t),e=this.index+t-1;e>=this.index;e--)i=(i<<8)+this.byteAt(e);return this.index+=t,i},readString:function(t){return n.transformTo("string",this.readData(t))},readData:function(t){},lastIndexOfSignature:function(t){},readAndCheckSignature:function(t){},readDate:function(){var t=this.readInt(4);return new Date(Date.UTC(1980+(t>>25&127),(t>>21&15)-1,t>>16&31,t>>11&31,t>>5&63,(31&t)<<1))}},e.exports=r},{"../utils":32}],19:[function(t,e,i){"use strict";var n=t("./Uint8ArrayReader");function r(t){n.call(this,t)}t("../utils").inherits(r,n),r.prototype.readData=function(t){this.checkOffset(t);var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e},e.exports=r},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,e,i){"use strict";var n=t("./DataReader");function r(t){n.call(this,t)}t("../utils").inherits(r,n),r.prototype.byteAt=function(t){return this.data.charCodeAt(this.zero+t)},r.prototype.lastIndexOfSignature=function(t){return this.data.lastIndexOf(t)-this.zero},r.prototype.readAndCheckSignature=function(t){return t===this.readData(4)},r.prototype.readData=function(t){this.checkOffset(t);var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e},e.exports=r},{"../utils":32,"./DataReader":18}],21:[function(t,e,i){"use strict";var n=t("./ArrayReader");function r(t){n.call(this,t)}t("../utils").inherits(r,n),r.prototype.readData=function(t){if(this.checkOffset(t),0===t)return new Uint8Array(0);var e=this.data.subarray(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e},e.exports=r},{"../utils":32,"./ArrayReader":17}],22:[function(t,e,i){"use strict";var n=t("../utils"),r=t("../support"),a=t("./ArrayReader"),o=t("./StringReader"),s=t("./NodeBufferReader"),l=t("./Uint8ArrayReader");e.exports=function(t){var e=n.getTypeOf(t);return n.checkSupport(e),"string"!==e||r.uint8array?"nodebuffer"===e?new s(t):r.uint8array?new l(n.transformTo("uint8array",t)):new a(n.transformTo("array",t)):new o(t)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,e,i){"use strict";i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\b"},{}],24:[function(t,e,i){"use strict";var n=t("./GenericWorker"),r=t("../utils");function a(t){n.call(this,"ConvertWorker to "+t),this.destType=t}r.inherits(a,n),a.prototype.processChunk=function(t){this.push({data:r.transformTo(this.destType,t.data),meta:t.meta})},e.exports=a},{"../utils":32,"./GenericWorker":28}],25:[function(t,e,i){"use strict";var n=t("./GenericWorker"),r=t("../crc32");function a(){n.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(a,n),a.prototype.processChunk=function(t){this.streamInfo.crc32=r(t.data,this.streamInfo.crc32||0),this.push(t)},e.exports=a},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,e,i){"use strict";var n=t("../utils"),r=t("./GenericWorker");function a(t){r.call(this,"DataLengthProbe for "+t),this.propName=t,this.withStreamInfo(t,0)}n.inherits(a,r),a.prototype.processChunk=function(t){if(t){var e=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=e+t.data.length}r.prototype.processChunk.call(this,t)},e.exports=a},{"../utils":32,"./GenericWorker":28}],27:[function(t,e,i){"use strict";var n=t("../utils"),r=t("./GenericWorker");function a(t){r.call(this,"DataWorker");var e=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,t.then((function(t){e.dataIsReady=!0,e.data=t,e.max=t&&t.length||0,e.type=n.getTypeOf(t),e.isPaused||e._tickAndRepeat()}),(function(t){e.error(t)}))}n.inherits(a,r),a.prototype.cleanUp=function(){r.prototype.cleanUp.call(this),this.data=null},a.prototype.resume=function(){return!!r.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,n.delay(this._tickAndRepeat,[],this)),!0)},a.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(n.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},a.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var t=null,e=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":t=this.data.substring(this.index,e);break;case"uint8array":t=this.data.subarray(this.index,e);break;case"array":case"nodebuffer":t=this.data.slice(this.index,e)}return this.index=e,this.push({data:t,meta:{percent:this.max?this.index/this.max*100:0}})},e.exports=a},{"../utils":32,"./GenericWorker":28}],28:[function(t,e,i){"use strict";function n(t){this.name=t||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}n.prototype={push:function(t){this.emit("data",t)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(t){this.emit("error",t)}return!0},error:function(t){return!this.isFinished&&(this.isPaused?this.generatedError=t:(this.isFinished=!0,this.emit("error",t),this.previous&&this.previous.error(t),this.cleanUp()),!0)},on:function(t,e){return this._listeners[t].push(e),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(t,e){if(this._listeners[t])for(var i=0;i<this._listeners[t].length;i++)this._listeners[t][i].call(this,e)},pipe:function(t){return t.registerPrevious(this)},registerPrevious:function(t){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=t.streamInfo,this.mergeStreamInfo(),this.previous=t;var e=this;return t.on("data",(function(t){e.processChunk(t)})),t.on("end",(function(){e.end()})),t.on("error",(function(t){e.error(t)})),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var t=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),t=!0),this.previous&&this.previous.resume(),!t},flush:function(){},processChunk:function(t){this.push(t)},withStreamInfo:function(t,e){return this.extraStreamInfo[t]=e,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var t in this.extraStreamInfo)this.extraStreamInfo.hasOwnProperty(t)&&(this.streamInfo[t]=this.extraStreamInfo[t])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var t="Worker "+this.name;return this.previous?this.previous+" -> "+t:t}},e.exports=n},{}],29:[function(t,i,n){"use strict";var r=t("../utils"),a=t("./ConvertWorker"),o=t("./GenericWorker"),s=t("../base64"),l=t("../support"),c=t("../external"),u=null;if(l.nodestream)try{u=t("../nodejs/NodejsStreamOutputAdapter")}catch(t){}function h(t,i){return new c.Promise((function(n,a){var o=[],l=t._internalType,c=t._outputType,u=t._mimeType;t.on("data",(function(t,e){o.push(t),i&&i(e)})).on("error",(function(t){o=[],a(t)})).on("end",(function(){try{var t=function(t,e,i){switch(t){case"blob":return r.newBlob(r.transformTo("arraybuffer",e),i);case"base64":return s.encode(e);default:return r.transformTo(t,e)}}(c,function(t,i){var n,r=0,a=null,o=0;for(n=0;n<i.length;n++)o+=i[n].length;switch(t){case"string":return i.join("");case"array":return Array.prototype.concat.apply([],i);case"uint8array":for(a=new Uint8Array(o),n=0;n<i.length;n++)a.set(i[n],r),r+=i[n].length;return a;case"nodebuffer":return e.concat(i);default:throw new Error("concat : unsupported type '"+t+"'")}}(l,o),u);n(t)}catch(t){a(t)}o=[]})).resume()}))}function d(t,e,i){var n=e;switch(e){case"blob":case"arraybuffer":n="uint8array";break;case"base64":n="string"}try{this._internalType=n,this._outputType=e,this._mimeType=i,r.checkSupport(n),this._worker=t.pipe(new a(n)),t.lock()}catch(t){this._worker=new o("error"),this._worker.error(t)}}d.prototype={accumulate:function(t){return h(this,t)},on:function(t,e){var i=this;return"data"===t?this._worker.on(t,(function(t){e.call(i,t.data,t.meta)})):this._worker.on(t,(function(){r.delay(e,arguments,i)})),this},resume:function(){return r.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(t){if(r.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new u(this,{objectMode:"nodebuffer"!==this._outputType},t)}},i.exports=d},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,i,n){"use strict";if(n.base64=!0,n.array=!0,n.string=!0,n.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,n.nodebuffer=void 0!==e,n.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)n.blob=!1;else{var r=new ArrayBuffer(0);try{n.blob=0===new Blob([r],{type:"application/zip"}).size}catch(t){try{var a=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);a.append(r),n.blob=0===a.getBlob("application/zip").size}catch(t){n.blob=!1}}}try{n.nodestream=!!t("readable-stream").Readable}catch(t){n.nodestream=!1}},{"readable-stream":16}],31:[function(t,e,i){"use strict";for(var n=t("./utils"),r=t("./support"),a=t("./nodejsUtils"),o=t("./stream/GenericWorker"),s=new Array(256),l=0;l<256;l++)s[l]=252<=l?6:248<=l?5:240<=l?4:224<=l?3:192<=l?2:1;function c(){o.call(this,"utf-8 decode"),this.leftOver=null}function u(){o.call(this,"utf-8 encode")}s[254]=s[254]=1,i.utf8encode=function(t){return r.nodebuffer?a.newBufferFrom(t,"utf-8"):function(t){var e,i,n,a,o,s=t.length,l=0;for(a=0;a<s;a++)55296==(64512&(i=t.charCodeAt(a)))&&a+1<s&&56320==(64512&(n=t.charCodeAt(a+1)))&&(i=65536+(i-55296<<10)+(n-56320),a++),l+=i<128?1:i<2048?2:i<65536?3:4;for(e=r.uint8array?new Uint8Array(l):new Array(l),a=o=0;o<l;a++)55296==(64512&(i=t.charCodeAt(a)))&&a+1<s&&56320==(64512&(n=t.charCodeAt(a+1)))&&(i=65536+(i-55296<<10)+(n-56320),a++),i<128?e[o++]=i:(i<2048?e[o++]=192|i>>>6:(i<65536?e[o++]=224|i>>>12:(e[o++]=240|i>>>18,e[o++]=128|i>>>12&63),e[o++]=128|i>>>6&63),e[o++]=128|63&i);return e}(t)},i.utf8decode=function(t){return r.nodebuffer?n.transformTo("nodebuffer",t).toString("utf-8"):function(t){var e,i,r,a,o=t.length,l=new Array(2*o);for(e=i=0;e<o;)if((r=t[e++])<128)l[i++]=r;else if(4<(a=s[r]))l[i++]=65533,e+=a-1;else{for(r&=2===a?31:3===a?15:7;1<a&&e<o;)r=r<<6|63&t[e++],a--;1<a?l[i++]=65533:r<65536?l[i++]=r:(r-=65536,l[i++]=55296|r>>10&1023,l[i++]=56320|1023&r)}return l.length!==i&&(l.subarray?l=l.subarray(0,i):l.length=i),n.applyFromCharCode(l)}(t=n.transformTo(r.uint8array?"uint8array":"array",t))},n.inherits(c,o),c.prototype.processChunk=function(t){var e=n.transformTo(r.uint8array?"uint8array":"array",t.data);if(this.leftOver&&this.leftOver.length){if(r.uint8array){var a=e;(e=new Uint8Array(a.length+this.leftOver.length)).set(this.leftOver,0),e.set(a,this.leftOver.length)}else e=this.leftOver.concat(e);this.leftOver=null}var o=function(t,e){var i;for((e=e||t.length)>t.length&&(e=t.length),i=e-1;0<=i&&128==(192&t[i]);)i--;return i<0||0===i?e:i+s[t[i]]>e?i:e}(e),l=e;o!==e.length&&(r.uint8array?(l=e.subarray(0,o),this.leftOver=e.subarray(o,e.length)):(l=e.slice(0,o),this.leftOver=e.slice(o,e.length))),this.push({data:i.utf8decode(l),meta:t.meta})},c.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=c,n.inherits(u,o),u.prototype.processChunk=function(t){this.push({data:i.utf8encode(t.data),meta:t.meta})},i.Utf8EncodeWorker=u},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,e,i){"use strict";var n=t("./support"),r=t("./base64"),a=t("./nodejsUtils"),o=t("set-immediate-shim"),s=t("./external");function l(t){return t}function c(t,e){for(var i=0;i<t.length;++i)e[i]=255&t.charCodeAt(i);return e}i.newBlob=function(t,e){i.checkSupport("blob");try{return new Blob([t],{type:e})}catch(i){try{var n=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return n.append(t),n.getBlob(e)}catch(t){throw new Error("Bug : can't construct the Blob.")}}};var u={stringifyByChunk:function(t,e,i){var n=[],r=0,a=t.length;if(a<=i)return String.fromCharCode.apply(null,t);for(;r<a;)"array"===e||"nodebuffer"===e?n.push(String.fromCharCode.apply(null,t.slice(r,Math.min(r+i,a)))):n.push(String.fromCharCode.apply(null,t.subarray(r,Math.min(r+i,a)))),r+=i;return n.join("")},stringifyByChar:function(t){for(var e="",i=0;i<t.length;i++)e+=String.fromCharCode(t[i]);return e},applyCanBeUsed:{uint8array:function(){try{return n.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(t){return!1}}(),nodebuffer:function(){try{return n.nodebuffer&&1===String.fromCharCode.apply(null,a.allocBuffer(1)).length}catch(t){return!1}}()}};function h(t){var e=65536,n=i.getTypeOf(t),r=!0;if("uint8array"===n?r=u.applyCanBeUsed.uint8array:"nodebuffer"===n&&(r=u.applyCanBeUsed.nodebuffer),r)for(;1<e;)try{return u.stringifyByChunk(t,n,e)}catch(t){e=Math.floor(e/2)}return u.stringifyByChar(t)}function d(t,e){for(var i=0;i<t.length;i++)e[i]=t[i];return e}i.applyFromCharCode=h;var p={};p.string={string:l,array:function(t){return c(t,new Array(t.length))},arraybuffer:function(t){return p.string.uint8array(t).buffer},uint8array:function(t){return c(t,new Uint8Array(t.length))},nodebuffer:function(t){return c(t,a.allocBuffer(t.length))}},p.array={string:h,array:l,arraybuffer:function(t){return new Uint8Array(t).buffer},uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return a.newBufferFrom(t)}},p.arraybuffer={string:function(t){return h(new Uint8Array(t))},array:function(t){return d(new Uint8Array(t),new Array(t.byteLength))},arraybuffer:l,uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return a.newBufferFrom(new Uint8Array(t))}},p.uint8array={string:h,array:function(t){return d(t,new Array(t.length))},arraybuffer:function(t){return t.buffer},uint8array:l,nodebuffer:function(t){return a.newBufferFrom(t)}},p.nodebuffer={string:h,array:function(t){return d(t,new Array(t.length))},arraybuffer:function(t){return p.nodebuffer.uint8array(t).buffer},uint8array:function(t){return d(t,new Uint8Array(t.length))},nodebuffer:l},i.transformTo=function(t,e){if(e=e||"",!t)return e;i.checkSupport(t);var n=i.getTypeOf(e);return p[n][t](e)},i.getTypeOf=function(t){return"string"==typeof t?"string":"[object Array]"===Object.prototype.toString.call(t)?"array":n.nodebuffer&&a.isBuffer(t)?"nodebuffer":n.uint8array&&t instanceof Uint8Array?"uint8array":n.arraybuffer&&t instanceof ArrayBuffer?"arraybuffer":void 0},i.checkSupport=function(t){if(!n[t.toLowerCase()])throw new Error(t+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(t){var e,i,n="";for(i=0;i<(t||"").length;i++)n+="\\x"+((e=t.charCodeAt(i))<16?"0":"")+e.toString(16).toUpperCase();return n},i.delay=function(t,e,i){o((function(){t.apply(i||null,e||[])}))},i.inherits=function(t,e){function i(){}i.prototype=e.prototype,t.prototype=new i},i.extend=function(){var t,e,i={};for(t=0;t<arguments.length;t++)for(e in arguments[t])arguments[t].hasOwnProperty(e)&&void 0===i[e]&&(i[e]=arguments[t][e]);return i},i.prepareContent=function(t,e,a,o,l){return s.Promise.resolve(e).then((function(t){return n.blob&&(t instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(t)))&&"undefined"!=typeof FileReader?new s.Promise((function(e,i){var n=new FileReader;n.onload=function(t){e(t.target.result)},n.onerror=function(t){i(t.target.error)},n.readAsArrayBuffer(t)})):t})).then((function(e){var u=i.getTypeOf(e);return u?("arraybuffer"===u?e=i.transformTo("uint8array",e):"string"===u&&(l?e=r.decode(e):a&&!0!==o&&(e=function(t){return c(t,n.uint8array?new Uint8Array(t.length):new Array(t.length))}(e))),e):s.Promise.reject(new Error("Can't read the data of '"+t+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))}))}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,"set-immediate-shim":54}],33:[function(t,e,i){"use strict";var n=t("./reader/readerFor"),r=t("./utils"),a=t("./signature"),o=t("./zipEntry"),s=(t("./utf8"),t("./support"));function l(t){this.files=[],this.loadOptions=t}l.prototype={checkSignature:function(t){if(!this.reader.readAndCheckSignature(t)){this.reader.index-=4;var e=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+r.pretty(e)+", expected "+r.pretty(t)+")")}},isSignature:function(t,e){var i=this.reader.index;this.reader.setIndex(t);var n=this.reader.readString(4)===e;return this.reader.setIndex(i),n},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var t=this.reader.readData(this.zipCommentLength),e=s.uint8array?"uint8array":"array",i=r.transformTo(e,t);this.zipComment=this.loadOptions.decodeFileName(i)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var t,e,i,n=this.zip64EndOfCentralSize-44;0<n;)t=this.reader.readInt(2),e=this.reader.readInt(4),i=this.reader.readData(e),this.zip64ExtensibleData[t]={id:t,length:e,value:i}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var t,e;for(t=0;t<this.files.length;t++)e=this.files[t],this.reader.setIndex(e.localHeaderOffset),this.checkSignature(a.LOCAL_FILE_HEADER),e.readLocalPart(this.reader),e.handleUTF8(),e.processAttributes()},readCentralDir:function(){var t;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(a.CENTRAL_FILE_HEADER);)(t=new o({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(t);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var t=this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);if(t<0)throw this.isSignature(0,a.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(t);var e=t;if(this.checkSignature(a.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===r.MAX_VALUE_16BITS||this.diskWithCentralDirStart===r.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===r.MAX_VALUE_16BITS||this.centralDirRecords===r.MAX_VALUE_16BITS||this.centralDirSize===r.MAX_VALUE_32BITS||this.centralDirOffset===r.MAX_VALUE_32BITS){if(this.zip64=!0,(t=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(t),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,a.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var i=this.centralDirOffset+this.centralDirSize;this.zip64&&(i+=20,i+=12+this.zip64EndOfCentralSize);var n=e-i;if(0<n)this.isSignature(e,a.CENTRAL_FILE_HEADER)||(this.reader.zero=n);else if(n<0)throw new Error("Corrupted zip: missing "+Math.abs(n)+" bytes.")},prepareReader:function(t){this.reader=n(t)},load:function(t){this.prepareReader(t),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},e.exports=l},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utf8":31,"./utils":32,"./zipEntry":34}],34:[function(t,e,i){"use strict";var n=t("./reader/readerFor"),r=t("./utils"),a=t("./compressedObject"),o=t("./crc32"),s=t("./utf8"),l=t("./compressions"),c=t("./support");function u(t,e){this.options=t,this.loadOptions=e}u.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(t){var e,i;if(t.skip(22),this.fileNameLength=t.readInt(2),i=t.readInt(2),this.fileName=t.readData(this.fileNameLength),t.skip(i),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(e=function(t){for(var e in l)if(l.hasOwnProperty(e)&&l[e].magic===t)return l[e];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+r.pretty(this.compressionMethod)+" unknown (inner file : "+r.transformTo("string",this.fileName)+")");this.decompressed=new a(this.compressedSize,this.uncompressedSize,this.crc32,e,t.readData(this.compressedSize))},readCentralPart:function(t){this.versionMadeBy=t.readInt(2),t.skip(2),this.bitFlag=t.readInt(2),this.compressionMethod=t.readString(2),this.date=t.readDate(),this.crc32=t.readInt(4),this.compressedSize=t.readInt(4),this.uncompressedSize=t.readInt(4);var e=t.readInt(2);if(this.extraFieldsLength=t.readInt(2),this.fileCommentLength=t.readInt(2),this.diskNumberStart=t.readInt(2),this.internalFileAttributes=t.readInt(2),this.externalFileAttributes=t.readInt(4),this.localHeaderOffset=t.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");t.skip(e),this.readExtraFields(t),this.parseZIP64ExtraField(t),this.fileComment=t.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var t=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==t&&(this.dosPermissions=63&this.externalFileAttributes),3==t&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(t){if(this.extraFields[1]){var e=n(this.extraFields[1].value);this.uncompressedSize===r.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===r.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===r.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===r.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(t){var e,i,n,r=t.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});t.index+4<r;)e=t.readInt(2),i=t.readInt(2),n=t.readData(i),this.extraFields[e]={id:e,length:i,value:n};t.setIndex(r)},handleUTF8:function(){var t=c.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=s.utf8decode(this.fileName),this.fileCommentStr=s.utf8decode(this.fileComment);else{var e=this.findExtraFieldUnicodePath();if(null!==e)this.fileNameStr=e;else{var i=r.transformTo(t,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(i)}var n=this.findExtraFieldUnicodeComment();if(null!==n)this.fileCommentStr=n;else{var a=r.transformTo(t,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(a)}}},findExtraFieldUnicodePath:function(){var t=this.extraFields[28789];if(t){var e=n(t.value);return 1!==e.readInt(1)||o(this.fileName)!==e.readInt(4)?null:s.utf8decode(e.readData(t.length-5))}return null},findExtraFieldUnicodeComment:function(){var t=this.extraFields[25461];if(t){var e=n(t.value);return 1!==e.readInt(1)||o(this.fileComment)!==e.readInt(4)?null:s.utf8decode(e.readData(t.length-5))}return null}},e.exports=u},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,e,i){"use strict";function n(t,e,i){this.name=t,this.dir=i.dir,this.date=i.date,this.comment=i.comment,this.unixPermissions=i.unixPermissions,this.dosPermissions=i.dosPermissions,this._data=e,this._dataBinary=i.binary,this.options={compression:i.compression,compressionOptions:i.compressionOptions}}var r=t("./stream/StreamHelper"),a=t("./stream/DataWorker"),o=t("./utf8"),s=t("./compressedObject"),l=t("./stream/GenericWorker");n.prototype={internalStream:function(t){var e=null,i="string";try{if(!t)throw new Error("No output type specified.");var n="string"===(i=t.toLowerCase())||"text"===i;"binarystring"!==i&&"text"!==i||(i="string"),e=this._decompressWorker();var a=!this._dataBinary;a&&!n&&(e=e.pipe(new o.Utf8EncodeWorker)),!a&&n&&(e=e.pipe(new o.Utf8DecodeWorker))}catch(t){(e=new l("error")).error(t)}return new r(e,i,"")},async:function(t,e){return this.internalStream(t).accumulate(e)},nodeStream:function(t,e){return this.internalStream(t||"nodebuffer").toNodejsStream(e)},_compressWorker:function(t,e){if(this._data instanceof s&&this._data.compression.magic===t.magic)return this._data.getCompressedWorker();var i=this._decompressWorker();return this._dataBinary||(i=i.pipe(new o.Utf8EncodeWorker)),s.createWorkerFrom(i,t,e)},_decompressWorker:function(){return this._data instanceof s?this._data.getContentWorker():this._data instanceof l?this._data:new a(this._data)}};for(var c=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],u=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},h=0;h<c.length;h++)n.prototype[c[h]]=u;e.exports=n},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,e,n){(function(t){"use strict";var i,n,r=t.MutationObserver||t.WebKitMutationObserver;if(r){var a=0,o=new r(u),s=t.document.createTextNode("");o.observe(s,{characterData:!0}),i=function(){s.data=a=++a%2}}else if(t.setImmediate||void 0===t.MessageChannel)i="document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var e=t.document.createElement("script");e.onreadystatechange=function(){u(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},t.document.documentElement.appendChild(e)}:function(){setTimeout(u,0)};else{var l=new t.MessageChannel;l.port1.onmessage=u,i=function(){l.port2.postMessage(0)}}var c=[];function u(){var t,e;n=!0;for(var i=c.length;i;){for(e=c,c=[],t=-1;++t<i;)e[t]();i=c.length}n=!1}e.exports=function(t){1!==c.push(t)||n||i()}}).call(this,void 0!==i?i:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(t,e,i){"use strict";var n=t("immediate");function r(){}var a={},o=["REJECTED"],s=["FULFILLED"],l=["PENDING"];function c(t){if("function"!=typeof t)throw new TypeError("resolver must be a function");this.state=l,this.queue=[],this.outcome=void 0,t!==r&&p(this,t)}function u(t,e,i){this.promise=t,"function"==typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof i&&(this.onRejected=i,this.callRejected=this.otherCallRejected)}function h(t,e,i){n((function(){var n;try{n=e(i)}catch(n){return a.reject(t,n)}n===t?a.reject(t,new TypeError("Cannot resolve promise with itself")):a.resolve(t,n)}))}function d(t){var e=t&&t.then;if(t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof e)return function(){e.apply(t,arguments)}}function p(t,e){var i=!1;function n(e){i||(i=!0,a.reject(t,e))}function r(e){i||(i=!0,a.resolve(t,e))}var o=f((function(){e(r,n)}));"error"===o.status&&n(o.value)}function f(t,e){var i={};try{i.value=t(e),i.status="success"}catch(t){i.status="error",i.value=t}return i}(e.exports=c).prototype.finally=function(t){if("function"!=typeof t)return this;var e=this.constructor;return this.then((function(i){return e.resolve(t()).then((function(){return i}))}),(function(i){return e.resolve(t()).then((function(){throw i}))}))},c.prototype.catch=function(t){return this.then(null,t)},c.prototype.then=function(t,e){if("function"!=typeof t&&this.state===s||"function"!=typeof e&&this.state===o)return this;var i=new this.constructor(r);return this.state!==l?h(i,this.state===s?t:e,this.outcome):this.queue.push(new u(i,t,e)),i},u.prototype.callFulfilled=function(t){a.resolve(this.promise,t)},u.prototype.otherCallFulfilled=function(t){h(this.promise,this.onFulfilled,t)},u.prototype.callRejected=function(t){a.reject(this.promise,t)},u.prototype.otherCallRejected=function(t){h(this.promise,this.onRejected,t)},a.resolve=function(t,e){var i=f(d,e);if("error"===i.status)return a.reject(t,i.value);var n=i.value;if(n)p(t,n);else{t.state=s,t.outcome=e;for(var r=-1,o=t.queue.length;++r<o;)t.queue[r].callFulfilled(e)}return t},a.reject=function(t,e){t.state=o,t.outcome=e;for(var i=-1,n=t.queue.length;++i<n;)t.queue[i].callRejected(e);return t},c.resolve=function(t){return t instanceof this?t:a.resolve(new this(r),t)},c.reject=function(t){var e=new this(r);return a.reject(e,t)},c.all=function(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var i=t.length,n=!1;if(!i)return this.resolve([]);for(var o=new Array(i),s=0,l=-1,c=new this(r);++l<i;)u(t[l],l);return c;function u(t,r){e.resolve(t).then((function(t){o[r]=t,++s!==i||n||(n=!0,a.resolve(c,o))}),(function(t){n||(n=!0,a.reject(c,t))}))}},c.race=function(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var i=t.length,n=!1;if(!i)return this.resolve([]);for(var o,s=-1,l=new this(r);++s<i;)o=t[s],e.resolve(o).then((function(t){n||(n=!0,a.resolve(l,t))}),(function(t){n||(n=!0,a.reject(l,t))}));return l}},{immediate:36}],38:[function(t,e,i){"use strict";var n={};(0,t("./lib/utils/common").assign)(n,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),e.exports=n},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,e,i){"use strict";var n=t("./zlib/deflate"),r=t("./utils/common"),a=t("./utils/strings"),o=t("./zlib/messages"),s=t("./zlib/zstream"),l=Object.prototype.toString,c=0,u=-1,h=0,d=8;function p(t){if(!(this instanceof p))return new p(t);this.options=r.assign({level:u,method:d,chunkSize:16384,windowBits:15,memLevel:8,strategy:h,to:""},t||{});var e=this.options;e.raw&&0<e.windowBits?e.windowBits=-e.windowBits:e.gzip&&0<e.windowBits&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var i=n.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(i!==c)throw new Error(o[i]);if(e.header&&n.deflateSetHeader(this.strm,e.header),e.dictionary){var f;if(f="string"==typeof e.dictionary?a.string2buf(e.dictionary):"[object ArrayBuffer]"===l.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,(i=n.deflateSetDictionary(this.strm,f))!==c)throw new Error(o[i]);this._dict_set=!0}}function f(t,e){var i=new p(e);if(i.push(t,!0),i.err)throw i.msg||o[i.err];return i.result}p.prototype.push=function(t,e){var i,o,s=this.strm,u=this.options.chunkSize;if(this.ended)return!1;o=e===~~e?e:!0===e?4:0,"string"==typeof t?s.input=a.string2buf(t):"[object ArrayBuffer]"===l.call(t)?s.input=new Uint8Array(t):s.input=t,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new r.Buf8(u),s.next_out=0,s.avail_out=u),1!==(i=n.deflate(s,o))&&i!==c)return this.onEnd(i),!(this.ended=!0);0!==s.avail_out&&(0!==s.avail_in||4!==o&&2!==o)||("string"===this.options.to?this.onData(a.buf2binstring(r.shrinkBuf(s.output,s.next_out))):this.onData(r.shrinkBuf(s.output,s.next_out)))}while((0<s.avail_in||0===s.avail_out)&&1!==i);return 4===o?(i=n.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===c):2!==o||(this.onEnd(c),!(s.avail_out=0))},p.prototype.onData=function(t){this.chunks.push(t)},p.prototype.onEnd=function(t){t===c&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},i.Deflate=p,i.deflate=f,i.deflateRaw=function(t,e){return(e=e||{}).raw=!0,f(t,e)},i.gzip=function(t,e){return(e=e||{}).gzip=!0,f(t,e)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,e,i){"use strict";var n=t("./zlib/inflate"),r=t("./utils/common"),a=t("./utils/strings"),o=t("./zlib/constants"),s=t("./zlib/messages"),l=t("./zlib/zstream"),c=t("./zlib/gzheader"),u=Object.prototype.toString;function h(t){if(!(this instanceof h))return new h(t);this.options=r.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;e.raw&&0<=e.windowBits&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(0<=e.windowBits&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),15<e.windowBits&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var i=n.inflateInit2(this.strm,e.windowBits);if(i!==o.Z_OK)throw new Error(s[i]);this.header=new c,n.inflateGetHeader(this.strm,this.header)}function d(t,e){var i=new h(e);if(i.push(t,!0),i.err)throw i.msg||s[i.err];return i.result}h.prototype.push=function(t,e){var i,s,l,c,h,d,p=this.strm,f=this.options.chunkSize,m=this.options.dictionary,g=!1;if(this.ended)return!1;s=e===~~e?e:!0===e?o.Z_FINISH:o.Z_NO_FLUSH,"string"==typeof t?p.input=a.binstring2buf(t):"[object ArrayBuffer]"===u.call(t)?p.input=new Uint8Array(t):p.input=t,p.next_in=0,p.avail_in=p.input.length;do{if(0===p.avail_out&&(p.output=new r.Buf8(f),p.next_out=0,p.avail_out=f),(i=n.inflate(p,o.Z_NO_FLUSH))===o.Z_NEED_DICT&&m&&(d="string"==typeof m?a.string2buf(m):"[object ArrayBuffer]"===u.call(m)?new Uint8Array(m):m,i=n.inflateSetDictionary(this.strm,d)),i===o.Z_BUF_ERROR&&!0===g&&(i=o.Z_OK,g=!1),i!==o.Z_STREAM_END&&i!==o.Z_OK)return this.onEnd(i),!(this.ended=!0);p.next_out&&(0!==p.avail_out&&i!==o.Z_STREAM_END&&(0!==p.avail_in||s!==o.Z_FINISH&&s!==o.Z_SYNC_FLUSH)||("string"===this.options.to?(l=a.utf8border(p.output,p.next_out),c=p.next_out-l,h=a.buf2string(p.output,l),p.next_out=c,p.avail_out=f-c,c&&r.arraySet(p.output,p.output,l,c,0),this.onData(h)):this.onData(r.shrinkBuf(p.output,p.next_out)))),0===p.avail_in&&0===p.avail_out&&(g=!0)}while((0<p.avail_in||0===p.avail_out)&&i!==o.Z_STREAM_END);return i===o.Z_STREAM_END&&(s=o.Z_FINISH),s===o.Z_FINISH?(i=n.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===o.Z_OK):s!==o.Z_SYNC_FLUSH||(this.onEnd(o.Z_OK),!(p.avail_out=0))},h.prototype.onData=function(t){this.chunks.push(t)},h.prototype.onEnd=function(t){t===o.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},i.Inflate=h,i.inflate=d,i.inflateRaw=function(t,e){return(e=e||{}).raw=!0,d(t,e)},i.ungzip=d},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,e,i){"use strict";var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;i.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var i=e.shift();if(i){if("object"!=typeof i)throw new TypeError(i+"must be non-object");for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])}}return t},i.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var r={arraySet:function(t,e,i,n,r){if(e.subarray&&t.subarray)t.set(e.subarray(i,i+n),r);else for(var a=0;a<n;a++)t[r+a]=e[i+a]},flattenChunks:function(t){var e,i,n,r,a,o;for(e=n=0,i=t.length;e<i;e++)n+=t[e].length;for(o=new Uint8Array(n),e=r=0,i=t.length;e<i;e++)a=t[e],o.set(a,r),r+=a.length;return o}},a={arraySet:function(t,e,i,n,r){for(var a=0;a<n;a++)t[r+a]=e[i+a]},flattenChunks:function(t){return[].concat.apply([],t)}};i.setTyped=function(t){t?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,r)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,a))},i.setTyped(n)},{}],42:[function(t,e,i){"use strict";var n=t("./common"),r=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch(t){r=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){a=!1}for(var o=new n.Buf8(256),s=0;s<256;s++)o[s]=252<=s?6:248<=s?5:240<=s?4:224<=s?3:192<=s?2:1;function l(t,e){if(e<65537&&(t.subarray&&a||!t.subarray&&r))return String.fromCharCode.apply(null,n.shrinkBuf(t,e));for(var i="",o=0;o<e;o++)i+=String.fromCharCode(t[o]);return i}o[254]=o[254]=1,i.string2buf=function(t){var e,i,r,a,o,s=t.length,l=0;for(a=0;a<s;a++)55296==(64512&(i=t.charCodeAt(a)))&&a+1<s&&56320==(64512&(r=t.charCodeAt(a+1)))&&(i=65536+(i-55296<<10)+(r-56320),a++),l+=i<128?1:i<2048?2:i<65536?3:4;for(e=new n.Buf8(l),a=o=0;o<l;a++)55296==(64512&(i=t.charCodeAt(a)))&&a+1<s&&56320==(64512&(r=t.charCodeAt(a+1)))&&(i=65536+(i-55296<<10)+(r-56320),a++),i<128?e[o++]=i:(i<2048?e[o++]=192|i>>>6:(i<65536?e[o++]=224|i>>>12:(e[o++]=240|i>>>18,e[o++]=128|i>>>12&63),e[o++]=128|i>>>6&63),e[o++]=128|63&i);return e},i.buf2binstring=function(t){return l(t,t.length)},i.binstring2buf=function(t){for(var e=new n.Buf8(t.length),i=0,r=e.length;i<r;i++)e[i]=t.charCodeAt(i);return e},i.buf2string=function(t,e){var i,n,r,a,s=e||t.length,c=new Array(2*s);for(i=n=0;i<s;)if((r=t[i++])<128)c[n++]=r;else if(4<(a=o[r]))c[n++]=65533,i+=a-1;else{for(r&=2===a?31:3===a?15:7;1<a&&i<s;)r=r<<6|63&t[i++],a--;1<a?c[n++]=65533:r<65536?c[n++]=r:(r-=65536,c[n++]=55296|r>>10&1023,c[n++]=56320|1023&r)}return l(c,n)},i.utf8border=function(t,e){var i;for((e=e||t.length)>t.length&&(e=t.length),i=e-1;0<=i&&128==(192&t[i]);)i--;return i<0||0===i?e:i+o[t[i]]>e?i:e}},{"./common":41}],43:[function(t,e,i){"use strict";e.exports=function(t,e,i,n){for(var r=65535&t|0,a=t>>>16&65535|0,o=0;0!==i;){for(i-=o=2e3<i?2e3:i;a=a+(r=r+e[n++]|0)|0,--o;);r%=65521,a%=65521}return r|a<<16|0}},{}],44:[function(t,e,i){"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,e,i){"use strict";var n=function(){for(var t,e=[],i=0;i<256;i++){t=i;for(var n=0;n<8;n++)t=1&t?3988292384^t>>>1:t>>>1;e[i]=t}return e}();e.exports=function(t,e,i,r){var a=n,o=r+i;t^=-1;for(var s=r;s<o;s++)t=t>>>8^a[255&(t^e[s])];return-1^t}},{}],46:[function(t,e,i){"use strict";var n,r=t("../utils/common"),a=t("./trees"),o=t("./adler32"),s=t("./crc32"),l=t("./messages"),c=0,u=4,h=0,d=-2,p=-1,f=4,m=2,g=8,y=9,b=286,A=30,v=19,w=2*b+1,E=15,_=3,x=258,T=x+_+1,M=42,C=113,k=1,R=2,S=3,D=4;function O(t,e){return t.msg=l[e],e}function P(t){return(t<<1)-(4<t?9:0)}function F(t){for(var e=t.length;0<=--e;)t[e]=0}function U(t){var e=t.state,i=e.pending;i>t.avail_out&&(i=t.avail_out),0!==i&&(r.arraySet(t.output,e.pending_buf,e.pending_out,i,t.next_out),t.next_out+=i,e.pending_out+=i,t.total_out+=i,t.avail_out-=i,e.pending-=i,0===e.pending&&(e.pending_out=0))}function B(t,e){a._tr_flush_block(t,0<=t.block_start?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,U(t.strm)}function I(t,e){t.pending_buf[t.pending++]=e}function j(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e}function L(t,e){var i,n,r=t.max_chain_length,a=t.strstart,o=t.prev_length,s=t.nice_match,l=t.strstart>t.w_size-T?t.strstart-(t.w_size-T):0,c=t.window,u=t.w_mask,h=t.prev,d=t.strstart+x,p=c[a+o-1],f=c[a+o];t.prev_length>=t.good_match&&(r>>=2),s>t.lookahead&&(s=t.lookahead);do{if(c[(i=e)+o]===f&&c[i+o-1]===p&&c[i]===c[a]&&c[++i]===c[a+1]){a+=2,i++;do{}while(c[++a]===c[++i]&&c[++a]===c[++i]&&c[++a]===c[++i]&&c[++a]===c[++i]&&c[++a]===c[++i]&&c[++a]===c[++i]&&c[++a]===c[++i]&&c[++a]===c[++i]&&a<d);if(n=x-(d-a),a=d-x,o<n){if(t.match_start=e,s<=(o=n))break;p=c[a+o-1],f=c[a+o]}}}while((e=h[e&u])>l&&0!=--r);return o<=t.lookahead?o:t.lookahead}function N(t){var e,i,n,a,l,c,u,h,d,p,f=t.w_size;do{if(a=t.window_size-t.lookahead-t.strstart,t.strstart>=f+(f-T)){for(r.arraySet(t.window,t.window,f,f,0),t.match_start-=f,t.strstart-=f,t.block_start-=f,e=i=t.hash_size;n=t.head[--e],t.head[e]=f<=n?n-f:0,--i;);for(e=i=f;n=t.prev[--e],t.prev[e]=f<=n?n-f:0,--i;);a+=f}if(0===t.strm.avail_in)break;if(c=t.strm,u=t.window,h=t.strstart+t.lookahead,p=void 0,(d=a)<(p=c.avail_in)&&(p=d),i=0===p?0:(c.avail_in-=p,r.arraySet(u,c.input,c.next_in,p,h),1===c.state.wrap?c.adler=o(c.adler,u,p,h):2===c.state.wrap&&(c.adler=s(c.adler,u,p,h)),c.next_in+=p,c.total_in+=p,p),t.lookahead+=i,t.lookahead+t.insert>=_)for(l=t.strstart-t.insert,t.ins_h=t.window[l],t.ins_h=(t.ins_h<<t.hash_shift^t.window[l+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[l+_-1])&t.hash_mask,t.prev[l&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=l,l++,t.insert--,!(t.lookahead+t.insert<_)););}while(t.lookahead<T&&0!==t.strm.avail_in)}function H(t,e){for(var i,n;;){if(t.lookahead<T){if(N(t),t.lookahead<T&&e===c)return k;if(0===t.lookahead)break}if(i=0,t.lookahead>=_&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+_-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==i&&t.strstart-i<=t.w_size-T&&(t.match_length=L(t,i)),t.match_length>=_)if(n=a._tr_tally(t,t.strstart-t.match_start,t.match_length-_),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=_){for(t.match_length--;t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+_-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart,0!=--t.match_length;);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else n=a._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(n&&(B(t,!1),0===t.strm.avail_out))return k}return t.insert=t.strstart<_-1?t.strstart:_-1,e===u?(B(t,!0),0===t.strm.avail_out?S:D):t.last_lit&&(B(t,!1),0===t.strm.avail_out)?k:R}function z(t,e){for(var i,n,r;;){if(t.lookahead<T){if(N(t),t.lookahead<T&&e===c)return k;if(0===t.lookahead)break}if(i=0,t.lookahead>=_&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+_-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=_-1,0!==i&&t.prev_length<t.max_lazy_match&&t.strstart-i<=t.w_size-T&&(t.match_length=L(t,i),t.match_length<=5&&(1===t.strategy||t.match_length===_&&4096<t.strstart-t.match_start)&&(t.match_length=_-1)),t.prev_length>=_&&t.match_length<=t.prev_length){for(r=t.strstart+t.lookahead-_,n=a._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-_),t.lookahead-=t.prev_length-1,t.prev_length-=2;++t.strstart<=r&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+_-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!=--t.prev_length;);if(t.match_available=0,t.match_length=_-1,t.strstart++,n&&(B(t,!1),0===t.strm.avail_out))return k}else if(t.match_available){if((n=a._tr_tally(t,0,t.window[t.strstart-1]))&&B(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return k}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(n=a._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<_-1?t.strstart:_-1,e===u?(B(t,!0),0===t.strm.avail_out?S:D):t.last_lit&&(B(t,!1),0===t.strm.avail_out)?k:R}function V(t,e,i,n,r){this.good_length=t,this.max_lazy=e,this.nice_length=i,this.max_chain=n,this.func=r}function G(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=g,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new r.Buf16(2*w),this.dyn_dtree=new r.Buf16(2*(2*A+1)),this.bl_tree=new r.Buf16(2*(2*v+1)),F(this.dyn_ltree),F(this.dyn_dtree),F(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new r.Buf16(E+1),this.heap=new r.Buf16(2*b+1),F(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new r.Buf16(2*b+1),F(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function W(t){var e;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=m,(e=t.state).pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?M:C,t.adler=2===e.wrap?0:1,e.last_flush=c,a._tr_init(e),h):O(t,d)}function X(t){var e=W(t);return e===h&&function(t){t.window_size=2*t.w_size,F(t.head),t.max_lazy_match=n[t.level].max_lazy,t.good_match=n[t.level].good_length,t.nice_match=n[t.level].nice_length,t.max_chain_length=n[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=_-1,t.match_available=0,t.ins_h=0}(t.state),e}function Y(t,e,i,n,a,o){if(!t)return d;var s=1;if(e===p&&(e=6),n<0?(s=0,n=-n):15<n&&(s=2,n-=16),a<1||y<a||i!==g||n<8||15<n||e<0||9<e||o<0||f<o)return O(t,d);8===n&&(n=9);var l=new G;return(t.state=l).strm=t,l.wrap=s,l.gzhead=null,l.w_bits=n,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=a+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+_-1)/_),l.window=new r.Buf8(2*l.w_size),l.head=new r.Buf16(l.hash_size),l.prev=new r.Buf16(l.w_size),l.lit_bufsize=1<<a+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new r.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=e,l.strategy=o,l.method=i,X(t)}n=[new V(0,0,0,0,(function(t,e){var i=65535;for(i>t.pending_buf_size-5&&(i=t.pending_buf_size-5);;){if(t.lookahead<=1){if(N(t),0===t.lookahead&&e===c)return k;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var n=t.block_start+i;if((0===t.strstart||t.strstart>=n)&&(t.lookahead=t.strstart-n,t.strstart=n,B(t,!1),0===t.strm.avail_out))return k;if(t.strstart-t.block_start>=t.w_size-T&&(B(t,!1),0===t.strm.avail_out))return k}return t.insert=0,e===u?(B(t,!0),0===t.strm.avail_out?S:D):(t.strstart>t.block_start&&(B(t,!1),t.strm.avail_out),k)})),new V(4,4,8,4,H),new V(4,5,16,8,H),new V(4,6,32,32,H),new V(4,4,16,16,z),new V(8,16,32,32,z),new V(8,16,128,128,z),new V(8,32,128,256,z),new V(32,128,258,1024,z),new V(32,258,258,4096,z)],i.deflateInit=function(t,e){return Y(t,e,g,15,8,0)},i.deflateInit2=Y,i.deflateReset=X,i.deflateResetKeep=W,i.deflateSetHeader=function(t,e){return t&&t.state?2!==t.state.wrap?d:(t.state.gzhead=e,h):d},i.deflate=function(t,e){var i,r,o,l;if(!t||!t.state||5<e||e<0)return t?O(t,d):d;if(r=t.state,!t.output||!t.input&&0!==t.avail_in||666===r.status&&e!==u)return O(t,0===t.avail_out?-5:d);if(r.strm=t,i=r.last_flush,r.last_flush=e,r.status===M)if(2===r.wrap)t.adler=0,I(r,31),I(r,139),I(r,8),r.gzhead?(I(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),I(r,255&r.gzhead.time),I(r,r.gzhead.time>>8&255),I(r,r.gzhead.time>>16&255),I(r,r.gzhead.time>>24&255),I(r,9===r.level?2:2<=r.strategy||r.level<2?4:0),I(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(I(r,255&r.gzhead.extra.length),I(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(t.adler=s(t.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69):(I(r,0),I(r,0),I(r,0),I(r,0),I(r,0),I(r,9===r.level?2:2<=r.strategy||r.level<2?4:0),I(r,3),r.status=C);else{var p=g+(r.w_bits-8<<4)<<8;p|=(2<=r.strategy||r.level<2?0:r.level<6?1:6===r.level?2:3)<<6,0!==r.strstart&&(p|=32),p+=31-p%31,r.status=C,j(r,p),0!==r.strstart&&(j(r,t.adler>>>16),j(r,65535&t.adler)),t.adler=1}if(69===r.status)if(r.gzhead.extra){for(o=r.pending;r.gzindex<(65535&r.gzhead.extra.length)&&(r.pending!==r.pending_buf_size||(r.gzhead.hcrc&&r.pending>o&&(t.adler=s(t.adler,r.pending_buf,r.pending-o,o)),U(t),o=r.pending,r.pending!==r.pending_buf_size));)I(r,255&r.gzhead.extra[r.gzindex]),r.gzindex++;r.gzhead.hcrc&&r.pending>o&&(t.adler=s(t.adler,r.pending_buf,r.pending-o,o)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=73)}else r.status=73;if(73===r.status)if(r.gzhead.name){o=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>o&&(t.adler=s(t.adler,r.pending_buf,r.pending-o,o)),U(t),o=r.pending,r.pending===r.pending_buf_size)){l=1;break}l=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,I(r,l)}while(0!==l);r.gzhead.hcrc&&r.pending>o&&(t.adler=s(t.adler,r.pending_buf,r.pending-o,o)),0===l&&(r.gzindex=0,r.status=91)}else r.status=91;if(91===r.status)if(r.gzhead.comment){o=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>o&&(t.adler=s(t.adler,r.pending_buf,r.pending-o,o)),U(t),o=r.pending,r.pending===r.pending_buf_size)){l=1;break}l=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,I(r,l)}while(0!==l);r.gzhead.hcrc&&r.pending>o&&(t.adler=s(t.adler,r.pending_buf,r.pending-o,o)),0===l&&(r.status=103)}else r.status=103;if(103===r.status&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&U(t),r.pending+2<=r.pending_buf_size&&(I(r,255&t.adler),I(r,t.adler>>8&255),t.adler=0,r.status=C)):r.status=C),0!==r.pending){if(U(t),0===t.avail_out)return r.last_flush=-1,h}else if(0===t.avail_in&&P(e)<=P(i)&&e!==u)return O(t,-5);if(666===r.status&&0!==t.avail_in)return O(t,-5);if(0!==t.avail_in||0!==r.lookahead||e!==c&&666!==r.status){var f=2===r.strategy?function(t,e){for(var i;;){if(0===t.lookahead&&(N(t),0===t.lookahead)){if(e===c)return k;break}if(t.match_length=0,i=a._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,i&&(B(t,!1),0===t.strm.avail_out))return k}return t.insert=0,e===u?(B(t,!0),0===t.strm.avail_out?S:D):t.last_lit&&(B(t,!1),0===t.strm.avail_out)?k:R}(r,e):3===r.strategy?function(t,e){for(var i,n,r,o,s=t.window;;){if(t.lookahead<=x){if(N(t),t.lookahead<=x&&e===c)return k;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=_&&0<t.strstart&&(n=s[r=t.strstart-1])===s[++r]&&n===s[++r]&&n===s[++r]){o=t.strstart+x;do{}while(n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&r<o);t.match_length=x-(o-r),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=_?(i=a._tr_tally(t,1,t.match_length-_),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(i=a._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),i&&(B(t,!1),0===t.strm.avail_out))return k}return t.insert=0,e===u?(B(t,!0),0===t.strm.avail_out?S:D):t.last_lit&&(B(t,!1),0===t.strm.avail_out)?k:R}(r,e):n[r.level].func(r,e);if(f!==S&&f!==D||(r.status=666),f===k||f===S)return 0===t.avail_out&&(r.last_flush=-1),h;if(f===R&&(1===e?a._tr_align(r):5!==e&&(a._tr_stored_block(r,0,0,!1),3===e&&(F(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),U(t),0===t.avail_out))return r.last_flush=-1,h}return e!==u?h:r.wrap<=0?1:(2===r.wrap?(I(r,255&t.adler),I(r,t.adler>>8&255),I(r,t.adler>>16&255),I(r,t.adler>>24&255),I(r,255&t.total_in),I(r,t.total_in>>8&255),I(r,t.total_in>>16&255),I(r,t.total_in>>24&255)):(j(r,t.adler>>>16),j(r,65535&t.adler)),U(t),0<r.wrap&&(r.wrap=-r.wrap),0!==r.pending?h:1)},i.deflateEnd=function(t){var e;return t&&t.state?(e=t.state.status)!==M&&69!==e&&73!==e&&91!==e&&103!==e&&e!==C&&666!==e?O(t,d):(t.state=null,e===C?O(t,-3):h):d},i.deflateSetDictionary=function(t,e){var i,n,a,s,l,c,u,p,f=e.length;if(!t||!t.state)return d;if(2===(s=(i=t.state).wrap)||1===s&&i.status!==M||i.lookahead)return d;for(1===s&&(t.adler=o(t.adler,e,f,0)),i.wrap=0,f>=i.w_size&&(0===s&&(F(i.head),i.strstart=0,i.block_start=0,i.insert=0),p=new r.Buf8(i.w_size),r.arraySet(p,e,f-i.w_size,i.w_size,0),e=p,f=i.w_size),l=t.avail_in,c=t.next_in,u=t.input,t.avail_in=f,t.next_in=0,t.input=e,N(i);i.lookahead>=_;){for(n=i.strstart,a=i.lookahead-(_-1);i.ins_h=(i.ins_h<<i.hash_shift^i.window[n+_-1])&i.hash_mask,i.prev[n&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=n,n++,--a;);i.strstart=n,i.lookahead=_-1,N(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=_-1,i.match_available=0,t.next_in=c,t.input=u,t.avail_in=l,i.wrap=s,h},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,e,i){"use strict";e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,e,i){"use strict";e.exports=function(t,e){var i,n,r,a,o,s,l,c,u,h,d,p,f,m,g,y,b,A,v,w,E,_,x,T,M;i=t.state,n=t.next_in,T=t.input,r=n+(t.avail_in-5),a=t.next_out,M=t.output,o=a-(e-t.avail_out),s=a+(t.avail_out-257),l=i.dmax,c=i.wsize,u=i.whave,h=i.wnext,d=i.window,p=i.hold,f=i.bits,m=i.lencode,g=i.distcode,y=(1<<i.lenbits)-1,b=(1<<i.distbits)-1;t:do{f<15&&(p+=T[n++]<<f,f+=8,p+=T[n++]<<f,f+=8),A=m[p&y];e:for(;;){if(p>>>=v=A>>>24,f-=v,0==(v=A>>>16&255))M[a++]=65535&A;else{if(!(16&v)){if(0==(64&v)){A=m[(65535&A)+(p&(1<<v)-1)];continue e}if(32&v){i.mode=12;break t}t.msg="invalid literal/length code",i.mode=30;break t}w=65535&A,(v&=15)&&(f<v&&(p+=T[n++]<<f,f+=8),w+=p&(1<<v)-1,p>>>=v,f-=v),f<15&&(p+=T[n++]<<f,f+=8,p+=T[n++]<<f,f+=8),A=g[p&b];i:for(;;){if(p>>>=v=A>>>24,f-=v,!(16&(v=A>>>16&255))){if(0==(64&v)){A=g[(65535&A)+(p&(1<<v)-1)];continue i}t.msg="invalid distance code",i.mode=30;break t}if(E=65535&A,f<(v&=15)&&(p+=T[n++]<<f,(f+=8)<v&&(p+=T[n++]<<f,f+=8)),l<(E+=p&(1<<v)-1)){t.msg="invalid distance too far back",i.mode=30;break t}if(p>>>=v,f-=v,(v=a-o)<E){if(u<(v=E-v)&&i.sane){t.msg="invalid distance too far back",i.mode=30;break t}if(x=d,(_=0)===h){if(_+=c-v,v<w){for(w-=v;M[a++]=d[_++],--v;);_=a-E,x=M}}else if(h<v){if(_+=c+h-v,(v-=h)<w){for(w-=v;M[a++]=d[_++],--v;);if(_=0,h<w){for(w-=v=h;M[a++]=d[_++],--v;);_=a-E,x=M}}}else if(_+=h-v,v<w){for(w-=v;M[a++]=d[_++],--v;);_=a-E,x=M}for(;2<w;)M[a++]=x[_++],M[a++]=x[_++],M[a++]=x[_++],w-=3;w&&(M[a++]=x[_++],1<w&&(M[a++]=x[_++]))}else{for(_=a-E;M[a++]=M[_++],M[a++]=M[_++],M[a++]=M[_++],2<(w-=3););w&&(M[a++]=M[_++],1<w&&(M[a++]=M[_++]))}break}}break}}while(n<r&&a<s);n-=w=f>>3,p&=(1<<(f-=w<<3))-1,t.next_in=n,t.next_out=a,t.avail_in=n<r?r-n+5:5-(n-r),t.avail_out=a<s?s-a+257:257-(a-s),i.hold=p,i.bits=f}},{}],49:[function(t,e,i){"use strict";var n=t("../utils/common"),r=t("./adler32"),a=t("./crc32"),o=t("./inffast"),s=t("./inftrees"),l=1,c=2,u=0,h=-2,d=1,p=852,f=592;function m(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function g(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new n.Buf16(320),this.work=new n.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function y(t){var e;return t&&t.state?(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=d,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new n.Buf32(p),e.distcode=e.distdyn=new n.Buf32(f),e.sane=1,e.back=-1,u):h}function b(t){var e;return t&&t.state?((e=t.state).wsize=0,e.whave=0,e.wnext=0,y(t)):h}function A(t,e){var i,n;return t&&t.state?(n=t.state,e<0?(i=0,e=-e):(i=1+(e>>4),e<48&&(e&=15)),e&&(e<8||15<e)?h:(null!==n.window&&n.wbits!==e&&(n.window=null),n.wrap=i,n.wbits=e,b(t))):h}function v(t,e){var i,n;return t?(n=new g,(t.state=n).window=null,(i=A(t,e))!==u&&(t.state=null),i):h}var w,E,_=!0;function x(t){if(_){var e;for(w=new n.Buf32(512),E=new n.Buf32(32),e=0;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(s(l,t.lens,0,288,w,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;s(c,t.lens,0,32,E,0,t.work,{bits:5}),_=!1}t.lencode=w,t.lenbits=9,t.distcode=E,t.distbits=5}function T(t,e,i,r){var a,o=t.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new n.Buf8(o.wsize)),r>=o.wsize?(n.arraySet(o.window,e,i-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):(r<(a=o.wsize-o.wnext)&&(a=r),n.arraySet(o.window,e,i-r,a,o.wnext),(r-=a)?(n.arraySet(o.window,e,i-r,r,0),o.wnext=r,o.whave=o.wsize):(o.wnext+=a,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=a))),0}i.inflateReset=b,i.inflateReset2=A,i.inflateResetKeep=y,i.inflateInit=function(t){return v(t,15)},i.inflateInit2=v,i.inflate=function(t,e){var i,p,f,g,y,b,A,v,w,E,_,M,C,k,R,S,D,O,P,F,U,B,I,j,L=0,N=new n.Buf8(4),H=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return h;12===(i=t.state).mode&&(i.mode=13),y=t.next_out,f=t.output,A=t.avail_out,g=t.next_in,p=t.input,b=t.avail_in,v=i.hold,w=i.bits,E=b,_=A,B=u;t:for(;;)switch(i.mode){case d:if(0===i.wrap){i.mode=13;break}for(;w<16;){if(0===b)break t;b--,v+=p[g++]<<w,w+=8}if(2&i.wrap&&35615===v){N[i.check=0]=255&v,N[1]=v>>>8&255,i.check=a(i.check,N,2,0),w=v=0,i.mode=2;break}if(i.flags=0,i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&v)<<8)+(v>>8))%31){t.msg="incorrect header check",i.mode=30;break}if(8!=(15&v)){t.msg="unknown compression method",i.mode=30;break}if(w-=4,U=8+(15&(v>>>=4)),0===i.wbits)i.wbits=U;else if(U>i.wbits){t.msg="invalid window size",i.mode=30;break}i.dmax=1<<U,t.adler=i.check=1,i.mode=512&v?10:12,w=v=0;break;case 2:for(;w<16;){if(0===b)break t;b--,v+=p[g++]<<w,w+=8}if(i.flags=v,8!=(255&i.flags)){t.msg="unknown compression method",i.mode=30;break}if(57344&i.flags){t.msg="unknown header flags set",i.mode=30;break}i.head&&(i.head.text=v>>8&1),512&i.flags&&(N[0]=255&v,N[1]=v>>>8&255,i.check=a(i.check,N,2,0)),w=v=0,i.mode=3;case 3:for(;w<32;){if(0===b)break t;b--,v+=p[g++]<<w,w+=8}i.head&&(i.head.time=v),512&i.flags&&(N[0]=255&v,N[1]=v>>>8&255,N[2]=v>>>16&255,N[3]=v>>>24&255,i.check=a(i.check,N,4,0)),w=v=0,i.mode=4;case 4:for(;w<16;){if(0===b)break t;b--,v+=p[g++]<<w,w+=8}i.head&&(i.head.xflags=255&v,i.head.os=v>>8),512&i.flags&&(N[0]=255&v,N[1]=v>>>8&255,i.check=a(i.check,N,2,0)),w=v=0,i.mode=5;case 5:if(1024&i.flags){for(;w<16;){if(0===b)break t;b--,v+=p[g++]<<w,w+=8}i.length=v,i.head&&(i.head.extra_len=v),512&i.flags&&(N[0]=255&v,N[1]=v>>>8&255,i.check=a(i.check,N,2,0)),w=v=0}else i.head&&(i.head.extra=null);i.mode=6;case 6:if(1024&i.flags&&(b<(M=i.length)&&(M=b),M&&(i.head&&(U=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Array(i.head.extra_len)),n.arraySet(i.head.extra,p,g,M,U)),512&i.flags&&(i.check=a(i.check,p,M,g)),b-=M,g+=M,i.length-=M),i.length))break t;i.length=0,i.mode=7;case 7:if(2048&i.flags){if(0===b)break t;for(M=0;U=p[g+M++],i.head&&U&&i.length<65536&&(i.head.name+=String.fromCharCode(U)),U&&M<b;);if(512&i.flags&&(i.check=a(i.check,p,M,g)),b-=M,g+=M,U)break t}else i.head&&(i.head.name=null);i.length=0,i.mode=8;case 8:if(4096&i.flags){if(0===b)break t;for(M=0;U=p[g+M++],i.head&&U&&i.length<65536&&(i.head.comment+=String.fromCharCode(U)),U&&M<b;);if(512&i.flags&&(i.check=a(i.check,p,M,g)),b-=M,g+=M,U)break t}else i.head&&(i.head.comment=null);i.mode=9;case 9:if(512&i.flags){for(;w<16;){if(0===b)break t;b--,v+=p[g++]<<w,w+=8}if(v!==(65535&i.check)){t.msg="header crc mismatch",i.mode=30;break}w=v=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),t.adler=i.check=0,i.mode=12;break;case 10:for(;w<32;){if(0===b)break t;b--,v+=p[g++]<<w,w+=8}t.adler=i.check=m(v),w=v=0,i.mode=11;case 11:if(0===i.havedict)return t.next_out=y,t.avail_out=A,t.next_in=g,t.avail_in=b,i.hold=v,i.bits=w,2;t.adler=i.check=1,i.mode=12;case 12:if(5===e||6===e)break t;case 13:if(i.last){v>>>=7&w,w-=7&w,i.mode=27;break}for(;w<3;){if(0===b)break t;b--,v+=p[g++]<<w,w+=8}switch(i.last=1&v,w-=1,3&(v>>>=1)){case 0:i.mode=14;break;case 1:if(x(i),i.mode=20,6!==e)break;v>>>=2,w-=2;break t;case 2:i.mode=17;break;case 3:t.msg="invalid block type",i.mode=30}v>>>=2,w-=2;break;case 14:for(v>>>=7&w,w-=7&w;w<32;){if(0===b)break t;b--,v+=p[g++]<<w,w+=8}if((65535&v)!=(v>>>16^65535)){t.msg="invalid stored block lengths",i.mode=30;break}if(i.length=65535&v,w=v=0,i.mode=15,6===e)break t;case 15:i.mode=16;case 16:if(M=i.length){if(b<M&&(M=b),A<M&&(M=A),0===M)break t;n.arraySet(f,p,g,M,y),b-=M,g+=M,A-=M,y+=M,i.length-=M;break}i.mode=12;break;case 17:for(;w<14;){if(0===b)break t;b--,v+=p[g++]<<w,w+=8}if(i.nlen=257+(31&v),v>>>=5,w-=5,i.ndist=1+(31&v),v>>>=5,w-=5,i.ncode=4+(15&v),v>>>=4,w-=4,286<i.nlen||30<i.ndist){t.msg="too many length or distance symbols",i.mode=30;break}i.have=0,i.mode=18;case 18:for(;i.have<i.ncode;){for(;w<3;){if(0===b)break t;b--,v+=p[g++]<<w,w+=8}i.lens[H[i.have++]]=7&v,v>>>=3,w-=3}for(;i.have<19;)i.lens[H[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,I={bits:i.lenbits},B=s(0,i.lens,0,19,i.lencode,0,i.work,I),i.lenbits=I.bits,B){t.msg="invalid code lengths set",i.mode=30;break}i.have=0,i.mode=19;case 19:for(;i.have<i.nlen+i.ndist;){for(;S=(L=i.lencode[v&(1<<i.lenbits)-1])>>>16&255,D=65535&L,!((R=L>>>24)<=w);){if(0===b)break t;b--,v+=p[g++]<<w,w+=8}if(D<16)v>>>=R,w-=R,i.lens[i.have++]=D;else{if(16===D){for(j=R+2;w<j;){if(0===b)break t;b--,v+=p[g++]<<w,w+=8}if(v>>>=R,w-=R,0===i.have){t.msg="invalid bit length repeat",i.mode=30;break}U=i.lens[i.have-1],M=3+(3&v),v>>>=2,w-=2}else if(17===D){for(j=R+3;w<j;){if(0===b)break t;b--,v+=p[g++]<<w,w+=8}w-=R,U=0,M=3+(7&(v>>>=R)),v>>>=3,w-=3}else{for(j=R+7;w<j;){if(0===b)break t;b--,v+=p[g++]<<w,w+=8}w-=R,U=0,M=11+(127&(v>>>=R)),v>>>=7,w-=7}if(i.have+M>i.nlen+i.ndist){t.msg="invalid bit length repeat",i.mode=30;break}for(;M--;)i.lens[i.have++]=U}}if(30===i.mode)break;if(0===i.lens[256]){t.msg="invalid code -- missing end-of-block",i.mode=30;break}if(i.lenbits=9,I={bits:i.lenbits},B=s(l,i.lens,0,i.nlen,i.lencode,0,i.work,I),i.lenbits=I.bits,B){t.msg="invalid literal/lengths set",i.mode=30;break}if(i.distbits=6,i.distcode=i.distdyn,I={bits:i.distbits},B=s(c,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,I),i.distbits=I.bits,B){t.msg="invalid distances set",i.mode=30;break}if(i.mode=20,6===e)break t;case 20:i.mode=21;case 21:if(6<=b&&258<=A){t.next_out=y,t.avail_out=A,t.next_in=g,t.avail_in=b,i.hold=v,i.bits=w,o(t,_),y=t.next_out,f=t.output,A=t.avail_out,g=t.next_in,p=t.input,b=t.avail_in,v=i.hold,w=i.bits,12===i.mode&&(i.back=-1);break}for(i.back=0;S=(L=i.lencode[v&(1<<i.lenbits)-1])>>>16&255,D=65535&L,!((R=L>>>24)<=w);){if(0===b)break t;b--,v+=p[g++]<<w,w+=8}if(S&&0==(240&S)){for(O=R,P=S,F=D;S=(L=i.lencode[F+((v&(1<<O+P)-1)>>O)])>>>16&255,D=65535&L,!(O+(R=L>>>24)<=w);){if(0===b)break t;b--,v+=p[g++]<<w,w+=8}v>>>=O,w-=O,i.back+=O}if(v>>>=R,w-=R,i.back+=R,i.length=D,0===S){i.mode=26;break}if(32&S){i.back=-1,i.mode=12;break}if(64&S){t.msg="invalid literal/length code",i.mode=30;break}i.extra=15&S,i.mode=22;case 22:if(i.extra){for(j=i.extra;w<j;){if(0===b)break t;b--,v+=p[g++]<<w,w+=8}i.length+=v&(1<<i.extra)-1,v>>>=i.extra,w-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=23;case 23:for(;S=(L=i.distcode[v&(1<<i.distbits)-1])>>>16&255,D=65535&L,!((R=L>>>24)<=w);){if(0===b)break t;b--,v+=p[g++]<<w,w+=8}if(0==(240&S)){for(O=R,P=S,F=D;S=(L=i.distcode[F+((v&(1<<O+P)-1)>>O)])>>>16&255,D=65535&L,!(O+(R=L>>>24)<=w);){if(0===b)break t;b--,v+=p[g++]<<w,w+=8}v>>>=O,w-=O,i.back+=O}if(v>>>=R,w-=R,i.back+=R,64&S){t.msg="invalid distance code",i.mode=30;break}i.offset=D,i.extra=15&S,i.mode=24;case 24:if(i.extra){for(j=i.extra;w<j;){if(0===b)break t;b--,v+=p[g++]<<w,w+=8}i.offset+=v&(1<<i.extra)-1,v>>>=i.extra,w-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){t.msg="invalid distance too far back",i.mode=30;break}i.mode=25;case 25:if(0===A)break t;if(M=_-A,i.offset>M){if((M=i.offset-M)>i.whave&&i.sane){t.msg="invalid distance too far back",i.mode=30;break}C=M>i.wnext?(M-=i.wnext,i.wsize-M):i.wnext-M,M>i.length&&(M=i.length),k=i.window}else k=f,C=y-i.offset,M=i.length;for(A<M&&(M=A),A-=M,i.length-=M;f[y++]=k[C++],--M;);0===i.length&&(i.mode=21);break;case 26:if(0===A)break t;f[y++]=i.length,A--,i.mode=21;break;case 27:if(i.wrap){for(;w<32;){if(0===b)break t;b--,v|=p[g++]<<w,w+=8}if(_-=A,t.total_out+=_,i.total+=_,_&&(t.adler=i.check=i.flags?a(i.check,f,_,y-_):r(i.check,f,_,y-_)),_=A,(i.flags?v:m(v))!==i.check){t.msg="incorrect data check",i.mode=30;break}w=v=0}i.mode=28;case 28:if(i.wrap&&i.flags){for(;w<32;){if(0===b)break t;b--,v+=p[g++]<<w,w+=8}if(v!==(4294967295&i.total)){t.msg="incorrect length check",i.mode=30;break}w=v=0}i.mode=29;case 29:B=1;break t;case 30:B=-3;break t;case 31:return-4;case 32:default:return h}return t.next_out=y,t.avail_out=A,t.next_in=g,t.avail_in=b,i.hold=v,i.bits=w,(i.wsize||_!==t.avail_out&&i.mode<30&&(i.mode<27||4!==e))&&T(t,t.output,t.next_out,_-t.avail_out)?(i.mode=31,-4):(E-=t.avail_in,_-=t.avail_out,t.total_in+=E,t.total_out+=_,i.total+=_,i.wrap&&_&&(t.adler=i.check=i.flags?a(i.check,f,_,t.next_out-_):r(i.check,f,_,t.next_out-_)),t.data_type=i.bits+(i.last?64:0)+(12===i.mode?128:0)+(20===i.mode||15===i.mode?256:0),(0==E&&0===_||4===e)&&B===u&&(B=-5),B)},i.inflateEnd=function(t){if(!t||!t.state)return h;var e=t.state;return e.window&&(e.window=null),t.state=null,u},i.inflateGetHeader=function(t,e){var i;return t&&t.state?0==(2&(i=t.state).wrap)?h:((i.head=e).done=!1,u):h},i.inflateSetDictionary=function(t,e){var i,n=e.length;return t&&t.state?0!==(i=t.state).wrap&&11!==i.mode?h:11===i.mode&&r(1,e,n,0)!==i.check?-3:T(t,e,n,n)?(i.mode=31,-4):(i.havedict=1,u):h},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,e,i){"use strict";var n=t("../utils/common"),r=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],s=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(t,e,i,l,c,u,h,d){var p,f,m,g,y,b,A,v,w,E=d.bits,_=0,x=0,T=0,M=0,C=0,k=0,R=0,S=0,D=0,O=0,P=null,F=0,U=new n.Buf16(16),B=new n.Buf16(16),I=null,j=0;for(_=0;_<=15;_++)U[_]=0;for(x=0;x<l;x++)U[e[i+x]]++;for(C=E,M=15;1<=M&&0===U[M];M--);if(M<C&&(C=M),0===M)return c[u++]=20971520,c[u++]=20971520,d.bits=1,0;for(T=1;T<M&&0===U[T];T++);for(C<T&&(C=T),_=S=1;_<=15;_++)if(S<<=1,(S-=U[_])<0)return-1;if(0<S&&(0===t||1!==M))return-1;for(B[1]=0,_=1;_<15;_++)B[_+1]=B[_]+U[_];for(x=0;x<l;x++)0!==e[i+x]&&(h[B[e[i+x]]++]=x);if(b=0===t?(P=I=h,19):1===t?(P=r,F-=257,I=a,j-=257,256):(P=o,I=s,-1),_=T,y=u,R=x=O=0,m=-1,g=(D=1<<(k=C))-1,1===t&&852<D||2===t&&592<D)return 1;for(;;){for(A=_-R,w=h[x]<b?(v=0,h[x]):h[x]>b?(v=I[j+h[x]],P[F+h[x]]):(v=96,0),p=1<<_-R,T=f=1<<k;c[y+(O>>R)+(f-=p)]=A<<24|v<<16|w|0,0!==f;);for(p=1<<_-1;O&p;)p>>=1;if(0!==p?(O&=p-1,O+=p):O=0,x++,0==--U[_]){if(_===M)break;_=e[i+h[x]]}if(C<_&&(O&g)!==m){for(0===R&&(R=C),y+=T,S=1<<(k=_-R);k+R<M&&!((S-=U[k+R])<=0);)k++,S<<=1;if(D+=1<<k,1===t&&852<D||2===t&&592<D)return 1;c[m=O&g]=C<<24|k<<16|y-u|0}}return 0!==O&&(c[y+O]=_-R<<24|64<<16|0),d.bits=C,0}},{"../utils/common":41}],51:[function(t,e,i){"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,e,i){"use strict";var n=t("../utils/common"),r=0,a=1;function o(t){for(var e=t.length;0<=--e;)t[e]=0}var s=0,l=29,c=256,u=c+1+l,h=30,d=19,p=2*u+1,f=15,m=16,g=7,y=256,b=16,A=17,v=18,w=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],E=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],_=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],x=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],T=new Array(2*(u+2));o(T);var M=new Array(2*h);o(M);var C=new Array(512);o(C);var k=new Array(256);o(k);var R=new Array(l);o(R);var S,D,O,P=new Array(h);function F(t,e,i,n,r){this.static_tree=t,this.extra_bits=e,this.extra_base=i,this.elems=n,this.max_length=r,this.has_stree=t&&t.length}function U(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}function B(t){return t<256?C[t]:C[256+(t>>>7)]}function I(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255}function j(t,e,i){t.bi_valid>m-i?(t.bi_buf|=e<<t.bi_valid&65535,I(t,t.bi_buf),t.bi_buf=e>>m-t.bi_valid,t.bi_valid+=i-m):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=i)}function L(t,e,i){j(t,i[2*e],i[2*e+1])}function N(t,e){for(var i=0;i|=1&t,t>>>=1,i<<=1,0<--e;);return i>>>1}function H(t,e,i){var n,r,a=new Array(f+1),o=0;for(n=1;n<=f;n++)a[n]=o=o+i[n-1]<<1;for(r=0;r<=e;r++){var s=t[2*r+1];0!==s&&(t[2*r]=N(a[s]++,s))}}function z(t){var e;for(e=0;e<u;e++)t.dyn_ltree[2*e]=0;for(e=0;e<h;e++)t.dyn_dtree[2*e]=0;for(e=0;e<d;e++)t.bl_tree[2*e]=0;t.dyn_ltree[2*y]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function V(t){8<t.bi_valid?I(t,t.bi_buf):0<t.bi_valid&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function G(t,e,i,n){var r=2*e,a=2*i;return t[r]<t[a]||t[r]===t[a]&&n[e]<=n[i]}function W(t,e,i){for(var n=t.heap[i],r=i<<1;r<=t.heap_len&&(r<t.heap_len&&G(e,t.heap[r+1],t.heap[r],t.depth)&&r++,!G(e,n,t.heap[r],t.depth));)t.heap[i]=t.heap[r],i=r,r<<=1;t.heap[i]=n}function X(t,e,i){var n,r,a,o,s=0;if(0!==t.last_lit)for(;n=t.pending_buf[t.d_buf+2*s]<<8|t.pending_buf[t.d_buf+2*s+1],r=t.pending_buf[t.l_buf+s],s++,0===n?L(t,r,e):(L(t,(a=k[r])+c+1,e),0!==(o=w[a])&&j(t,r-=R[a],o),L(t,a=B(--n),i),0!==(o=E[a])&&j(t,n-=P[a],o)),s<t.last_lit;);L(t,y,e)}function Y(t,e){var i,n,r,a=e.dyn_tree,o=e.stat_desc.static_tree,s=e.stat_desc.has_stree,l=e.stat_desc.elems,c=-1;for(t.heap_len=0,t.heap_max=p,i=0;i<l;i++)0!==a[2*i]?(t.heap[++t.heap_len]=c=i,t.depth[i]=0):a[2*i+1]=0;for(;t.heap_len<2;)a[2*(r=t.heap[++t.heap_len]=c<2?++c:0)]=1,t.depth[r]=0,t.opt_len--,s&&(t.static_len-=o[2*r+1]);for(e.max_code=c,i=t.heap_len>>1;1<=i;i--)W(t,a,i);for(r=l;i=t.heap[1],t.heap[1]=t.heap[t.heap_len--],W(t,a,1),n=t.heap[1],t.heap[--t.heap_max]=i,t.heap[--t.heap_max]=n,a[2*r]=a[2*i]+a[2*n],t.depth[r]=(t.depth[i]>=t.depth[n]?t.depth[i]:t.depth[n])+1,a[2*i+1]=a[2*n+1]=r,t.heap[1]=r++,W(t,a,1),2<=t.heap_len;);t.heap[--t.heap_max]=t.heap[1],function(t,e){var i,n,r,a,o,s,l=e.dyn_tree,c=e.max_code,u=e.stat_desc.static_tree,h=e.stat_desc.has_stree,d=e.stat_desc.extra_bits,m=e.stat_desc.extra_base,g=e.stat_desc.max_length,y=0;for(a=0;a<=f;a++)t.bl_count[a]=0;for(l[2*t.heap[t.heap_max]+1]=0,i=t.heap_max+1;i<p;i++)g<(a=l[2*l[2*(n=t.heap[i])+1]+1]+1)&&(a=g,y++),l[2*n+1]=a,c<n||(t.bl_count[a]++,o=0,m<=n&&(o=d[n-m]),s=l[2*n],t.opt_len+=s*(a+o),h&&(t.static_len+=s*(u[2*n+1]+o)));if(0!==y){do{for(a=g-1;0===t.bl_count[a];)a--;t.bl_count[a]--,t.bl_count[a+1]+=2,t.bl_count[g]--,y-=2}while(0<y);for(a=g;0!==a;a--)for(n=t.bl_count[a];0!==n;)c<(r=t.heap[--i])||(l[2*r+1]!==a&&(t.opt_len+=(a-l[2*r+1])*l[2*r],l[2*r+1]=a),n--)}}(t,e),H(a,c,t.bl_count)}function Q(t,e,i){var n,r,a=-1,o=e[1],s=0,l=7,c=4;for(0===o&&(l=138,c=3),e[2*(i+1)+1]=65535,n=0;n<=i;n++)r=o,o=e[2*(n+1)+1],++s<l&&r===o||(s<c?t.bl_tree[2*r]+=s:0!==r?(r!==a&&t.bl_tree[2*r]++,t.bl_tree[2*b]++):s<=10?t.bl_tree[2*A]++:t.bl_tree[2*v]++,a=r,c=(s=0)===o?(l=138,3):r===o?(l=6,3):(l=7,4))}function q(t,e,i){var n,r,a=-1,o=e[1],s=0,l=7,c=4;for(0===o&&(l=138,c=3),n=0;n<=i;n++)if(r=o,o=e[2*(n+1)+1],!(++s<l&&r===o)){if(s<c)for(;L(t,r,t.bl_tree),0!=--s;);else 0!==r?(r!==a&&(L(t,r,t.bl_tree),s--),L(t,b,t.bl_tree),j(t,s-3,2)):s<=10?(L(t,A,t.bl_tree),j(t,s-3,3)):(L(t,v,t.bl_tree),j(t,s-11,7));a=r,c=(s=0)===o?(l=138,3):r===o?(l=6,3):(l=7,4)}}o(P);var Z=!1;function K(t,e,i,r){j(t,(s<<1)+(r?1:0),3),function(t,e,i,r){V(t),r&&(I(t,i),I(t,~i)),n.arraySet(t.pending_buf,t.window,e,i,t.pending),t.pending+=i}(t,e,i,!0)}i._tr_init=function(t){Z||(function(){var t,e,i,n,r,a=new Array(f+1);for(n=i=0;n<l-1;n++)for(R[n]=i,t=0;t<1<<w[n];t++)k[i++]=n;for(k[i-1]=n,n=r=0;n<16;n++)for(P[n]=r,t=0;t<1<<E[n];t++)C[r++]=n;for(r>>=7;n<h;n++)for(P[n]=r<<7,t=0;t<1<<E[n]-7;t++)C[256+r++]=n;for(e=0;e<=f;e++)a[e]=0;for(t=0;t<=143;)T[2*t+1]=8,t++,a[8]++;for(;t<=255;)T[2*t+1]=9,t++,a[9]++;for(;t<=279;)T[2*t+1]=7,t++,a[7]++;for(;t<=287;)T[2*t+1]=8,t++,a[8]++;for(H(T,u+1,a),t=0;t<h;t++)M[2*t+1]=5,M[2*t]=N(t,5);S=new F(T,w,c+1,u,f),D=new F(M,E,0,h,f),O=new F(new Array(0),_,0,d,g)}(),Z=!0),t.l_desc=new U(t.dyn_ltree,S),t.d_desc=new U(t.dyn_dtree,D),t.bl_desc=new U(t.bl_tree,O),t.bi_buf=0,t.bi_valid=0,z(t)},i._tr_stored_block=K,i._tr_flush_block=function(t,e,i,n){var o,s,l=0;0<t.level?(2===t.strm.data_type&&(t.strm.data_type=function(t){var e,i=4093624447;for(e=0;e<=31;e++,i>>>=1)if(1&i&&0!==t.dyn_ltree[2*e])return r;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return a;for(e=32;e<c;e++)if(0!==t.dyn_ltree[2*e])return a;return r}(t)),Y(t,t.l_desc),Y(t,t.d_desc),l=function(t){var e;for(Q(t,t.dyn_ltree,t.l_desc.max_code),Q(t,t.dyn_dtree,t.d_desc.max_code),Y(t,t.bl_desc),e=d-1;3<=e&&0===t.bl_tree[2*x[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}(t),o=t.opt_len+3+7>>>3,(s=t.static_len+3+7>>>3)<=o&&(o=s)):o=s=i+5,i+4<=o&&-1!==e?K(t,e,i,n):4===t.strategy||s===o?(j(t,2+(n?1:0),3),X(t,T,M)):(j(t,4+(n?1:0),3),function(t,e,i,n){var r;for(j(t,e-257,5),j(t,i-1,5),j(t,n-4,4),r=0;r<n;r++)j(t,t.bl_tree[2*x[r]+1],3);q(t,t.dyn_ltree,e-1),q(t,t.dyn_dtree,i-1)}(t,t.l_desc.max_code+1,t.d_desc.max_code+1,l+1),X(t,t.dyn_ltree,t.dyn_dtree)),z(t),n&&V(t)},i._tr_tally=function(t,e,i){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&i,t.last_lit++,0===e?t.dyn_ltree[2*i]++:(t.matches++,e--,t.dyn_ltree[2*(k[i]+c+1)]++,t.dyn_dtree[2*B(e)]++),t.last_lit===t.lit_bufsize-1},i._tr_align=function(t){j(t,2,3),L(t,y,T),function(t){16===t.bi_valid?(I(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):8<=t.bi_valid&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}(t)}},{"../utils/common":41}],53:[function(t,e,i){"use strict";e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,e,i){"use strict";e.exports="function"==typeof n?n:function(){var t=[].slice.apply(arguments);t.splice(1,0,0),setTimeout.apply(null,t)}},{}]},{},[10])(10)}).call(this,i(181).Buffer,i(19),i(45).setImmediate)},function(t,e,i){"use strict";(function(t,i){var n=Object.keys,r=Array.isArray,a="undefined"!=typeof self?self:"undefined"!=typeof window?window:t;function o(t,e){return"object"!=typeof e||n(e).forEach((function(i){t[i]=e[i]})),t}var s=Object.getPrototypeOf,l={}.hasOwnProperty;function c(t,e){return l.call(t,e)}function u(t,e){"function"==typeof e&&(e=e(s(t))),n(e).forEach((function(i){d(t,i,e[i])}))}var h=Object.defineProperty;function d(t,e,i,n){h(t,e,o(i&&c(i,"get")&&"function"==typeof i.get?{get:i.get,set:i.set,configurable:!0}:{value:i,configurable:!0,writable:!0},n))}function p(t){return{from:function(e){return t.prototype=Object.create(e.prototype),d(t.prototype,"constructor",t),{extend:u.bind(null,t.prototype)}}}}var f=Object.getOwnPropertyDescriptor;function m(t,e){var i;return f(t,e)||(i=s(t))&&m(i,e)}var g=[].slice;function y(t,e,i){return g.call(t,e,i)}function b(t,e){return e(t)}function A(t){if(!t)throw new Error("Assertion Failed")}function v(t){a.setImmediate?i(t):setTimeout(t,0)}function w(t,e){return t.reduce((function(t,i,n){var r=e(i,n);return r&&(t[r[0]]=r[1]),t}),{})}function E(t,e){return function(){try{t.apply(this,arguments)}catch(t){e(t)}}}function _(t,e,i){try{t.apply(null,i)}catch(t){e&&e(t)}}function x(t,e){if(c(t,e))return t[e];if(!e)return t;if("string"!=typeof e){for(var i=[],n=0,r=e.length;n<r;++n){var a=x(t,e[n]);i.push(a)}return i}var o=e.indexOf(".");if(-1!==o){var s=t[e.substr(0,o)];return void 0===s?void 0:x(s,e.substr(o+1))}}function T(t,e,i){if(t&&void 0!==e&&(!("isFrozen"in Object)||!Object.isFrozen(t)))if("string"!=typeof e&&"length"in e){A("string"!=typeof i&&"length"in i);for(var n=0,r=e.length;n<r;++n)T(t,e[n],i[n])}else{var a=e.indexOf(".");if(-1!==a){var o=e.substr(0,a),s=e.substr(a+1);if(""===s)void 0===i?delete t[o]:t[o]=i;else{var l=t[o];l||(l=t[o]={}),T(l,s,i)}}else void 0===i?delete t[e]:t[e]=i}}function M(t){var e={};for(var i in t)c(t,i)&&(e[i]=t[i]);return e}var C=[].concat;function k(t){return C.apply([],t)}var R="Boolean,String,Date,RegExp,Blob,File,FileList,ArrayBuffer,DataView,Uint8ClampedArray,ImageData,Map,Set".split(",").concat(k([8,16,32,64].map((function(t){return["Int","Uint","Float"].map((function(e){return e+t+"Array"}))})))).filter((function(t){return a[t]})).map((function(t){return a[t]}));function S(t){if(!t||"object"!=typeof t)return t;var e;if(r(t)){e=[];for(var i=0,n=t.length;i<n;++i)e.push(S(t[i]))}else if(R.indexOf(t.constructor)>=0)e=t;else for(var a in e=t.constructor?Object.create(t.constructor.prototype):{},t)c(t,a)&&(e[a]=S(t[a]));return e}function D(t,e,i,r){return i=i||{},r=r||"",n(t).forEach((function(n){if(c(e,n)){var a=t[n],o=e[n];"object"==typeof a&&"object"==typeof o&&a&&o&&""+a.constructor==""+o.constructor?D(a,o,i,r+n+"."):a!==o&&(i[r+n]=e[n])}else i[r+n]=void 0})),n(e).forEach((function(n){c(t,n)||(i[r+n]=e[n])})),i}var O="undefined"!=typeof Symbol&&Symbol.iterator,P=O?function(t){var e;return null!=t&&(e=t[O])&&e.apply(t)}:function(){return null},F={};function U(t){var e,i,n,a;if(1===arguments.length){if(r(t))return t.slice();if(this===F&&"string"==typeof t)return[t];if(a=P(t)){for(i=[];!(n=a.next()).done;)i.push(n.value);return i}if(null==t)return[t];if("number"==typeof(e=t.length)){for(i=new Array(e);e--;)i[e]=t[e];return i}return[t]}for(e=arguments.length,i=new Array(e);e--;)i[e]=arguments[e];return i}var B="undefined"!=typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function I(t,e){B=t,j=e}var j=function(){return!0},L=!new Error("").stack;function N(){if(L)try{throw N.arguments,new Error}catch(t){return t}return new Error}function H(t,e){var i=t.stack;return i?(e=e||0,0===i.indexOf(t.name)&&(e+=(t.name+t.message).split("\n").length),i.split("\n").slice(e).filter(j).map((function(t){return"\n"+t})).join("")):""}var z=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],V=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(z),G={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed"};function W(t,e){this._e=N(),this.name=t,this.message=e}function X(t,e,i,n){this._e=N(),this.failures=e,this.failedKeys=n,this.successCount=i}function Y(t,e){this._e=N(),this.name="BulkError",this.failures=e,this.message=function(t,e){return t+". Errors: "+e.map((function(t){return t.toString()})).filter((function(t,e,i){return i.indexOf(t)===e})).join("\n")}(t,e)}p(W).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+H(this._e,2))}},toString:function(){return this.name+": "+this.message}}),p(X).from(W),p(Y).from(W);var Q=V.reduce((function(t,e){return t[e]=e+"Error",t}),{}),q=W,Z=V.reduce((function(t,e){var i=e+"Error";function n(t,n){this._e=N(),this.name=i,t?"string"==typeof t?(this.message=t,this.inner=n||null):"object"==typeof t&&(this.message=t.name+" "+t.message,this.inner=t):(this.message=G[e]||i,this.inner=null)}return p(n).from(q),t[e]=n,t}),{});Z.Syntax=SyntaxError,Z.Type=TypeError,Z.Range=RangeError;var K=z.reduce((function(t,e){return t[e+"Error"]=Z[e],t}),{});var J=V.reduce((function(t,e){return-1===["Syntax","Type","Range"].indexOf(e)&&(t[e+"Error"]=Z[e]),t}),{});function $(){}function tt(t){return t}function et(t,e){return null==t||t===tt?e:function(i){return e(t(i))}}function it(t,e){return function(){t.apply(this,arguments),e.apply(this,arguments)}}function nt(t,e){return t===$?e:function(){var i=t.apply(this,arguments);void 0!==i&&(arguments[0]=i);var n=this.onsuccess,r=this.onerror;this.onsuccess=null,this.onerror=null;var a=e.apply(this,arguments);return n&&(this.onsuccess=this.onsuccess?it(n,this.onsuccess):n),r&&(this.onerror=this.onerror?it(r,this.onerror):r),void 0!==a?a:i}}function rt(t,e){return t===$?e:function(){t.apply(this,arguments);var i=this.onsuccess,n=this.onerror;this.onsuccess=this.onerror=null,e.apply(this,arguments),i&&(this.onsuccess=this.onsuccess?it(i,this.onsuccess):i),n&&(this.onerror=this.onerror?it(n,this.onerror):n)}}function at(t,e){return t===$?e:function(i){var n=t.apply(this,arguments);o(i,n);var r=this.onsuccess,a=this.onerror;this.onsuccess=null,this.onerror=null;var s=e.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?it(r,this.onsuccess):r),a&&(this.onerror=this.onerror?it(a,this.onerror):a),void 0===n?void 0===s?void 0:s:o(n,s)}}function ot(t,e){return t===$?e:function(){return!1!==e.apply(this,arguments)&&t.apply(this,arguments)}}function st(t,e){return t===$?e:function(){var i=t.apply(this,arguments);if(i&&"function"==typeof i.then){for(var n=this,r=arguments.length,a=new Array(r);r--;)a[r]=arguments[r];return i.then((function(){return e.apply(n,a)}))}return e.apply(this,arguments)}}J.ModifyError=X,J.DexieError=W,J.BulkError=Y;var lt={},ct=function(){try{return new Function("let F=async ()=>{},p=F();return [p,Object.getPrototypeOf(p),Promise.resolve(),F.constructor];")()}catch(e){var t=a.Promise;return t?[t.resolve(),t.prototype,t.resolve()]:[]}}(),ut=ct[0],ht=ct[1],dt=ct[2],pt=ht&&ht.then,ft=ut&&ut.constructor,mt=ct[3],gt=!!dt,yt=!1,bt=dt?function(){dt.then(Ht)}:a.setImmediate?i.bind(null,Ht):a.MutationObserver?function(){var t=document.createElement("div");new MutationObserver((function(){Ht(),t=null})).observe(t,{attributes:!0}),t.setAttribute("i","1")}:function(){setTimeout(Ht,0)},At=function(t,e){kt.push([t,e]),wt&&(bt(),wt=!1)},vt=!0,wt=!0,Et=[],_t=[],xt=null,Tt=tt,Mt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:he,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach((function(t){try{he(t[0],t[1])}catch(t){}}))}},Ct=Mt,kt=[],Rt=0,St=[];function Dt(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=$,this._lib=!1;var e=this._PSD=Ct;if(B&&(this._stackHolder=N(),this._prev=null,this._numPrev=0),"function"!=typeof t){if(t!==lt)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&Ut(this,this._value))}this._state=null,this._value=null,++e.ref,Ft(this,t)}var Ot={get:function(){var t=Ct,e=Kt;function i(i,n){var r=this,a=!t.global&&(t!==Ct||e!==Kt);a&&ee();var o=new Dt((function(e,o){It(r,new Pt(le(i,t,a),le(n,t,a),e,o,t))}));return B&&Nt(o,this),o}return i.prototype=lt,i},set:function(t){d(this,"then",t&&t.prototype===lt?Ot:{get:function(){return t},set:Ot.set})}};function Pt(t,e,i,n,r){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.resolve=i,this.reject=n,this.psd=r}function Ft(t,e){try{e((function(e){if(null===t._state){if(e===t)throw new TypeError("A promise cannot be resolved with itself.");var i=t._lib&&zt();e&&"function"==typeof e.then?Ft(t,(function(t,i){e instanceof Dt?e._then(t,i):e.then(t,i)})):(t._state=!0,t._value=e,Bt(t)),i&&Vt()}}),Ut.bind(null,t))}catch(e){Ut(t,e)}}function Ut(t,e){if(_t.push(e),null===t._state){var i=t._lib&&zt();e=Tt(e),t._state=!1,t._value=e,B&&null!==e&&"object"==typeof e&&!e._promise&&_((function(){var i=m(e,"stack");e._promise=t,d(e,"stack",{get:function(){return yt?i&&(i.get?i.get.apply(e):i.value):t.stack}})})),function(t){Et.some((function(e){return e._value===t._value}))||Et.push(t)}(t),Bt(t),i&&Vt()}}function Bt(t){var e=t._listeners;t._listeners=[];for(var i=0,n=e.length;i<n;++i)It(t,e[i]);var r=t._PSD;--r.ref||r.finalize(),0===Rt&&(++Rt,At((function(){0==--Rt&&Gt()}),[]))}function It(t,e){if(null!==t._state){var i=t._state?e.onFulfilled:e.onRejected;if(null===i)return(t._state?e.resolve:e.reject)(t._value);++e.psd.ref,++Rt,At(jt,[i,t,e])}else t._listeners.push(e)}function jt(t,e,i){try{xt=e;var n,r=e._value;e._state?n=t(r):(_t.length&&(_t=[]),n=t(r),-1===_t.indexOf(r)&&function(t){var e=Et.length;for(;e;)if(Et[--e]._value===t._value)return void Et.splice(e,1)}(e)),i.resolve(n)}catch(t){i.reject(t)}finally{xt=null,0==--Rt&&Gt(),--i.psd.ref||i.psd.finalize()}}function Lt(t,e,i){if(e.length===i)return e;var n="";if(!1===t._state){var r,a,o=t._value;null!=o?(r=o.name||"Error",a=o.message||o,n=H(o,0)):(r=o,a=""),e.push(r+(a?": "+a:"")+n)}return B&&((n=H(t._stackHolder,2))&&-1===e.indexOf(n)&&e.push(n),t._prev&&Lt(t._prev,e,i)),e}function Nt(t,e){var i=e?e._numPrev+1:0;i<100&&(t._prev=e,t._numPrev=i)}function Ht(){zt()&&Vt()}function zt(){var t=vt;return vt=!1,wt=!1,t}function Vt(){var t,e,i;do{for(;kt.length>0;)for(t=kt,kt=[],i=t.length,e=0;e<i;++e){var n=t[e];n[0].apply(null,n[1])}}while(kt.length>0);vt=!0,wt=!0}function Gt(){var t=Et;Et=[],t.forEach((function(t){t._PSD.onunhandled.call(null,t._value,t)}));for(var e=St.slice(0),i=e.length;i;)e[--i]()}function Wt(t){return new Dt(lt,!1,t)}function Xt(t,e){var i=Ct;return function(){var n=zt(),r=Ct;try{return ae(i,!0),t.apply(this,arguments)}catch(t){e&&e(t)}finally{ae(r,!1),n&&Vt()}}}u(Dt.prototype,{then:Ot,_then:function(t,e){It(this,new Pt(null,null,t,e,Ct))},catch:function(t){if(1===arguments.length)return this.then(null,t);var e=arguments[0],i=arguments[1];return"function"==typeof e?this.then(null,(function(t){return t instanceof e?i(t):Wt(t)})):this.then(null,(function(t){return t&&t.name===e?i(t):Wt(t)}))},finally:function(t){return this.then((function(e){return t(),e}),(function(e){return t(),Wt(e)}))},stack:{get:function(){if(this._stack)return this._stack;try{yt=!0;var t=Lt(this,[],20).join("\nFrom previous: ");return null!==this._state&&(this._stack=t),t}finally{yt=!1}}},timeout:function(t,e){var i=this;return t<1/0?new Dt((function(n,r){var a=setTimeout((function(){return r(new Z.Timeout(e))}),t);i.then(n,r).finally(clearTimeout.bind(null,a))})):this}}),"undefined"!=typeof Symbol&&Symbol.toStringTag&&d(Dt.prototype,Symbol.toStringTag,"Promise"),Mt.env=oe(),u(Dt,{all:function(){var t=U.apply(null,arguments).map(ie);return new Dt((function(e,i){0===t.length&&e([]);var n=t.length;t.forEach((function(r,a){return Dt.resolve(r).then((function(i){t[a]=i,--n||e(t)}),i)}))}))},resolve:function(t){if(t instanceof Dt)return t;if(t&&"function"==typeof t.then)return new Dt((function(e,i){t.then(e,i)}));var e=new Dt(lt,!0,t);return Nt(e,xt),e},reject:Wt,race:function(){var t=U.apply(null,arguments).map(ie);return new Dt((function(e,i){t.map((function(t){return Dt.resolve(t).then(e,i)}))}))},PSD:{get:function(){return Ct},set:function(t){return Ct=t}},newPSD:$t,usePSD:se,scheduler:{get:function(){return At},set:function(t){At=t}},rejectionMapper:{get:function(){return Tt},set:function(t){Tt=t}},follow:function(t,e){return new Dt((function(i,n){return $t((function(e,i){var n=Ct;n.unhandleds=[],n.onunhandled=i,n.finalize=it((function(){var t=this;!function(t){function e(){t(),St.splice(St.indexOf(e),1)}St.push(e),++Rt,At((function(){0==--Rt&&Gt()}),[])}((function(){0===t.unhandleds.length?e():i(t.unhandleds[0])}))}),n.finalize),t()}),e,i,n)}))}});var Yt={awaits:0,echoes:0,id:0},Qt=0,qt=[],Zt=0,Kt=0,Jt=0;function $t(t,e,i,n){var r=Ct,a=Object.create(r);a.parent=r,a.ref=0,a.global=!1,a.id=++Jt;var s=Mt.env;a.env=gt?{Promise:Dt,PromiseProp:{value:Dt,configurable:!0,writable:!0},all:Dt.all,race:Dt.race,resolve:Dt.resolve,reject:Dt.reject,nthen:ce(s.nthen,a),gthen:ce(s.gthen,a)}:{},e&&o(a,e),++r.ref,a.finalize=function(){--this.parent.ref||this.parent.finalize()};var l=se(a,t,i,n);return 0===a.ref&&a.finalize(),l}function te(){return Yt.id||(Yt.id=++Qt),++Yt.awaits,Yt.echoes+=7,Yt.id}function ee(t){!Yt.awaits||t&&t!==Yt.id||(0==--Yt.awaits&&(Yt.id=0),Yt.echoes=7*Yt.awaits)}function ie(t){return Yt.echoes&&t&&t.constructor===ft?(te(),t.then((function(t){return ee(),t}),(function(t){return ee(),de(t)}))):t}function ne(t){++Kt,Yt.echoes&&0!=--Yt.echoes||(Yt.echoes=Yt.id=0),qt.push(Ct),ae(t,!0)}function re(){var t=qt[qt.length-1];qt.pop(),ae(t,!1)}function ae(t,e){var i,n=Ct;if((e?!Yt.echoes||Zt++&&t===Ct:!Zt||--Zt&&t===Ct)||(i=e?ne.bind(null,t):re,pt.call(ut,i)),t!==Ct&&(Ct=t,n===Mt&&(Mt.env=oe()),gt)){var r=Mt.env.Promise,o=t.env;ht.then=o.nthen,r.prototype.then=o.gthen,(n.global||t.global)&&(Object.defineProperty(a,"Promise",o.PromiseProp),r.all=o.all,r.race=o.race,r.resolve=o.resolve,r.reject=o.reject)}}function oe(){var t=a.Promise;return gt?{Promise:t,PromiseProp:Object.getOwnPropertyDescriptor(a,"Promise"),all:t.all,race:t.race,resolve:t.resolve,reject:t.reject,nthen:ht.then,gthen:t.prototype.then}:{}}function se(t,e,i,n,r){var a=Ct;try{return ae(t,!0),e(i,n,r)}finally{ae(a,!1)}}function le(t,e,i){return"function"!=typeof t?t:function(){var n=Ct;i&&te(),ae(e,!0);try{return t.apply(this,arguments)}finally{ae(n,!1)}}}function ce(t,e){return function(i,n){return t.call(this,le(i,e,!1),le(n,e,!1))}}var ue="unhandledrejection";function he(t,e){var i;try{i=e.onuncatched(t)}catch(t){}if(!1!==i)try{var n,r={promise:e,reason:t};if(a.document&&document.createEvent?((n=document.createEvent("Event")).initEvent(ue,!0,!0),o(n,r)):a.CustomEvent&&o(n=new CustomEvent(ue,{detail:r}),r),n&&a.dispatchEvent&&(dispatchEvent(n),!a.PromiseRejectionEvent&&a.onunhandledrejection))try{a.onunhandledrejection(n)}catch(t){}n.defaultPrevented||console.warn("Unhandled rejection: "+(t.stack||t))}catch(t){}}var de=Dt.reject;function pe(t){var e={},i=function(i,n){if(n){for(var r=arguments.length,a=new Array(r-1);--r;)a[r-1]=arguments[r];return e[i].subscribe.apply(null,a),t}if("string"==typeof i)return e[i]};i.addEventType=s;for(var a=1,o=arguments.length;a<o;++a)s(arguments[a]);return i;function s(t,n,r){if("object"==typeof t)return l(t);n||(n=ot),r||(r=$);var a={subscribers:[],fire:r,subscribe:function(t){-1===a.subscribers.indexOf(t)&&(a.subscribers.push(t),a.fire=n(a.fire,t))},unsubscribe:function(t){a.subscribers=a.subscribers.filter((function(e){return e!==t})),a.fire=a.subscribers.reduce(n,r)}};return e[t]=i[t]=a,a}function l(t){n(t).forEach((function(e){var i=t[e];if(r(i))s(e,t[e][0],t[e][1]);else{if("asap"!==i)throw new Z.InvalidArgument("Invalid event config");var n=s(e,tt,(function(){for(var t=arguments.length,e=new Array(t);t--;)e[t]=arguments[t];n.subscribers.forEach((function(t){v((function(){t.apply(null,e)}))}))}))}}))}}var fe,me="{version}",ge=String.fromCharCode(65535),ye=function(){try{return IDBKeyRange.only([[]]),[[]]}catch(t){return ge}}(),be=-1/0,Ae="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",ve="String expected.",we=[],Ee="undefined"!=typeof navigator&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),_e=Ee,xe=Ee,Te=function(t){return!/(dexie\.js|dexie\.min\.js)/.test(t)};function Me(t,e){var i,s,l,h,p,f=Me.dependencies,m=o({addons:Me.addons,autoOpen:!0,indexedDB:f.indexedDB,IDBKeyRange:f.IDBKeyRange},e),g=m.addons,v=m.autoOpen,C=m.indexedDB,R=m.IDBKeyRange,O=this._dbSchema={},P=[],I=[],j={},L=null,z=null,V=!1,G=null,W=!1,Q="readonly",q="readwrite",K=this,J=new Dt((function(t){i=t})),it=new Dt((function(t,e){s=e})),ot=!0,lt=!!je(C);function ct(t){this._cfg={version:t,storesSource:null,dbschema:{},tables:{},contentUpgrade:null},this.stores({})}function ut(t,e,i){var r=K._createTransaction(q,I,O);r.create(e),r._completion.catch(i);var a=r._reject.bind(r);$t((function(){Ct.trans=r,0===t?(n(O).forEach((function(t){ht(e,t,O[t].primKey,O[t].indexes)})),Dt.follow((function(){return K.on.populate.fire(r)})).catch(a)):function(t,e,i){var r=[],a=P.filter((function(e){return e._cfg.version===t}))[0];if(!a)throw new Z.Upgrade("Dexie specification of currently installed DB version is missing");O=K._dbSchema=a._cfg.dbschema;var o=!1;function s(){return r.length?Dt.resolve(r.shift()(e.idbtrans)).then(s):Dt.resolve()}return P.filter((function(e){return e._cfg.version>t})).forEach((function(t){r.push((function(){var n=O,r=t._cfg.dbschema;Bt(n,i),Bt(r,i),O=K._dbSchema=r;var a=function(t,e){var i={del:[],add:[],change:[]};for(var n in t)e[n]||i.del.push(n);for(n in e){var r=t[n],a=e[n];if(r){var o={name:n,def:a,recreate:!1,del:[],add:[],change:[]};if(r.primKey.src!==a.primKey.src)o.recreate=!0,i.change.push(o);else{var s=r.idxByName,l=a.idxByName;for(var c in s)l[c]||o.del.push(c);for(c in l){var u=s[c],h=l[c];u?u.src!==h.src&&o.change.push(h):o.add.push(h)}(o.del.length>0||o.add.length>0||o.change.length>0)&&i.change.push(o)}}else i.add.push([n,a])}return i}(n,r);if(a.add.forEach((function(t){ht(i,t[0],t[1].primKey,t[1].indexes)})),a.change.forEach((function(t){if(t.recreate)throw new Z.Upgrade("Not yet support for changing primary key");var e=i.objectStore(t.name);t.add.forEach((function(t){dt(e,t)})),t.change.forEach((function(t){e.deleteIndex(t.name),dt(e,t)})),t.del.forEach((function(t){e.deleteIndex(t)}))})),t._cfg.contentUpgrade)return o=!0,Dt.follow((function(){t._cfg.contentUpgrade(e)}))})),r.push((function(e){o&&_e||function(t,e){for(var i=0;i<e.db.objectStoreNames.length;++i){var n=e.db.objectStoreNames[i];null==t[n]&&e.db.deleteObjectStore(n)}}(t._cfg.dbschema,e)}))})),s().then((function(){!function(t,e){n(t).forEach((function(i){e.db.objectStoreNames.contains(i)||ht(e,i,t[i].primKey,t[i].indexes)}))}(O,i)}))}(t,r,e).catch(a)}))}function ht(t,e,i,n){var r=t.db.createObjectStore(e,i.keyPath?{keyPath:i.keyPath,autoIncrement:i.auto}:{autoIncrement:i.auto});return n.forEach((function(t){dt(r,t)})),r}function dt(t,e){t.createIndex(e.name,e.keyPath,{unique:e.unique,multiEntry:e.multi})}function pt(t,e,i){if(W||Ct.letThrough){var n=K._createTransaction(t,e,O);try{n.create()}catch(t){return de(t)}return n._promise(t,(function(t,e){return $t((function(){return Ct.trans=n,i(t,e,n)}))})).then((function(t){return n._completion.then((function(){return t}))}))}if(!V){if(!v)return de(new Z.DatabaseClosed);K.open().catch($)}return J.then((function(){return pt(t,e,i)}))}function gt(t,e,i){var n=arguments.length;if(n<2)throw new Z.InvalidArgument("Too few arguments");for(var r=new Array(n-1);--n;)r[n-1]=arguments[n];i=r.pop();var a=k(r);return[t,a,i]}function yt(t,e,i){this.name=t,this.schema=e,this._tx=i,this.hook=j[t]?j[t].hook:pe(null,{creating:[nt,$],reading:[et,tt],updating:[at,$],deleting:[rt,$]})}function bt(t,e,i){return(i?Oe:Se)((function(i){t.push(i),e&&e()}))}function At(t,e,i,n,r){return new Dt((function(a,o){var s=i.length,l=s-1;if(0===s)return a();if(n){var c,u=Oe(o),h=Re(null);_((function(){for(var n=0;n<s;++n){c={onsuccess:null,onerror:null};var o=i[n];r.call(c,o[0],o[1],e);var d=t.delete(o[0]);d._hookCtx=c,d.onerror=u,d.onsuccess=n===l?Re(a):h}}),(function(t){throw c.onerror&&c.onerror(t),t}))}else for(var d=0;d<s;++d){var p=t.delete(i[d]);p.onerror=Se(o),d===l&&(p.onsuccess=Xt((function(){return a()})))}}))}function vt(t,e,i,n){var r=this;this.db=K,this.mode=t,this.storeNames=e,this.idbtrans=null,this.on=pe(this,"complete","error","abort"),this.parent=n||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Dt((function(t,e){r._resolve=t,r._reject=e})),this._completion.then((function(){r.active=!1,r.on.complete.fire()}),(function(t){var e=r.active;return r.active=!1,r.on.error.fire(t),r.parent?r.parent._reject(t):e&&r.idbtrans&&r.idbtrans.abort(),de(t)}))}function wt(t,e,i){this._ctx={table:t,index:":id"===e?null:e,or:i}}function Et(t,e){var i=null,n=null;if(e)try{i=e()}catch(t){n=t}var r=t._ctx,a=r.table;this._ctx={table:a,index:r.index,isPrimKey:!r.index||a.schema.primKey.keyPath&&r.index===a.schema.primKey.name,range:i,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:n,or:r.or,valueMapper:a.hook.reading.fire}}function _t(t,e){return!(t.filter||t.algorithm||t.or)&&(e?t.justLimit:!t.replayFilter)}function xt(t,e){return t._cfg.version-e._cfg.version}function Tt(t,e,i){e.forEach((function(e){var n=i[e];t.forEach((function(t){e in t||(t===vt.prototype||t instanceof vt?d(t,e,{get:function(){return this.table(e)}}):t[e]=new yt(e,n))}))}))}function Mt(t,e,i,n,r,a){var o=Xt(a?function(t,e,n){return i(a(t),e,n)}:i,r);t.onerror||(t.onerror=Se(r)),t.onsuccess=E(e?function(){var i=t.result;if(i){var a=function(){i.continue()};e(i,(function(t){a=t}),n,r)&&o(i.value,i,(function(t){a=t})),a()}else n()}:function(){var e=t.result;if(e){var i=function(){e.continue()};o(e.value,e,(function(t){i=t})),i()}else n()},r)}function kt(t,e){return C.cmp(t,e)}function Rt(t,e){return kt(t,e)>0?t:e}function St(t,e){return C.cmp(t,e)}function Ot(t,e){return C.cmp(e,t)}function Pt(t,e){return t<e?-1:t===e?0:1}function Ft(t,e){return t>e?-1:t===e?0:1}function Ut(t,e){return t?e?function(){return t.apply(this,arguments)&&e.apply(this,arguments)}:t:e}function Bt(t,e){for(var i=e.db.objectStoreNames,n=0;n<i.length;++n){var r=i[n],o=e.objectStore(r);l="getAll"in o;for(var s=0;s<o.indexNames.length;++s){var c=o.indexNames[s],u=o.index(c).keyPath,h="string"==typeof u?u:"["+y(u).join("+")+"]";if(t[r]){var d=t[r].idxByName[h];d&&(d.name=c)}}}/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&a.WorkerGlobalScope&&a instanceof a.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(l=!1)}function It(t){K.on("blocked").fire(t),we.filter((function(t){return t.name===K.name&&t!==K&&!t._vcFired})).map((function(e){return e.on("versionchange").fire(t)}))}this.version=function(t){if(L||V)throw new Z.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,t);var e=P.filter((function(e){return e._cfg.version===t}))[0];return e||(e=new ct(t),P.push(e),P.sort(xt),ot=!1,e)},o(ct.prototype,{stores:function(t){this._cfg.storesSource=this._cfg.storesSource?o(this._cfg.storesSource,t):t;var e={};P.forEach((function(t){o(e,t._cfg.storesSource)}));var i=this._cfg.dbschema={};return this._parseStoresSpec(e,i),O=K._dbSchema=i,[j,K,vt.prototype].forEach((function(t){for(var e in t)t[e]instanceof yt&&delete t[e]})),Tt([j,K,vt.prototype,this._cfg.tables],n(i),i),I=n(i),this},upgrade:function(t){return this._cfg.contentUpgrade=t,this},_parseStoresSpec:function(t,e){n(t).forEach((function(i){if(null!==t[i]){var n={},a=function(t){var e=[];return t.split(",").forEach((function(t){var i=(t=t.trim()).replace(/([&*]|\+\+)/g,""),n=/^\[/.test(i)?i.match(/^\[(.*)\]$/)[1].split("+"):i;e.push(new Ue(i,n||null,/\&/.test(t),/\*/.test(t),/\+\+/.test(t),r(n),/\./.test(t)))})),e}(t[i]),o=a.shift();if(o.multi)throw new Z.Schema("Primary key cannot be multi-valued");o.keyPath&&T(n,o.keyPath,o.auto?0:o.keyPath),a.forEach((function(t){if(t.auto)throw new Z.Schema("Only primary key can be marked as autoIncrement (++)");if(!t.keyPath)throw new Z.Schema("Index must have a name and cannot be an empty string");T(n,t.keyPath,t.compound?t.keyPath.map((function(){return""})):"")})),e[i]=new Be(i,o,a,n)}}))}}),this._allTables=j,this._createTransaction=function(t,e,i,n){return new vt(t,e,i,n)},this._whenReady=function(t){return W||Ct.letThrough?t():new Dt((function(t,e){if(!V){if(!v)return void e(new Z.DatabaseClosed);K.open().catch($)}J.then(t,e)})).then(t)},this.verno=0,this.open=function(){if(V||L)return J.then((function(){return z?de(z):K}));B&&(it._stackHolder=N()),V=!0,z=null,W=!1;var e=i,r=null;return Dt.race([it,new Dt((function(e,i){if(!C)throw new Z.MissingAPI("indexedDB API not found. If using IE10+, make sure to run your code on a server URL (not locally). If using old Safari versions, make sure to include indexedDB polyfill.");var a=ot?C.open(t):C.open(t,Math.round(10*K.verno));if(!a)throw new Z.MissingAPI("IndexedDB API not available");a.onerror=Se(i),a.onblocked=Xt(It),a.onupgradeneeded=Xt((function(e){if(r=a.transaction,ot&&!K._allowEmptyDB){a.onerror=Pe,r.abort(),a.result.close();var n=C.deleteDatabase(t);n.onsuccess=n.onerror=Xt((function(){i(new Z.NoSuchDatabase("Database "+t+" doesnt exist"))}))}else{r.onerror=Se(i),ut((e.oldVersion>Math.pow(2,62)?0:e.oldVersion)/10,r,i)}}),i),a.onsuccess=Xt((function(){if(r=null,L=a.result,we.push(K),ot)!function(){if(K.verno=L.version/10,K._dbSchema=O={},0===(I=y(L.objectStoreNames,0)).length)return;var t=L.transaction(Ie(I),"readonly");I.forEach((function(e){for(var i=t.objectStore(e),n=i.keyPath,r=n&&"string"==typeof n&&-1!==n.indexOf("."),a=new Ue(n,n||"",!1,!1,!!i.autoIncrement,n&&"string"!=typeof n,r),o=[],s=0;s<i.indexNames.length;++s){var l=i.index(i.indexNames[s]);r=(n=l.keyPath)&&"string"==typeof n&&-1!==n.indexOf(".");var c=new Ue(l.name,n,!!l.unique,!!l.multiEntry,!1,n&&"string"!=typeof n,r);o.push(c)}O[e]=new Be(e,a,o,{})})),Tt([j],n(O),O)}();else if(L.objectStoreNames.length>0)try{Bt(O,L.transaction(Ie(L.objectStoreNames),Q))}catch(t){}L.onversionchange=Xt((function(t){K._vcFired=!0,K.on("versionchange").fire(t)})),lt||"__dbnames"===t||fe.dbnames.put({name:t}).catch($),e()}),i)}))]).then((function(){return G=[],Dt.resolve(Me.vip(K.on.ready.fire)).then((function t(){if(G.length>0){var e=G.reduce(st,$);return G=[],Dt.resolve(Me.vip(e)).then(t)}}))})).finally((function(){G=null})).then((function(){return V=!1,K})).catch((function(t){try{r&&r.abort()}catch(t){}return V=!1,K.close(),de(z=t)})).finally((function(){W=!0,e()}))},this.close=function(){var t=we.indexOf(K);if(t>=0&&we.splice(t,1),L){try{L.close()}catch(t){}L=null}v=!1,z=new Z.DatabaseClosed,V&&s(z),J=new Dt((function(t){i=t})),it=new Dt((function(t,e){s=e}))},this.delete=function(){var e=arguments.length>0;return new Dt((function(i,n){if(e)throw new Z.InvalidArgument("Arguments not allowed in db.delete()");function r(){K.close();var e=C.deleteDatabase(t);e.onsuccess=Xt((function(){lt||fe.dbnames.delete(t).catch($),i()})),e.onerror=Se(n),e.onblocked=It}V?J.then(r):r()}))},this.backendDB=function(){return L},this.isOpen=function(){return null!==L},this.hasBeenClosed=function(){return z&&z instanceof Z.DatabaseClosed},this.hasFailed=function(){return null!==z},this.dynamicallyOpened=function(){return ot},this.name=t,u(this,{tables:{get:function(){return n(j).map((function(t){return j[t]}))}}}),this.on=pe(this,"populate","blocked","versionchange",{ready:[st,$]}),this.on.ready.subscribe=b(this.on.ready.subscribe,(function(t){return function(e,i){Me.vip((function(){W?(z||Dt.resolve().then(e),i&&t(e)):G?(G.push(e),i&&t(e)):(t(e),i||t((function t(){K.on.ready.unsubscribe(e),K.on.ready.unsubscribe(t)})))}))}})),this.transaction=function(){var t=gt.apply(this,arguments);return this._transaction.apply(this,t)},this._transaction=function(t,e,i){var n=Ct.trans;n&&n.db===K&&-1===t.indexOf("!")||(n=null);var r=-1!==t.indexOf("?");t=t.replace("!","").replace("?","");try{var a=e.map((function(t){var e=t instanceof yt?t.name:t;if("string"!=typeof e)throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return e}));if("r"==t||t==Q)t=Q;else{if("rw"!=t&&t!=q)throw new Z.InvalidArgument("Invalid transaction mode: "+t);t=q}if(n){if(n.mode===Q&&t===q){if(!r)throw new Z.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");n=null}n&&a.forEach((function(t){if(n&&-1===n.storeNames.indexOf(t)){if(!r)throw new Z.SubTransaction("Table "+t+" not included in parent transaction.");n=null}})),r&&n&&!n.active&&(n=null)}}catch(t){return n?n._promise(null,(function(e,i){i(t)})):de(t)}return n?n._promise(t,o,"lock"):Ct.trans?se(Ct.transless,(function(){return K._whenReady(o)})):K._whenReady(o);function o(){return Dt.resolve().then((function(){var e,r=Ct.transless||Ct,o=K._createTransaction(t,a,O,n),s={trans:o,transless:r};n?o.idbtrans=n.idbtrans:o.create(),i.constructor===mt&&te();var l=Dt.follow((function(){if(e=i.call(o,o))if(e.constructor===ft){var t=ee.bind(null,null);e.then(t,t)}else"function"==typeof e.next&&"function"==typeof e.throw&&(e=Fe(e))}),s);return(e&&"function"==typeof e.then?Dt.resolve(e).then((function(t){return o.active?t:de(new Z.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))})):l.then((function(){return e}))).then((function(t){return n&&o._resolve(),o._completion.then((function(){return t}))})).catch((function(t){return o._reject(t),de(t)}))}))}},this.table=function(t){if(!c(j,t))throw new Z.InvalidTable("Table "+t+" does not exist");return j[t]},u(yt.prototype,{_trans:function(t,e,i){var n=this._tx||Ct.trans;return n&&n.db===K?n===Ct.trans?n._promise(t,e,i):$t((function(){return n._promise(t,e,i)}),{trans:n,transless:Ct.transless||Ct}):pt(t,[this.name],e)},_idbstore:function(t,e,i){var n=this.name;return this._trans(t,(function(t,i,r){if(-1===r.storeNames.indexOf(n))throw new Z.NotFound("Table"+n+" not part of transaction");return e(t,i,r.idbtrans.objectStore(n),r)}),i)},get:function(t,e){if(t&&t.constructor===Object)return this.where(t).first(e);var i=this;return this._idbstore(Q,(function(e,n,r){var a=r.get(t);a.onerror=Se(n),a.onsuccess=Xt((function(){e(i.hook.reading.fire(a.result))}),n)})).then(e)},where:function(t){if("string"==typeof t)return new wt(this,t);if(r(t))return new wt(this,"["+t.join("+")+"]");var e=n(t);if(1===e.length)return this.where(e[0]).equals(t[e[0]]);var i=this.schema.indexes.concat(this.schema.primKey).filter((function(t){return t.compound&&e.every((function(e){return t.keyPath.indexOf(e)>=0}))&&t.keyPath.every((function(t){return e.indexOf(t)>=0}))}))[0];if(i&&ye!==ge)return this.where(i.name).equals(i.keyPath.map((function(e){return t[e]})));i||console.warn("The query "+JSON.stringify(t)+" on "+this.name+" would benefit of a compound index ["+e.join("+")+"]");var a=this.schema.idxByName,o=e.reduce((function(e,i){return[e[0]||a[i],e[0]||!a[i]?Ut(e[1],(function(e){return""+x(e,i)==""+t[i]})):e[1]]}),[null,null]),s=o[0];return s?this.where(s.name).equals(t[s.keyPath]).filter(o[1]):i?this.filter(o[1]):this.where(e).equals("")},count:function(t){return this.toCollection().count(t)},offset:function(t){return this.toCollection().offset(t)},limit:function(t){return this.toCollection().limit(t)},reverse:function(){return this.toCollection().reverse()},filter:function(t){return this.toCollection().and(t)},each:function(t){return this.toCollection().each(t)},toArray:function(t){return this.toCollection().toArray(t)},orderBy:function(t){return new Et(new wt(this,r(t)?"["+t.join("+")+"]":t))},toCollection:function(){return new Et(new wt(this))},mapToClass:function(t,e){this.schema.mappedClass=t;var i=Object.create(t.prototype);e&&ke(i,e),this.schema.instanceTemplate=i;var n=function(e){if(!e)return e;var i=Object.create(t.prototype);for(var n in e)if(c(e,n))try{i[n]=e[n]}catch(t){}return i};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=n,this.hook("reading",n),t},defineClass:function(t){return this.mapToClass(Me.defineClass(t),t)},bulkDelete:function(t){return this.hook.deleting.fire===$?this._idbstore(q,(function(e,i,n,r){e(At(n,r,t,!1,$))})):this.where(":id").anyOf(t).delete().then((function(){}))},bulkPut:function(t,e){var i=this;return this._idbstore(q,(function(n,r,a){if(!a.keyPath&&!i.schema.primKey.auto&&!e)throw new Z.InvalidArgument("bulkPut() with non-inbound keys requires keys array in second argument");if(a.keyPath&&e)throw new Z.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(e&&e.length!==t.length)throw new Z.InvalidArgument("Arguments objects and keys must have the same length");if(0===t.length)return n();var o,s,l=function(t){0===c.length?n(t):r(new Y(i.name+".bulkPut(): "+c.length+" of "+u+" operations failed",c))},c=[],u=t.length,h=i;if(i.hook.creating.fire===$&&i.hook.updating.fire===$){s=bt(c);for(var d=0,p=t.length;d<p;++d)(o=e?a.put(t[d],e[d]):a.put(t[d])).onerror=s;o.onerror=bt(c,l),o.onsuccess=De(l)}else{var f=e||a.keyPath&&t.map((function(t){return x(t,a.keyPath)})),m=f&&w(f,(function(e,i){return null!=e&&[e,t[i]]}));(f?h.where(":id").anyOf(f.filter((function(t){return null!=t}))).modify((function(){this.value=m[this.primKey],m[this.primKey]=null})).catch(X,(function(t){c=t.failures})).then((function(){for(var i=[],n=e&&[],r=f.length-1;r>=0;--r){var a=f[r];(null==a||m[a])&&(i.push(t[r]),e&&n.push(a),null!=a&&(m[a]=null))}return i.reverse(),e&&n.reverse(),h.bulkAdd(i,n)})).then((function(t){var e=f[f.length-1];return null!=e?e:t})):h.bulkAdd(t)).then(l).catch(Y,(function(t){c=c.concat(t.failures),l()})).catch(r)}}),"locked")},bulkAdd:function(t,e){var i=this,n=this.hook.creating.fire;return this._idbstore(q,(function(r,a,o,s){if(!o.keyPath&&!i.schema.primKey.auto&&!e)throw new Z.InvalidArgument("bulkAdd() with non-inbound keys requires keys array in second argument");if(o.keyPath&&e)throw new Z.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(e&&e.length!==t.length)throw new Z.InvalidArgument("Arguments objects and keys must have the same length");if(0===t.length)return r();function l(t){0===d.length?r(t):a(new Y(i.name+".bulkAdd(): "+d.length+" of "+p+" operations failed",d))}var c,u,h,d=[],p=t.length;if(n!==$){var f,m=o.keyPath;u=bt(d,null,!0),h=Re(null),_((function(){for(var i=0,r=t.length;i<r;++i){f={onerror:null,onsuccess:null};var a=e&&e[i],l=t[i],d=e?a:m?x(l,m):void 0,p=n.call(f,d,l,s);null==d&&null!=p&&(m?T(l=S(l),m,p):a=p),(c=null!=a?o.add(l,a):o.add(l))._hookCtx=f,i<r-1&&(c.onerror=u,f.onsuccess&&(c.onsuccess=h))}}),(function(t){throw f.onerror&&f.onerror(t),t})),c.onerror=bt(d,l,!0),c.onsuccess=Re(l)}else{u=bt(d);for(var g=0,y=t.length;g<y;++g)(c=e?o.add(t[g],e[g]):o.add(t[g])).onerror=u;c.onerror=bt(d,l),c.onsuccess=De(l)}}))},add:function(t,e){var i=this.hook.creating.fire;return this._idbstore(q,(function(n,r,a,o){var s={onsuccess:null,onerror:null};if(i!==$){var l=null!=e?e:a.keyPath?x(t,a.keyPath):void 0,c=i.call(s,l,t,o);null==l&&null!=c&&(a.keyPath?T(t,a.keyPath,c):e=c)}try{var u=null!=e?a.add(t,e):a.add(t);u._hookCtx=s,u.onerror=Oe(r),u.onsuccess=Re((function(e){var i=a.keyPath;i&&T(t,i,e),n(e)}))}catch(t){throw s.onerror&&s.onerror(t),t}}))},put:function(t,e){var i=this,n=this.hook.creating.fire,r=this.hook.updating.fire;if(n!==$||r!==$){var a=this.schema.primKey.keyPath,o=void 0!==e?e:a&&x(t,a);return null==o?this.add(t):(t=S(t),this._trans(q,(function(){return i.where(":id").equals(o).modify((function(){this.value=t})).then((function(n){return 0===n?i.add(t,e):o}))}),"locked"))}return this._idbstore(q,(function(i,n,r){var a=void 0!==e?r.put(t,e):r.put(t);a.onerror=Se(n),a.onsuccess=Xt((function(e){var n=r.keyPath;n&&T(t,n,e.target.result),i(a.result)}))}))},delete:function(t){return this.hook.deleting.subscribers.length?this.where(":id").equals(t).delete():this._idbstore(q,(function(e,i,n){var r=n.delete(t);r.onerror=Se(i),r.onsuccess=Xt((function(){e(r.result)}))}))},clear:function(){return this.hook.deleting.subscribers.length?this.toCollection().delete():this._idbstore(q,(function(t,e,i){var n=i.clear();n.onerror=Se(e),n.onsuccess=Xt((function(){t(n.result)}))}))},update:function(t,e){if("object"!=typeof e||r(e))throw new Z.InvalidArgument("Modifications must be an object.");if("object"!=typeof t||r(t))return this.where(":id").equals(t).modify(e);n(e).forEach((function(i){T(t,i,e[i])}));var i=x(t,this.schema.primKey.keyPath);return void 0===i?de(new Z.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(i).modify(e)}}),u(vt.prototype,{_lock:function(){return A(!Ct.global),++this._reculock,1!==this._reculock||Ct.global||(Ct.lockOwnerFor=this),this},_unlock:function(){if(A(!Ct.global),0==--this._reculock)for(Ct.global||(Ct.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var t=this._blockedFuncs.shift();try{se(t[1],t[0])}catch(t){}}return this},_locked:function(){return this._reculock&&Ct.lockOwnerFor!==this},create:function(t){var e=this;if(!this.mode)return this;if(A(!this.idbtrans),!t&&!L)switch(z&&z.name){case"DatabaseClosedError":throw new Z.DatabaseClosed(z);case"MissingAPIError":throw new Z.MissingAPI(z.message,z);default:throw new Z.OpenFailed(z)}if(!this.active)throw new Z.TransactionInactive;return A(null===this._completion._state),(t=this.idbtrans=t||L.transaction(Ie(this.storeNames),this.mode)).onerror=Xt((function(i){Pe(i),e._reject(t.error)})),t.onabort=Xt((function(i){Pe(i),e.active&&e._reject(new Z.Abort(t.error)),e.active=!1,e.on("abort").fire(i)})),t.oncomplete=Xt((function(){e.active=!1,e._resolve()})),this},_promise:function(t,e,i){var n=this;if(t===q&&this.mode!==q)return de(new Z.ReadOnly("Transaction is readonly"));if(!this.active)return de(new Z.TransactionInactive);if(this._locked())return new Dt((function(r,a){n._blockedFuncs.push([function(){n._promise(t,e,i).then(r,a)},Ct])}));if(i)return $t((function(){var t=new Dt((function(t,i){n._lock();var r=e(t,i,n);r&&r.then&&r.then(t,i)}));return t.finally((function(){return n._unlock()})),t._lib=!0,t}));var r=new Dt((function(t,i){var r=e(t,i,n);r&&r.then&&r.then(t,i)}));return r._lib=!0,r},_root:function(){return this.parent?this.parent._root():this},waitFor:function(t){var e=this._root();if(t=Dt.resolve(t),e._waitingFor)e._waitingFor=e._waitingFor.then((function(){return t}));else{e._waitingFor=t,e._waitingQueue=[];var i=e.idbtrans.objectStore(e.storeNames[0]);!function t(){for(++e._spinCount;e._waitingQueue.length;)e._waitingQueue.shift()();e._waitingFor&&(i.get(-1/0).onsuccess=t)}()}var n=e._waitingFor;return new Dt((function(i,r){t.then((function(t){return e._waitingQueue.push(Xt(i.bind(null,t)))}),(function(t){return e._waitingQueue.push(Xt(r.bind(null,t)))})).finally((function(){e._waitingFor===n&&(e._waitingFor=null)}))}))},abort:function(){this.active&&this._reject(new Z.Abort),this.active=!1},tables:{get:(h="Transaction.tables",p=function(){return j},function(){return console.warn(h+" is deprecated. See https://github.com/dfahlander/Dexie.js/wiki/Deprecations. "+H(N(),1)),p.apply(this,arguments)})},table:function(t){return new yt(t,K.table(t).schema,this)}}),u(wt.prototype,(function(){function t(t,e,i){var n=t instanceof wt?new Et(t):t;return n._ctx.error=i?new i(e):new TypeError(e),n}function e(t){return new Et(t,(function(){return R.only("")})).limit(0)}function i(t,e,i,n,r,a){for(var o=Math.min(t.length,n.length),s=-1,l=0;l<o;++l){var c=e[l];if(c!==n[l])return r(t[l],i[l])<0?t.substr(0,l)+i[l]+i.substr(l+1):r(t[l],n[l])<0?t.substr(0,l)+n[l]+i.substr(l+1):s>=0?t.substr(0,s)+e[s]+i.substr(s+1):null;r(t[l],c)<0&&(s=l)}return o<n.length&&"next"===a?t+i.substr(t.length):o<t.length&&"prev"===a?t.substr(0,i.length):s<0?null:t.substr(0,s)+n[s]+i.substr(s+1)}function n(e,n,r,a){var o,s,l,c,u,h,d,p=r.length;if(!r.every((function(t){return"string"==typeof t})))return t(e,ve);function f(t){o=function(t){return"next"===t?function(t){return t.toUpperCase()}:function(t){return t.toLowerCase()}}(t),s=function(t){return"next"===t?function(t){return t.toLowerCase()}:function(t){return t.toUpperCase()}}(t),l="next"===t?Pt:Ft;var e=r.map((function(t){return{lower:s(t),upper:o(t)}})).sort((function(t,e){return l(t.lower,e.lower)}));c=e.map((function(t){return t.upper})),u=e.map((function(t){return t.lower})),h=t,d="next"===t?"":a}f("next");var m=new Et(e,(function(){return R.bound(c[0],u[p-1]+a)}));m._ondirectionchange=function(t){f(t)};var g=0;return m._addAlgorithm((function(t,e,r){var a=t.key;if("string"!=typeof a)return!1;var o=s(a);if(n(o,u,g))return!0;for(var f=null,m=g;m<p;++m){var y=i(a,o,c[m],u[m],l,h);null===y&&null===f?g=m+1:(null===f||l(f,y)>0)&&(f=y)}return e(null!==f?function(){t.continue(f+d)}:r),!1})),m}return{between:function(i,n,r,a){r=!1!==r,a=!0===a;try{return kt(i,n)>0||0===kt(i,n)&&(r||a)&&(!r||!a)?e(this):new Et(this,(function(){return R.bound(i,n,!r,!a)}))}catch(e){return t(this,Ae)}},equals:function(t){return new Et(this,(function(){return R.only(t)}))},above:function(t){return new Et(this,(function(){return R.lowerBound(t,!0)}))},aboveOrEqual:function(t){return new Et(this,(function(){return R.lowerBound(t)}))},below:function(t){return new Et(this,(function(){return R.upperBound(t,!0)}))},belowOrEqual:function(t){return new Et(this,(function(){return R.upperBound(t)}))},startsWith:function(e){return"string"!=typeof e?t(this,ve):this.between(e,e+ge,!0,!0)},startsWithIgnoreCase:function(t){return""===t?this.startsWith(t):n(this,(function(t,e){return 0===t.indexOf(e[0])}),[t],ge)},equalsIgnoreCase:function(t){return n(this,(function(t,e){return t===e[0]}),[t],"")},anyOfIgnoreCase:function(){var t=U.apply(F,arguments);return 0===t.length?e(this):n(this,(function(t,e){return-1!==e.indexOf(t)}),t,"")},startsWithAnyOfIgnoreCase:function(){var t=U.apply(F,arguments);return 0===t.length?e(this):n(this,(function(t,e){return e.some((function(e){return 0===t.indexOf(e)}))}),t,ge)},anyOf:function(){var i=U.apply(F,arguments),n=St;try{i.sort(n)}catch(e){return t(this,Ae)}if(0===i.length)return e(this);var r=new Et(this,(function(){return R.bound(i[0],i[i.length-1])}));r._ondirectionchange=function(t){n="next"===t?St:Ot,i.sort(n)};var a=0;return r._addAlgorithm((function(t,e,r){for(var o=t.key;n(o,i[a])>0;)if(++a===i.length)return e(r),!1;return 0===n(o,i[a])||(e((function(){t.continue(i[a])})),!1)})),r},notEqual:function(t){return this.inAnyRange([[be,t],[t,ye]],{includeLowers:!1,includeUppers:!1})},noneOf:function(){var e=U.apply(F,arguments);if(0===e.length)return new Et(this);try{e.sort(St)}catch(e){return t(this,Ae)}var i=e.reduce((function(t,e){return t?t.concat([[t[t.length-1][1],e]]):[[be,e]]}),null);return i.push([e[e.length-1],ye]),this.inAnyRange(i,{includeLowers:!1,includeUppers:!1})},inAnyRange:function(i,n){if(0===i.length)return e(this);if(!i.every((function(t){return void 0!==t[0]&&void 0!==t[1]&&St(t[0],t[1])<=0})))return t(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Z.InvalidArgument);var r=!n||!1!==n.includeLowers,a=n&&!0===n.includeUppers;var o,s=St;function l(t,e){return s(t[0],e[0])}try{(o=i.reduce((function(t,e){for(var i=0,n=t.length;i<n;++i){var r=t[i];if(kt(e[0],r[1])<0&&kt(e[1],r[0])>0){r[0]=kt(a=r[0],o=e[0])<0?a:o,r[1]=Rt(r[1],e[1]);break}}var a,o;return i===n&&t.push(e),t}),[])).sort(l)}catch(e){return t(this,Ae)}var c=0,u=a?function(t){return St(t,o[c][1])>0}:function(t){return St(t,o[c][1])>=0},h=r?function(t){return Ot(t,o[c][0])>0}:function(t){return Ot(t,o[c][0])>=0};var d=u,p=new Et(this,(function(){return R.bound(o[0][0],o[o.length-1][1],!r,!a)}));return p._ondirectionchange=function(t){"next"===t?(d=u,s=St):(d=h,s=Ot),o.sort(l)},p._addAlgorithm((function(t,e,i){for(var n=t.key;d(n);)if(++c===o.length)return e(i),!1;return!!function(t){return!u(t)&&!h(t)}(n)||(0===kt(n,o[c][1])||0===kt(n,o[c][0])||e((function(){s===St?t.continue(o[c][0]):t.continue(o[c][1])})),!1)})),p},startsWithAnyOf:function(){var i=U.apply(F,arguments);return i.every((function(t){return"string"==typeof t}))?0===i.length?e(this):this.inAnyRange(i.map((function(t){return[t,t+ge]}))):t(this,"startsWithAnyOf() only works with strings")}}})),u(Et.prototype,(function(){function t(t,e){t.filter=Ut(t.filter,e)}function e(t,e,i){var n=t.replayFilter;t.replayFilter=n?function(){return Ut(n(),e())}:e,t.justLimit=i&&!n}function i(t,e){if(t.isPrimKey)return e;var i=t.table.schema.idxByName[t.index];if(!i)throw new Z.Schema("KeyPath "+t.index+" on object store "+e.name+" is not indexed");return e.index(i.name)}function r(t,e){var n=i(t,e);return t.keysOnly&&"openKeyCursor"in n?n.openKeyCursor(t.range||null,t.dir+t.unique):n.openCursor(t.range||null,t.dir+t.unique)}function a(t,e,i,n,a){var o=t.replayFilter?Ut(t.filter,t.replayFilter()):t.filter;t.or?function(){var s={},l=0;function u(){2==++l&&i()}function h(t,i,r){if(!o||o(i,r,u,n)){var a=i.primaryKey,l=""+a;"[object ArrayBuffer]"===l&&(l=""+new Uint8Array(a)),c(s,l)||(s[l]=!0,e(t,i,r))}}t.or._iterate(h,u,n,a),Mt(r(t,a),t.algorithm,h,u,n,!t.keysOnly&&t.valueMapper)}():Mt(r(t,a),Ut(t.algorithm,o),e,i,n,!t.keysOnly&&t.valueMapper)}return{_read:function(t,e){var i=this._ctx;return i.error?i.table._trans(null,de.bind(null,i.error)):i.table._idbstore(Q,t).then(e)},_write:function(t){var e=this._ctx;return e.error?e.table._trans(null,de.bind(null,e.error)):e.table._idbstore(q,t,"locked")},_addAlgorithm:function(t){var e=this._ctx;e.algorithm=Ut(e.algorithm,t)},_iterate:function(t,e,i,n){return a(this._ctx,t,e,i,n)},clone:function(t){var e=Object.create(this.constructor.prototype),i=Object.create(this._ctx);return t&&o(i,t),e._ctx=i,e},raw:function(){return this._ctx.valueMapper=null,this},each:function(t){var e=this._ctx;return this._read((function(i,n,r){a(e,t,i,n,r)}))},count:function(t){var e=this._ctx;if(_t(e,!0))return this._read((function(t,n,r){var a=i(e,r),o=e.range?a.count(e.range):a.count();o.onerror=Se(n),o.onsuccess=function(i){t(Math.min(i.target.result,e.limit))}}),t);var n=0;return this._read((function(t,i,r){a(e,(function(){return++n,!1}),(function(){t(n)}),i,r)}),t)},sortBy:function(t,e){var i=t.split(".").reverse(),n=i[0],r=i.length-1;function a(t,e){return e?a(t[i[e]],e-1):t[n]}var o="next"===this._ctx.dir?1:-1;function s(t,e){var i=a(t,r),n=a(e,r);return i<n?-o:i>n?o:0}return this.toArray((function(t){return t.sort(s)})).then(e)},toArray:function(t){var e=this._ctx;return this._read((function(t,n,r){if(l&&"next"===e.dir&&_t(e,!0)&&e.limit>0){var o=e.table.hook.reading.fire,s=i(e,r),c=e.limit<1/0?s.getAll(e.range,e.limit):s.getAll(e.range);c.onerror=Se(n),c.onsuccess=De(o===tt?t:function(e){try{t(e.map(o))}catch(t){n(t)}})}else{var u=[];a(e,(function(t){u.push(t)}),(function(){t(u)}),n,r)}}),t)},offset:function(t){var i=this._ctx;return t<=0||(i.offset+=t,_t(i)?e(i,(function(){var e=t;return function(t,i){return 0===e||(1===e?(--e,!1):(i((function(){t.advance(e),e=0})),!1))}})):e(i,(function(){var e=t;return function(){return--e<0}}))),this},limit:function(t){return this._ctx.limit=Math.min(this._ctx.limit,t),e(this._ctx,(function(){var e=t;return function(t,i,n){return--e<=0&&i(n),e>=0}}),!0),this},until:function(e,i){return t(this._ctx,(function(t,n,r){return!e(t.value)||(n(r),i)})),this},first:function(t){return this.limit(1).toArray((function(t){return t[0]})).then(t)},last:function(t){return this.reverse().first(t)},filter:function(e){return t(this._ctx,(function(t){return e(t.value)})),function(t,e){t.isMatch=Ut(t.isMatch,e)}(this._ctx,e),this},and:function(t){return this.filter(t)},or:function(t){return new wt(this._ctx.table,t,this)},reverse:function(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},desc:function(){return this.reverse()},eachKey:function(t){var e=this._ctx;return e.keysOnly=!e.isMatch,this.each((function(e,i){t(i.key,i)}))},eachUniqueKey:function(t){return this._ctx.unique="unique",this.eachKey(t)},eachPrimaryKey:function(t){var e=this._ctx;return e.keysOnly=!e.isMatch,this.each((function(e,i){t(i.primaryKey,i)}))},keys:function(t){var e=this._ctx;e.keysOnly=!e.isMatch;var i=[];return this.each((function(t,e){i.push(e.key)})).then((function(){return i})).then(t)},primaryKeys:function(t){var e=this._ctx;if(l&&"next"===e.dir&&_t(e,!0)&&e.limit>0)return this._read((function(t,n,r){var a=i(e,r),o=e.limit<1/0?a.getAllKeys(e.range,e.limit):a.getAllKeys(e.range);o.onerror=Se(n),o.onsuccess=De(t)})).then(t);e.keysOnly=!e.isMatch;var n=[];return this.each((function(t,e){n.push(e.primaryKey)})).then((function(){return n})).then(t)},uniqueKeys:function(t){return this._ctx.unique="unique",this.keys(t)},firstKey:function(t){return this.limit(1).keys((function(t){return t[0]})).then(t)},lastKey:function(t){return this.reverse().firstKey(t)},distinct:function(){var e=this._ctx,i=e.index&&e.table.schema.idxByName[e.index];if(!i||!i.multi)return this;var n={};return t(this._ctx,(function(t){var e=t.primaryKey.toString(),i=c(n,e);return n[e]=!0,!i})),this},modify:function(t){var e=this,i=this._ctx.table.hook,r=i.updating.fire,a=i.deleting.fire;return this._write((function(i,s,l,u){var h;if("function"==typeof t)h=r===$&&a===$?t:function(e){var i=S(e);if(!1===t.call(this,e,this))return!1;if(c(this,"value")){var o=D(i,this.value),s=r.call(this,o,this.primKey,i,u);s&&(e=this.value,n(s).forEach((function(t){T(e,t,s[t])})))}else a.call(this,this.primKey,e,u)};else if(r===$){var d=n(t),p=d.length;h=function(e){for(var i=!1,n=0;n<p;++n){var r=d[n],a=t[r];x(e,r)!==a&&(T(e,r,a),i=!0)}return i}}else{var f=t;t=M(f),h=function(e){var i=!1,a=r.call(this,t,this.primKey,S(e),u);return a&&o(t,a),n(t).forEach((function(n){var r=t[n];x(e,n)!==r&&(T(e,n,r),i=!0)})),a&&(t=M(f)),i}}var m=0,g=0,y=!1,b=[],A=[],v=null;function w(t){return t&&(b.push(t),A.push(v)),s(new X("Error modifying one or more objects",b,g,A))}function E(){y&&g+b.length===m&&(b.length>0?w():i(g))}e.clone().raw()._iterate((function(t,e){v=e.primaryKey;var i={primKey:e.primaryKey,value:t,onsuccess:null,onerror:null};function n(t){return b.push(t),A.push(i.primKey),E(),!0}if(!1!==h.call(i,t,i)){var r=!c(i,"value");++m,_((function(){var t=r?e.delete():e.update(i.value);t._hookCtx=i,t.onerror=Oe(n),t.onsuccess=Re((function(){++g,E()}))}),n)}else i.onsuccess&&i.onsuccess(i.value)}),(function(){y=!0,E()}),w,l)}))},delete:function(){var t=this,e=this._ctx,i=e.range,n=e.table.hook.deleting.fire,r=n!==$;if(!r&&_t(e)&&(e.isPrimKey&&!xe||!i))return this._write((function(t,e,n){var r=Se(e),a=i?n.count(i):n.count();a.onerror=r,a.onsuccess=function(){var o=a.result;_((function(){var e=i?n.delete(i):n.clear();e.onerror=r,e.onsuccess=function(){return t(o)}}),(function(t){return e(t)}))}}));var a=r?2e3:1e4;return this._write((function(i,o,s,l){var c=0,u=t.clone({keysOnly:!e.isMatch&&!r}).distinct().limit(a).raw(),h=[],d=function(){return u.each(r?function(t,e){h.push([e.primaryKey,e.value])}:function(t,e){h.push(e.primaryKey)}).then((function(){return r?h.sort((function(t,e){return St(t[0],e[0])})):h.sort(St),At(s,l,h,r,n)})).then((function(){var t=h.length;return c+=t,h=[],t<a?c:d()}))};i(d())}))}}})),o(this,{Collection:Et,Table:yt,Transaction:vt,Version:ct,WhereClause:wt}),K.on("versionchange",(function(t){t.newVersion>0?console.warn("Another connection wants to upgrade database '"+K.name+"'. Closing db now to resume the upgrade."):console.warn("Another connection wants to delete database '"+K.name+"'. Closing db now to resume the delete request."),K.close()})),K.on("blocked",(function(t){!t.newVersion||t.newVersion<t.oldVersion?console.warn("Dexie.delete('"+K.name+"') was blocked"):console.warn("Upgrade '"+K.name+"' blocked by other connection holding version "+t.oldVersion/10)})),g.forEach((function(t){t(K)}))}function Ce(t){if("function"==typeof t)return new t;if(r(t))return[Ce(t[0])];if(t&&"object"==typeof t){var e={};return ke(e,t),e}return t}function ke(t,e){return n(e).forEach((function(i){var n=Ce(e[i]);t[i]=n})),t}function Re(t){return Xt((function(e){var i=e.target,n=i._hookCtx,r=n.value||i.result,a=n&&n.onsuccess;a&&a(r),t&&t(r)}),t)}function Se(t){return Xt((function(e){return Pe(e),t(e.target.error),!1}))}function De(t){return Xt((function(e){t(e.target.result)}))}function Oe(t){return Xt((function(e){var i=e.target,n=i.error,r=i._hookCtx,a=r&&r.onerror;return a&&a(n),Pe(e),t(n),!1}))}function Pe(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault()}function Fe(t){var e=function(e){return t.next(e)},i=a(e),n=a((function(e){return t.throw(e)}));function a(t){return function(e){var a=t(e),o=a.value;return a.done?o:o&&"function"==typeof o.then?o.then(i,n):r(o)?Dt.all(o).then(i,n):i(o)}}return a(e)()}function Ue(t,e,i,n,r,a,o){this.name=t,this.keyPath=e,this.unique=i,this.multi=n,this.auto=r,this.compound=a,this.dotted=o;var s="string"==typeof e?e:e&&"["+[].join.call(e,"+")+"]";this.src=(i?"&":"")+(n?"*":"")+(r?"++":"")+s}function Be(t,e,i,n){this.name=t,this.primKey=e||new Ue,this.indexes=i||[new Ue],this.instanceTemplate=n,this.mappedClass=null,this.idxByName=w(i,(function(t){return[t.name,t]}))}function Ie(t){return 1===t.length?t[0]:t}function je(t){var e=t&&(t.getDatabaseNames||t.webkitGetDatabaseNames);return e&&e.bind(t)}I(B,Te),u(Me,J),u(Me,{delete:function(t){var e=new Me(t),i=e.delete();return i.onblocked=function(t){return e.on("blocked",t),this},i},exists:function(t){return new Me(t).open().then((function(t){return t.close(),!0})).catch(Me.NoSuchDatabaseError,(function(){return!1}))},getDatabaseNames:function(t){var e=je(Me.dependencies.indexedDB);return e?new Dt((function(t,i){var n=e();n.onsuccess=function(e){t(y(e.target.result,0))},n.onerror=Se(i)})).then(t):fe.dbnames.toCollection().primaryKeys(t)},defineClass:function(){return function(t){t&&o(this,t)}},applyStructure:ke,ignoreTransaction:function(t){return Ct.trans?se(Ct.transless,t):t()},vip:function(t){return $t((function(){return Ct.letThrough=!0,t()}))},async:function(t){return function(){try{var e=Fe(t.apply(this,arguments));return e&&"function"==typeof e.then?e:Dt.resolve(e)}catch(t){return de(t)}}},spawn:function(t,e,i){try{var n=Fe(t.apply(i,e||[]));return n&&"function"==typeof n.then?n:Dt.resolve(n)}catch(t){return de(t)}},currentTransaction:{get:function(){return Ct.trans||null}},waitFor:function(t,e){var i=Dt.resolve("function"==typeof t?Me.ignoreTransaction(t):t).timeout(e||6e4);return Ct.trans?Ct.trans.waitFor(i):i},Promise:Dt,debug:{get:function(){return B},set:function(t){I(t,"dexie"===t?function(){return!0}:Te)}},derive:p,extend:o,props:u,override:b,Events:pe,getByKeyPath:x,setByKeyPath:T,delByKeyPath:function(t,e){"string"==typeof e?T(t,e,void 0):"length"in e&&[].map.call(e,(function(e){T(t,e,void 0)}))},shallowClone:M,deepClone:S,getObjectDiff:D,asap:v,maxKey:ye,minKey:be,addons:[],connections:we,MultiModifyError:Z.Modify,errnames:Q,IndexSpec:Ue,TableSchema:Be,dependencies:function(){try{return{indexedDB:a.indexedDB||a.mozIndexedDB||a.webkitIndexedDB||a.msIndexedDB,IDBKeyRange:a.IDBKeyRange||a.webkitIDBKeyRange}}catch(t){return{indexedDB:null,IDBKeyRange:null}}}(),semVer:me,version:me.split(".").map((function(t){return parseInt(t)})).reduce((function(t,e,i){return t+e/Math.pow(10,2*i)})),default:Me,Dexie:Me}),Dt.rejectionMapper=function(t,e){if(!t||t instanceof W||t instanceof TypeError||t instanceof SyntaxError||!t.name||!K[t.name])return t;var i=new K[t.name](e||t.message,t);return"stack"in t&&d(i,"stack",{get:function(){return this.inner.stack}}),i},(fe=new Me("__dbnames")).version(1).stores({dbnames:"name"}),function(){var t="Dexie.DatabaseNames";try{void 0!==typeof localStorage&&void 0!==a.document&&(JSON.parse(localStorage.getItem(t)||"[]").forEach((function(t){return fe.dbnames.put({name:t}).catch($)})),localStorage.removeItem(t))}catch(t){}}(),e.a=Me}).call(this,i(19),i(45).setImmediate)},function(t,e,i){"use strict";(function(t){var n=i(375),r=i(376),a=i(377);function o(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(t,e){if(o()<e)throw new RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=l.prototype:(null===t&&(t=new l(e)),t.length=e),t}function l(t,e,i){if(!(l.TYPED_ARRAY_SUPPORT||this instanceof l))return new l(t,e,i);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return h(this,t)}return c(this,t,e,i)}function c(t,e,i,n){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,i,n){if(e.byteLength,i<0||e.byteLength<i)throw new RangeError("'offset' is out of bounds");if(e.byteLength<i+(n||0))throw new RangeError("'length' is out of bounds");e=void 0===i&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,i):new Uint8Array(e,i,n);l.TYPED_ARRAY_SUPPORT?(t=e).__proto__=l.prototype:t=d(t,e);return t}(t,e,i,n):"string"==typeof e?function(t,e,i){"string"==typeof i&&""!==i||(i="utf8");if(!l.isEncoding(i))throw new TypeError('"encoding" must be a valid string encoding');var n=0|f(e,i),r=(t=s(t,n)).write(e,i);r!==n&&(t=t.slice(0,r));return t}(t,e,i):function(t,e){if(l.isBuffer(e)){var i=0|p(e.length);return 0===(t=s(t,i)).length||e.copy(t,0,0,i),t}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(n=e.length)!=n?s(t,0):d(t,e);if("Buffer"===e.type&&a(e.data))return d(t,e.data)}var n;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function u(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function h(t,e){if(u(e),t=s(t,e<0?0:0|p(e)),!l.TYPED_ARRAY_SUPPORT)for(var i=0;i<e;++i)t[i]=0;return t}function d(t,e){var i=e.length<0?0:0|p(e.length);t=s(t,i);for(var n=0;n<i;n+=1)t[n]=255&e[n];return t}function p(t){if(t>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|t}function f(t,e){if(l.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var i=t.length;if(0===i)return 0;for(var n=!1;;)switch(e){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":case void 0:return H(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return z(t).length;default:if(n)return H(t).length;e=(""+e).toLowerCase(),n=!0}}function m(t,e,i){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===i||i>this.length)&&(i=this.length),i<=0)return"";if((i>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return S(this,e,i);case"utf8":case"utf-8":return M(this,e,i);case"ascii":return k(this,e,i);case"latin1":case"binary":return R(this,e,i);case"base64":return T(this,e,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return D(this,e,i);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function g(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function y(t,e,i,n,r){if(0===t.length)return-1;if("string"==typeof i?(n=i,i=0):i>2147483647?i=2147483647:i<-2147483648&&(i=-2147483648),i=+i,isNaN(i)&&(i=r?0:t.length-1),i<0&&(i=t.length+i),i>=t.length){if(r)return-1;i=t.length-1}else if(i<0){if(!r)return-1;i=0}if("string"==typeof e&&(e=l.from(e,n)),l.isBuffer(e))return 0===e.length?-1:b(t,e,i,n,r);if("number"==typeof e)return e&=255,l.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(t,e,i):Uint8Array.prototype.lastIndexOf.call(t,e,i):b(t,[e],i,n,r);throw new TypeError("val must be string, number or Buffer")}function b(t,e,i,n,r){var a,o=1,s=t.length,l=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;o=2,s/=2,l/=2,i/=2}function c(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(r){var u=-1;for(a=i;a<s;a++)if(c(t,a)===c(e,-1===u?0:a-u)){if(-1===u&&(u=a),a-u+1===l)return u*o}else-1!==u&&(a-=a-u),u=-1}else for(i+l>s&&(i=s-l),a=i;a>=0;a--){for(var h=!0,d=0;d<l;d++)if(c(t,a+d)!==c(e,d)){h=!1;break}if(h)return a}return-1}function A(t,e,i,n){i=Number(i)||0;var r=t.length-i;n?(n=Number(n))>r&&(n=r):n=r;var a=e.length;if(a%2!=0)throw new TypeError("Invalid hex string");n>a/2&&(n=a/2);for(var o=0;o<n;++o){var s=parseInt(e.substr(2*o,2),16);if(isNaN(s))return o;t[i+o]=s}return o}function v(t,e,i,n){return V(H(e,t.length-i),t,i,n)}function w(t,e,i,n){return V(function(t){for(var e=[],i=0;i<t.length;++i)e.push(255&t.charCodeAt(i));return e}(e),t,i,n)}function E(t,e,i,n){return w(t,e,i,n)}function _(t,e,i,n){return V(z(e),t,i,n)}function x(t,e,i,n){return V(function(t,e){for(var i,n,r,a=[],o=0;o<t.length&&!((e-=2)<0);++o)n=(i=t.charCodeAt(o))>>8,r=i%256,a.push(r),a.push(n);return a}(e,t.length-i),t,i,n)}function T(t,e,i){return 0===e&&i===t.length?n.fromByteArray(t):n.fromByteArray(t.slice(e,i))}function M(t,e,i){i=Math.min(t.length,i);for(var n=[],r=e;r<i;){var a,o,s,l,c=t[r],u=null,h=c>239?4:c>223?3:c>191?2:1;if(r+h<=i)switch(h){case 1:c<128&&(u=c);break;case 2:128==(192&(a=t[r+1]))&&(l=(31&c)<<6|63&a)>127&&(u=l);break;case 3:a=t[r+1],o=t[r+2],128==(192&a)&&128==(192&o)&&(l=(15&c)<<12|(63&a)<<6|63&o)>2047&&(l<55296||l>57343)&&(u=l);break;case 4:a=t[r+1],o=t[r+2],s=t[r+3],128==(192&a)&&128==(192&o)&&128==(192&s)&&(l=(15&c)<<18|(63&a)<<12|(63&o)<<6|63&s)>65535&&l<1114112&&(u=l)}null===u?(u=65533,h=1):u>65535&&(u-=65536,n.push(u>>>10&1023|55296),u=56320|1023&u),n.push(u),r+=h}return function(t){var e=t.length;if(e<=C)return String.fromCharCode.apply(String,t);var i="",n=0;for(;n<e;)i+=String.fromCharCode.apply(String,t.slice(n,n+=C));return i}(n)}e.Buffer=l,e.SlowBuffer=function(t){+t!=t&&(t=0);return l.alloc(+t)},e.INSPECT_MAX_BYTES=50,l.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=o(),l.poolSize=8192,l._augment=function(t){return t.__proto__=l.prototype,t},l.from=function(t,e,i){return c(null,t,e,i)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0})),l.alloc=function(t,e,i){return function(t,e,i,n){return u(e),e<=0?s(t,e):void 0!==i?"string"==typeof n?s(t,e).fill(i,n):s(t,e).fill(i):s(t,e)}(null,t,e,i)},l.allocUnsafe=function(t){return h(null,t)},l.allocUnsafeSlow=function(t){return h(null,t)},l.isBuffer=function(t){return!(null==t||!t._isBuffer)},l.compare=function(t,e){if(!l.isBuffer(t)||!l.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var i=t.length,n=e.length,r=0,a=Math.min(i,n);r<a;++r)if(t[r]!==e[r]){i=t[r],n=e[r];break}return i<n?-1:n<i?1:0},l.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(t,e){if(!a(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return l.alloc(0);var i;if(void 0===e)for(e=0,i=0;i<t.length;++i)e+=t[i].length;var n=l.allocUnsafe(e),r=0;for(i=0;i<t.length;++i){var o=t[i];if(!l.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,r),r+=o.length}return n},l.byteLength=f,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)g(this,e,e+1);return this},l.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)g(this,e,e+3),g(this,e+1,e+2);return this},l.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)g(this,e,e+7),g(this,e+1,e+6),g(this,e+2,e+5),g(this,e+3,e+4);return this},l.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?M(this,0,t):m.apply(this,arguments)},l.prototype.equals=function(t){if(!l.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===l.compare(this,t)},l.prototype.inspect=function(){var t="",i=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,i).match(/.{2}/g).join(" "),this.length>i&&(t+=" ... ")),"<Buffer "+t+">"},l.prototype.compare=function(t,e,i,n,r){if(!l.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===i&&(i=t?t.length:0),void 0===n&&(n=0),void 0===r&&(r=this.length),e<0||i>t.length||n<0||r>this.length)throw new RangeError("out of range index");if(n>=r&&e>=i)return 0;if(n>=r)return-1;if(e>=i)return 1;if(this===t)return 0;for(var a=(r>>>=0)-(n>>>=0),o=(i>>>=0)-(e>>>=0),s=Math.min(a,o),c=this.slice(n,r),u=t.slice(e,i),h=0;h<s;++h)if(c[h]!==u[h]){a=c[h],o=u[h];break}return a<o?-1:o<a?1:0},l.prototype.includes=function(t,e,i){return-1!==this.indexOf(t,e,i)},l.prototype.indexOf=function(t,e,i){return y(this,t,e,i,!0)},l.prototype.lastIndexOf=function(t,e,i){return y(this,t,e,i,!1)},l.prototype.write=function(t,e,i,n){if(void 0===e)n="utf8",i=this.length,e=0;else if(void 0===i&&"string"==typeof e)n=e,i=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(i)?(i|=0,void 0===n&&(n="utf8")):(n=i,i=void 0)}var r=this.length-e;if((void 0===i||i>r)&&(i=r),t.length>0&&(i<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var a=!1;;)switch(n){case"hex":return A(this,t,e,i);case"utf8":case"utf-8":return v(this,t,e,i);case"ascii":return w(this,t,e,i);case"latin1":case"binary":return E(this,t,e,i);case"base64":return _(this,t,e,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,t,e,i);default:if(a)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),a=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var C=4096;function k(t,e,i){var n="";i=Math.min(t.length,i);for(var r=e;r<i;++r)n+=String.fromCharCode(127&t[r]);return n}function R(t,e,i){var n="";i=Math.min(t.length,i);for(var r=e;r<i;++r)n+=String.fromCharCode(t[r]);return n}function S(t,e,i){var n=t.length;(!e||e<0)&&(e=0),(!i||i<0||i>n)&&(i=n);for(var r="",a=e;a<i;++a)r+=N(t[a]);return r}function D(t,e,i){for(var n=t.slice(e,i),r="",a=0;a<n.length;a+=2)r+=String.fromCharCode(n[a]+256*n[a+1]);return r}function O(t,e,i){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>i)throw new RangeError("Trying to access beyond buffer length")}function P(t,e,i,n,r,a){if(!l.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>r||e<a)throw new RangeError('"value" argument is out of bounds');if(i+n>t.length)throw new RangeError("Index out of range")}function F(t,e,i,n){e<0&&(e=65535+e+1);for(var r=0,a=Math.min(t.length-i,2);r<a;++r)t[i+r]=(e&255<<8*(n?r:1-r))>>>8*(n?r:1-r)}function U(t,e,i,n){e<0&&(e=4294967295+e+1);for(var r=0,a=Math.min(t.length-i,4);r<a;++r)t[i+r]=e>>>8*(n?r:3-r)&255}function B(t,e,i,n,r,a){if(i+n>t.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function I(t,e,i,n,a){return a||B(t,0,i,4),r.write(t,e,i,n,23,4),i+4}function j(t,e,i,n,a){return a||B(t,0,i,8),r.write(t,e,i,n,52,8),i+8}l.prototype.slice=function(t,e){var i,n=this.length;if((t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t),l.TYPED_ARRAY_SUPPORT)(i=this.subarray(t,e)).__proto__=l.prototype;else{var r=e-t;i=new l(r,void 0);for(var a=0;a<r;++a)i[a]=this[a+t]}return i},l.prototype.readUIntLE=function(t,e,i){t|=0,e|=0,i||O(t,e,this.length);for(var n=this[t],r=1,a=0;++a<e&&(r*=256);)n+=this[t+a]*r;return n},l.prototype.readUIntBE=function(t,e,i){t|=0,e|=0,i||O(t,e,this.length);for(var n=this[t+--e],r=1;e>0&&(r*=256);)n+=this[t+--e]*r;return n},l.prototype.readUInt8=function(t,e){return e||O(t,1,this.length),this[t]},l.prototype.readUInt16LE=function(t,e){return e||O(t,2,this.length),this[t]|this[t+1]<<8},l.prototype.readUInt16BE=function(t,e){return e||O(t,2,this.length),this[t]<<8|this[t+1]},l.prototype.readUInt32LE=function(t,e){return e||O(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},l.prototype.readUInt32BE=function(t,e){return e||O(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},l.prototype.readIntLE=function(t,e,i){t|=0,e|=0,i||O(t,e,this.length);for(var n=this[t],r=1,a=0;++a<e&&(r*=256);)n+=this[t+a]*r;return n>=(r*=128)&&(n-=Math.pow(2,8*e)),n},l.prototype.readIntBE=function(t,e,i){t|=0,e|=0,i||O(t,e,this.length);for(var n=e,r=1,a=this[t+--n];n>0&&(r*=256);)a+=this[t+--n]*r;return a>=(r*=128)&&(a-=Math.pow(2,8*e)),a},l.prototype.readInt8=function(t,e){return e||O(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},l.prototype.readInt16LE=function(t,e){e||O(t,2,this.length);var i=this[t]|this[t+1]<<8;return 32768&i?4294901760|i:i},l.prototype.readInt16BE=function(t,e){e||O(t,2,this.length);var i=this[t+1]|this[t]<<8;return 32768&i?4294901760|i:i},l.prototype.readInt32LE=function(t,e){return e||O(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},l.prototype.readInt32BE=function(t,e){return e||O(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},l.prototype.readFloatLE=function(t,e){return e||O(t,4,this.length),r.read(this,t,!0,23,4)},l.prototype.readFloatBE=function(t,e){return e||O(t,4,this.length),r.read(this,t,!1,23,4)},l.prototype.readDoubleLE=function(t,e){return e||O(t,8,this.length),r.read(this,t,!0,52,8)},l.prototype.readDoubleBE=function(t,e){return e||O(t,8,this.length),r.read(this,t,!1,52,8)},l.prototype.writeUIntLE=function(t,e,i,n){(t=+t,e|=0,i|=0,n)||P(this,t,e,i,Math.pow(2,8*i)-1,0);var r=1,a=0;for(this[e]=255&t;++a<i&&(r*=256);)this[e+a]=t/r&255;return e+i},l.prototype.writeUIntBE=function(t,e,i,n){(t=+t,e|=0,i|=0,n)||P(this,t,e,i,Math.pow(2,8*i)-1,0);var r=i-1,a=1;for(this[e+r]=255&t;--r>=0&&(a*=256);)this[e+r]=t/a&255;return e+i},l.prototype.writeUInt8=function(t,e,i){return t=+t,e|=0,i||P(this,t,e,1,255,0),l.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},l.prototype.writeUInt16LE=function(t,e,i){return t=+t,e|=0,i||P(this,t,e,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):F(this,t,e,!0),e+2},l.prototype.writeUInt16BE=function(t,e,i){return t=+t,e|=0,i||P(this,t,e,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):F(this,t,e,!1),e+2},l.prototype.writeUInt32LE=function(t,e,i){return t=+t,e|=0,i||P(this,t,e,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):U(this,t,e,!0),e+4},l.prototype.writeUInt32BE=function(t,e,i){return t=+t,e|=0,i||P(this,t,e,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):U(this,t,e,!1),e+4},l.prototype.writeIntLE=function(t,e,i,n){if(t=+t,e|=0,!n){var r=Math.pow(2,8*i-1);P(this,t,e,i,r-1,-r)}var a=0,o=1,s=0;for(this[e]=255&t;++a<i&&(o*=256);)t<0&&0===s&&0!==this[e+a-1]&&(s=1),this[e+a]=(t/o>>0)-s&255;return e+i},l.prototype.writeIntBE=function(t,e,i,n){if(t=+t,e|=0,!n){var r=Math.pow(2,8*i-1);P(this,t,e,i,r-1,-r)}var a=i-1,o=1,s=0;for(this[e+a]=255&t;--a>=0&&(o*=256);)t<0&&0===s&&0!==this[e+a+1]&&(s=1),this[e+a]=(t/o>>0)-s&255;return e+i},l.prototype.writeInt8=function(t,e,i){return t=+t,e|=0,i||P(this,t,e,1,127,-128),l.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},l.prototype.writeInt16LE=function(t,e,i){return t=+t,e|=0,i||P(this,t,e,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):F(this,t,e,!0),e+2},l.prototype.writeInt16BE=function(t,e,i){return t=+t,e|=0,i||P(this,t,e,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):F(this,t,e,!1),e+2},l.prototype.writeInt32LE=function(t,e,i){return t=+t,e|=0,i||P(this,t,e,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):U(this,t,e,!0),e+4},l.prototype.writeInt32BE=function(t,e,i){return t=+t,e|=0,i||P(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):U(this,t,e,!1),e+4},l.prototype.writeFloatLE=function(t,e,i){return I(this,t,e,!0,i)},l.prototype.writeFloatBE=function(t,e,i){return I(this,t,e,!1,i)},l.prototype.writeDoubleLE=function(t,e,i){return j(this,t,e,!0,i)},l.prototype.writeDoubleBE=function(t,e,i){return j(this,t,e,!1,i)},l.prototype.copy=function(t,e,i,n){if(i||(i=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<i&&(n=i),n===i)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-i&&(n=t.length-e+i);var r,a=n-i;if(this===t&&i<e&&e<n)for(r=a-1;r>=0;--r)t[r+e]=this[r+i];else if(a<1e3||!l.TYPED_ARRAY_SUPPORT)for(r=0;r<a;++r)t[r+e]=this[r+i];else Uint8Array.prototype.set.call(t,this.subarray(i,i+a),e);return a},l.prototype.fill=function(t,e,i,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,i=this.length):"string"==typeof i&&(n=i,i=this.length),1===t.length){var r=t.charCodeAt(0);r<256&&(t=r)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!l.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<i)throw new RangeError("Out of range index");if(i<=e)return this;var a;if(e>>>=0,i=void 0===i?this.length:i>>>0,t||(t=0),"number"==typeof t)for(a=e;a<i;++a)this[a]=t;else{var o=l.isBuffer(t)?t:H(new l(t,n).toString()),s=o.length;for(a=0;a<i-e;++a)this[a+e]=o[a%s]}return this};var L=/[^+\/0-9A-Za-z-_]/g;function N(t){return t<16?"0"+t.toString(16):t.toString(16)}function H(t,e){var i;e=e||1/0;for(var n=t.length,r=null,a=[],o=0;o<n;++o){if((i=t.charCodeAt(o))>55295&&i<57344){if(!r){if(i>56319){(e-=3)>-1&&a.push(239,191,189);continue}if(o+1===n){(e-=3)>-1&&a.push(239,191,189);continue}r=i;continue}if(i<56320){(e-=3)>-1&&a.push(239,191,189),r=i;continue}i=65536+(r-55296<<10|i-56320)}else r&&(e-=3)>-1&&a.push(239,191,189);if(r=null,i<128){if((e-=1)<0)break;a.push(i)}else if(i<2048){if((e-=2)<0)break;a.push(i>>6|192,63&i|128)}else if(i<65536){if((e-=3)<0)break;a.push(i>>12|224,i>>6&63|128,63&i|128)}else{if(!(i<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;a.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}}return a}function z(t){return n.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(L,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function V(t,e,i,n){for(var r=0;r<n&&!(r+i>=e.length||r>=t.length);++r)e[r+i]=t[r];return r}}).call(this,i(19))},,function(t,e,i){let n=i(184).version;console.log("including VARTISTE toolkit",n),document.currentScript&&(window.VARTISTE_TOOLKIT_URL=document.currentScript.src.split("/").slice(0,-1).join("/")),window.VARTISTE_TOOLKIT&&window.VARTISTE_TOOLKIT.assetUrl&&(window.VARTISTE_TOOLKIT_URL=VARTISTE_TOOLKIT.assetUrl),window.VARTISTE_TOOLKIT=Object.assign({includeFiles:void 0,excludeFiles:[],includeComponents:void 0,excludeComponents:[],includeCompositor:!1,replaceTextWithTroikaText:"auto",required_assets:["./shelf.png","./hand-right.png","./matcap.jpg","./hand.glb","./close-circle-outline.png","./reset-orientation.jpg","./button.glb","./headset.glb","./lead-pencil.png"]},window.VARTISTE_TOOLKIT||{}),VARTISTE_TOOLKIT.excludeFiles=VARTISTE_TOOLKIT.excludeFiles.map((t=>t.match(/\.?\/?(.*?)(\.?js)?$/)[1])),VARTISTE_TOOLKIT.includeFiles&&(VARTISTE_TOOLKIT.includeFiles=VARTISTE_TOOLKIT.includeFiles.map((t=>t.match(/\.?\/?(.*?)(\.?js)?$/)[1]))),THREE.Matrix4.prototype.invert||(THREE.Matrix4.prototype.invert=function(){return this.getInverse(this)});const{loadAsset:r,loadAllAssets:a}=i(185),o=AFRAME.registerComponent,s=AFRAME.registerSystem;function l(t){let e=t.match(/\.?\/?(.*?)(\.?js)?$/)[1];return!(VARTISTE_TOOLKIT.includeFiles&&!VARTISTE_TOOLKIT.includeFiles.includes(e))&&!VARTISTE_TOOLKIT.excludeFiles.includes(e)}AFRAME.registerComponent=function(t,e){if((!VARTISTE_TOOLKIT.includeComponents||VARTISTE_TOOLKIT.includeComponents.includes(t))&&!VARTISTE_TOOLKIT.excludeComponents.includes(t))return o.call(this,t,e)},AFRAME.registerSystem=function(t,e){if((!VARTISTE_TOOLKIT.includeComponents||VARTISTE_TOOLKIT.includeComponents.includes(t))&&!VARTISTE_TOOLKIT.excludeComponents.includes(t))return s.call(this,t,e)},l("./framework/fix-text-autoscaling-logging.js")&&i(193),l("./framework/valve-index-controls")&&!AFRAME.components["valve-index-controls"]&&i(194),l("./text")&&i(195),l("./shelf")&&i(197),l("./icon-button")&&i(31),l("./edit-field")&&i(198),l("./popup-shelf")&&i(161),l("./tooltip")&&i(267),l("./frame")&&i(268),l("./optimization-components")&&i(269),l("./speech")&&i(271),l("./matcap-shader")&&i(272),l("./desktop-controls")&&i(273),l("./manipulator")&&i(274),l("./canvas-shader-processor")&&i(10),l("./canvas-updater")&&i(296),l("./demo-overlay")&&i(297),l("./joystick-directions")&&i(17),l("./popup-shelf")&&i(161),l("./smooth-controller")&&i(298),l("./draw-canvas")&&i(299),l("./hand-draw-tool")&&i(308),l("./paint-system")&&i(309),l("./color-picker")&&i(395),l("./leap-hand")&&i(394),l("./hand-tracking")&&i(358),l("./hdri-environment")&&i(396),l("./fix-oculus-steamvr")&&i(359),l("./artist-positioning")&&i(360),l("./canvas-fx")&&i(361),l("./scalable-raycaster")&&i(364),l("./webxr-input-profiles")&&i(397),l("./camera-capture")&&i(365),l("./physics")&&i(367),l("./kromophone")&&i(372),l("./pencil-tool")&&i(373),l("./brush-editor")&&i(374),l("./avatar")&&i(390);const{ButtonMaps:c,Axes:u,JoystickDirections:h}=i(17),{Undo:d,UndoStack:p}=i(4),{Pool:f}=i(3),{MaterialTransformations:m}=i(30);window.VARTISTE={},VARTISTE.Util=i(0).Util;const g=i(13);Object.assign(VARTISTE,{ButtonMaps:c,Axes:u,JoystickDirections:h,Pool:f,Undo:d,UndoStack:p,MaterialTransformations:m,VERSION:n,Color:g}),VARTISTE_TOOLKIT.includeCompositor&&(i(398),VARTISTE.Compositor=Compositor,l("./settings-system")&&i(399),l("./file-upload")&&i(18),l("./busy")&&i(392),l("./brush-shelf")&&i(393)),AFRAME.registerComponent("vartiste-rotation-button-mapping",{dependencies:["raycaster"],init(){let t=new c;t.setMap({abutton:t.toggle("rotating"),trackpad:t.toggle("rotating"),thumbstick:t.toggle("orbiting")},"grabbing"),t.install(this)}}),AFRAME.registerComponent("vartiste-user-root",{schema:{resetPositioner:{default:"#camera-reset-el"},speed:{default:1}},init(){this.el.innerHTML=i(156),this.el.querySelector("#right-hand").setAttribute("joystick-turn","target: #artist-root"),this.el.sceneEl.setAttribute("artist-positioner","resetPositioner",this.data.resetPositioner),this.desktopControls=this.el.querySelector("*[desktop-controls]")},update(t){VARTISTE.Util.whenLoaded(this.desktopControls,(()=>{this.desktopControls.setAttribute("wasd-controls","acceleration",this.data.speed)}))}}),AFRAME.registerComponent=o,AFRAME.registerSystem=s},function(t){t.exports=JSON.parse('{"name":"aframe-vartiste-toolkit","version":"1.33.0","description":"Toolkit to create GUI similar to VARTISTE","main":"vartiste-toolkit.js","scripts":{"test":"echo \\"Error: no test specified\\" && exit 1"},"repository":{"type":"git","url":"git+https://gitlab.com/zach-geek/vartiste.git"},"keywords":["VR","aframe","vartiste","aframe-component"],"author":"Zach Capalbo","license":"Apache-2.0","bugs":{"url":"https://gitlab.com/zach-geek/vartiste/issues"},"homepage":"https://vartiste.xyz/docs.html"}')},function(t,e,i){"use strict";i.r(e),i.d(e,"loadAsset",(function(){return n})),i.d(e,"loadAllAssets",(function(){return a}));i(0);function n(t,e){let n=t.slice("./".length);if(n.startsWith("."))return;let r=`asset-${n.split(".")[0]}`;if(document.getElementById(r))return;let a="a-asset-item",o=i(191)(`./${n}`);o.startsWith("asset/")&&/\.(png|jpg)$/i.test(o)||/^data:image/.test(o)?(o=`${o}`,a="img"):n.endsWith(".wav")&&(a="audio"),o.startsWith("asset/")&&window.VARTISTE_TOOLKIT_URL&&(o=`${VARTISTE_TOOLKIT_URL}/${o}`);var s=document.createElement(a);return e.append(s),s.setAttribute("src",o),s.id=r,s.setAttribute("crossorigin","anonymous"),s.classList.add("vartiste-asset"),s}var r=!1;function a(){let t=document.querySelector("a-assets");for(let e of i(192).keys())n(e,t)}var o=!1,s=new THREE.FileLoader;window.AFRAME.registerElement("vartiste-assets",{prototype:Object.create(window.AFRAME.ANode.prototype,{createdCallback:{value:function(){this.setAttribute("src",""),this.isAssetItem=!0,this.isAssets=!0,this.fileLoader=s,this.timeout=null}},attachedCallback:{value:function(){if(!o){this.parentNode&&this.parentNode.hasLoaded&&console.warn("Assets have already loaded. streetmix-assets may have problems"),o=!0,console.log("Attaching VARTISTE Assets");var t=this.parentNode;this.setAttribute("timeout",t.getAttribute("timeout")),r?this.load():t.parentNode.addEventListener("vartisteassetsadded",(()=>{this.load()})),this.emit("vartisteassetsadded")}}},load:{value:function(){let t=this.parentNode,e=[];this.waitingFor={};let i=t.querySelectorAll("img.vartiste-asset");for(let t=0;t<i.length;t++){let n=i[t];e.push(new Promise((function(e,r){THREE.Cache.files[i[t].getAttribute("src")]=n,n.onload=e,n.onerror=r}))),this.waitingFor[n.id]=e[e.length-1]}let n=this.querySelectorAll("audio.vartiste-asset, video.vartiste-asset");for(let t=0;t<n.length;t++){let i=n[t];i.src||i.srcObject||warn("Audio/video asset has neither `src` nor `srcObject` attributes."),e.push(mediaElementLoaded(i)),this.waitingFor[i.id]=e[e.length-1]}Promise.all(e).then((()=>{this.hasLoaded=!0,this.emit("loaded",void 0,!1),t.load()}))}}})});var l=function(t){if("A-SCENE"!==t.target.nodeName)return;let e=t.target.querySelector("a-assets");if(!e)return console.log("Creating new a-assets"),e=document.createElement("a-assets"),e.setAttribute("timeout",3e5),void t.target.append(e);if(window.VARTISTE_TOOLKIT&&!e.querySelector("vartiste-assets, *[vartiste-assets]"))for(let t of VARTISTE_TOOLKIT.required_assets)n(t,e);else a();r=!0;let i=document.createElement("vartiste-assets");e.append(i),document.removeEventListener("DOMSubtreeModified",l)};document.addEventListener("DOMSubtreeModified",l,!1)},function(t,e,i){var n=i(46),r=i(187),a={};for(var o in n)n.hasOwnProperty(o)&&(a[n[o]]=o);var s=t.exports={to:{},get:{}};function l(t,e,i){return Math.min(Math.max(e,t),i)}function c(t){var e=t.toString(16).toUpperCase();return e.length<2?"0"+e:e}s.get=function(t){var e,i;switch(t.substring(0,3).toLowerCase()){case"hsl":e=s.get.hsl(t),i="hsl";break;case"hwb":e=s.get.hwb(t),i="hwb";break;default:e=s.get.rgb(t),i="rgb"}return e?{model:i,value:e}:null},s.get.rgb=function(t){if(!t)return null;var e,i,r,a=[0,0,0,1];if(e=t.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(r=e[2],e=e[1],i=0;i<3;i++){var o=2*i;a[i]=parseInt(e.slice(o,o+2),16)}r&&(a[3]=parseInt(r,16)/255)}else if(e=t.match(/^#([a-f0-9]{3,4})$/i)){for(r=(e=e[1])[3],i=0;i<3;i++)a[i]=parseInt(e[i]+e[i],16);r&&(a[3]=parseInt(r+r,16)/255)}else if(e=t.match(/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/)){for(i=0;i<3;i++)a[i]=parseInt(e[i+1],0);e[4]&&(a[3]=parseFloat(e[4]))}else{if(!(e=t.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/)))return(e=t.match(/(\D+)/))?"transparent"===e[1]?[0,0,0,0]:(a=n[e[1]])?(a[3]=1,a):null:null;for(i=0;i<3;i++)a[i]=Math.round(2.55*parseFloat(e[i+1]));e[4]&&(a[3]=parseFloat(e[4]))}for(i=0;i<3;i++)a[i]=l(a[i],0,255);return a[3]=l(a[3],0,1),a},s.get.hsl=function(t){if(!t)return null;var e=t.match(/^hsla?\(\s*([+-]?(?:\d*\.)?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/);if(e){var i=parseFloat(e[4]);return[(parseFloat(e[1])+360)%360,l(parseFloat(e[2]),0,100),l(parseFloat(e[3]),0,100),l(isNaN(i)?1:i,0,1)]}return null},s.get.hwb=function(t){if(!t)return null;var e=t.match(/^hwb\(\s*([+-]?\d*[\.]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/);if(e){var i=parseFloat(e[4]);return[(parseFloat(e[1])%360+360)%360,l(parseFloat(e[2]),0,100),l(parseFloat(e[3]),0,100),l(isNaN(i)?1:i,0,1)]}return null},s.to.hex=function(){var t=r(arguments);return"#"+c(t[0])+c(t[1])+c(t[2])+(t[3]<1?c(Math.round(255*t[3])):"")},s.to.rgb=function(){var t=r(arguments);return t.length<4||1===t[3]?"rgb("+Math.round(t[0])+", "+Math.round(t[1])+", "+Math.round(t[2])+")":"rgba("+Math.round(t[0])+", "+Math.round(t[1])+", "+Math.round(t[2])+", "+t[3]+")"},s.to.rgb.percent=function(){var t=r(arguments),e=Math.round(t[0]/255*100),i=Math.round(t[1]/255*100),n=Math.round(t[2]/255*100);return t.length<4||1===t[3]?"rgb("+e+"%, "+i+"%, "+n+"%)":"rgba("+e+"%, "+i+"%, "+n+"%, "+t[3]+")"},s.to.hsl=function(){var t=r(arguments);return t.length<4||1===t[3]?"hsl("+t[0]+", "+t[1]+"%, "+t[2]+"%)":"hsla("+t[0]+", "+t[1]+"%, "+t[2]+"%, "+t[3]+")"},s.to.hwb=function(){var t=r(arguments),e="";return t.length>=4&&1!==t[3]&&(e=", "+t[3]),"hwb("+t[0]+", "+t[1]+"%, "+t[2]+"%"+e+")"},s.to.keyword=function(t){return a[t.slice(0,3)]}},function(t,e,i){"use strict";var n=i(188),r=Array.prototype.concat,a=Array.prototype.slice,o=t.exports=function(t){for(var e=[],i=0,o=t.length;i<o;i++){var s=t[i];n(s)?e=r.call(e,a.call(s)):e.push(s)}return e};o.wrap=function(t){return function(){return t(o(arguments))}}},function(t,e){t.exports=function(t){return!(!t||"string"==typeof t)&&(t instanceof Array||Array.isArray(t)||t.length>=0&&(t.splice instanceof Function||Object.getOwnPropertyDescriptor(t,t.length-1)&&"String"!==t.constructor.name))}},function(t,e,i){var n=i(47),r=i(190),a={};Object.keys(n).forEach((function(t){a[t]={},Object.defineProperty(a[t],"channels",{value:n[t].channels}),Object.defineProperty(a[t],"labels",{value:n[t].labels});var e=r(t);Object.keys(e).forEach((function(i){var n=e[i];a[t][i]=function(t){var e=function(e){if(null==e)return e;arguments.length>1&&(e=Array.prototype.slice.call(arguments));var i=t(e);if("object"==typeof i)for(var n=i.length,r=0;r<n;r++)i[r]=Math.round(i[r]);return i};return"conversion"in t&&(e.conversion=t.conversion),e}(n),a[t][i].raw=function(t){var e=function(e){return null==e?e:(arguments.length>1&&(e=Array.prototype.slice.call(arguments)),t(e))};return"conversion"in t&&(e.conversion=t.conversion),e}(n)}))})),t.exports=a},function(t,e,i){var n=i(47);function r(t){var e=function(){for(var t={},e=Object.keys(n),i=e.length,r=0;r<i;r++)t[e[r]]={distance:-1,parent:null};return t}(),i=[t];for(e[t].distance=0;i.length;)for(var r=i.pop(),a=Object.keys(n[r]),o=a.length,s=0;s<o;s++){var l=a[s],c=e[l];-1===c.distance&&(c.distance=e[r].distance+1,c.parent=r,i.unshift(l))}return e}function a(t,e){return function(i){return e(t(i))}}function o(t,e){for(var i=[e[t].parent,t],r=n[e[t].parent][t],o=e[t].parent;e[o].parent;)i.unshift(e[o].parent),r=a(n[e[o].parent][o],r),o=e[o].parent;return r.conversion=i,r}t.exports=function(t){for(var e=r(t),i={},n=Object.keys(e),a=n.length,s=0;s<a;s++){var l=n[s];null!==e[l].parent&&(i[l]=o(l,e))}return i}},function(t,e,i){var n={"./account-voice.png":48,"./archive-arrow-down-outline.png":49,"./arrow-all.png":50,"./arrow-collapse-left.png":51,"./arrow-collapse-vertical.png":52,"./arrow-down-bold.png":53,"./arrow-left.png":54,"./arrow-right.png":55,"./arrow-up-bold.png":56,"./axis-z-rotate-clockwise.png":57,"./backspace-outline.png":58,"./badge-account-horizontal-outline.png":59,"./bed.png":60,"./blur-linear.png":61,"./blur-preview.png":34,"./brightness-4.png":62,"./brush.png":63,"./button-matcap.jpg":64,"./button.glb":65,"./camera-body.glb":66,"./camera.png":67,"./character-base.glb":68,"./check-outline.png":69,"./chevron-down.png":70,"./chevron-up.png":71,"./close-circle-outline.png":72,"./close.png":73,"./collage.png":74,"./colorful_studio.jpg":75,"./colorful_studio_1k.hdr":76,"./confirmation.wav":77,"./cube-send.png":78,"./cylinder.png":79,"./delete.png":80,"./dice-2.png":81,"./dice-4.png":82,"./dice-6.png":35,"./dots-square.png":83,"./drag-and-drop.png":84,"./ear-hearing.png":85,"./error.wav":86,"./eye-off.png":87,"./eye.png":88,"./file-outline.png":89,"./floppy.png":90,"./folder-open-outline.png":91,"./font.woff":23,"./format-color-fill.png":36,"./gif.png":92,"./hand-no-lines.png":93,"./hand-one-line.png":94,"./hand-right.png":95,"./hand-two-lines.png":96,"./hand.glb":97,"./head-base.glb":98,"./headset.glb":99,"./help-circle-outline.png":100,"./horizontal-rotate-counterclockwise.png":101,"./image-filter-hdr.png":102,"./lead-pencil.png":103,"./light-switch.png":104,"./lock-outline.png":105,"./masked-bucket.png":37,"./matcap.jpg":106,"./navigation_backward-selection.wav":107,"./navigation_forward-selection.wav":108,"./navigation_hover-tap.wav":109,"./newspaper-variant-outline.png":110,"./nudge-brush.png":24,"./oven.png":111,"./palette-swatch-outline.png":112,"./place.glb":113,"./play-pause.png":114,"./plus-box-multiple.png":115,"./plus-box-outline.png":116,"./record.png":117,"./reset-orientation.jpg":118,"./resize.png":119,"./rotate-3d-variant.png":120,"./rotate-orbit.png":121,"./save-to-browser.png":122,"./sfx-03.wav":123,"./sfx-04.wav":124,"./sfx-05.wav":125,"./sfx-06.wav":126,"./sfx-07.wav":127,"./sfx-08.wav":128,"./sfx-09.wav":129,"./sfx-click.wav":130,"./sfx-clock.wav":131,"./sfx-noise.wav":132,"./sfx-punch.wav":133,"./shape-outline.png":134,"./shelf.png":135,"./skeletonator.png":136,"./sketchfab.png":137,"./spotlight.glb":138,"./spray.png":139,"./swap-horizontal-variant.png":140,"./swap-vertical-variant.png":141,"./tap-resonant.wav":142,"./title-font.woff":38,"./transition-masked.png":39,"./transition.png":143,"./translate.png":144,"./ui_lock.wav":145,"./ui_tap-variant-01.wav":146,"./ui_tap-variant-02.wav":147,"./ui_tap-variant-03.wav":148,"./ui_tap-variant-04.wav":149,"./undo.png":150,"./vartiste.png":151,"./video-vintage.png":152,"./volume-brush.glb":153,"./web.png":154};function r(t){var e=a(t);return i(e)}function a(t){if(!i.o(n,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return n[t]}r.keys=function(){return Object.keys(n)},r.resolve=a,t.exports=r,r.id=191},function(t,e,i){var n={"./account-voice.png":48,"./archive-arrow-down-outline.png":49,"./arrow-all.png":50,"./arrow-collapse-left.png":51,"./arrow-collapse-vertical.png":52,"./arrow-down-bold.png":53,"./arrow-left.png":54,"./arrow-right.png":55,"./arrow-up-bold.png":56,"./axis-z-rotate-clockwise.png":57,"./backspace-outline.png":58,"./badge-account-horizontal-outline.png":59,"./bed.png":60,"./blur-linear.png":61,"./blur-preview.png":34,"./brightness-4.png":62,"./brush.png":63,"./button-matcap.jpg":64,"./button.glb":65,"./camera-body.glb":66,"./camera.png":67,"./character-base.glb":68,"./check-outline.png":69,"./chevron-down.png":70,"./chevron-up.png":71,"./close-circle-outline.png":72,"./close.png":73,"./collage.png":74,"./colorful_studio.jpg":75,"./colorful_studio_1k.hdr":76,"./confirmation.wav":77,"./cube-send.png":78,"./cylinder.png":79,"./delete.png":80,"./dice-2.png":81,"./dice-4.png":82,"./dice-6.png":35,"./dots-square.png":83,"./drag-and-drop.png":84,"./ear-hearing.png":85,"./error.wav":86,"./eye-off.png":87,"./eye.png":88,"./file-outline.png":89,"./floppy.png":90,"./folder-open-outline.png":91,"./font.woff":23,"./format-color-fill.png":36,"./gif.png":92,"./hand-no-lines.png":93,"./hand-one-line.png":94,"./hand-right.png":95,"./hand-two-lines.png":96,"./hand.glb":97,"./head-base.glb":98,"./headset.glb":99,"./help-circle-outline.png":100,"./horizontal-rotate-counterclockwise.png":101,"./image-filter-hdr.png":102,"./lead-pencil.png":103,"./light-switch.png":104,"./lock-outline.png":105,"./masked-bucket.png":37,"./matcap.jpg":106,"./navigation_backward-selection.wav":107,"./navigation_forward-selection.wav":108,"./navigation_hover-tap.wav":109,"./newspaper-variant-outline.png":110,"./nudge-brush.png":24,"./oven.png":111,"./palette-swatch-outline.png":112,"./place.glb":113,"./play-pause.png":114,"./plus-box-multiple.png":115,"./plus-box-outline.png":116,"./record.png":117,"./reset-orientation.jpg":118,"./resize.png":119,"./rotate-3d-variant.png":120,"./rotate-orbit.png":121,"./save-to-browser.png":122,"./sfx-03.wav":123,"./sfx-04.wav":124,"./sfx-05.wav":125,"./sfx-06.wav":126,"./sfx-07.wav":127,"./sfx-08.wav":128,"./sfx-09.wav":129,"./sfx-click.wav":130,"./sfx-clock.wav":131,"./sfx-noise.wav":132,"./sfx-punch.wav":133,"./shape-outline.png":134,"./shelf.png":135,"./skeletonator.png":136,"./sketchfab.png":137,"./spotlight.glb":138,"./spray.png":139,"./swap-horizontal-variant.png":140,"./swap-vertical-variant.png":141,"./tap-resonant.wav":142,"./title-font.woff":38,"./transition-masked.png":39,"./transition.png":143,"./translate.png":144,"./ui_lock.wav":145,"./ui_tap-variant-01.wav":146,"./ui_tap-variant-02.wav":147,"./ui_tap-variant-03.wav":148,"./ui_tap-variant-04.wav":149,"./undo.png":150,"./vartiste.png":151,"./video-vintage.png":152,"./volume-brush.glb":153,"./web.png":154};function r(t){var e=a(t);return i(e)}function a(t){if(!i.o(n,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return n[t]}r.keys=function(){return Object.keys(n)},r.resolve=a,t.exports=r,r.id=192},function(t,e){if(THREE.BufferGeometry.prototype.fromGeometry){let t=THREE.BufferGeometry.prototype.fromGeometry;THREE.BufferGeometry.prototype.fromGeometry=function(e){return 0===e.faces.length?this:t.call(this,e)}}THREE.Matrix4.prototype.getInverse=function(t){return this.copy(t).invert()}},function(t,e){var i=AFRAME.registerComponent,n=AFRAME.utils.bind,r=AFRAME.utils.trackedControls,a=r.checkControllerPresentAndSetup,o=r.emitIfAxesChanged,s=r.onButtonEvent,l="https://cdn.aframe.io/controllers/valve/index/valve_index_",c={left:l+"left.gltf",right:l+"right.gltf"},u="valve",h={left:{x:-.00023692678902063457,y:.04724540367838371,z:-.061959880395271096},right:{x:.002471558599671131,y:.055765208987076195,z:-.061068168708348844}},d={left:{_x:.692295102620542,_y:-.0627618864318427,_z:-.06265893149611756,_order:"XYZ"},right:{_x:.6484021229942998,_y:-.032563619881892894,_z:-.1327973171917482,_order:"XYZ"}};t.exports.Component=i("valve-index-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#FAFAFA"},buttonHighlightColor:{type:"color",default:"#22D1EE"},model:{default:!0},orientationOffset:{type:"vec3"}},mapping:{axes:{trackpad:[0,1]},buttons:["trigger","grip","joystick","abutton","abutton","system","finger1","finger2","finger3","finger4","finger5"]},init:function(){var t=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=n(this.onButtonChanged,this),this.onButtonDown=function(e){s(e.detail.id,"down",t)},this.onButtonUp=function(e){s(e.detail.id,"up",t)},this.onButtonTouchEnd=function(e){s(e.detail.id,"touchend",t)},this.onButtonTouchStart=function(e){s(e.detail.id,"touchstart",t)},this.previousButtonValues={},this.rendererSystem=this.el.sceneEl.systems.renderer,this.bindMethods()},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=n(this.onModelLoaded,this),this.onControllersUpdate=n(this.onControllersUpdate,this),this.checkIfControllerPresent=n(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=n(this.removeControllersUpdateListener,this),this.onAxisMoved=n(this.onAxisMoved,this)},addEventListeners:function(){var t=this.el;t.addEventListener("buttonchanged",this.onButtonChanged),t.addEventListener("buttondown",this.onButtonDown),t.addEventListener("buttonup",this.onButtonUp),t.addEventListener("touchend",this.onButtonTouchEnd),t.addEventListener("touchstart",this.onButtonTouchStart),t.addEventListener("model-loaded",this.onModelLoaded),t.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var t=this.el;t.removeEventListener("buttonchanged",this.onButtonChanged),t.removeEventListener("buttondown",this.onButtonDown),t.removeEventListener("buttonup",this.onButtonUp),t.removeEventListener("touchend",this.onButtonTouchEnd),t.removeEventListener("touchstart",this.onButtonTouchStart),t.removeEventListener("model-loaded",this.onModelLoaded),t.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var t=this.data,e="right"===t.hand?0:"left"===t.hand?1:2;a(this,u,{index:e,iterateControllerProfiles:!0,hand:t.hand})},injectTrackedControls:function(){var t=this.el,e=this.data;t.setAttribute("tracked-controls",{idPrefix:u,controller:"right"===e.hand?1:"left"===e.hand?0:2,hand:e.hand,orientationOffset:e.orientationOffset}),this.loadModel()},loadModel:function(){var t=this.data;t.model&&this.el.setAttribute("gltf-model",""+c[t.hand])},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(t){var e,i=this.mapping.buttons[t.detail.id],n=this.buttonMeshes;i&&("trigger"===i&&(e=t.detail.state.value,n&&n.trigger&&(n.trigger.rotation.x=-e*(Math.PI/12))),this.el.emit(i+"changed",t.detail.state))},onModelLoaded:function(t){var e,i=t.detail.model,n=this;this.data.model&&((e=this.buttonMeshes={}).grip={left:i.getObjectByName("leftgrip"),right:i.getObjectByName("rightgrip")},e.menu=i.getObjectByName("menubutton"),e.system=i.getObjectByName("systembutton"),e.trackpad=i.getObjectByName("touchpad"),e.trigger=i.getObjectByName("trigger"),Object.keys(e).forEach((function(t){n.setButtonColor(t,n.data.buttonColor)})),i.position.copy(h[this.data.hand]),i.rotation.copy(d[this.data.hand]),this.el.emit("controllermodelready",{name:"valve-index-controlls",model:this.data.model,rayOrigin:new THREE.Vector3(0,0,0)}))},onAxisMoved:function(t){o(this,this.mapping.axes,t)},updateModel:function(t,e){this.data.model},setButtonColor:function(t,e){this.buttonMeshes,this.rendererSystem}})},function(t,e,i){i(196);const n=!(window.VARTISTE_TOOLKIT&&("auto"===window.VARTISTE_TOOLKIT.replaceTextWithTroikaText?VARTISTE_TOOLKIT.includeFiles&&VARTISTE_TOOLKIT.includeFiles.length||VARTISTE_TOOLKIT.includeComponents&&VARTISTE_TOOLKIT.includeComponents.length:!window.VARTISTE_TOOLKIT.replaceTextWithTroikaText));(t=>{if(!t)return;window.VARTISTE_TOOLKIT&&console.info("VARTISTE TOOLKIT NEW BEHAVIOR NOTICE: Replacing AFRAME text component with TroikaText shim. Set VARTISTE_TOOLKIT.replaceTextWithTroikaText = false to disable this");const e=AFRAME.components.text.schema;delete AFRAME.components.text,AFRAME.registerComponent("text",{dependencies:["troika-text"],schema:Object.assign({},e,{font:{default:window.VARTISTE_TOOLKIT_URL?`${VARTISTE_TOOLKIT_URL}/${i(23)}`:i(23)}}),update(t){let e={};for(let t in this.data)t in AFRAME.components["troika-text"].schema&&(e[t]=this.data[t]);e.value=`${e.value}`;"auto"==this.data.width?e.maxWidth=1:this.data.width?e.maxWidth=this.data.width:this.data.wrapCount&&(e.maxWidth=1.6*(.5+this.data.wrapCount)),this.data.wrapCount&&this.data.width&&(e.fontSize=1.6*this.data.width/this.data.wrapCount),this.data.zOffset&&(this.el.components["troika-text"].troikaTextMesh.position.z=this.data.zOffset),this.el.setAttribute("troika-text",e),this.updateLayout()},updateLayout(){var t=this.el,e=(this.data,this.el.components["troika-text"].troikaTextMesh);if(!e)return;this.setMesh||(e.addEventListener("synccomplete",this.onSync.bind(this)),this.setMesh=!0);var i,n=e.geometry;if(!e||!n)return;(i=t.getAttribute("geometry"))&&"plane"===i.primitive&&(i.width||(this.setWidth=!0),i.height||(this.setHeight=!0)),e.position.x=this.data.xOffset,e.position.y=this.data.yOffset,e._needsSync=!0,e.sync()},onSync(){var t=this.el,e=(this.data,this.el.components["troika-text"].troikaTextMesh.geometry);t.getAttribute("geometry");let i=1.1*(e.boundingBox.max.x-e.boundingBox.min.x),n=1.1*(e.boundingBox.max.y-e.boundingBox.min.y);this.setWidth&&t.setAttribute("geometry","width",i),this.setHeight&&t.setAttribute("geometry","height",n),(this.setWidth||this.setHeight)&&("left"===this.data.anchor?t.getObject3D("mesh").position.x=i/2/1.1:"right"===this.data.anchor&&(t.getObject3D("mesh").position.x=-i/2/1.1),"top"===this.data.baseline?t.getObject3D("mesh").position.y=-n/2/1.1:"bottom"===this.data.baseline&&(t.getObject3D("mesh").position.y=n/2/1.1))}})})(n),AFRAME.registerComponent("text-geometry-shifter",{dependencies:["text"],init(){if(n)return;let t=this.el.components.text.updateLayout;this.el.components.text.updateLayout=function(...e){t.call(this,...e);let i=this.el.getAttribute("text"),n=this.el.getAttribute("geometry").height;"top"===i.baseline?this.el.getObject3D("mesh").position.y=-n/2/1.1:"bottom"===i.baseline&&(this.el.getObject3D("mesh").position.y=n/2/1.1)}}})},function(t,e,i){(function(t){!function(t,e){"use strict";function i(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}function n(t){if(t&&t.__esModule)return t;var e=Object.create(null);return t&&Object.keys(t).forEach((function(i){if("default"!==i){var n=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(e,i,n.get?n:{enumerable:!0,get:function(){return t[i]}})}})),e.default=t,Object.freeze(e)}var r=n(t),a=i(e);function o(){var t,e=0,i=[],n=0,r=0;var a=p((function(t){r||l(1,t)})),s=p((function(t){r||l(-1,t)}));function l(i,n){r++;var a=0;try{n===g&&f();var o=i>0&&d(n);o?o.call(n,p((function(t){a++,l(1,t)})),p((function(t){a++,l(-1,t)}))):(e=i,t=n,c())}catch(t){e||a||l(-1,t)}}function c(){n||(setTimeout(u,0),n=1)}function u(){var t=i;n=0,i=[],t.forEach(h)}function h(t){t()}function d(t){var e=t&&(m(t)||"object"==typeof t)&&t.then;return m(e)&&e}function p(t){var e=0;return function(){for(var i=[],n=arguments.length;n--;)i[n]=arguments[n];e++||t.apply(this,i)}}function f(){throw new TypeError("Chaining cycle detected")}var m=function(t){return"function"==typeof t},g={then:function(n,r){var a=o();return i.push((function(){var i=e>0?n:r;if(m(i))try{var o=i(t);o===a&&f();var s=d(o);s?s.call(o,a.resolve,a.reject):a.resolve(o)}catch(t){a.reject(t)}else a[e>0?"resolve":"reject"](t)})),e&&c(),a},resolve:a,reject:s};return g}function s(){var t,e,i=new Promise((function(i,n){t=i,e=n}));return{then:i.then.bind(i),resolve:t,reject:e}}o.all=s.all=function(t){var e=0,i=[],n=l();return 0===t.length?n.resolve([]):t.forEach((function(r,a){var o=l();o.resolve(r),o.then((function(r){e++,i[a]=r,e===t.length&&n.resolve(i)}),n.reject)})),n};var l="function"==typeof Promise?s:o;function c(){var t=Object.create(null);function e(n,r){var a=n.id,o=n.name,s=n.dependencies;void 0===s&&(s=[]);var l=n.init;void 0===l&&(l=function(){});var c=n.getTransferables;if(void 0===c&&(c=null),!t[a])try{s=s.map((function(i){return i&&i.isWorkerModule&&(e(i,(function(t){if(t instanceof Error)throw t})),i=t[i.id].value),i})),l=i("<"+o+">.init",l),c&&(c=i("<"+o+">.getTransferables",c));var u=null;"function"==typeof l?u=l.apply(void 0,s):console.error("worker module init function failed to rehydrate"),t[a]={id:a,value:u,getTransferables:c},r(u)}catch(t){t&&t.noLog||console.error(t),r(t)}}function i(t,e){var i=void 0;self.troikaDefine=function(t){return i=t};var n=URL.createObjectURL(new Blob(["/** "+t.replace(/\*/g,"")+" **/\n\ntroikaDefine(\n"+e+"\n)"],{type:"application/javascript"}));try{importScripts(n)}catch(t){console.error(t)}return URL.revokeObjectURL(n),delete self.troikaDefine,i}self.addEventListener("message",(function(i){var n=i.data,r=n.messageId,a=n.action,o=n.data;try{"registerModule"===a&&e(o,(function(t){t instanceof Error?postMessage({messageId:r,success:!1,error:t.message}):postMessage({messageId:r,success:!0,result:{isCallable:"function"==typeof t}})})),"callModule"===a&&function(e,i){var n,r=e.id,a=e.args;t[r]&&"function"==typeof t[r].value||i(new Error("Worker module "+r+": not found or its 'init' did not return a function"));try{var o=(n=t[r]).value.apply(n,a);o&&"function"==typeof o.then?o.then(s,(function(t){return i(t instanceof Error?t:new Error(""+t))})):s(o)}catch(t){i(t)}function s(e){try{var n=t[r].getTransferables&&t[r].getTransferables(e);n&&Array.isArray(n)&&n.length||(n=void 0),i(e,n)}catch(t){console.error(t),i(t)}}}(o,(function(t,e){t instanceof Error?postMessage({messageId:r,success:!1,error:t.message}):postMessage({messageId:r,success:!0,result:t},e||void 0)}))}catch(t){postMessage({messageId:r,success:!1,error:t.stack})}}))}var u=function(){var t=!1;if("undefined"!=typeof window&&void 0!==window.document)try{new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"}))).terminate(),t=!0}catch(t){console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+t.message+"]")}return u=function(){return t},t},h=0,d=0,p=!1,f=Object.create(null),m=function(){var t=Object.create(null);return t._count=0,t}();function g(t){if(!(t&&"function"==typeof t.init||p))throw new Error("requires `options.init` function");var e=t.dependencies,i=t.init,n=t.getTransferables,r=t.workerId;if(!u())return function(t){var e=function(){for(var t=[],i=arguments.length;i--;)t[i]=arguments[i];return e._getInitResult().then((function(e){if("function"==typeof e)return e.apply(void 0,t);throw new Error("Worker module function was called but `init` did not return a callable function")}))};return e._getInitResult=function(){var i=t.dependencies,n=t.init;i=Array.isArray(i)?i.map((function(t){return t&&t._getInitResult?t._getInitResult():t})):[];var r=l.all(i).then((function(t){return n.apply(null,t)}));return e._getInitResult=function(){return r},r},e}(t);null==r&&(r="#default");var a="workerModule"+ ++h,o=t.name||a,s=null;function c(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return s||(s=b(r,"registerModule",c.workerModuleData)),s.then((function(e){if(e.isCallable)return b(r,"callModule",{id:a,args:t});throw new Error("Worker module function was called but `init` did not return a callable function")}))}return e=e&&e.map((function(t){return"function"!=typeof t||t.workerModuleData||(p=!0,t=g({workerId:r,name:"<"+o+"> function dependency: "+t.name,init:"function(){return (\n"+y(t)+"\n)}"}),p=!1),t&&t.workerModuleData&&(t=t.workerModuleData),t})),c.workerModuleData={isWorkerModule:!0,id:a,name:o,dependencies:e,init:y(i),getTransferables:n&&y(n)},c}function y(t){var e=t.toString();return!/^function/.test(e)&&/^\w+\s*\(/.test(e)&&(e="function "+e),e}function b(t,e,i){var n=l(),r=++d;return m[r]=function(t){t.success?n.resolve(t.result):n.reject(new Error("Error in worker "+e+" call: "+t.error))},m._count++,m._count>1e3&&console.warn("Large number of open WorkerModule requests, some may not be returning"),function(t){var e=f[t];if(!e){var i=y(c);(e=f[t]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+t.replace(/\*/g,"")+" **/\n\n;("+i+")()"],{type:"application/javascript"})))).onmessage=function(t){var e=t.data,i=e.messageId,n=m[i];if(!n)throw new Error("WorkerModule response with empty or unknown messageId");delete m[i],m._count--,n(e)}}return e}(t).postMessage({messageId:r,action:e,data:i}),n}var A=g({name:"Thenable",dependencies:[l],init:function(t){return t}});const v=/\bvoid\s+main\s*\(\s*\)\s*{/g;function w(e){return e.replace(/^[ \t]*#include +<([\w\d./]+)>/gm,(function(e,i){let n=t.ShaderChunk[i];return n?w(n):e}))}const E=[];for(let t=0;t<256;t++)E[t]=(t<16?"0":"")+t.toString(16);const _=Object.assign||function(){let t=arguments[0];for(let e=1,i=arguments.length;e<i;e++){let i=arguments[e];if(i)for(let e in i)i.hasOwnProperty(e)&&(t[e]=i[e])}return t},x=Date.now(),T=new WeakMap,M=new Map;let C=1e10;function k(e,i){const n=function(t){const e=JSON.stringify(t,S);let i=O.get(e);null==i&&O.set(e,i=++D);return i}(i);let r=T.get(e);if(r||T.set(e,r=Object.create(null)),r[n])return new r[n];const a=`_onBeforeCompile${n}`,o=function(t){e.onBeforeCompile.call(this,t);const r=n+"|||"+t.vertexShader+"|||"+t.fragmentShader;let o=M[r];if(!o){const e=function({vertexShader:t,fragmentShader:e},i,n){let{vertexDefs:r,vertexMainIntro:a,vertexMainOutro:o,vertexTransform:s,fragmentDefs:l,fragmentMainIntro:c,fragmentMainOutro:u,fragmentColorTransform:h,customRewriter:d,timeUniform:p}=i;r=r||"",a=a||"",o=o||"",l=l||"",c=c||"",u=u||"",(s||d)&&(t=w(t));(h||d)&&(e=w(e=e.replace(/^[ \t]*#include <((?:tonemapping|encodings|fog|premultiplied_alpha|dithering)_fragment)>/gm,"\n//!BEGIN_POST_CHUNK $1\n$&\n//!END_POST_CHUNK\n")));if(d){let i=d({vertexShader:t,fragmentShader:e});t=i.vertexShader,e=i.fragmentShader}if(h){let t=[];e=e.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,(e=>(t.push(e),""))),u=`${h}\n${t.join("\n")}\n${u}`}if(p){const t=`\nuniform float ${p};\n`;r=t+r,l=t+l}s&&(r=`${r}\nvoid troikaVertexTransform${n}(inout vec3 position, inout vec3 normal, inout vec2 uv) {\n  ${s}\n}\n`,a=`\ntroika_position_${n} = vec3(position);\ntroika_normal_${n} = vec3(normal);\ntroika_uv_${n} = vec2(uv);\ntroikaVertexTransform${n}(troika_position_${n}, troika_normal_${n}, troika_uv_${n});\n${a}\n`,t=(t=`vec3 troika_position_${n};\nvec3 troika_normal_${n};\nvec2 troika_uv_${n};\n${t}\n`).replace(/\b(position|normal|uv)\b/g,((t,e,i,r)=>/\battribute\s+vec[23]\s+$/.test(r.substr(0,i))?e:`troika_${e}_${n}`)));return t=R(t,n,r,a,o),e=R(e,n,l,c,u),{vertexShader:t,fragmentShader:e}}(t,i,n);o=M[r]=e}t.vertexShader=o.vertexShader,t.fragmentShader=o.fragmentShader,_(t.uniforms,this.uniforms),i.timeUniform&&(t.uniforms[i.timeUniform]={get value(){return Date.now()-x}}),this[a]&&this[a](t)},s=function(){return l(i.chained?e:e.clone())},l=function(t){const r=Object.create(t,c);return Object.defineProperty(r,"baseMaterial",{value:e}),Object.defineProperty(r,"id",{value:C++}),r.uuid=function(){const t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,i=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(E[255&t]+E[t>>8&255]+E[t>>16&255]+E[t>>24&255]+"-"+E[255&e]+E[e>>8&255]+"-"+E[e>>16&15|64]+E[e>>24&255]+"-"+E[63&i|128]+E[i>>8&255]+"-"+E[i>>16&255]+E[i>>24&255]+E[255&n]+E[n>>8&255]+E[n>>16&255]+E[n>>24&255]).toUpperCase()}(),r.uniforms=_({},t.uniforms,i.uniforms),r.defines=_({},t.defines,i.defines),r.defines[`TROIKA_DERIVED_MATERIAL_${n}`]="",r.extensions=_({},t.extensions,i.extensions),r._listeners=void 0,r},c={constructor:{value:s},isDerivedMaterial:{value:!0},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return n}},onBeforeCompile:{get:()=>o,set(t){this[a]=t}},copy:{writable:!0,configurable:!0,value:function(i){return e.copy.call(this,i),e.isShaderMaterial||e.isDerivedMaterial||(_(this.extensions,i.extensions),_(this.defines,i.defines),_(this.uniforms,t.UniformsUtils.clone(i.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){const t=new e.constructor;return l(t).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){let n=this._depthMaterial;return n||(n=this._depthMaterial=k(e.isDerivedMaterial?e.getDepthMaterial():new t.MeshDepthMaterial({depthPacking:t.RGBADepthPacking}),i),n.defines.IS_DEPTH_MATERIAL="",n.uniforms=this.uniforms),n}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){let n=this._distanceMaterial;return n||(n=this._distanceMaterial=k(e.isDerivedMaterial?e.getDistanceMaterial():new t.MeshDistanceMaterial,i),n.defines.IS_DISTANCE_MATERIAL="",n.uniforms=this.uniforms),n}},dispose:{writable:!0,configurable:!0,value(){const{_depthMaterial:t,_distanceMaterial:i}=this;t&&t.dispose(),i&&i.dispose(),e.dispose.call(this)}}};return r[n]=s,new s}function R(t,e,i,n,r){return(n||r||i)&&(t=t.replace(v,`\n${i}\nvoid troikaOrigMain${e}() {`),t+=`\nvoid main() {\n  ${n}\n  troikaOrigMain${e}();\n  ${r}\n}`),t}function S(t,e){return"uniforms"===t?void 0:"function"==typeof e?e.toString():e}let D=0;const O=new Map;const P=g({name:"Typr Font Parser",dependencies:[function(){return"undefined"==typeof window&&(self.window=self),function(t){var e={parse:function(t){var i=e._bin,n=new Uint8Array(t);if("ttcf"==i.readASCII(n,0,4)){var r=4;i.readUshort(n,r),r+=2,i.readUshort(n,r),r+=2;var a=i.readUint(n,r);r+=4;for(var o=[],s=0;s<a;s++){var l=i.readUint(n,r);r+=4,o.push(e._readFont(n,l))}return o}return[e._readFont(n,0)]},_readFont:function(t,i){var n=e._bin,r=i;n.readFixed(t,i),i+=4;var a=n.readUshort(t,i);i+=2,n.readUshort(t,i),i+=2,n.readUshort(t,i),i+=2,n.readUshort(t,i),i+=2;for(var o=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GPOS","GSUB","SVG "],s={_data:t,_offset:r},l={},c=0;c<a;c++){var u=n.readASCII(t,i,4);i+=4,n.readUint(t,i),i+=4;var h=n.readUint(t,i);i+=4;var d=n.readUint(t,i);i+=4,l[u]={offset:h,length:d}}for(c=0;c<o.length;c++){var p=o[c];l[p]&&(s[p.trim()]=e[p.trim()].parse(t,l[p].offset,l[p].length,s))}return s},_tabOffset:function(t,i,n){for(var r=e._bin,a=r.readUshort(t,n+4),o=n+12,s=0;s<a;s++){var l=r.readASCII(t,o,4);o+=4,r.readUint(t,o),o+=4;var c=r.readUint(t,o);if(o+=4,r.readUint(t,o),o+=4,l==i)return c}return 0}};e._bin={readFixed:function(t,e){return(t[e]<<8|t[e+1])+(t[e+2]<<8|t[e+3])/65540},readF2dot14:function(t,i){return e._bin.readShort(t,i)/16384},readInt:function(t,i){var n=e._bin.t.uint8;return n[0]=t[i+3],n[1]=t[i+2],n[2]=t[i+1],n[3]=t[i],e._bin.t.int32[0]},readInt8:function(t,i){return e._bin.t.uint8[0]=t[i],e._bin.t.int8[0]},readShort:function(t,i){var n=e._bin.t.uint8;return n[1]=t[i],n[0]=t[i+1],e._bin.t.int16[0]},readUshort:function(t,e){return t[e]<<8|t[e+1]},readUshorts:function(t,i,n){for(var r=[],a=0;a<n;a++)r.push(e._bin.readUshort(t,i+2*a));return r},readUint:function(t,i){var n=e._bin.t.uint8;return n[3]=t[i],n[2]=t[i+1],n[1]=t[i+2],n[0]=t[i+3],e._bin.t.uint32[0]},readUint64:function(t,i){return 4294967296*e._bin.readUint(t,i)+e._bin.readUint(t,i+4)},readASCII:function(t,e,i){for(var n="",r=0;r<i;r++)n+=String.fromCharCode(t[e+r]);return n},readUnicode:function(t,e,i){for(var n="",r=0;r<i;r++){var a=t[e++]<<8|t[e++];n+=String.fromCharCode(a)}return n},_tdec:"undefined"!=typeof window&&window.TextDecoder?new window.TextDecoder:null,readUTF8:function(t,i,n){var r=e._bin._tdec;return r&&0==i&&n==t.length?r.decode(t):e._bin.readASCII(t,i,n)},readBytes:function(t,e,i){for(var n=[],r=0;r<i;r++)n.push(t[e+r]);return n},readASCIIArray:function(t,e,i){for(var n=[],r=0;r<i;r++)n.push(String.fromCharCode(t[e+r]));return n}},e._bin.t={buff:new ArrayBuffer(8)},e._bin.t.int8=new Int8Array(e._bin.t.buff),e._bin.t.uint8=new Uint8Array(e._bin.t.buff),e._bin.t.int16=new Int16Array(e._bin.t.buff),e._bin.t.uint16=new Uint16Array(e._bin.t.buff),e._bin.t.int32=new Int32Array(e._bin.t.buff),e._bin.t.uint32=new Uint32Array(e._bin.t.buff),e._lctf={},e._lctf.parse=function(t,i,n,r,a){var o=e._bin,s={},l=i;o.readFixed(t,i),i+=4;var c=o.readUshort(t,i);i+=2;var u=o.readUshort(t,i);i+=2;var h=o.readUshort(t,i);return i+=2,s.scriptList=e._lctf.readScriptList(t,l+c),s.featureList=e._lctf.readFeatureList(t,l+u),s.lookupList=e._lctf.readLookupList(t,l+h,a),s},e._lctf.readLookupList=function(t,i,n){var r=e._bin,a=i,o=[],s=r.readUshort(t,i);i+=2;for(var l=0;l<s;l++){var c=r.readUshort(t,i);i+=2;var u=e._lctf.readLookupTable(t,a+c,n);o.push(u)}return o},e._lctf.readLookupTable=function(t,i,n){var r=e._bin,a=i,o={tabs:[]};o.ltype=r.readUshort(t,i),i+=2,o.flag=r.readUshort(t,i),i+=2;var s=r.readUshort(t,i);i+=2;for(var l=o.ltype,c=0;c<s;c++){var u=r.readUshort(t,i);i+=2;var h=n(t,l,a+u,o);o.tabs.push(h)}return o},e._lctf.numOfOnes=function(t){for(var e=0,i=0;i<32;i++)0!=(t>>>i&1)&&e++;return e},e._lctf.readClassDef=function(t,i){var n=e._bin,r=[],a=n.readUshort(t,i);if(i+=2,1==a){var o=n.readUshort(t,i);i+=2;var s=n.readUshort(t,i);i+=2;for(var l=0;l<s;l++)r.push(o+l),r.push(o+l),r.push(n.readUshort(t,i)),i+=2}if(2==a){var c=n.readUshort(t,i);for(i+=2,l=0;l<c;l++)r.push(n.readUshort(t,i)),i+=2,r.push(n.readUshort(t,i)),i+=2,r.push(n.readUshort(t,i)),i+=2}return r},e._lctf.getInterval=function(t,e){for(var i=0;i<t.length;i+=3){var n=t[i],r=t[i+1];if(t[i+2],n<=e&&e<=r)return i}return-1},e._lctf.readCoverage=function(t,i){var n=e._bin,r={};r.fmt=n.readUshort(t,i),i+=2;var a=n.readUshort(t,i);return i+=2,1==r.fmt&&(r.tab=n.readUshorts(t,i,a)),2==r.fmt&&(r.tab=n.readUshorts(t,i,3*a)),r},e._lctf.coverageIndex=function(t,i){var n=t.tab;if(1==t.fmt)return n.indexOf(i);if(2==t.fmt){var r=e._lctf.getInterval(n,i);if(-1!=r)return n[r+2]+(i-n[r])}return-1},e._lctf.readFeatureList=function(t,i){var n=e._bin,r=i,a=[],o=n.readUshort(t,i);i+=2;for(var s=0;s<o;s++){var l=n.readASCII(t,i,4);i+=4;var c=n.readUshort(t,i);i+=2;var u=e._lctf.readFeatureTable(t,r+c);u.tag=l.trim(),a.push(u)}return a},e._lctf.readFeatureTable=function(t,i){var n=e._bin,r=i,a={},o=n.readUshort(t,i);i+=2,o>0&&(a.featureParams=r+o);var s=n.readUshort(t,i);i+=2,a.tab=[];for(var l=0;l<s;l++)a.tab.push(n.readUshort(t,i+2*l));return a},e._lctf.readScriptList=function(t,i){var n=e._bin,r=i,a={},o=n.readUshort(t,i);i+=2;for(var s=0;s<o;s++){var l=n.readASCII(t,i,4);i+=4;var c=n.readUshort(t,i);i+=2,a[l.trim()]=e._lctf.readScriptTable(t,r+c)}return a},e._lctf.readScriptTable=function(t,i){var n=e._bin,r=i,a={},o=n.readUshort(t,i);i+=2,a.default=e._lctf.readLangSysTable(t,r+o);var s=n.readUshort(t,i);i+=2;for(var l=0;l<s;l++){var c=n.readASCII(t,i,4);i+=4;var u=n.readUshort(t,i);i+=2,a[c.trim()]=e._lctf.readLangSysTable(t,r+u)}return a},e._lctf.readLangSysTable=function(t,i){var n=e._bin,r={};n.readUshort(t,i),i+=2,r.reqFeature=n.readUshort(t,i),i+=2;var a=n.readUshort(t,i);return i+=2,r.features=n.readUshorts(t,i,a),r},e.CFF={},e.CFF.parse=function(t,i,n){var r=e._bin;(t=new Uint8Array(t.buffer,i,n))[i=0],t[++i],t[++i],t[++i],i++;var a=[];i=e.CFF.readIndex(t,i,a);for(var o=[],s=0;s<a.length-1;s++)o.push(r.readASCII(t,i+a[s],a[s+1]-a[s]));i+=a[a.length-1];var l=[];i=e.CFF.readIndex(t,i,l);var c=[];for(s=0;s<l.length-1;s++)c.push(e.CFF.readDict(t,i+l[s],i+l[s+1]));i+=l[l.length-1];var u=c[0],h=[];i=e.CFF.readIndex(t,i,h);var d=[];for(s=0;s<h.length-1;s++)d.push(r.readASCII(t,i+h[s],h[s+1]-h[s]));if(i+=h[h.length-1],e.CFF.readSubrs(t,i,u),u.CharStrings){i=u.CharStrings,h=[],i=e.CFF.readIndex(t,i,h);var p=[];for(s=0;s<h.length-1;s++)p.push(r.readBytes(t,i+h[s],h[s+1]-h[s]));u.CharStrings=p}if(u.ROS){i=u.FDArray;var f=[];for(i=e.CFF.readIndex(t,i,f),u.FDArray=[],s=0;s<f.length-1;s++){var m=e.CFF.readDict(t,i+f[s],i+f[s+1]);e.CFF._readFDict(t,m,d),u.FDArray.push(m)}i+=f[f.length-1],i=u.FDSelect,u.FDSelect=[];var g=t[i];if(i++,3!=g)throw g;var y=r.readUshort(t,i);for(i+=2,s=0;s<y+1;s++)u.FDSelect.push(r.readUshort(t,i),t[i+2]),i+=3}return u.Encoding&&(u.Encoding=e.CFF.readEncoding(t,u.Encoding,u.CharStrings.length)),u.charset&&(u.charset=e.CFF.readCharset(t,u.charset,u.CharStrings.length)),e.CFF._readFDict(t,u,d),u},e.CFF._readFDict=function(t,i,n){var r;for(var a in i.Private&&(r=i.Private[1],i.Private=e.CFF.readDict(t,r,r+i.Private[0]),i.Private.Subrs&&e.CFF.readSubrs(t,r+i.Private.Subrs,i.Private)),i)-1!=["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(a)&&(i[a]=n[i[a]-426+35])},e.CFF.readSubrs=function(t,i,n){var r=e._bin,a=[];i=e.CFF.readIndex(t,i,a);var o,s=a.length;o=s<1240?107:s<33900?1131:32768,n.Bias=o,n.Subrs=[];for(var l=0;l<a.length-1;l++)n.Subrs.push(r.readBytes(t,i+a[l],a[l+1]-a[l]))},e.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],e.CFF.glyphByUnicode=function(t,e){for(var i=0;i<t.charset.length;i++)if(t.charset[i]==e)return i;return-1},e.CFF.glyphBySE=function(t,i){return i<0||i>255?-1:e.CFF.glyphByUnicode(t,e.CFF.tableSE[i])},e.CFF.readEncoding=function(t,i,n){e._bin;var r=[".notdef"],a=t[i];if(i++,0!=a)throw"error: unknown encoding format: "+a;var o=t[i];i++;for(var s=0;s<o;s++)r.push(t[i+s]);return r},e.CFF.readCharset=function(t,i,n){var r=e._bin,a=[".notdef"],o=t[i];if(i++,0==o)for(var s=0;s<n;s++){var l=r.readUshort(t,i);i+=2,a.push(l)}else{if(1!=o&&2!=o)throw"error: format: "+o;for(;a.length<n;){l=r.readUshort(t,i),i+=2;var c=0;for(1==o?(c=t[i],i++):(c=r.readUshort(t,i),i+=2),s=0;s<=c;s++)a.push(l),l++}}return a},e.CFF.readIndex=function(t,i,n){var r=e._bin,a=r.readUshort(t,i)+1,o=t[i+=2];if(i++,1==o)for(var s=0;s<a;s++)n.push(t[i+s]);else if(2==o)for(s=0;s<a;s++)n.push(r.readUshort(t,i+2*s));else if(3==o)for(s=0;s<a;s++)n.push(16777215&r.readUint(t,i+3*s-1));else if(1!=a)throw"unsupported offset size: "+o+", count: "+a;return(i+=a*o)-1},e.CFF.getCharString=function(t,i,n){var r=e._bin,a=t[i],o=t[i+1];t[i+2],t[i+3],t[i+4];var s=1,l=null,c=null;a<=20&&(l=a,s=1),12==a&&(l=100*a+o,s=2),21<=a&&a<=27&&(l=a,s=1),28==a&&(c=r.readShort(t,i+1),s=3),29<=a&&a<=31&&(l=a,s=1),32<=a&&a<=246&&(c=a-139,s=1),247<=a&&a<=250&&(c=256*(a-247)+o+108,s=2),251<=a&&a<=254&&(c=256*-(a-251)-o-108,s=2),255==a&&(c=r.readInt(t,i+1)/65535,s=5),n.val=null!=c?c:"o"+l,n.size=s},e.CFF.readCharString=function(t,i,n){for(var r=i+n,a=e._bin,o=[];i<r;){var s=t[i],l=t[i+1];t[i+2],t[i+3],t[i+4];var c=1,u=null,h=null;s<=20&&(u=s,c=1),12==s&&(u=100*s+l,c=2),19!=s&&20!=s||(u=s,c=2),21<=s&&s<=27&&(u=s,c=1),28==s&&(h=a.readShort(t,i+1),c=3),29<=s&&s<=31&&(u=s,c=1),32<=s&&s<=246&&(h=s-139,c=1),247<=s&&s<=250&&(h=256*(s-247)+l+108,c=2),251<=s&&s<=254&&(h=256*-(s-251)-l-108,c=2),255==s&&(h=a.readInt(t,i+1)/65535,c=5),o.push(null!=h?h:"o"+u),i+=c}return o},e.CFF.readDict=function(t,i,n){for(var r=e._bin,a={},o=[];i<n;){var s=t[i],l=t[i+1];t[i+2],t[i+3],t[i+4];var c=1,u=null,h=null;if(28==s&&(h=r.readShort(t,i+1),c=3),29==s&&(h=r.readInt(t,i+1),c=5),32<=s&&s<=246&&(h=s-139,c=1),247<=s&&s<=250&&(h=256*(s-247)+l+108,c=2),251<=s&&s<=254&&(h=256*-(s-251)-l-108,c=2),255==s)throw h=r.readInt(t,i+1)/65535,c=5,"unknown number";if(30==s){var d=[];for(c=1;;){var p=t[i+c];c++;var f=p>>4,m=15&p;if(15!=f&&d.push(f),15!=m&&d.push(m),15==m)break}for(var g="",y=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],b=0;b<d.length;b++)g+=y[d[b]];h=parseFloat(g)}s<=21&&(u=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][s],c=1,12==s&&(u=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][l],c=2)),null!=u?(a[u]=1==o.length?o[0]:o,o=[]):o.push(h),i+=c}return a},e.cmap={},e.cmap.parse=function(t,i,n){t=new Uint8Array(t.buffer,i,n),i=0;var r=e._bin,a={};r.readUshort(t,i),i+=2;var o=r.readUshort(t,i);i+=2;var s=[];a.tables=[];for(var l=0;l<o;l++){var c=r.readUshort(t,i);i+=2;var u=r.readUshort(t,i);i+=2;var h=r.readUint(t,i);i+=4;var d="p"+c+"e"+u,p=s.indexOf(h);if(-1==p){var f;p=a.tables.length,s.push(h);var m=r.readUshort(t,h);0==m?f=e.cmap.parse0(t,h):4==m?f=e.cmap.parse4(t,h):6==m?f=e.cmap.parse6(t,h):12==m?f=e.cmap.parse12(t,h):console.debug("unknown format: "+m,c,u,h),a.tables.push(f)}if(null!=a[d])throw"multiple tables for one platform+encoding";a[d]=p}return a},e.cmap.parse0=function(t,i){var n=e._bin,r={};r.format=n.readUshort(t,i),i+=2;var a=n.readUshort(t,i);i+=2,n.readUshort(t,i),i+=2,r.map=[];for(var o=0;o<a-6;o++)r.map.push(t[i+o]);return r},e.cmap.parse4=function(t,i){var n=e._bin,r=i,a={};a.format=n.readUshort(t,i),i+=2;var o=n.readUshort(t,i);i+=2,n.readUshort(t,i),i+=2;var s=n.readUshort(t,i);i+=2;var l=s/2;a.searchRange=n.readUshort(t,i),i+=2,a.entrySelector=n.readUshort(t,i),i+=2,a.rangeShift=n.readUshort(t,i),i+=2,a.endCount=n.readUshorts(t,i,l),i+=2*l,i+=2,a.startCount=n.readUshorts(t,i,l),i+=2*l,a.idDelta=[];for(var c=0;c<l;c++)a.idDelta.push(n.readShort(t,i)),i+=2;for(a.idRangeOffset=n.readUshorts(t,i,l),i+=2*l,a.glyphIdArray=[];i<r+o;)a.glyphIdArray.push(n.readUshort(t,i)),i+=2;return a},e.cmap.parse6=function(t,i){var n=e._bin,r={};r.format=n.readUshort(t,i),i+=2,n.readUshort(t,i),i+=2,n.readUshort(t,i),i+=2,r.firstCode=n.readUshort(t,i),i+=2;var a=n.readUshort(t,i);i+=2,r.glyphIdArray=[];for(var o=0;o<a;o++)r.glyphIdArray.push(n.readUshort(t,i)),i+=2;return r},e.cmap.parse12=function(t,i){var n=e._bin,r={};r.format=n.readUshort(t,i),i+=2,i+=2,n.readUint(t,i),i+=4,n.readUint(t,i),i+=4;var a=n.readUint(t,i);i+=4,r.groups=[];for(var o=0;o<a;o++){var s=i+12*o,l=n.readUint(t,s+0),c=n.readUint(t,s+4),u=n.readUint(t,s+8);r.groups.push([l,c,u])}return r},e.glyf={},e.glyf.parse=function(t,e,i,n){for(var r=[],a=0;a<n.maxp.numGlyphs;a++)r.push(null);return r},e.glyf._parseGlyf=function(t,i){var n=e._bin,r=t._data,a=e._tabOffset(r,"glyf",t._offset)+t.loca[i];if(t.loca[i]==t.loca[i+1])return null;var o={};if(o.noc=n.readShort(r,a),a+=2,o.xMin=n.readShort(r,a),a+=2,o.yMin=n.readShort(r,a),a+=2,o.xMax=n.readShort(r,a),a+=2,o.yMax=n.readShort(r,a),a+=2,o.xMin>=o.xMax||o.yMin>=o.yMax)return null;if(o.noc>0){o.endPts=[];for(var s=0;s<o.noc;s++)o.endPts.push(n.readUshort(r,a)),a+=2;var l=n.readUshort(r,a);if(a+=2,r.length-a<l)return null;o.instructions=n.readBytes(r,a,l),a+=l;var c=o.endPts[o.noc-1]+1;for(o.flags=[],s=0;s<c;s++){var u=r[a];if(a++,o.flags.push(u),0!=(8&u)){var h=r[a];a++;for(var d=0;d<h;d++)o.flags.push(u),s++}}for(o.xs=[],s=0;s<c;s++){var p=0!=(2&o.flags[s]),f=0!=(16&o.flags[s]);p?(o.xs.push(f?r[a]:-r[a]),a++):f?o.xs.push(0):(o.xs.push(n.readShort(r,a)),a+=2)}for(o.ys=[],s=0;s<c;s++)p=0!=(4&o.flags[s]),f=0!=(32&o.flags[s]),p?(o.ys.push(f?r[a]:-r[a]),a++):f?o.ys.push(0):(o.ys.push(n.readShort(r,a)),a+=2);var m=0,g=0;for(s=0;s<c;s++)m+=o.xs[s],g+=o.ys[s],o.xs[s]=m,o.ys[s]=g}else{var y;o.parts=[];do{y=n.readUshort(r,a),a+=2;var b={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(o.parts.push(b),b.glyphIndex=n.readUshort(r,a),a+=2,1&y){var A=n.readShort(r,a);a+=2;var v=n.readShort(r,a);a+=2}else A=n.readInt8(r,a),a++,v=n.readInt8(r,a),a++;2&y?(b.m.tx=A,b.m.ty=v):(b.p1=A,b.p2=v),8&y?(b.m.a=b.m.d=n.readF2dot14(r,a),a+=2):64&y?(b.m.a=n.readF2dot14(r,a),a+=2,b.m.d=n.readF2dot14(r,a),a+=2):128&y&&(b.m.a=n.readF2dot14(r,a),a+=2,b.m.b=n.readF2dot14(r,a),a+=2,b.m.c=n.readF2dot14(r,a),a+=2,b.m.d=n.readF2dot14(r,a),a+=2)}while(32&y);if(256&y){var w=n.readUshort(r,a);for(a+=2,o.instr=[],s=0;s<w;s++)o.instr.push(r[a]),a++}}return o},e.GPOS={},e.GPOS.parse=function(t,i,n,r){return e._lctf.parse(t,i,n,r,e.GPOS.subt)},e.GPOS.subt=function(t,i,n,r){var a=e._bin,o=n,s={};if(s.fmt=a.readUshort(t,n),n+=2,1==i||2==i||3==i||7==i||8==i&&s.fmt<=2){var l=a.readUshort(t,n);n+=2,s.coverage=e._lctf.readCoverage(t,l+o)}if(1==i&&1==s.fmt){var c=a.readUshort(t,n);n+=2;var u=e._lctf.numOfOnes(c);0!=c&&(s.pos=e.GPOS.readValueRecord(t,n,c))}else if(2==i&&s.fmt>=1&&s.fmt<=2){c=a.readUshort(t,n),n+=2;var h=a.readUshort(t,n);n+=2,u=e._lctf.numOfOnes(c);var d=e._lctf.numOfOnes(h);if(1==s.fmt){s.pairsets=[];var p=a.readUshort(t,n);n+=2;for(var f=0;f<p;f++){var m=o+a.readUshort(t,n);n+=2;var g=a.readUshort(t,m);m+=2;for(var y=[],b=0;b<g;b++){var A=a.readUshort(t,m);m+=2,0!=c&&(T=e.GPOS.readValueRecord(t,m,c),m+=2*u),0!=h&&(M=e.GPOS.readValueRecord(t,m,h),m+=2*d),y.push({gid2:A,val1:T,val2:M})}s.pairsets.push(y)}}if(2==s.fmt){var v=a.readUshort(t,n);n+=2;var w=a.readUshort(t,n);n+=2;var E=a.readUshort(t,n);n+=2;var _=a.readUshort(t,n);for(n+=2,s.classDef1=e._lctf.readClassDef(t,o+v),s.classDef2=e._lctf.readClassDef(t,o+w),s.matrix=[],f=0;f<E;f++){var x=[];for(b=0;b<_;b++){var T=null,M=null;0!=c&&(T=e.GPOS.readValueRecord(t,n,c),n+=2*u),0!=h&&(M=e.GPOS.readValueRecord(t,n,h),n+=2*d),x.push({val1:T,val2:M})}s.matrix.push(x)}}}else{if(9==i&&1==s.fmt){var C=a.readUshort(t,n);n+=2;var k=a.readUint(t,n);if(n+=4,9==r.ltype)r.ltype=C;else if(r.ltype!=C)throw"invalid extension substitution";return e.GPOS.subt(t,r.ltype,o+k)}console.debug("unsupported GPOS table LookupType",i,"format",s.fmt)}return s},e.GPOS.readValueRecord=function(t,i,n){var r=e._bin,a=[];return a.push(1&n?r.readShort(t,i):0),i+=1&n?2:0,a.push(2&n?r.readShort(t,i):0),i+=2&n?2:0,a.push(4&n?r.readShort(t,i):0),i+=4&n?2:0,a.push(8&n?r.readShort(t,i):0),i+=8&n?2:0,a},e.GSUB={},e.GSUB.parse=function(t,i,n,r){return e._lctf.parse(t,i,n,r,e.GSUB.subt)},e.GSUB.subt=function(t,i,n,r){var a=e._bin,o=n,s={};if(s.fmt=a.readUshort(t,n),n+=2,1!=i&&4!=i&&5!=i&&6!=i)return null;if(1==i||4==i||5==i&&s.fmt<=2||6==i&&s.fmt<=2){var l=a.readUshort(t,n);n+=2,s.coverage=e._lctf.readCoverage(t,o+l)}if(1==i&&s.fmt>=1&&s.fmt<=2){if(1==s.fmt)s.delta=a.readShort(t,n),n+=2;else if(2==s.fmt){var c=a.readUshort(t,n);n+=2,s.newg=a.readUshorts(t,n,c),n+=2*s.newg.length}}else if(4==i){s.vals=[],c=a.readUshort(t,n),n+=2;for(var u=0;u<c;u++){var h=a.readUshort(t,n);n+=2,s.vals.push(e.GSUB.readLigatureSet(t,o+h))}}else if(5==i&&2==s.fmt){if(2==s.fmt){var d=a.readUshort(t,n);n+=2,s.cDef=e._lctf.readClassDef(t,o+d),s.scset=[];var p=a.readUshort(t,n);for(n+=2,u=0;u<p;u++){var f=a.readUshort(t,n);n+=2,s.scset.push(0==f?null:e.GSUB.readSubClassSet(t,o+f))}}}else if(6==i&&3==s.fmt){if(3==s.fmt){for(u=0;u<3;u++){c=a.readUshort(t,n),n+=2;for(var m=[],g=0;g<c;g++)m.push(e._lctf.readCoverage(t,o+a.readUshort(t,n+2*g)));n+=2*c,0==u&&(s.backCvg=m),1==u&&(s.inptCvg=m),2==u&&(s.ahedCvg=m)}c=a.readUshort(t,n),n+=2,s.lookupRec=e.GSUB.readSubstLookupRecords(t,n,c)}}else{if(7==i&&1==s.fmt){var y=a.readUshort(t,n);n+=2;var b=a.readUint(t,n);if(n+=4,9==r.ltype)r.ltype=y;else if(r.ltype!=y)throw"invalid extension substitution";return e.GSUB.subt(t,r.ltype,o+b)}console.debug("unsupported GSUB table LookupType",i,"format",s.fmt)}return s},e.GSUB.readSubClassSet=function(t,i){var n=e._bin.readUshort,r=i,a=[],o=n(t,i);i+=2;for(var s=0;s<o;s++){var l=n(t,i);i+=2,a.push(e.GSUB.readSubClassRule(t,r+l))}return a},e.GSUB.readSubClassRule=function(t,i){var n=e._bin.readUshort,r={},a=n(t,i),o=n(t,i+=2);i+=2,r.input=[];for(var s=0;s<a-1;s++)r.input.push(n(t,i)),i+=2;return r.substLookupRecords=e.GSUB.readSubstLookupRecords(t,i,o),r},e.GSUB.readSubstLookupRecords=function(t,i,n){for(var r=e._bin.readUshort,a=[],o=0;o<n;o++)a.push(r(t,i),r(t,i+2)),i+=4;return a},e.GSUB.readChainSubClassSet=function(t,i){var n=e._bin,r=i,a=[],o=n.readUshort(t,i);i+=2;for(var s=0;s<o;s++){var l=n.readUshort(t,i);i+=2,a.push(e.GSUB.readChainSubClassRule(t,r+l))}return a},e.GSUB.readChainSubClassRule=function(t,i){for(var n=e._bin,r={},a=["backtrack","input","lookahead"],o=0;o<a.length;o++){var s=n.readUshort(t,i);i+=2,1==o&&s--,r[a[o]]=n.readUshorts(t,i,s),i+=2*r[a[o]].length}return s=n.readUshort(t,i),i+=2,r.subst=n.readUshorts(t,i,2*s),i+=2*r.subst.length,r},e.GSUB.readLigatureSet=function(t,i){var n=e._bin,r=i,a=[],o=n.readUshort(t,i);i+=2;for(var s=0;s<o;s++){var l=n.readUshort(t,i);i+=2,a.push(e.GSUB.readLigature(t,r+l))}return a},e.GSUB.readLigature=function(t,i){var n=e._bin,r={chain:[]};r.nglyph=n.readUshort(t,i),i+=2;var a=n.readUshort(t,i);i+=2;for(var o=0;o<a-1;o++)r.chain.push(n.readUshort(t,i)),i+=2;return r},e.head={},e.head.parse=function(t,i,n){var r=e._bin,a={};return r.readFixed(t,i),i+=4,a.fontRevision=r.readFixed(t,i),i+=4,r.readUint(t,i),i+=4,r.readUint(t,i),i+=4,a.flags=r.readUshort(t,i),i+=2,a.unitsPerEm=r.readUshort(t,i),i+=2,a.created=r.readUint64(t,i),i+=8,a.modified=r.readUint64(t,i),i+=8,a.xMin=r.readShort(t,i),i+=2,a.yMin=r.readShort(t,i),i+=2,a.xMax=r.readShort(t,i),i+=2,a.yMax=r.readShort(t,i),i+=2,a.macStyle=r.readUshort(t,i),i+=2,a.lowestRecPPEM=r.readUshort(t,i),i+=2,a.fontDirectionHint=r.readShort(t,i),i+=2,a.indexToLocFormat=r.readShort(t,i),i+=2,a.glyphDataFormat=r.readShort(t,i),i+=2,a},e.hhea={},e.hhea.parse=function(t,i,n){var r=e._bin,a={};return r.readFixed(t,i),i+=4,a.ascender=r.readShort(t,i),i+=2,a.descender=r.readShort(t,i),i+=2,a.lineGap=r.readShort(t,i),i+=2,a.advanceWidthMax=r.readUshort(t,i),i+=2,a.minLeftSideBearing=r.readShort(t,i),i+=2,a.minRightSideBearing=r.readShort(t,i),i+=2,a.xMaxExtent=r.readShort(t,i),i+=2,a.caretSlopeRise=r.readShort(t,i),i+=2,a.caretSlopeRun=r.readShort(t,i),i+=2,a.caretOffset=r.readShort(t,i),i+=2,i+=8,a.metricDataFormat=r.readShort(t,i),i+=2,a.numberOfHMetrics=r.readUshort(t,i),i+=2,a},e.hmtx={},e.hmtx.parse=function(t,i,n,r){for(var a=e._bin,o={aWidth:[],lsBearing:[]},s=0,l=0,c=0;c<r.maxp.numGlyphs;c++)c<r.hhea.numberOfHMetrics&&(s=a.readUshort(t,i),i+=2,l=a.readShort(t,i),i+=2),o.aWidth.push(s),o.lsBearing.push(l);return o},e.kern={},e.kern.parse=function(t,i,n,r){var a=e._bin,o=a.readUshort(t,i);if(i+=2,1==o)return e.kern.parseV1(t,i-2,n,r);var s=a.readUshort(t,i);i+=2;for(var l={glyph1:[],rval:[]},c=0;c<s;c++){i+=2,n=a.readUshort(t,i),i+=2;var u=a.readUshort(t,i);i+=2;var h=u>>>8;if(0!=(h&=15))throw"unknown kern table format: "+h;i=e.kern.readFormat0(t,i,l)}return l},e.kern.parseV1=function(t,i,n,r){var a=e._bin;a.readFixed(t,i),i+=4;var o=a.readUint(t,i);i+=4;for(var s={glyph1:[],rval:[]},l=0;l<o;l++){a.readUint(t,i),i+=4;var c=a.readUshort(t,i);i+=2,a.readUshort(t,i),i+=2;var u=c>>>8;if(0!=(u&=15))throw"unknown kern table format: "+u;i=e.kern.readFormat0(t,i,s)}return s},e.kern.readFormat0=function(t,i,n){var r=e._bin,a=-1,o=r.readUshort(t,i);i+=2,r.readUshort(t,i),i+=2,r.readUshort(t,i),i+=2,r.readUshort(t,i),i+=2;for(var s=0;s<o;s++){var l=r.readUshort(t,i);i+=2;var c=r.readUshort(t,i);i+=2;var u=r.readShort(t,i);i+=2,l!=a&&(n.glyph1.push(l),n.rval.push({glyph2:[],vals:[]}));var h=n.rval[n.rval.length-1];h.glyph2.push(c),h.vals.push(u),a=l}return i},e.loca={},e.loca.parse=function(t,i,n,r){var a=e._bin,o=[],s=r.head.indexToLocFormat,l=r.maxp.numGlyphs+1;if(0==s)for(var c=0;c<l;c++)o.push(a.readUshort(t,i+(c<<1))<<1);if(1==s)for(c=0;c<l;c++)o.push(a.readUint(t,i+(c<<2)));return o},e.maxp={},e.maxp.parse=function(t,i,n){var r=e._bin,a={},o=r.readUint(t,i);return i+=4,a.numGlyphs=r.readUshort(t,i),i+=2,65536==o&&(a.maxPoints=r.readUshort(t,i),i+=2,a.maxContours=r.readUshort(t,i),i+=2,a.maxCompositePoints=r.readUshort(t,i),i+=2,a.maxCompositeContours=r.readUshort(t,i),i+=2,a.maxZones=r.readUshort(t,i),i+=2,a.maxTwilightPoints=r.readUshort(t,i),i+=2,a.maxStorage=r.readUshort(t,i),i+=2,a.maxFunctionDefs=r.readUshort(t,i),i+=2,a.maxInstructionDefs=r.readUshort(t,i),i+=2,a.maxStackElements=r.readUshort(t,i),i+=2,a.maxSizeOfInstructions=r.readUshort(t,i),i+=2,a.maxComponentElements=r.readUshort(t,i),i+=2,a.maxComponentDepth=r.readUshort(t,i),i+=2),a},e.name={},e.name.parse=function(t,i,n){var r=e._bin,a={};r.readUshort(t,i),i+=2;var o=r.readUshort(t,i);i+=2,r.readUshort(t,i);for(var s,l=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],c=i+=2,u=0;u<o;u++){var h=r.readUshort(t,i);i+=2;var d=r.readUshort(t,i);i+=2;var p=r.readUshort(t,i);i+=2;var f=r.readUshort(t,i);i+=2;var m=r.readUshort(t,i);i+=2;var g=r.readUshort(t,i);i+=2;var y,b=l[f],A=c+12*o+g;if(0==h)y=r.readUnicode(t,A,m/2);else if(3==h&&0==d)y=r.readUnicode(t,A,m/2);else if(0==d)y=r.readASCII(t,A,m);else if(1==d)y=r.readUnicode(t,A,m/2);else if(3==d)y=r.readUnicode(t,A,m/2);else{if(1!=h)throw"unknown encoding "+d+", platformID: "+h;y=r.readASCII(t,A,m),console.debug("reading unknown MAC encoding "+d+" as ASCII")}var v="p"+h+","+p.toString(16);null==a[v]&&(a[v]={}),a[v][void 0!==b?b:f]=y,a[v]._lang=p}for(var w in a)if(null!=a[w].postScriptName&&1033==a[w]._lang)return a[w];for(var w in a)if(null!=a[w].postScriptName&&0==a[w]._lang)return a[w];for(var w in a)if(null!=a[w].postScriptName&&3084==a[w]._lang)return a[w];for(var w in a)if(null!=a[w].postScriptName)return a[w];for(var w in a){s=w;break}return console.debug("returning name table with languageID "+a[s]._lang),a[s]},e["OS/2"]={},e["OS/2"].parse=function(t,i,n){var r=e._bin.readUshort(t,i);i+=2;var a={};if(0==r)e["OS/2"].version0(t,i,a);else if(1==r)e["OS/2"].version1(t,i,a);else if(2==r||3==r||4==r)e["OS/2"].version2(t,i,a);else{if(5!=r)throw"unknown OS/2 table version: "+r;e["OS/2"].version5(t,i,a)}return a},e["OS/2"].version0=function(t,i,n){var r=e._bin;return n.xAvgCharWidth=r.readShort(t,i),i+=2,n.usWeightClass=r.readUshort(t,i),i+=2,n.usWidthClass=r.readUshort(t,i),i+=2,n.fsType=r.readUshort(t,i),i+=2,n.ySubscriptXSize=r.readShort(t,i),i+=2,n.ySubscriptYSize=r.readShort(t,i),i+=2,n.ySubscriptXOffset=r.readShort(t,i),i+=2,n.ySubscriptYOffset=r.readShort(t,i),i+=2,n.ySuperscriptXSize=r.readShort(t,i),i+=2,n.ySuperscriptYSize=r.readShort(t,i),i+=2,n.ySuperscriptXOffset=r.readShort(t,i),i+=2,n.ySuperscriptYOffset=r.readShort(t,i),i+=2,n.yStrikeoutSize=r.readShort(t,i),i+=2,n.yStrikeoutPosition=r.readShort(t,i),i+=2,n.sFamilyClass=r.readShort(t,i),i+=2,n.panose=r.readBytes(t,i,10),i+=10,n.ulUnicodeRange1=r.readUint(t,i),i+=4,n.ulUnicodeRange2=r.readUint(t,i),i+=4,n.ulUnicodeRange3=r.readUint(t,i),i+=4,n.ulUnicodeRange4=r.readUint(t,i),i+=4,n.achVendID=[r.readInt8(t,i),r.readInt8(t,i+1),r.readInt8(t,i+2),r.readInt8(t,i+3)],i+=4,n.fsSelection=r.readUshort(t,i),i+=2,n.usFirstCharIndex=r.readUshort(t,i),i+=2,n.usLastCharIndex=r.readUshort(t,i),i+=2,n.sTypoAscender=r.readShort(t,i),i+=2,n.sTypoDescender=r.readShort(t,i),i+=2,n.sTypoLineGap=r.readShort(t,i),i+=2,n.usWinAscent=r.readUshort(t,i),i+=2,n.usWinDescent=r.readUshort(t,i),i+2},e["OS/2"].version1=function(t,i,n){var r=e._bin;return i=e["OS/2"].version0(t,i,n),n.ulCodePageRange1=r.readUint(t,i),i+=4,n.ulCodePageRange2=r.readUint(t,i),i+4},e["OS/2"].version2=function(t,i,n){var r=e._bin;return i=e["OS/2"].version1(t,i,n),n.sxHeight=r.readShort(t,i),i+=2,n.sCapHeight=r.readShort(t,i),i+=2,n.usDefault=r.readUshort(t,i),i+=2,n.usBreak=r.readUshort(t,i),i+=2,n.usMaxContext=r.readUshort(t,i),i+2},e["OS/2"].version5=function(t,i,n){var r=e._bin;return i=e["OS/2"].version2(t,i,n),n.usLowerOpticalPointSize=r.readUshort(t,i),i+=2,n.usUpperOpticalPointSize=r.readUshort(t,i),i+2},e.post={},e.post.parse=function(t,i,n){var r=e._bin,a={};return a.version=r.readFixed(t,i),i+=4,a.italicAngle=r.readFixed(t,i),i+=4,a.underlinePosition=r.readShort(t,i),i+=2,a.underlineThickness=r.readShort(t,i),i+=2,a},null==e&&(e={}),null==e.U&&(e.U={}),e.U.codeToGlyph=function(t,e){var i=t.cmap,n=-1;if(null!=i.p0e4?n=i.p0e4:null!=i.p3e1?n=i.p3e1:null!=i.p1e0?n=i.p1e0:null!=i.p0e3&&(n=i.p0e3),-1==n)throw"no familiar platform and encoding!";var r=i.tables[n];if(0==r.format)return e>=r.map.length?0:r.map[e];if(4==r.format){for(var a=-1,o=0;o<r.endCount.length;o++)if(e<=r.endCount[o]){a=o;break}return-1==a||r.startCount[a]>e?0:65535&(0!=r.idRangeOffset[a]?r.glyphIdArray[e-r.startCount[a]+(r.idRangeOffset[a]>>1)-(r.idRangeOffset.length-a)]:e+r.idDelta[a])}if(12==r.format){if(e>r.groups[r.groups.length-1][1])return 0;for(o=0;o<r.groups.length;o++){var s=r.groups[o];if(s[0]<=e&&e<=s[1])return s[2]+(e-s[0])}return 0}throw"unknown cmap table format "+r.format},e.U.glyphToPath=function(t,i){var n={cmds:[],crds:[]};if(t.SVG&&t.SVG.entries[i]){var r=t.SVG.entries[i];return null==r?n:("string"==typeof r&&(r=e.SVG.toPath(r),t.SVG.entries[i]=r),r)}if(t.CFF){var a={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:t.CFF.Private?t.CFF.Private.defaultWidthX:0,open:!1},o=t.CFF,s=t.CFF.Private;if(o.ROS){for(var l=0;o.FDSelect[l+2]<=i;)l+=2;s=o.FDArray[o.FDSelect[l+1]].Private}e.U._drawCFF(t.CFF.CharStrings[i],a,o,s,n)}else t.glyf&&e.U._drawGlyf(i,t,n);return n},e.U._drawGlyf=function(t,i,n){var r=i.glyf[t];null==r&&(r=i.glyf[t]=e.glyf._parseGlyf(i,t)),null!=r&&(r.noc>-1?e.U._simpleGlyph(r,n):e.U._compoGlyph(r,i,n))},e.U._simpleGlyph=function(t,i){for(var n=0;n<t.noc;n++){for(var r=0==n?0:t.endPts[n-1]+1,a=t.endPts[n],o=r;o<=a;o++){var s=o==r?a:o-1,l=o==a?r:o+1,c=1&t.flags[o],u=1&t.flags[s],h=1&t.flags[l],d=t.xs[o],p=t.ys[o];if(o==r)if(c){if(!u){e.U.P.moveTo(i,d,p);continue}e.U.P.moveTo(i,t.xs[s],t.ys[s])}else u?e.U.P.moveTo(i,t.xs[s],t.ys[s]):e.U.P.moveTo(i,(t.xs[s]+d)/2,(t.ys[s]+p)/2);c?u&&e.U.P.lineTo(i,d,p):h?e.U.P.qcurveTo(i,d,p,t.xs[l],t.ys[l]):e.U.P.qcurveTo(i,d,p,(d+t.xs[l])/2,(p+t.ys[l])/2)}e.U.P.closePath(i)}},e.U._compoGlyph=function(t,i,n){for(var r=0;r<t.parts.length;r++){var a={cmds:[],crds:[]},o=t.parts[r];e.U._drawGlyf(o.glyphIndex,i,a);for(var s=o.m,l=0;l<a.crds.length;l+=2){var c=a.crds[l],u=a.crds[l+1];n.crds.push(c*s.a+u*s.b+s.tx),n.crds.push(c*s.c+u*s.d+s.ty)}for(l=0;l<a.cmds.length;l++)n.cmds.push(a.cmds[l])}},e.U._getGlyphClass=function(t,i){var n=e._lctf.getInterval(i,t);return-1==n?0:i[n+2]},e.U.getPairAdjustment=function(t,i,n){var r=0;if(t.GPOS)for(var a=t.GPOS,o=a.lookupList,s=a.featureList,l=[],c=0;c<s.length;c++){var u=s[c];if("kern"==u.tag)for(var h=0;h<u.tab.length;h++)if(!l[u.tab[h]]){l[u.tab[h]]=!0;for(var d=o[u.tab[h]],p=0;p<d.tabs.length;p++)if(null!=d.tabs[p]){var f,m=d.tabs[p];if(!m.coverage||-1!=(f=e._lctf.coverageIndex(m.coverage,i)))if(1==d.ltype);else if(2==d.ltype){var g;if(1==m.fmt){var y=m.pairsets[f];for(c=0;c<y.length;c++)y[c].gid2==n&&(g=y[c])}else if(2==m.fmt){var b=e.U._getGlyphClass(i,m.classDef1),A=e.U._getGlyphClass(n,m.classDef2);g=m.matrix[b][A]}g&&g.val1&&g.val1[2]&&(r+=g.val1[2]),g&&g.val2&&g.val2[0]&&(r+=g.val2[0])}}}}if(t.kern){var v=t.kern.glyph1.indexOf(i);if(-1!=v){var w=t.kern.rval[v].glyph2.indexOf(n);-1!=w&&(r+=t.kern.rval[v].vals[w])}}return r},e.U._applySubs=function(t,i,n,r){for(var a=t.length-i-1,o=0;o<n.tabs.length;o++)if(null!=n.tabs[o]){var s,l=n.tabs[o];if(!l.coverage||-1!=(s=e._lctf.coverageIndex(l.coverage,t[i])))if(1==n.ltype)t[i],1==l.fmt?t[i]=t[i]+l.delta:t[i]=l.newg[s];else if(4==n.ltype)for(var c=l.vals[s],u=0;u<c.length;u++){var h=c[u],d=h.chain.length;if(!(d>a)){for(var p=!0,f=0,m=0;m<d;m++){for(;-1==t[i+f+(1+m)];)f++;h.chain[m]!=t[i+f+(1+m)]&&(p=!1)}if(p){for(t[i]=h.nglyph,m=0;m<d+f;m++)t[i+m+1]=-1;break}}}else if(5==n.ltype&&2==l.fmt)for(var g=e._lctf.getInterval(l.cDef,t[i]),y=l.cDef[g+2],b=l.scset[y],A=0;A<b.length;A++){var v=b[A],w=v.input;if(!(w.length>a)){for(p=!0,m=0;m<w.length;m++){var E=e._lctf.getInterval(l.cDef,t[i+1+m]);if(-1==g&&l.cDef[E+2]!=w[m]){p=!1;break}}if(p){var _=v.substLookupRecords;for(u=0;u<_.length;u+=2)_[u],_[u+1]}}}else if(6==n.ltype&&3==l.fmt){if(!e.U._glsCovered(t,l.backCvg,i-l.backCvg.length))continue;if(!e.U._glsCovered(t,l.inptCvg,i))continue;if(!e.U._glsCovered(t,l.ahedCvg,i+l.inptCvg.length))continue;var x=l.lookupRec;for(A=0;A<x.length;A+=2){g=x[A];var T=r[x[A+1]];e.U._applySubs(t,i+g,T,r)}}}},e.U._glsCovered=function(t,i,n){for(var r=0;r<i.length;r++)if(-1==e._lctf.coverageIndex(i[r],t[n+r]))return!1;return!0},e.U.glyphsToPath=function(t,i,n){for(var r={cmds:[],crds:[]},a=0,o=0;o<i.length;o++){var s=i[o];if(-1!=s){for(var l=o<i.length-1&&-1!=i[o+1]?i[o+1]:0,c=e.U.glyphToPath(t,s),u=0;u<c.crds.length;u+=2)r.crds.push(c.crds[u]+a),r.crds.push(c.crds[u+1]);for(n&&r.cmds.push(n),u=0;u<c.cmds.length;u++)r.cmds.push(c.cmds[u]);n&&r.cmds.push("X"),a+=t.hmtx.aWidth[s],o<i.length-1&&(a+=e.U.getPairAdjustment(t,s,l))}}return r},e.U.P={},e.U.P.moveTo=function(t,e,i){t.cmds.push("M"),t.crds.push(e,i)},e.U.P.lineTo=function(t,e,i){t.cmds.push("L"),t.crds.push(e,i)},e.U.P.curveTo=function(t,e,i,n,r,a,o){t.cmds.push("C"),t.crds.push(e,i,n,r,a,o)},e.U.P.qcurveTo=function(t,e,i,n,r){t.cmds.push("Q"),t.crds.push(e,i,n,r)},e.U.P.closePath=function(t){t.cmds.push("Z")},e.U._drawCFF=function(t,i,n,r,a){for(var o=i.stack,s=i.nStems,l=i.haveWidth,c=i.width,u=i.open,h=0,d=i.x,p=i.y,f=0,m=0,g=0,y=0,b=0,A=0,v=0,w=0,E=0,_=0,x={val:0,size:0};h<t.length;){e.CFF.getCharString(t,h,x);var T=x.val;if(h+=x.size,"o1"==T||"o18"==T)o.length%2!=0&&!l&&(c=o.shift()+r.nominalWidthX),s+=o.length>>1,o.length=0,l=!0;else if("o3"==T||"o23"==T)o.length%2!=0&&!l&&(c=o.shift()+r.nominalWidthX),s+=o.length>>1,o.length=0,l=!0;else if("o4"==T)o.length>1&&!l&&(c=o.shift()+r.nominalWidthX,l=!0),u&&e.U.P.closePath(a),p+=o.pop(),e.U.P.moveTo(a,d,p),u=!0;else if("o5"==T)for(;o.length>0;)d+=o.shift(),p+=o.shift(),e.U.P.lineTo(a,d,p);else if("o6"==T||"o7"==T)for(var M=o.length,C="o6"==T,k=0;k<M;k++){var R=o.shift();C?d+=R:p+=R,C=!C,e.U.P.lineTo(a,d,p)}else if("o8"==T||"o24"==T){M=o.length;for(var S=0;S+6<=M;)f=d+o.shift(),m=p+o.shift(),g=f+o.shift(),y=m+o.shift(),d=g+o.shift(),p=y+o.shift(),e.U.P.curveTo(a,f,m,g,y,d,p),S+=6;"o24"==T&&(d+=o.shift(),p+=o.shift(),e.U.P.lineTo(a,d,p))}else{if("o11"==T)break;if("o1234"==T||"o1235"==T||"o1236"==T||"o1237"==T)"o1234"==T&&(m=p,g=(f=d+o.shift())+o.shift(),_=y=m+o.shift(),A=y,w=p,d=(v=(b=(E=g+o.shift())+o.shift())+o.shift())+o.shift(),e.U.P.curveTo(a,f,m,g,y,E,_),e.U.P.curveTo(a,b,A,v,w,d,p)),"o1235"==T&&(f=d+o.shift(),m=p+o.shift(),g=f+o.shift(),y=m+o.shift(),E=g+o.shift(),_=y+o.shift(),b=E+o.shift(),A=_+o.shift(),v=b+o.shift(),w=A+o.shift(),d=v+o.shift(),p=w+o.shift(),o.shift(),e.U.P.curveTo(a,f,m,g,y,E,_),e.U.P.curveTo(a,b,A,v,w,d,p)),"o1236"==T&&(f=d+o.shift(),m=p+o.shift(),g=f+o.shift(),_=y=m+o.shift(),A=y,v=(b=(E=g+o.shift())+o.shift())+o.shift(),w=A+o.shift(),d=v+o.shift(),e.U.P.curveTo(a,f,m,g,y,E,_),e.U.P.curveTo(a,b,A,v,w,d,p)),"o1237"==T&&(f=d+o.shift(),m=p+o.shift(),g=f+o.shift(),y=m+o.shift(),E=g+o.shift(),_=y+o.shift(),b=E+o.shift(),A=_+o.shift(),v=b+o.shift(),w=A+o.shift(),Math.abs(v-d)>Math.abs(w-p)?d=v+o.shift():p=w+o.shift(),e.U.P.curveTo(a,f,m,g,y,E,_),e.U.P.curveTo(a,b,A,v,w,d,p));else if("o14"==T){if(o.length>0&&!l&&(c=o.shift()+n.nominalWidthX,l=!0),4==o.length){var D=o.shift(),O=o.shift(),P=o.shift(),F=o.shift(),U=e.CFF.glyphBySE(n,P),B=e.CFF.glyphBySE(n,F);e.U._drawCFF(n.CharStrings[U],i,n,r,a),i.x=D,i.y=O,e.U._drawCFF(n.CharStrings[B],i,n,r,a)}u&&(e.U.P.closePath(a),u=!1)}else if("o19"==T||"o20"==T)o.length%2!=0&&!l&&(c=o.shift()+r.nominalWidthX),s+=o.length>>1,o.length=0,l=!0,h+=s+7>>3;else if("o21"==T)o.length>2&&!l&&(c=o.shift()+r.nominalWidthX,l=!0),p+=o.pop(),d+=o.pop(),u&&e.U.P.closePath(a),e.U.P.moveTo(a,d,p),u=!0;else if("o22"==T)o.length>1&&!l&&(c=o.shift()+r.nominalWidthX,l=!0),d+=o.pop(),u&&e.U.P.closePath(a),e.U.P.moveTo(a,d,p),u=!0;else if("o25"==T){for(;o.length>6;)d+=o.shift(),p+=o.shift(),e.U.P.lineTo(a,d,p);f=d+o.shift(),m=p+o.shift(),g=f+o.shift(),y=m+o.shift(),d=g+o.shift(),p=y+o.shift(),e.U.P.curveTo(a,f,m,g,y,d,p)}else if("o26"==T)for(o.length%2&&(d+=o.shift());o.length>0;)f=d,m=p+o.shift(),d=g=f+o.shift(),p=(y=m+o.shift())+o.shift(),e.U.P.curveTo(a,f,m,g,y,d,p);else if("o27"==T)for(o.length%2&&(p+=o.shift());o.length>0;)m=p,g=(f=d+o.shift())+o.shift(),y=m+o.shift(),d=g+o.shift(),p=y,e.U.P.curveTo(a,f,m,g,y,d,p);else if("o10"==T||"o29"==T){var I="o10"==T?r:n;if(0==o.length)console.debug("error: empty stack");else{var j=o.pop(),L=I.Subrs[j+I.Bias];i.x=d,i.y=p,i.nStems=s,i.haveWidth=l,i.width=c,i.open=u,e.U._drawCFF(L,i,n,r,a),d=i.x,p=i.y,s=i.nStems,l=i.haveWidth,c=i.width,u=i.open}}else if("o30"==T||"o31"==T){var N=o.length,H=(S=0,"o31"==T);for(S+=N-(M=-3&N);S<M;)H?(m=p,g=(f=d+o.shift())+o.shift(),p=(y=m+o.shift())+o.shift(),M-S==5?(d=g+o.shift(),S++):d=g,H=!1):(f=d,m=p+o.shift(),g=f+o.shift(),y=m+o.shift(),d=g+o.shift(),M-S==5?(p=y+o.shift(),S++):p=y,H=!0),e.U.P.curveTo(a,f,m,g,y,d,p),S+=4}else{if("o"==(T+"").charAt(0))throw console.debug("Unknown operation: "+T,t),T;o.push(T)}}}i.x=d,i.y=p,i.nStems=s,i.haveWidth=l,i.width=c,i.open=u};var i=e,n={Typr:i};return t.Typr=i,t.default=n,Object.defineProperty(t,"__esModule",{value:!0}),t}({}).Typr},function(){return function(t){var e=Uint8Array,i=Uint16Array,n=Uint32Array,r=new e([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),a=new e([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),o=new e([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),s=function(t,e){for(var r=new i(31),a=0;a<31;++a)r[a]=e+=1<<t[a-1];var o=new n(r[30]);for(a=1;a<30;++a)for(var s=r[a];s<r[a+1];++s)o[s]=s-r[a]<<5|a;return[r,o]},l=s(r,2),c=l[0],u=l[1];c[28]=258,u[258]=28;for(var h=s(a,0)[0],d=new i(32768),p=0;p<32768;++p){var f=(43690&p)>>>1|(21845&p)<<1;f=(61680&(f=(52428&f)>>>2|(13107&f)<<2))>>>4|(3855&f)<<4,d[p]=((65280&f)>>>8|(255&f)<<8)>>>1}var m=function(t,e,n){for(var r=t.length,a=0,o=new i(e);a<r;++a)++o[t[a]-1];var s,l=new i(e);for(a=0;a<e;++a)l[a]=l[a-1]+o[a-1]<<1;if(n){s=new i(1<<e);var c=15-e;for(a=0;a<r;++a)if(t[a])for(var u=a<<4|t[a],h=e-t[a],p=l[t[a]-1]++<<h,f=p|(1<<h)-1;p<=f;++p)s[d[p]>>>c]=u}else for(s=new i(r),a=0;a<r;++a)s[a]=d[l[t[a]-1]++]>>>15-t[a];return s},g=new e(288);for(p=0;p<144;++p)g[p]=8;for(p=144;p<256;++p)g[p]=9;for(p=256;p<280;++p)g[p]=7;for(p=280;p<288;++p)g[p]=8;var y=new e(32);for(p=0;p<32;++p)y[p]=5;var b=m(g,9,1),A=m(y,5,1),v=function(t){for(var e=t[0],i=1;i<t.length;++i)t[i]>e&&(e=t[i]);return e},w=function(t,e,i){var n=e/8>>0;return(t[n]|t[n+1]<<8)>>>(7&e)&i},E=function(t,e){var i=e/8>>0;return(t[i]|t[i+1]<<8|t[i+2]<<16)>>>(7&e)},_=function(t,s,l){var u=t.length,d=!s||l,p=!l||l.i;l||(l={}),s||(s=new e(3*u));var f,g=function(t){var i=s.length;if(t>i){var n=new e(Math.max(2*i,t));n.set(s),s=n}},y=l.f||0,_=l.p||0,x=l.b||0,T=l.l,M=l.d,C=l.m,k=l.n,R=8*u;do{if(!T){l.f=y=w(t,_,1);var S=w(t,_+1,3);if(_+=3,!S){var D=t[(z=((f=_)/8>>0)+(7&f&&1)+4)-4]|t[z-3]<<8,O=z+D;if(O>u){if(p)throw"unexpected EOF";break}d&&g(x+D),s.set(t.subarray(z,O),x),l.b=x+=D,l.p=_=8*O;continue}if(1==S)T=b,M=A,C=9,k=5;else{if(2!=S)throw"invalid block type";var P=w(t,_,31)+257,F=w(t,_+10,15)+4,U=P+w(t,_+5,31)+1;_+=14;for(var B=new e(U),I=new e(19),j=0;j<F;++j)I[o[j]]=w(t,_+3*j,7);_+=3*F;var L=v(I),N=(1<<L)-1;if(!p&&_+U*(L+7)>R)break;var H=m(I,L,1);for(j=0;j<U;){var z,V=H[w(t,_,N)];if(_+=15&V,(z=V>>>4)<16)B[j++]=z;else{var G=0,W=0;for(16==z?(W=3+w(t,_,3),_+=2,G=B[j-1]):17==z?(W=3+w(t,_,7),_+=3):18==z&&(W=11+w(t,_,127),_+=7);W--;)B[j++]=G}}var X=B.subarray(0,P),Y=B.subarray(P);C=v(X),k=v(Y),T=m(X,C,1),M=m(Y,k,1)}if(_>R)throw"unexpected EOF"}d&&g(x+131072);for(var Q=(1<<C)-1,q=(1<<k)-1,Z=C+k+18;p||_+Z<R;){var K=(G=T[E(t,_)&Q])>>>4;if((_+=15&G)>R)throw"unexpected EOF";if(!G)throw"invalid length/literal";if(K<256)s[x++]=K;else{if(256==K){T=null;break}var J=K-254;if(K>264){var $=r[j=K-257];J=w(t,_,(1<<$)-1)+c[j],_+=$}var tt=M[E(t,_)&q],et=tt>>>4;if(!tt)throw"invalid distance";if(_+=15&tt,Y=h[et],et>3&&($=a[et],Y+=E(t,_)&(1<<$)-1,_+=$),_>R)throw"unexpected EOF";d&&g(x+131072);for(var it=x+J;x<it;x+=4)s[x]=s[x-Y],s[x+1]=s[x+1-Y],s[x+2]=s[x+2-Y],s[x+3]=s[x+3-Y];x=it}}l.l=T,l.p=_,l.b=x,T&&(y=1,l.m=C,l.d=M,l.n=k)}while(!y);return x==s.length?s:function(t,r,a){(null==r||r<0)&&(r=0),(null==a||a>t.length)&&(a=t.length);var o=new(t instanceof i?i:t instanceof n?n:e)(a-r);return o.set(t.subarray(r,a)),o}(s,0,x)};return t.convert_streams=function(t){var e=new DataView(t),i=0;function n(){var t=e.getUint16(i);return i+=2,t}function r(){var t=e.getUint32(i);return i+=4,t}function a(t){y.setUint16(b,t),b+=2}function o(t){y.setUint32(b,t),b+=4}for(var s={signature:r(),flavor:r(),length:r(),numTables:n(),reserved:n(),totalSfntSize:r(),majorVersion:n(),minorVersion:n(),metaOffset:r(),metaLength:r(),metaOrigLength:r(),privOffset:r(),privLength:r()},l=0;Math.pow(2,l)<=s.numTables;)l++;l--;for(var c=16*Math.pow(2,l),u=16*s.numTables-c,h=12,d=[],p=0;p<s.numTables;p++)d.push({tag:r(),offset:r(),compLength:r(),origLength:r(),origChecksum:r()}),h+=16;var f,m=new Uint8Array(12+16*d.length+d.reduce((function(t,e){return t+e.origLength+4}),0)),g=m.buffer,y=new DataView(g),b=0;return o(s.flavor),a(s.numTables),a(c),a(l),a(u),d.forEach((function(t){o(t.tag),o(t.origChecksum),o(h),o(t.origLength),t.outOffset=h,(h+=t.origLength)%4!=0&&(h+=4-h%4)})),d.forEach((function(e){var i,n=t.slice(e.offset,e.offset+e.compLength);if(e.compLength!=e.origLength){var r=new Uint8Array(e.origLength);i=new Uint8Array(n,2),_(i,r)}else r=new Uint8Array(n);m.set(r,e.outOffset);var a=0;(h=e.outOffset+e.origLength)%4!=0&&(a=4-h%4),m.set(new Uint8Array(a).buffer,e.outOffset+e.origLength),f=h+a})),g.slice(0,f)},t}({}).convert_streams},function(t,e){const i={M:2,L:2,Q:4,C:6,Z:0},n={C:"18g,ca,368,1kz",D:"17k,6,2,2+4,5+c,2+6,2+1,10+1,9+f,j+11,2+1,a,2,2+1,15+2,3,j+2,6+3,2+8,2,2,2+1,w+a,4+e,3+3,2,3+2,3+5,23+w,2f+4,3,2+9,2,b,2+3,3,1k+9,6+1,3+1,2+2,2+d,30g,p+y,1,1+1g,f+x,2,sd2+1d,jf3+4,f+3,2+4,2+2,b+3,42,2,4+2,2+1,2,3,t+1,9f+w,2,el+2,2+g,d+2,2l,2+1,5,3+1,2+1,2,3,6,16wm+1v",R:"17m+3,2,2,6+3,m,15+2,2+2,h+h,13,3+8,2,2,3+1,2,p+1,x,5+4,5,a,2,2,3,u,c+2,g+1,5,2+1,4+1,5j,6+1,2,b,2+2,f,2+1,1s+2,2,3+1,7,1ez0,2,2+1,4+4,b,4,3,b,42,2+2,4,3,2+1,2,o+3,ae,ep,x,2o+2,3+1,3,5+1,6",L:"x9u,jff,a,fd,jv",T:"4t,gj+33,7o+4,1+1,7c+18,2,2+1,2+1,2,21+a,2,1b+k,h,2u+6,3+5,3+1,2+3,y,2,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,3,7,6+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+d,1,1+1,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,ek,3+1,r+4,1e+4,6+5,2p+c,1+3,1,1+2,1+b,2db+2,3y,2p+v,ff+3,30+1,n9x,1+2,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,5s,6y+2,ea,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+9,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2,2b+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,470+8,at4+4,1o+6,t5,1s+3,2a,f5l+1,2+3,43o+2,a+7,1+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,1,gzau,v+2n,3l+6n"};let r;function a(t){if(!r){const t={R:2,L:1,D:4,C:16,U:32,T:8};r=new Map;for(let e in n){let i=0;n[e].split(",").forEach((n=>{let[a,o]=n.split("+");a=parseInt(a,36),o=o?parseInt(o,36):0,r.set(i+=a,t[e]);for(let n=o;n--;)r.set(++i,t[e])}))}}return r.get(t)||32}const o=[null,"isol","init","fina","medi"];function s(t){const e=new Uint8Array(t.length);let i=32,n=1,r=-1;for(let o=0;o<t.length;o++){const s=t.codePointAt(o);let l=0|a(s),c=1;8&l||(21&i?22&l?(c=3,1!==n&&3!==n||e[r]++):33&l&&(2!==n&&4!==n||e[r]--):34&i&&(2!==n&&4!==n||e[r]--),n=e[o]=c,i=l,r=o,s>65535&&o++)}return e}function l(e){const n=Object.create(null),r={unitsPerEm:e.head.unitsPerEm,ascender:e.hhea.ascender,descender:e.hhea.descender,forEachGlyph(a,l,c,u){let h=0;const d=1/r.unitsPerEm*l,p=function(e,i){const n=[];for(let r=0;r<i.length;r++){const a=i.codePointAt(r);a>65535&&r++,n.push(t.U.codeToGlyph(e,a))}const r=e.GSUB;if(r){const{lookupList:e,featureList:a}=r;let l;const c=/^(rlig|liga|mset|isol|init|fina|medi|half|pres|blws)$/,u=[];a.forEach((r=>{if(c.test(r.tag))for(let a=0;a<r.tab.length;a++){if(u[r.tab[a]])continue;u[r.tab[a]]=!0;const c=e[r.tab[a]],h=/^(isol|init|fina|medi)$/.test(r.tag);h&&!l&&(l=s(i));for(let i=0;i<n.length;i++)l&&h&&o[l[i]]!==r.tag||t.U._applySubs(n,i,c,e)}}))}return n}(e,a);let f=0,m=-1;return p.forEach(((r,o)=>{if(-1!==r){let a=n[r];if(!a){const{cmds:o,crds:s}=t.U.glyphToPath(e,r);let l,c,u,h;if(s.length){l=c=1/0,u=h=-1/0;for(let t=0,e=s.length;t<e;t+=2){let e=s[t],i=s[t+1];e<l&&(l=e),i<c&&(c=i),e>u&&(u=e),i>h&&(h=i)}}else l=u=c=h=0;a=n[r]={index:r,advanceWidth:e.hmtx.aWidth[r],xMin:l,yMin:c,xMax:u,yMax:h,pathCommandCount:o.length,forEachPathCommand(t){let e=0;const n=[];for(let r=0,a=o.length;r<a;r++){const a=i[o[r]];n.length=1+a,n[0]=o[r];for(let t=1;t<=a;t++)n[t]=s[e++];t.apply(null,n)}}}}-1!==m&&(h+=t.U.getPairAdjustment(e,m,r)*d),u.call(null,a,h,f),a.advanceWidth&&(h+=a.advanceWidth*d),c&&(h+=c*l),m=r}f+=a.codePointAt(f)>65535?2:1})),h}};return r}return function(i){const n=new Uint8Array(i,0,4),r=t._bin.readASCII(n,0,4);if("wOFF"===r)i=e(i);else if("wOF2"===r)throw new Error("woff2 fonts not supported");return l(t.parse(i)[0])}}],init:(t,e,i)=>i(t(),e())}),F={defaultFontURL:"https://fonts.gstatic.com/s/roboto/v18/KFOmCnqEu92Fr1Mu4mxM.woff",sdfGlyphSize:64,sdfMargin:1/16,sdfExponent:9,textureWidth:2048},U=new t.Color,B=Object.create(null);function I(e,i){if((e=function(t,e){for(let i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}({},e)).font=function(t){j||(j="undefined"==typeof document?{}:document.createElement("a"));return j.href=t,j.href}(e.font||F.defaultFontURL),e.text=""+e.text,e.sdfGlyphSize=e.sdfGlyphSize||F.sdfGlyphSize,null!=e.colorRanges){let t={};for(let i in e.colorRanges)if(e.colorRanges.hasOwnProperty(i)){let n=e.colorRanges[i];"number"!=typeof n&&(n=U.set(n).getHex()),t[i]=n}e.colorRanges=t}Object.freeze(e);const{textureWidth:n,sdfExponent:r}=F,{sdfGlyphSize:a}=e;let o=`${e.font}@${a}`,s=B[o];s||(s=B[o]={sdfTexture:new t.DataTexture(new Uint8Array(a*n*4),n,a,t.RGBAFormat,void 0,void 0,void 0,void 0,t.LinearFilter,t.LinearFilter)},s.sdfTexture.font=e.font),L(e).then((t=>{t.newGlyphSDFs&&(t.newGlyphSDFs.forEach((({textureData:t,atlasIndex:e})=>{const i=s.sdfTexture.image;for(;i.data.length<(e+1)*a*a;){const t=new Uint8Array(2*i.data.length);t.set(i.data),i.data=t,i.height*=2}const n=Math.floor(e/4),r=i.width/a,o=Math.floor(n/r)*i.width*a*4+n%r*a*4+e%4;for(let e=0;e<a;e++){const n=e*a,r=o+e*i.width*4;for(let e=0;e<a;e++)i.data[r+4*e]=t[n+e]}})),s.sdfTexture.needsUpdate=!0),i(Object.freeze({parameters:e,sdfTexture:s.sdfTexture,sdfGlyphSize:a,sdfExponent:r,glyphBounds:t.glyphBounds,glyphAtlasIndices:t.glyphAtlasIndices,glyphColors:t.glyphColors,caretPositions:t.caretPositions,caretHeight:t.caretHeight,chunkedBounds:t.chunkedBounds,ascender:t.ascender,descender:t.descender,lineHeight:t.lineHeight,topBaseline:t.topBaseline,blockBounds:t.blockBounds,visibleBounds:t.visibleBounds,timings:t.timings,get totalBounds(){return console.log("totalBounds deprecated, use blockBounds instead"),t.blockBounds},get totalBlockSize(){console.log("totalBlockSize deprecated, use blockBounds instead");const[e,i,n,r]=t.blockBounds;return[n-e,r-i]}}))}))}let j;const L=g({name:"TextBuilder",dependencies:[g({name:"FontProcessor",dependencies:[F,P,function(){let t=!1;const e=[];function i(){t&&(e.sort((function(t,e){return t.maxX-e.maxX})),t=!1)}function n(t,e,i,n,r,a){const o=r-i,s=a-n,l=o*o+s*s,c=l?Math.max(0,Math.min(1,((t-i)*o+(e-n)*s)/l)):0,u=t-(i+c*o),h=e-(n+c*s);return u*u+h*h}return{addLineSegment:function(i,n,r,a){const o={x0:i,y0:n,x1:r,y1:a,minX:Math.min(i,r),minY:Math.min(n,a),maxX:Math.max(i,r),maxY:Math.max(n,a)};e.push(o),t=!0},findNearestSignedDistance:function(t,r){i();let a=1/0,o=1/0;for(let i=e.length;i--;){const s=e[i];if(s.maxX+o<=t)break;if(t+o>s.minX&&r-o<s.maxY&&r+o>s.minY){const e=n(t,r,s.x0,s.y0,s.x1,s.y1);e<a&&(a=e,o=Math.sqrt(a))}}return function(t,n){i();let r=!1;for(let i=e.length;i--;){const a=e[i];if(a.maxX<=t)break;if(a.minY<n&&a.maxY>n){a.y0>n!=a.y1>n&&t<(a.x1-a.x0)*(n-a.y0)/(a.y1-a.y0)+a.x0&&(r=!r)}}return r}(t,r)&&(o=-o),o}}},function(t,e){const{sdfExponent:i,sdfMargin:n}=e;function r(t,e,i,n,r,a,o){const s=1-o;return{x:s*s*t+2*s*o*i+o*o*r,y:s*s*e+2*s*o*n+o*o*a}}function a(t,e,i,n,r,a,o,s,l){const c=1-l;return{x:c*c*c*t+3*c*c*l*i+3*c*l*l*r+l*l*l*o,y:c*c*c*e+3*c*c*l*n+3*c*l*l*a+l*l*l*s}}return function(e,o){const s=new Uint8Array(o*o),l=e.xMax-e.xMin,c=e.yMax-e.yMin,u=Math.max(l,c),h=Math.max(l,c)/o*(n*o+.5),d=e.xMin-h,p=e.yMin-h,f=e.xMax+h,m=e.yMax+h,g=f-d,y=m-p,b=Math.max(g,y);if(e.pathCommandCount){const n=t(e);let l,c,h,f;e.forEachPathCommand(((t,e,i,o,s,u,d)=>{switch(t){case"M":h=l=e,f=c=i;break;case"L":e===h&&i===f||n.addLineSegment(h,f,h=e,f=i);break;case"Q":{let t={x:h,y:f};for(let a=1;a<16;a++){let l=r(h,f,e,i,o,s,a/15);n.addLineSegment(t.x,t.y,l.x,l.y),t=l}h=o,f=s;break}case"C":{let t={x:h,y:f};for(let r=1;r<16;r++){let l=a(h,f,e,i,o,s,u,d,r/15);n.addLineSegment(t.x,t.y,l.x,l.y),t=l}h=u,f=d;break}case"Z":h===l&&f===c||n.addLineSegment(h,f,l,c)}}));for(let t=0;t<o;t++)for(let e=0;e<o;e++){const r=n.findNearestSignedDistance(d+g*(t+.5)/o,p+y*(e+.5)/o,u);let a=Math.pow(1-Math.abs(r)/b,i)/2;r<0&&(a=1-a),a=Math.max(0,Math.min(255,Math.round(255*a))),s[e*o+t]=a}}return{textureData:s,renderingBounds:[d,p,f,m]}}},function(t,e,i,n){const{defaultFontURL:r}=n,a=Object.create(null),o=Object.create(null),s=1/0,l=/[\u00AD\u034F\u061C\u115F-\u1160\u17B4-\u17B5\u180B-\u180E\u200B-\u200F\u202A-\u202E\u2060-\u206F\u3164\uFE00-\uFE0F\uFEFF\uFFA0\uFFF0-\uFFF8]/;function c(e,i){e||(e=r);let n=o[e];n?n.pending?n.pending.push(i):i(n):(o[e]={pending:[i]},function(e,i){!function n(){const a=t=>{console.error(`Failure loading font ${e}${e===r?"":"; trying fallback"}`,t),e!==r&&(e=r,n())};try{const n=new XMLHttpRequest;n.open("get",e,!0),n.responseType="arraybuffer",n.onload=function(){if(n.status>=400)a(new Error(n.statusText));else if(n.status>0)try{const e=t(n.response);i(e)}catch(t){a(t)}},n.onerror=a,n.send()}catch(t){a(t)}}()}(e,(t=>{let i=o[e].pending;o[e]=t,i.forEach((e=>e(t)))})))}function u({text:t="",font:n=r,sdfGlyphSize:o=64,fontSize:u=1,letterSpacing:f=0,lineHeight:m="normal",maxWidth:g=s,direction:y,textAlign:b="left",textIndent:A=0,whiteSpace:v="normal",overflowWrap:w="normal",anchorX:E=0,anchorY:_=0,includeCaretPositions:x=!1,chunkedBoundsSize:T=8192,colorRanges:M=null},C,k=!1){const R=d(),S={total:0,fontLoad:0,layout:0,sdf:{},sdfTotal:0};t.indexOf("\r")>-1&&(console.warn("FontProcessor.process: got text with \\r chars; normalizing to \\n"),t=t.replace(/\r\n/g,"\n").replace(/\r/g,"\n")),u=+u,f=+f,g=+g,m=m||"normal",A=+A,function(t,e,i){t||(t=r);let n=`${t}@${e}`,o=a[n];o?i(o):c(t,(t=>{o=a[n]||(a[n]={fontObj:t,glyphs:{},glyphCount:0}),i(o)}))}(n,o,(n=>{const r=n.fontObj,a=isFinite(g);let c=null,D=null,O=null,P=null,F=null,U=null,B=null,I=0,j=0,L="nowrap"!==v;const{ascender:N,descender:H,unitsPerEm:z}=r;S.fontLoad=d()-R;const V=d(),G=u/z;"normal"===m&&(m=(N-H)/z);const W=((m*=u)-(N-H)*G)/2,X=-(N*G+W),Y=Math.min(m,(N-H)*G),Q=(N+H)/2*G-Y/2;let q=A,Z=new p;const K=[Z];r.forEachGlyph(t,u,f,((e,i,n)=>{const r=t.charAt(n),o=e.advanceWidth*G,s=Z.count;let c;if("isEmpty"in e||(e.isWhitespace=!!r&&/\s/.test(r),e.isEmpty=e.xMin===e.xMax||e.yMin===e.yMax||l.test(r)),e.isWhitespace||e.isEmpty||j++,L&&a&&!e.isWhitespace&&i+o+q>g&&s){if(Z.glyphAt(s-1).glyphObj.isWhitespace)c=new p,q=-i;else for(let t=s;t--;){if(0===t&&"break-word"===w){c=new p,q=-i;break}if(Z.glyphAt(t).glyphObj.isWhitespace){c=Z.splitAt(t+1);const e=c.glyphAt(0).x;q-=e;for(let t=c.count;t--;)c.glyphAt(t).x-=e;break}}c&&(Z.isSoftWrapped=!0,Z=c,K.push(Z),I=g)}let h=Z.glyphAt(Z.count);h.glyphObj=e,h.x=i+q,h.width=o,h.charIndex=n,"\n"===r&&(Z=new p,K.push(Z),q=-(i+o+f*u)+A)})),K.forEach((t=>{for(let e=t.count;e--;){let{glyphObj:i,x:n,width:r}=t.glyphAt(e);if(!i.isWhitespace)return t.width=n+r,void(t.width>I&&(I=t.width))}}));let J=0,$=0;if(E&&("number"==typeof E?J=-E:"string"==typeof E&&(J=-I*("left"===E?0:"center"===E?.5:"right"===E?1:h(E)))),_)if("number"==typeof _)$=-_;else if("string"==typeof _){let t=K.length*m;$="top"===_?0:"top-baseline"===_?-X:"middle"===_?t/2:"bottom"===_?t:"bottom-baseline"===_?t-W+H*G:h(_)*t}if(!k){const a=i.getEmbeddingLevels(t,y);D=new Float32Array(4*j),O=new Float32Array(j),U=[s,s,-1/0,-1/0],B=[];let l=X;x&&(F=new Float32Array(3*t.length)),M&&(P=new Uint8Array(3*j));let u,h,p=0,f=-1,g=-1;K.forEach(((y,A)=>{let{count:v,width:w}=y;if(v>0){let m=0;for(let t=v;t--&&y.glyphAt(t).glyphObj.isWhitespace;)m++;let A=0,E=0;if("center"===b)A=(I-w)/2;else if("right"===b)A=I-w;else if("justify"===b&&y.isSoftWrapped){let t=0;for(let e=v-m;e--;)y.glyphAt(e).glyphObj.isWhitespace&&t++;E=(I-w)/t}if(E||A){let t=0;for(let e=0;e<v;e++){let i=y.glyphAt(e);const n=i.glyphObj;i.x+=A+t,0!==E&&n.isWhitespace&&e<v-m&&(t+=E,i.width+=E)}}const _=i.getReorderSegments(t,a,y.glyphAt(0).charIndex,y.glyphAt(y.count-1).charIndex);for(let t=0;t<_.length;t++){const[e,i]=_[t];let n=1/0,r=-1/0;for(let t=0;t<v;t++)if(y.glyphAt(t).charIndex>=e){let e=t,a=t;for(;a<v;a++){let t=y.glyphAt(a);if(t.charIndex>i)break;a<v-m&&(n=Math.min(n,t.x),r=Math.max(r,t.x+t.width))}for(let t=e;t<a;t++){const e=y.glyphAt(t);e.x=r-(e.x+e.width-n)}break}}let C;const k=t=>C=t;for(let m=0;m<v;m++){let b=y.glyphAt(m);C=b.glyphObj;const A=1&a.levels[b.charIndex];if(A){const e=i.getMirroredCharacter(t[b.charIndex]);e&&r.forEachGlyph(e,0,0,k)}if(x){const{charIndex:t}=b,e=b.x+J,i=b.x+b.width+J;for(F[3*t]=A?i:e,F[3*t+1]=A?e:i,F[3*t+2]=l+Q+$;t-f>1;)F[3*(f+1)]=F[3*f],F[3*(f+1)+1]=F[3*f+1],F[3*(f+1)+2]=F[3*f+2],f++;f=t}if(M){const{charIndex:t}=b;for(;t>g;)g++,M.hasOwnProperty(g)&&(h=M[g])}if(!C.isWhitespace&&!C.isEmpty){const i=p++;let r=n.glyphs[C.index];if(!r){const i=d(),a=e(C,o);S.sdf[t.charAt(b.charIndex)]=d()-i,a.atlasIndex=n.glyphCount++,c||(c=[]),c.push(a),r=n.glyphs[C.index]={atlasIndex:a.atlasIndex,glyphObj:C,renderingBounds:a.renderingBounds}}const a=r.renderingBounds,f=4*i,m=b.x+J,g=l+$;D[f]=m+a[0]*G,D[f+1]=g+a[1]*G,D[f+2]=m+a[2]*G,D[f+3]=g+a[3]*G;const y=m+C.xMin*G,A=g+C.yMin*G,v=m+C.xMax*G,w=g+C.yMax*G;y<U[0]&&(U[0]=y),A<U[1]&&(U[1]=A),v>U[2]&&(U[2]=v),w>U[3]&&(U[3]=w),i%T==0&&(u={start:i,end:i,rect:[s,s,-1/0,-1/0]},B.push(u)),u.end++;const E=u.rect;if(y<E[0]&&(E[0]=y),A<E[1]&&(E[1]=A),v>E[2]&&(E[2]=v),w>E[3]&&(E[3]=w),O[i]=r.atlasIndex,M){const t=3*i;P[t]=h>>16&255,P[t+1]=h>>8&255,P[t+2]=255&h}}}}l-=m}))}for(let t in S.sdf)S.sdfTotal+=S.sdf[t];S.layout=d()-V-S.sdfTotal,S.total=d()-R,C({glyphBounds:D,glyphAtlasIndices:O,caretPositions:F,caretHeight:Y,glyphColors:P,chunkedBounds:B,ascender:N*G,descender:H*G,lineHeight:m,topBaseline:X,blockBounds:[J,$-K.length*m,J+I,$],visibleBounds:U,newGlyphSDFs:c,timings:S})}))}function h(t){let e=t.match(/^([\d.]+)%$/),i=e?parseFloat(e[1]):NaN;return isNaN(i)?0:i/100}function d(){return(self.performance||Date).now()}function p(){this.data=[]}const f=["glyphObj","x","width","charIndex"];return p.prototype={width:0,isSoftWrapped:!1,get count(){return Math.ceil(this.data.length/f.length)},glyphAt(t){let e=p.flyweight;return e.data=this.data,e.index=t,e},splitAt(t){let e=new p;return e.data=this.data.splice(t*f.length),e}},p.flyweight=f.reduce(((t,e,i,n)=>(Object.defineProperty(t,e,{get(){return this.data[this.index*f.length+i]},set(t){this.data[this.index*f.length+i]=t}}),t)),{data:null,index:0}),{process:u,measure:function(t,e){u(t,(t=>{const[i,n,r,a]=t.blockBounds;e({width:r-i,height:a-n})}),{metricsOnly:!0})},loadFont:c}},function(){return function(t){var e={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"};const i={},n={};i.L=1,n[1]="L",Object.keys(e).forEach(((t,e)=>{i[t]=1<<e+1,n[i[t]]=t})),Object.freeze(i);const r=i.LRI|i.RLI|i.FSI,a=i.L|i.R|i.AL,o=i.B|i.S|i.WS|i.ON|i.FSI|i.LRI|i.RLI|i.PDI,s=i.BN|i.RLE|i.LRE|i.RLO|i.LRO|i.PDF,l=i.S|i.WS|i.B|r|i.PDI|s;let c=null;function u(t){return function(){if(!c){c=new Map;for(let t in e)if(e.hasOwnProperty(t)){let n=0;e[t].split(",").forEach((e=>{let[r,a]=e.split("+");r=parseInt(r,36),a=a?parseInt(a,36):0,c.set(n+=r,i[t]);for(let e=0;e<a;e++)c.set(++n,i[t])}))}}}(),c.get(t.codePointAt(0))||i.L}var h="14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",d="6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye";function p(t,e){let i=0;const n=new Map,r=e&&new Map;let a;return t.split(",").forEach((function t(o){if(-1!==o.indexOf("+"))for(let e=+o;e--;)t(a);else{a=o;let[t,s]=o.split(">");t=String.fromCodePoint(i+=parseInt(t,36)),s=String.fromCodePoint(i+=parseInt(s,36)),n.set(t,s),e&&r.set(s,t)}})),{map:n,reverseMap:r}}let f,m,g;function y(){if(!f){let{map:t,reverseMap:e}=p(h,!0);f=t,m=e,g=p(d,!1).map}}function b(t){return y(),f.get(t)||null}function A(t){return y(),m.get(t)||null}function v(t){return y(),g.get(t)||null}const{L:w,R:E,EN:_,ES:x,ET:T,AN:M,CS:C,B:k,S:R,ON:S,BN:D,NSM:O,AL:P,LRO:F,RLO:U,LRE:B,RLE:I,PDF:j,LRI:L,RLI:N,FSI:H,PDI:z}=i;let V;function G(t){return function(){if(!V){const{map:t,reverseMap:e}=p("14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1",!0);e.forEach(((e,i)=>{t.set(i,e)})),V=t}}(),V.get(t)||null}function W(t,e,i,n){let r=t.length;i=Math.max(0,null==i?0:+i),n=Math.min(r-1,null==n?r-1:+n);const a=[];return e.paragraphs.forEach((r=>{const o=Math.max(i,r.start),s=Math.min(n,r.end);if(o<s){const n=e.levels.slice(o,s+1);for(let e=s;e>=o&&u(t[e])&l;e--)n[e]=r.level;let c=r.level,h=1/0;for(let t=0;t<n.length;t++){const e=n[t];e>c&&(c=e),e<h&&(h=1|e)}for(let t=c;t>=h;t--)for(let e=0;e<n.length;e++)if(n[e]>=t){const r=e;for(;e+1<n.length&&n[e+1]>=t;)e++;e>r&&a.push([r+i,e+i])}}})),a}function X(t,e,i,n){const r=W(t,e,i,n),a=[];for(let e=0;e<t.length;e++)a[e]=e;return r.forEach((([t,e])=>{const i=a.slice(t,e+1);for(let t=i.length;t--;)a[e-t]=i[t]})),a}return t.closingToOpeningBracket=A,t.getBidiCharType=u,t.getBidiCharTypeName=function(t){return n[u(t)]},t.getCanonicalBracket=v,t.getEmbeddingLevels=function(t,e){const i=new Uint32Array(t.length);for(let e=0;e<t.length;e++)i[e]=u(t[e]);const n=new Map;function c(t,e){const r=i[t];i[t]=e,n.set(r,n.get(r)-1),r&o&&n.set(o,n.get(o)-1),n.set(e,(n.get(e)||0)+1),e&o&&n.set(o,(n.get(o)||0)+1)}const h=new Uint8Array(t.length),d=new Map,p=[];let f=null;for(let n=0;n<t.length;n++)f||p.push(f={start:n,end:t.length-1,level:"rtl"===e?1:"ltr"===e?0:V(n,!1)}),i[n]&k&&(f.end=n,f=null);const m=I|B|U|F|r|z|j|k,g=t=>t+(1&t?1:2),y=t=>t+(1&t?2:1);for(let e=0;e<p.length;e++){f=p[e];const G=[{_level:f.level,_override:0,_isolate:0}];let X,Y=0,Q=0,q=0;n.clear();for(let t=f.start;t<=f.end;t++){let e=i[t];if(X=G[G.length-1],n.set(e,(n.get(e)||0)+1),e&o&&n.set(o,(n.get(o)||0)+1),e&m)if(e&(I|B)){h[t]=X._level;const i=(e===I?y:g)(X._level);i<=125&&!Y&&!Q?G.push({_level:i,_override:0,_isolate:0}):Y||Q++}else if(e&(U|F)){h[t]=X._level;const i=(e===U?y:g)(X._level);i<=125&&!Y&&!Q?G.push({_level:i,_override:e&U?E:w,_isolate:0}):Y||Q++}else if(e&r){e&H&&(e=1===V(t+1,!0)?N:L),h[t]=X._level,X._override&&c(t,X._override);const i=(e===N?y:g)(X._level);i<=125&&0===Y&&0===Q?(q++,G.push({_level:i,_override:0,_isolate:1,_isolInitIndex:t})):Y++}else if(e&z){if(Y>0)Y--;else if(q>0){for(Q=0;!G[G.length-1]._isolate;)G.pop();const e=G[G.length-1]._isolInitIndex;null!=e&&(d.set(e,t),d.set(t,e)),G.pop(),q--}X=G[G.length-1],h[t]=X._level,X._override&&c(t,X._override)}else e&j?(0===Y&&(Q>0?Q--:!X._isolate&&G.length>1&&(G.pop(),X=G[G.length-1])),h[t]=X._level):e&k&&(h[t]=f.level);else h[t]=X._level,X._override&&e!==D&&c(t,X._override)}const Z=[];let K=null;for(let t=f.start;t<=f.end;t++){const e=i[t];if(!(e&s)){const i=h[t],n=e&r,a=e===z;K&&i===K._level?(K._end=t,K._endsWithIsolInit=n):Z.push(K={_start:t,_end:t,_level:i,_startsWithPDI:a,_endsWithIsolInit:n})}}const J=[];for(let t=0;t<Z.length;t++){const e=Z[t];if(!e._startsWithPDI||e._startsWithPDI&&!d.has(e._start)){const n=[K=e];for(let e;K&&K._endsWithIsolInit&&null!=(e=d.get(K._end));)for(let i=t+1;i<Z.length;i++)if(Z[i]._start===e){n.push(K=Z[i]);break}const a=[];for(let t=0;t<n.length;t++){const e=n[t];for(let t=e._start;t<=e._end;t++)a.push(t)}let o=h[a[0]],l=f.level;for(let t=a[0]-1;t>=0;t--)if(!(i[t]&s)){l=h[t];break}const c=a[a.length-1];let u=h[c],p=f.level;if(!(i[c]&r))for(let t=c+1;t<=f.end;t++)if(!(i[t]&s)){p=h[t];break}J.push({_seqIndices:a,_sosType:Math.max(l,o)%2?E:w,_eosType:Math.max(p,u)%2?E:w})}}for(let e=0;e<J.length;e++){const{_seqIndices:l,_sosType:h,_eosType:d}=J[e];if(n.get(O))for(let t=0;t<l.length;t++){const e=l[t];if(i[e]&O){let n=h;for(let e=t-1;e>=0;e--)if(!(i[l[e]]&s)){n=i[l[e]];break}c(e,n&(r|z)?S:n)}}if(n.get(_))for(let t=0;t<l.length;t++){const e=l[t];if(i[e]&_)for(let n=t-1;n>=-1;n--){const t=-1===n?h:i[l[n]];if(t&a){t===P&&c(e,M);break}}}if(n.get(P))for(let t=0;t<l.length;t++){const e=l[t];i[e]&P&&c(e,E)}if(n.get(x)||n.get(C))for(let t=1;t<l.length-1;t++){const e=l[t];if(i[e]&(x|C)){let n=0,r=0;for(let e=t-1;e>=0&&(n=i[l[e]],n&s);e--);for(let e=t+1;e<l.length&&(r=i[l[e]],r&s);e++);n===r&&(i[e]===x?n===_:n&(_|M))&&c(e,n)}}if(n.get(_))for(let t=0;t<l.length;t++){const e=l[t];if(i[e]&_){for(let e=t-1;e>=0&&i[l[e]]&(T|s);e--)c(l[e],_);for(let e=t+1;e<l.length&&i[l[e]]&(T|s);e++)c(l[e],_)}}if(n.get(T)||n.get(x)||n.get(C))for(let t=0;t<l.length;t++){const e=l[t];if(i[e]&(T|x|C)){c(e,S);for(let e=t-1;e>=0&&i[l[e]]&s;e--)c(l[e],S);for(let e=t+1;e<l.length&&i[l[e]]&s;e++)c(l[e],S)}}if(n.get(_))for(let t=0,e=h;t<l.length;t++){const n=l[t],r=i[n];r&_?e===w&&c(n,w):r&a&&(e=r)}if(n.get(o)){const e=E|_|M,n=e|w,r=[];{const e=[];for(let n=0;n<l.length;n++)if(i[l[n]]&o){const i=t[l[n]];let a;if(null!==b(i)){if(!(e.length<63))break;e.push({char:i,seqIndex:n})}else if(null!==(a=A(i)))for(let t=e.length-1;t>=0;t--){const o=e[t].char;if(o===a||o===A(v(i))||b(v(o))===i){r.push([e[t].seqIndex,n]),e.length=t;break}}}r.sort(((t,e)=>t[0]-e[0]))}for(let a=0;a<r.length;a++){const[o,c]=r[a];let d=!1,p=0;for(let t=o+1;t<c;t++){const r=l[t];if(i[r]&n){d=!0;const t=i[r]&e?E:w;if(t===W(r)){p=t;break}}}if(d&&!p){p=h;for(let t=o-1;t>=0;t--){const r=l[t];if(i[r]&n){const t=i[r]&e?E:w;p=t!==W(r)?t:W(r);break}}}if(p){if(i[l[o]]=i[l[c]]=p,p!==W(l[o]))for(let e=o+1;e<l.length;e++)if(!(i[l[e]]&s)){u(t[l[e]])&O&&(i[l[e]]=p);break}if(p!==W(l[c]))for(let e=c+1;e<l.length;e++)if(!(i[l[e]]&s)){u(t[l[e]])&O&&(i[l[e]]=p);break}}}for(let t=0;t<l.length;t++)if(i[l[t]]&o){let n=t,r=t,a=h;for(let r=t-1;r>=0;r--){if(!(i[l[r]]&s)){a=i[l[r]]&e?E:w;break}n=r}let c=d;for(let n=t+1;n<l.length;n++){if(!(i[l[n]]&(o|s))){c=i[l[n]]&e?E:w;break}r=n}for(let t=n;t<=r;t++)i[l[t]]=a===c?a:W(l[t]);t=r}}}for(let e=f.start;e<=f.end;e++){const n=h[e],r=i[e];if(1&n?r&(w|_|M)&&h[e]++:r&E?h[e]++:r&(M|_)&&(h[e]+=2),r&s&&(h[e]=0===e?f.level:h[e-1]),e===f.end||u(t[e])&(R|k))for(let i=e;i>=0&&u(t[i])&l;i--)h[i]=f.level}}return{levels:h,paragraphs:p};function V(e,n){for(let a=e;a<t.length;a++){const e=i[a];if(e&(E|P))return 1;if(e&(k|w)||n&&e===z)return 0;if(e&r){const e=G(a);a=-1===e?t.length:e}}return 0}function G(e){let n=1;for(let a=e+1;a<t.length;a++){const t=i[a];if(t&k)break;if(t&z){if(0==--n)return a}else t&r&&n++}return-1}function W(t){return 1&h[t]?E:w}},t.getMirroredCharacter=G,t.getMirroredCharactersMap=function(t,e,i,n){let r=t.length;i=Math.max(0,null==i?0:+i),n=Math.min(r-1,null==n?r-1:+n);const a=new Map;for(let r=i;r<=n;r++)if(1&e[r]){const e=G(t[r]);null!==e&&a.set(r,e)}return a},t.getReorderSegments=W,t.getReorderedIndices=X,t.getReorderedString=function(t,e,i,n){const r=X(t,e,i,n),a=[...t];return r.forEach(((i,n)=>{a[n]=(1&e.levels[i]?G(t[i]):null)||t[i]})),a.join("")},t.openingToClosingBracket=b,Object.defineProperty(t,"__esModule",{value:!0}),t}({})}],init(t,e,i,n,r,a){const{sdfExponent:o,sdfMargin:s,defaultFontURL:l}=t;return r(e,n(i,{sdfExponent:o,sdfMargin:s}),a(),{defaultFontURL:l})}}),A],init:(t,e)=>function(i){const n=new e;return t.process(i,n.resolve),n},getTransferables(t){const e=[t.glyphBounds.buffer,t.glyphAtlasIndices.buffer];return t.caretPositions&&e.push(t.caretPositions.buffer),t.newGlyphSDFs&&t.newGlyphSDFs.forEach((t=>{e.push(t.textureData.buffer)})),e}}),N=(()=>{const e={};new t.Vector3;const i="aTroikaGlyphIndex";class n extends t.InstancedBufferGeometry{constructor(){super(),this.detail=1,this.curveRadius=0,this.groups=[{start:0,count:1/0,materialIndex:0},{start:0,count:1/0,materialIndex:1}],this.boundingSphere=new t.Sphere,this.boundingBox=new t.Box3}computeBoundingSphere(){}computeBoundingBox(){}set detail(i){if(i!==this._detail){this._detail=i,("number"!=typeof i||i<1)&&(i=1);let n=function(i){let n=e[i];return n||(n=e[i]=new t.PlaneBufferGeometry(1,1,i,i).translate(.5,.5,0)),n}(i);["position","normal","uv"].forEach((t=>{this.attributes[t]=n.attributes[t].clone()})),this.setIndex(n.getIndex().clone())}}get detail(){return this._detail}set curveRadius(t){t!==this._curveRadius&&(this._curveRadius=t,this._updateBounds())}get curveRadius(){return this._curveRadius}updateGlyphs(t,e,n,o,s){r(this,"aTroikaGlyphBounds",t,4),r(this,i,e,1),r(this,"aTroikaGlyphColor",s,3),this._blockBounds=n,this._chunkedBounds=o,a(this,e.length),this._updateBounds()}_updateBounds(){const t=this._blockBounds;if(t){const{curveRadius:e,boundingBox:i}=this;if(e){const{PI:n,floor:r,min:a,max:o,sin:s,cos:l}=Math,c=n/2,u=2*n,h=Math.abs(e),d=t[0]/h,p=t[2]/h,f=r((d+c)/u)!==r((p+c)/u)?-h:a(s(d)*h,s(p)*h),m=r((d-c)/u)!==r((p-c)/u)?h:o(s(d)*h,s(p)*h),g=r((d+n)/u)!==r((p+n)/u)?2*h:o(h-l(d)*h,h-l(p)*h);i.min.set(f,t[1],e<0?-g:0),i.max.set(m,t[3],e<0?0:g)}else i.min.set(t[0],t[1],0),i.max.set(t[2],t[3],0);i.getBoundingSphere(this.boundingSphere)}}applyClipRect(t){let e=this.getAttribute(i).count,n=this._chunkedBounds;if(n)for(let i=n.length;i--;){e=n[i].end;let r=n[i].rect;if(r[1]<t.w&&r[3]>t.y&&r[0]<t.z&&r[2]>t.x)break}a(this,e)}}function r(e,i,n,r){const a=e.getAttribute(i);n?a&&a.array.length===n.length?(a.array.set(n),a.needsUpdate=!0):(e.setAttribute(i,new t.InstancedBufferAttribute(n,r)),delete e._maxInstanceCount,e.dispose()):a&&e.deleteAttribute(i)}function a(t,e){t[t.hasOwnProperty("instanceCount")?"instanceCount":"maxInstancedCount"]=e}return n.prototype.setAttribute||(n.prototype.setAttribute=function(t,e){return this.attributes[t]=e,this}),n})();const H=(()=>{const e=new t.MeshBasicMaterial({color:16777215,side:t.DoubleSide,transparent:!0}),i=8421504,n=new t.Matrix4,r=new t.Vector3,a=new t.Vector3,o=[],s=new t.Vector3,l="+x+y";function c(t){return Array.isArray(t)?t[0]:t}let u=()=>{const i=new t.Mesh(new t.PlaneBufferGeometry(1,1),e);return u=()=>i,i},h=()=>{const i=new t.Mesh(new t.PlaneBufferGeometry(1,1,32,1),e);return h=()=>i,i};const d={type:"syncstart"},p={type:"synccomplete"},f=["font","fontSize","letterSpacing","lineHeight","maxWidth","overflowWrap","text","direction","textAlign","textIndent","whiteSpace","anchorX","anchorY","colorRanges","sdfGlyphSize"],m=f.concat("material","color","depthOffset","clipRect","curveRadius","orientation","glyphGeometryDetail");class g extends t.Mesh{constructor(){super(new N,null),this.text="",this.anchorX=0,this.anchorY=0,this.curveRadius=0,this.direction="auto",this.font=null,this.fontSize=.1,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.textIndent=0,this.whiteSpace="normal",this.material=null,this.color=null,this.colorRanges=null,this.outlineWidth=0,this.outlineColor=0,this.outlineOpacity=1,this.outlineBlur=0,this.outlineOffsetX=0,this.outlineOffsetY=0,this.strokeWidth=0,this.strokeColor=i,this.strokeOpacity=1,this.fillOpacity=1,this.depthOffset=0,this.clipRect=null,this.orientation=l,this.glyphGeometryDetail=1,this.sdfGlyphSize=null,this.debugSDF=!1}sync(t){this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(t):(this._isSyncing=!0,this.dispatchEvent(d),I({text:this.text,font:this.font,fontSize:this.fontSize||.1,letterSpacing:this.letterSpacing||0,lineHeight:this.lineHeight||"normal",maxWidth:this.maxWidth,direction:this.direction||"auto",textAlign:this.textAlign,textIndent:this.textIndent,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchorX:this.anchorX,anchorY:this.anchorY,colorRanges:this.colorRanges,includeCaretPositions:!0,sdfGlyphSize:this.sdfGlyphSize},(e=>{this._isSyncing=!1,this._textRenderInfo=e,this.geometry.updateGlyphs(e.glyphBounds,e.glyphAtlasIndices,e.blockBounds,e.chunkedBounds,e.glyphColors);const i=this._queuedSyncs;i&&(this._queuedSyncs=null,this._needsSync=!0,this.sync((()=>{i.forEach((t=>t&&t()))}))),this.dispatchEvent(p),t&&t()}))))}onBeforeRender(t,e,i,n,r,a){this.sync(),r.isTroikaTextMaterial&&this._prepareForRender(r)}dispose(){this.geometry.dispose()}get textRenderInfo(){return this._textRenderInfo||null}get material(){let i=this._derivedMaterial;const n=this._baseMaterial||this._defaultMaterial||(this._defaultMaterial=e.clone());if(i&&i.baseMaterial===n||(i=this._derivedMaterial=function(e){const i=k(e,{chained:!0,extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFTextureSize:{value:new t.Vector2},uTroikaSDFGlyphSize:{value:0},uTroikaSDFExponent:{value:0},uTroikaTotalBounds:{value:new t.Vector4(0,0,0,0)},uTroikaClipRect:{value:new t.Vector4(0,0,0,0)},uTroikaDistanceOffset:{value:0},uTroikaOutlineOpacity:{value:0},uTroikaFillOpacity:{value:1},uTroikaPositionOffset:{value:new t.Vector2},uTroikaCurveRadius:{value:0},uTroikaBlurRadius:{value:0},uTroikaStrokeWidth:{value:0},uTroikaStrokeColor:{value:new t.Color},uTroikaStrokeOpacity:{value:1},uTroikaOrient:{value:new t.Matrix3},uTroikaUseGlyphColors:{value:!0},uTroikaSDFDebug:{value:!1}},vertexDefs:"\nuniform vec2 uTroikaSDFTextureSize;\nuniform float uTroikaSDFGlyphSize;\nuniform vec4 uTroikaTotalBounds;\nuniform vec4 uTroikaClipRect;\nuniform mat3 uTroikaOrient;\nuniform bool uTroikaUseGlyphColors;\nuniform float uTroikaDistanceOffset;\nuniform float uTroikaBlurRadius;\nuniform vec2 uTroikaPositionOffset;\nuniform float uTroikaCurveRadius;\nattribute vec4 aTroikaGlyphBounds;\nattribute float aTroikaGlyphIndex;\nattribute vec3 aTroikaGlyphColor;\nvarying vec2 vTroikaGlyphUV;\nvarying vec4 vTroikaTextureUVBounds;\nvarying float vTroikaTextureChannel;\nvarying vec3 vTroikaGlyphColor;\nvarying vec2 vTroikaGlyphDimensions;\n",vertexTransform:"\nvec4 bounds = aTroikaGlyphBounds;\nbounds.xz += uTroikaPositionOffset.x;\nbounds.yw -= uTroikaPositionOffset.y;\n\nvec4 outlineBounds = vec4(\n  bounds.xy - uTroikaDistanceOffset - uTroikaBlurRadius,\n  bounds.zw + uTroikaDistanceOffset + uTroikaBlurRadius\n);\nvec4 clippedBounds = vec4(\n  clamp(outlineBounds.xy, uTroikaClipRect.xy, uTroikaClipRect.zw),\n  clamp(outlineBounds.zw, uTroikaClipRect.xy, uTroikaClipRect.zw)\n);\n\nvec2 clippedXY = (mix(clippedBounds.xy, clippedBounds.zw, position.xy) - bounds.xy) / (bounds.zw - bounds.xy);\n\nposition.xy = mix(bounds.xy, bounds.zw, clippedXY);\n\nuv = (position.xy - uTroikaTotalBounds.xy) / (uTroikaTotalBounds.zw - uTroikaTotalBounds.xy);\n\nfloat rad = uTroikaCurveRadius;\nif (rad != 0.0) {\n  float angle = position.x / rad;\n  position.xz = vec2(sin(angle) * rad, rad - cos(angle) * rad);\n  normal.xz = vec2(sin(angle), cos(angle));\n}\n  \nposition = uTroikaOrient * position;\nnormal = uTroikaOrient * normal;\n\nvTroikaGlyphUV = clippedXY.xy;\nvTroikaGlyphDimensions = vec2(bounds[2] - bounds[0], bounds[3] - bounds[1]);\n\n\nfloat txCols = uTroikaSDFTextureSize.x / uTroikaSDFGlyphSize;\nvec2 txUvPerSquare = uTroikaSDFGlyphSize / uTroikaSDFTextureSize;\nvec2 txStartUV = txUvPerSquare * vec2(\n  mod(floor(aTroikaGlyphIndex / 4.0), txCols),\n  floor(floor(aTroikaGlyphIndex / 4.0) / txCols)\n);\nvTroikaTextureUVBounds = vec4(txStartUV, vec2(txStartUV) + txUvPerSquare);\nvTroikaTextureChannel = mod(aTroikaGlyphIndex, 4.0);\n",fragmentDefs:"\nuniform sampler2D uTroikaSDFTexture;\nuniform vec2 uTroikaSDFTextureSize;\nuniform float uTroikaSDFGlyphSize;\nuniform float uTroikaSDFExponent;\nuniform float uTroikaDistanceOffset;\nuniform float uTroikaFillOpacity;\nuniform float uTroikaOutlineOpacity;\nuniform float uTroikaBlurRadius;\nuniform vec3 uTroikaStrokeColor;\nuniform float uTroikaStrokeWidth;\nuniform float uTroikaStrokeOpacity;\nuniform bool uTroikaSDFDebug;\nvarying vec2 vTroikaGlyphUV;\nvarying vec4 vTroikaTextureUVBounds;\nvarying float vTroikaTextureChannel;\nvarying vec2 vTroikaGlyphDimensions;\n\nfloat troikaSdfValueToSignedDistance(float alpha) {\n  // Inverse of encoding in SDFGenerator.js\n  \n  float maxDimension = max(vTroikaGlyphDimensions.x, vTroikaGlyphDimensions.y);\n  float absDist = (1.0 - pow(2.0 * (alpha > 0.5 ? 1.0 - alpha : alpha), 1.0 / uTroikaSDFExponent)) * maxDimension;\n  float signedDist = absDist * (alpha > 0.5 ? -1.0 : 1.0);\n  return signedDist;\n}\n\nfloat troikaGlyphUvToSdfValue(vec2 glyphUV) {\n  vec2 textureUV = mix(vTroikaTextureUVBounds.xy, vTroikaTextureUVBounds.zw, glyphUV);\n  vec4 rgba = texture2D(uTroikaSDFTexture, textureUV);\n  float ch = floor(vTroikaTextureChannel + 0.5); //NOTE: can't use round() in WebGL1\n  return ch == 0.0 ? rgba.r : ch == 1.0 ? rgba.g : ch == 2.0 ? rgba.b : rgba.a;\n}\n\nfloat troikaGlyphUvToDistance(vec2 uv) {\n  return troikaSdfValueToSignedDistance(troikaGlyphUvToSdfValue(uv));\n}\n\nfloat troikaGetAADist() {\n  \n  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300\n  return length(fwidth(vTroikaGlyphUV * vTroikaGlyphDimensions)) * 0.5;\n  #else\n  return vTroikaGlyphDimensions.x / 64.0;\n  #endif\n}\n\nfloat troikaGetFragDistValue() {\n  vec2 clampedGlyphUV = clamp(vTroikaGlyphUV, 0.5 / uTroikaSDFGlyphSize, 1.0 - 0.5 / uTroikaSDFGlyphSize);\n  float distance = troikaGlyphUvToDistance(clampedGlyphUV);\n \n  // Extrapolate distance when outside bounds:\n  distance += clampedGlyphUV == vTroikaGlyphUV ? 0.0 : \n    length((vTroikaGlyphUV - clampedGlyphUV) * vTroikaGlyphDimensions);\n\n  \n\n  return distance;\n}\n\nfloat troikaGetEdgeAlpha(float distance, float distanceOffset, float aaDist) {\n  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)\n  float alpha = step(-distanceOffset, -distance);\n  #else\n\n  float alpha = smoothstep(\n    distanceOffset + aaDist,\n    distanceOffset - aaDist,\n    distance\n  );\n  #endif\n\n  return alpha;\n}\n",fragmentColorTransform:"\nfloat aaDist = troikaGetAADist();\nfloat distance = troikaGetFragDistValue();\nfloat edgeAlpha = uTroikaSDFDebug ?\n  troikaGlyphUvToSdfValue(vTroikaGlyphUV) :\n  troikaGetEdgeAlpha(distance, uTroikaDistanceOffset, max(aaDist, uTroikaBlurRadius));\n\n#if !defined(IS_DEPTH_MATERIAL) && !defined(IS_DISTANCE_MATERIAL)\nvec4 fillRGBA = gl_FragColor;\nfillRGBA.a *= uTroikaFillOpacity;\nvec4 strokeRGBA = uTroikaStrokeWidth == 0.0 ? fillRGBA : vec4(uTroikaStrokeColor, uTroikaStrokeOpacity);\nif (fillRGBA.a == 0.0) fillRGBA.rgb = strokeRGBA.rgb;\ngl_FragColor = mix(fillRGBA, strokeRGBA, smoothstep(\n  -uTroikaStrokeWidth - aaDist,\n  -uTroikaStrokeWidth + aaDist,\n  distance\n));\ngl_FragColor.a *= edgeAlpha;\n#endif\n\nif (edgeAlpha == 0.0) {\n  discard;\n}\n",customRewriter({vertexShader:t,fragmentShader:e}){let i=/\buniform\s+vec3\s+diffuse\b/;return i.test(e)&&(e=e.replace(i,"varying vec3 vTroikaGlyphColor").replace(/\bdiffuse\b/g,"vTroikaGlyphColor"),i.test(t)||(t=t.replace(v,"uniform vec3 diffuse;\n$&\nvTroikaGlyphColor = uTroikaUseGlyphColors ? aTroikaGlyphColor / 255.0 : diffuse;\n"))),{vertexShader:t,fragmentShader:e}}});return i.transparent=!0,Object.defineProperties(i,{isTroikaTextMaterial:{value:!0},shadowSide:{get(){return this.side},set(){}}}),i}(n),n.addEventListener("dispose",(function t(){n.removeEventListener("dispose",t),i.dispose()}))),this.outlineWidth||this.outlineBlur||this.outlineOffsetX||this.outlineOffsetY){let t=i._outlineMtl;return t||(t=i._outlineMtl=Object.create(i,{id:{value:i.id+.1}}),t.isTextOutlineMaterial=!0,t.depthWrite=!1,t.map=null,i.addEventListener("dispose",(function e(){i.removeEventListener("dispose",e),t.dispose()}))),[t,i]}return i}set material(t){t&&t.isTroikaTextMaterial?(this._derivedMaterial=t,this._baseMaterial=t.baseMaterial):this._baseMaterial=t}get glyphGeometryDetail(){return this.geometry.detail}set glyphGeometryDetail(t){this.geometry.detail=t}get curveRadius(){return this.geometry.curveRadius}set curveRadius(t){this.geometry.curveRadius=t}get customDepthMaterial(){return c(this.material).getDepthMaterial()}get customDistanceMaterial(){return c(this.material).getDistanceMaterial()}_prepareForRender(e){const o=e.isTextOutlineMaterial,c=e.uniforms,u=this.textRenderInfo;if(u){const{sdfTexture:t,blockBounds:e}=u;c.uTroikaSDFTexture.value=t,c.uTroikaSDFTextureSize.value.set(t.image.width,t.image.height),c.uTroikaSDFGlyphSize.value=u.sdfGlyphSize,c.uTroikaSDFExponent.value=u.sdfExponent,c.uTroikaTotalBounds.value.fromArray(e),c.uTroikaUseGlyphColors.value=!o&&!!u.glyphColors;let n,r,a,s=0,l=0,h=0,d=0,p=0;if(o){let{outlineWidth:t,outlineOffsetX:e,outlineOffsetY:i,outlineBlur:r,outlineOpacity:a}=this;s=this._parsePercent(t)||0,l=Math.max(0,this._parsePercent(r)||0),n=a,d=this._parsePercent(e)||0,p=this._parsePercent(i)||0}else h=Math.max(0,this._parsePercent(this.strokeWidth)||0),h&&(a=this.strokeColor,c.uTroikaStrokeColor.value.set(null==a?i:a),r=this.strokeOpacity,null==r&&(r=1)),n=this.fillOpacity;c.uTroikaDistanceOffset.value=s,c.uTroikaPositionOffset.value.set(d,p),c.uTroikaBlurRadius.value=l,c.uTroikaStrokeWidth.value=h,c.uTroikaStrokeOpacity.value=r,c.uTroikaFillOpacity.value=null==n?1:n,c.uTroikaCurveRadius.value=this.curveRadius||0;let f=this.clipRect;if(f&&Array.isArray(f)&&4===f.length)c.uTroikaClipRect.value.fromArray(f);else{const t=100*(this.fontSize||.1);c.uTroikaClipRect.value.set(e[0]-t,e[1]-t,e[2]+t,e[3]+t)}this.geometry.applyClipRect(c.uTroikaClipRect.value)}c.uTroikaSDFDebug.value=!!this.debugSDF,e.polygonOffset=!!this.depthOffset,e.polygonOffsetFactor=e.polygonOffsetUnits=this.depthOffset||0;const h=o?this.outlineColor||0:this.color;if(null==h)delete e.color;else{const i=e.hasOwnProperty("color")?e.color:e.color=new t.Color;h===i._input&&"object"!=typeof h||i.set(i._input=h)}let d=this.orientation||l;if(d!==e._orientation){let t=c.uTroikaOrient.value;d=d.replace(/[^-+xyz]/g,"");let i=d!==l&&d.match(/^([-+])([xyz])([-+])([xyz])$/);if(i){let[,e,o,l,c]=i;r.set(0,0,0)[o]="-"===e?1:-1,a.set(0,0,0)[c]="-"===l?-1:1,n.lookAt(s,r.cross(a),a),t.setFromMatrix4(n)}else t.identity();e._orientation=d}}_parsePercent(t){if("string"==typeof t){let e=t.match(/^(-?[\d.]+)%$/),i=e?parseFloat(e[1]):NaN;t=(isNaN(i)?0:i/100)*this.fontSize}return t}localPositionToTextCoords(e,i=new t.Vector2){i.copy(e);const n=this.curveRadius;return n&&(i.x=Math.atan2(e.x,Math.abs(n)-Math.abs(e.z))*Math.abs(n)),i}worldPositionToTextCoords(e,i=new t.Vector2){return r.copy(e),this.localPositionToTextCoords(this.worldToLocal(r),i)}raycast(t,e){const{textRenderInfo:i,curveRadius:n}=this;if(i){const r=i.blockBounds,a=n?h():u(),s=a.geometry,{position:l,uv:c}=s.attributes;for(let t=0;t<c.count;t++){let e=r[0]+c.getX(t)*(r[2]-r[0]);const i=r[1]+c.getY(t)*(r[3]-r[1]);let a=0;n&&(a=n-Math.cos(e/n)*n,e=Math.sin(e/n)*n),l.setXYZ(t,e,i,a)}s.boundingSphere=this.geometry.boundingSphere,s.boundingBox=this.geometry.boundingBox,a.matrixWorld=this.matrixWorld,a.material.side=this.material.side,o.length=0,a.raycast(t,o);for(let t=0;t<o.length;t++)o[t].object=this,e.push(o[t])}}copy(t){const e=this.geometry;return super.copy(t),this.geometry=e,m.forEach((e=>{this[e]=t[e]})),this}clone(){return(new this.constructor).copy(this)}}f.forEach((t=>{const e="_private_"+t;Object.defineProperty(g.prototype,t,{get(){return this[e]},set(t){t!==this[e]&&(this[e]=t,this._needsSync=!0)}})}));let y=!1;return Object.defineProperty(g.prototype,"anchor",{get(){return this._deprecated_anchor},set(t){this._deprecated_anchor=t,y||(console.warn("TextMesh: `anchor` has been deprecated; use `anchorX` and `anchorY` instead."),y=!0),Array.isArray(t)?(this.anchorX=100*(+t[0]||0)+"%",this.anchorY=100*(+t[1]||0)+"%"):this.anchorX=this.anchorY=0}}),g})();var z="troika-text";function V(t){return{default:t,parse:function(t){return"string"==typeof t&&t.indexOf("%")>0?t:(t=+t,isNaN(t)?0:t)},stringify:function(t){return""+t}}}a.default.registerComponent(z,{schema:{align:{type:"string",default:"left",oneOf:["left","right","center","justify"]},anchor:{default:"center",oneOf:["left","right","center","align"]},baseline:{default:"center",oneOf:["top","center","bottom"]},clipRect:{type:"string",default:"",parse:function(t){return t&&(t=t.split(/[\s,]+/).reduce((function(t,e){return e=+e,isNaN(e)||t.push(e),t}),[])),t&&4===t.length?t:null},stringify:function(t){return t?t.join(" "):""}},color:{type:"color",default:"#FFF"},curveRadius:{type:"number",default:0},depthOffset:{type:"number",default:0},direction:{type:"string",default:"auto",oneOf:["auto","ltr","rtl"]},fillOpacity:{type:"number",default:1},font:{type:"string"},fontSize:{type:"number",default:.2},letterSpacing:{type:"number",default:0},lineHeight:{type:"number"},maxWidth:{type:"number",default:1/0},outlineBlur:V(0),outlineColor:{type:"color",default:"#000"},outlineOffsetX:V(0),outlineOffsetY:V(0),outlineOpacity:{type:"number",default:1},outlineWidth:V(0),overflowWrap:{type:"string",default:"normal",oneOf:["normal","break-word"]},strokeColor:{type:"color",default:"grey"},strokeOpacity:{type:"number",default:1},strokeWidth:V(0),textIndent:{type:"number",default:0},value:{type:"string"},whiteSpace:{default:"normal",oneOf:["normal","nowrap"]}},init:function(){var t;"a-troika-text"===this.el.tagName.toLowerCase()?t=this.el:(t=document.createElement("a-entity"),this.el.appendChild(t)),this.troikaTextEntity=t;var e=this.troikaTextMesh=new H;t.setObject3D("mesh",e)},update:function(){var t=this.data,e=this.troikaTextMesh,i=this.troikaTextEntity;if(e.text=(t.value||"").replace(/\\n/g,"\n").replace(/\\t/g,"\t"),e.textAlign=t.align,e.anchorX=W["align"===t.anchor?t.align:t.anchor]||"center",e.anchorY=X[t.baseline]||"middle",e.color=t.color,e.clipRect=t.clipRect,e.curveRadius=t.curveRadius,e.depthOffset=t.depthOffset||0,e.direction=t.direction,e.fillOpacity=t.fillOpacity,e.font=t.font,e.fontSize=t.fontSize,e.letterSpacing=t.letterSpacing||0,e.lineHeight=t.lineHeight||"normal",e.outlineBlur=t.outlineBlur,e.outlineColor=t.outlineColor,e.outlineOffsetX=t.outlineOffsetX,e.outlineOffsetY=t.outlineOffsetY,e.outlineOpacity=t.outlineOpacity,e.outlineWidth=t.outlineWidth,e.overflowWrap=t.overflowWrap,e.strokeColor=t.strokeColor,e.strokeOpacity=t.strokeOpacity,e.strokeWidth=t.strokeWidth,e.textIndent=t.textIndent,e.whiteSpace=t.whiteSpace,e.maxWidth=t.maxWidth,e.sync(),i!==this.el){var n=this.el.getAttribute("troika-text-material");n?i.setAttribute("material",n):i.removeAttribute("material")}},remove:function(){this.troikaTextMesh.dispose(),this.troikaTextEntity!==this.el&&this.el.removeChild(this.troikaTextEntity)}});var G,W={left:"left",center:"center",right:"right"},X={top:"top",center:"middle",bottom:"bottom"},Y={},Q=a.default.components["troika-text"].schema;Object.keys(Q).map((function(t){var e=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();Y[e]="troika-text."+t})),a.default.registerPrimitive("a-troika-text",{defaultComponents:{"troika-text":{}},mappings:Y}),(G=r).MathUtils||(G.MathUtils=G.Math)}(THREE,AFRAME)}).call(this,i(21))},function(t,e,i){const n=i(155),{Util:r}=i(0);AFRAME.registerComponent("shelf",{dependencies:["grab-activate","bypass-hidden-updates"],schema:{width:{default:4},height:{default:3},offset:{type:"vec3",default:{x:0,y:0,z:0}},frame:{default:!0},closeable:{default:!1},hideOnly:{default:!0},pinnable:{default:!0},closable:{default:void 0,parse:t=>t},grabRoot:{default:!0},popup:{default:!1},name:{type:"string"}},events:{componentchanged:function(t){"visible"===t.detail.name&&this.el.sceneEl.emit("refreshobjects")}},init(){if(!this.el.attached)throw new Error("Not attached!");var t=document.createElement("a-entity");t.innerHTML=n,t.querySelectorAll(".clickable").forEach((t=>t["redirect-grab"]=this.el)),this.container=t,this.el.prepend(t),this.el.setAttribute("bypass-hidden-updates",""),this.data.grabRoot&&this.el.classList.add("grab-root");let e=!1;for(let t=this.el.parentEl;t;t=t.parentEl)if(t.hasAttribute("billboard")){e=!0;break}},update(t){if(void 0!==this.data.closable&&(console.warn("shelf.closable will clobber shelf.closeable"),this.data.closeable=this.data.closable),this.container.hasLoaded){this.container.querySelector(".bg").setAttribute("geometry",{width:this.data.width,height:this.data.height}),this.container.setAttribute("position",this.data.offset),!this.el.hasAttribute("frame")&&this.data.frame?r.whenLoaded(this.container.querySelector(".bg"),(()=>{this.el.setAttribute("frame",{outline:!1,closable:this.data.closeable,pinnable:this.data.pinnable,hideOnly:this.data.hideOnly,geometryTarget:this.container.querySelector(".bg"),name:r.translate(this.data.name)})})):t&&this.data.name===t.name||!this.data.frame||r.whenLoaded(this.container.querySelector(".bg"),(()=>{this.el.setAttribute("frame","name",r.translate(this.data.name))})),this.data.popup&&this.data.frame&&r.whenLoaded(this.container.querySelector(".bg"),(()=>{this.el.setAttribute("frame","closePopup",!0)}));let e=this.container.querySelector(".handle");e.setAttribute("position",`0 -${this.data.height/2+e.getAttribute("geometry").radius} 0`),e.setAttribute("geometry","height",1*this.data.width)}else this.container.addEventListener("loaded",(t=>this.update()))}}),AFRAME.registerComponent("expandable-shelf",{dependencies:["shelf"],schema:{extraWidth:{default:0},extraHeight:{default:1},expanded:{default:!1},expansionSelector:{default:".expanded"}},init(){this.expanded=!1,this.el.querySelectorAll(this.data.expansionSelector).forEach((t=>{t.setAttribute("visible",this.expanded)}))},update(){if(this.data.expanded===this.expanded)return;let{height:t,width:e}=this.el.getAttribute("shelf");this.data.expanded?(this.el.setAttribute("shelf","height",t+this.data.extraHeight),this.el.setAttribute("shelf","offset",`0 -${this.data.extraHeight/2} 0`),this.el.querySelectorAll(this.data.expansionSelector).forEach((t=>t.setAttribute("visible",!0)))):(this.el.setAttribute("shelf","height",t-this.data.extraHeight),this.el.setAttribute("shelf","offset","0 0 0"),this.el.querySelectorAll(this.data.expansionSelector).forEach((t=>t.setAttribute("visible",!1)))),this.expanded=this.data.expanded,this.el.sceneEl.emit("refreshobjects")}}),AFRAME.registerComponent("shelf-content",{schema:{padding:{default:.4}},init(){let t=this.el.parentEl;for(;t;){if(t.hasAttribute("shelf")){this.shelf=t;break}t=t.parentEl}t?(this.el.classList.add("grab-root"),this.el["redirect-grab"]=this.shelf):console.warn("shelf-content must be placed in a shelf")},update(t){this.shelf&&r.whenLoaded(this.shelf,(()=>{let t=this.shelf.getAttribute("shelf");this.el.setAttribute("position",`${-t.width/2+this.data.padding} ${t.height/2-this.data.padding} 0`)}))}}),AFRAME.registerComponent("hide-shelf-on-click",{events:{click:function(t){window.setTimeout((()=>{let t=this.el.parentEl;for(;t;){if(t.hasAttribute("shelf"))return void t.setAttribute("visible","false");t=t.parentEl}}),200)}}})},function(t,e,i){"use strict";i.r(e);var n=i(0);AFRAME.registerSystem("edit-field",{schema:{scale:{type:"vec3",default:new THREE.Vector3(1,1,1)}}}),AFRAME.registerComponent("edit-field",{dependencies:["text","popup-button"],schema:{tooltip:{type:"string"},type:{type:"string",default:"number",oneOf:["number","float","string","dropdown"]},target:{type:"selector"},component:{type:"string"},property:{type:"string"},autoClear:{type:"boolean",default:!1}},events:{popuplaunched:function(t){this.connectKeyboard()},popupclosed:function(t){this.disconnectKeyboard()}},init(){this.el.setAttribute("popup-button","scale",this.system.data.scale),this.numpad=this.el.components["popup-button"].popup;let{numpad:t}=this;this.inputField=document.createElement("input"),this.inputField.classList.add("keyboard-form"),this.inputField.editField=this,document.body.append(this.inputField),this.inputField.addEventListener("keyup",(t=>{"Enter"===event.key&&this.ok()})),this.inputField.addEventListener("keydown",(t=>{t.stopPropagation()})),this.inputField.addEventListener("input",(t=>{this.setValue(this.inputField.value)})),t.addEventListener("click",(t=>this.buttonClicked(t))),this.el.addEventListener("popuplaunched",(e=>{t.querySelector(".value").setAttribute("text",{value:this.el.getAttribute("text").value}),t.setAttribute("visible",!0),t.querySelector("*[shelf]").setAttribute("shelf","name",this.data.tooltip),("number"===this.data.type||"float"===this.data.type||this.data.autoClear)&&this.setValue("",{update:!1})}))},update(t){let e="numpad";"string"===this.data.type&&(e="keyboard"),"float"===this.data.type&&(e="numpad-float"),this.el.setAttribute("popup-button",{icon:"#asset-lead-pencil",tooltip:this.data.tooltip,popup:e,deferred:!0}),this.data.target!==t.target&&(t.target&&t.target.removeEventListener("componentchanged",this.componentchangedlistener),this.data.target&&(this.componentchangedlistener=t=>{t.detail.name===this.data.component&&this.setValue(this.data.target.getAttribute(this.data.component)[this.data.property].toString(),{update:!1})},this.data.target.addEventListener("componentchanged",this.componentchangedlistener),n.Util.whenLoaded([this.numpad,this.el,this.data.target],(()=>{this.setValue(this.data.target.getAttribute(this.data.component)[this.data.property].toString(),{update:!1})}))))},remove(){this.inputField.remove()},setValue(t,{update:e=!0}={}){let i=this.numpad.querySelector(".value");i&&i.setAttribute("text",{value:t}),this.el.setAttribute("text",{value:t}),this.inputField.value=t,e&&this.data.target&&this.data.target.setAttribute(this.data.component,{[this.data.property]:t})},buttonClicked(t){console.log(t);let e=t.target.object3D,i=!0;e.traverseAncestors((t=>i=i&&t.visible)),this.inputField.focus();this.numpad;if(t.target.hasAttribute("action"))this[t.target.getAttribute("action")](t);else if(t.target.hasAttribute("text")){let e=t.target.getAttribute("text").value;""===e&&(e=" ");let i=this.el.getAttribute("text").value;this.setValue(i+e,{update:!1})}},backspace(t){this.setValue(this.el.getAttribute("text").value.slice(0,-1),{update:!1})},ok(t){this.setValue(this.el.getAttribute("text").value),this.el.components["popup-button"].closePopup(),this.el.emit("editfinished",{value:this.el.getAttribute("text").value})},clear(t){this.setValue("")},async paste(t){this.inputField.focus(),navigator.clipboard?this.setValue(await navigator.clipboard.readText()):document.execCommand("paste")},connectKeyboard(){console.log("Connecting keyboard"),this.inputField.focus()},disconnectKeyboard(){this.inputField.blur(),this.el.sceneEl.canvas.focus()}}),AFRAME.registerComponent("popup-button",{schema:{tooltip:{type:"string"},icon:{type:"string",default:"#asset-lead-pencil"},popup:{type:"string",default:"numpad"},scale:{type:"vec3",default:new THREE.Vector3(1,1,1)},offset:{type:"vec3",default:new THREE.Vector3(0,0,.1)},autoScale:{default:!1},deferred:{type:"boolean",default:!0}},init(){let t;if(this.el.hasAttribute("icon-button"))t=this.el,this.el.addEventListener("click",(e=>{e.target===t&&this.launchPopup()}));else{this.el.setAttribute("text",{align:"right"});let e=this.el.getAttribute("text").width;t=document.createElement("a-entity"),t.setAttribute("position",e/2+.3+" 0 0"),t.setAttribute("icon-button",this.data.icon),this.el.append(t),t.addEventListener("click",(t=>this.launchPopup()))}this.editButton=t;let e=document.createElement("a-entity");this.el.hasAttribute("icon-button")?this.el.parentEl.append(e):this.el.append(e),this.popup=e,e.setAttribute("position","0 0 0.1"),e.setAttribute("visible","false"),e.addEventListener("click",(t=>{t.target.hasAttribute("popup-action")&&this[t.target.getAttribute("popup-action")+"Popup"]()})),e.addEventListener("popupaction",(t=>{this[t.detail+"Popup"](),t.stopPropagation(),console.log("Trying to stop propogation",this.el,t)}))},update(t){if(this.data.tooltip&&this.editButton.setAttribute("tooltip",this.data.tooltip),this.data.deferred&&this.popupLoaded&&this.data.popup!==t.popup){this.popupLoaded=!1;for(let t of this.popup.children)this.popup.remove(t)}if(this.data.popup!==t.popup&&!this.data.deferred){console.debug("Resetting popup HTML",this.data.popup,t.popup);for(let t of this.popup.children)this.popup.remove(t);let e=document.createElement("a-entity");for(let t of this.popup.children)this.popup.removeChild(t);this.popup.append(e),e.innerHTML=i(25)(`./${this.data.popup}.html.slm`),this.popupLoaded=!0}if(!this.popupLoaded&&!this.data.deferred){console.debug("Initing popup",this.data.deferred,this.data);for(let t of this.popup.children)this.popup.remove(t);let t=document.createElement("a-entity");this.popup.append(t),t.innerHTML=i(25)(`./${this.data.popup}.html.slm`),this.popupLoaded=!0}},launchPopup(){let t=this.popup;if(this.popupLoaded||(t.innerHTML=i(25)(`./${this.data.popup}.html.slm`),this.popupLoaded=!0),!this.shelfPopup&&1===t.children.length&&t.children[0].hasAttribute("shelf")&&(this.shelfPopup=t.children[0],n.Util.whenLoaded(this.shelfPopup,(()=>{this.shelfPopup.setAttribute("shelf","popup",!0),this.shelfPopup.addEventListener("popupaction",(t=>{this.popup.emit("popupaction",t.detail),t.stopPropagation()}))}))),t.object3D.position.copy(this.data.offset),t.object3D.updateMatrixWorld(),!this.data.autoScale){let e=t.object3D.parent.getWorldScale(new THREE.Vector3);e.x=this.data.scale.x/e.x,e.y=this.data.scale.y/e.y,e.z=this.data.scale.z/e.z,t.object3D.scale.copy(e)}t.setAttribute("visible",!0),this.shelfPopup?n.Util.whenLoaded(this.shelfPopup,(()=>{this.el.sceneEl.emit("refreshobjects"),this.el.emit("popuplaunched",t),this.shelfPopup.emit("popupshown")})):(this.el.sceneEl.emit("refreshobjects"),t.emit("popupshown"),this.el.emit("popuplaunched"))},closePopup(){this.popup.setAttribute("visible",!1),this.popup.setAttribute("position","0 -999999 0.1"),this.el.emit("popupclosed"),(this.shelfPopup||this.popup).emit("popuphidden")}}),AFRAME.registerComponent("not-frustum-culled",{events:{object3dset:function(t){this.el.object3D.traverse((t=>t.frustumCulled=!1))}},init(){this.el.object3D.frustumCulled=!1}}),AFRAME.registerComponent("v-bind",{multiple:!0,schema:{target:{type:"selector"},component:{type:"string"},property:{type:"string"},source:{type:"selector"},sourceComponent:{type:"string"},sourceProperty:{type:"string"},setOnLoad:{default:!1}},init(){this.handleUpdate=this.handleUpdate.bind(this),this.data.setOnLoad&&n.Util.whenLoaded([this.el,this.data.source],(()=>{this.forceUpdate()}))},update(t){let e=this.data.source||this.el.sceneEl;e!==this.source&&(this.source&&this.source.removeEventListener("componentchanged",this.handleUpdate),e.addEventListener("componentchanged",this.handleUpdate),this.source=e),this.forceUpdate()},handleUpdate(t){t.detail.name===this.data.sourceComponent&&this.forceUpdate()},forceUpdate(){let t=this.data.source.getAttribute(this.data.sourceComponent);t=this.data.sourceProperty?t[this.data.sourceProperty]:t,(this.data.target||this.el).setAttribute(this.data.component,this.data.property?this.data.property:t,this.data.property?t:void 0)}}),AFRAME.registerComponent("dropdown-button",{schema:{options:{type:"array"},optionIcon:{type:"string",default:"#asset-record"},tooltip:{default:"Select"},target:{type:"selector"},component:{type:"string"},property:{type:"string"},selectedValue:{type:"string"}},events:{popuplaunched:function(t){this.populatePopup()}},emits:{dropdownoption:{}},init(){this.el.setAttribute("popup-button","popup: dropdown-popup"),n.Util.whenLoaded(this.data.target?[this.data.target,this.el]:this.el,(()=>{this.data.target&&(this.data.selectedValue=this.data.property?this.data.target.getAttribute(this.data.component)[this.data.property]:this.data.target.getAttribute(this.data.component)),this.el.hasAttribute("text")&&this.el.setAttribute("text","value",this.data.selectedValue)}))},populatePopup(){console.log("Populating popup",this.data.options);let t=this.el.components["popup-button"].popup;t.querySelector("*[shelf]").setAttribute("shelf","height",Math.max(4,.5*this.data.options.length+.3));let e=t.querySelector("*[shelf-content]");e.getChildEntities().forEach((t=>e.removeChild(t)));let i=Math.max.apply(Math,this.data.options.map((t=>t.length)));for(let t of this.data.options){let n=document.createElement("a-entity");e.append(n),n.setAttribute("icon-row","");let r=document.createElement("a-entity");n.append(r),r.setAttribute("icon-button",this.data.optionIcon),this.data.target?r.setAttribute("radio-button",{value:t,target:this.data.target,component:this.data.component,property:this.data.property}):t===this.data.selectedValue&&r.setAttribute("toggle-button","toggled","true"),r.addEventListener("click",(e=>{this.el.emit("dropdownoption",t),this.el.setAttribute("dropdown-button","selectedValue",t),this.el.hasAttribute("text")&&this.el.setAttribute("text","value",t)})),r.setAttribute("popup-action","close");let a=document.createElement("a-entity");n.append(a),a.setAttribute("text",`wrapCount: ${i+3}; width: 1.5; anchor: left; align: left`),a.setAttribute("text","value",t),a.setAttribute("position","0.4 0 0")}}}),AFRAME.registerComponent("deferred-load",{schema:{loaded:{default:!1},onVisible:{default:!1},popup:{type:"string",default:""}},events:{componentchanged:function(t){"visible"===t.detail.name&&this.data.onVisible&&this.el.getAttribute("visible")&&this.load()}},update(t){this.data.loaded&&this.load()},load(){if(this.loaded)return;if(this.data.popup.length)return void(this.el.innerHTML=i(25)(`./${this.data.popup}.html.slm`));let t=this.el.querySelector("script");console.log("Loading script",t,this.el),this.el.innerHTML=t.text,this.loaded=!0}})},function(t,e){t.exports='<a-entity position="-1.5 0.0 0" scale="0.3 0.3 1" shelf="name: Help Shelf; closeable: true" visible="false"><a-entity position="-1 0.7 0" scale="0.5 0.5 1"><a-image height="352" position="0 0.5 0" scale="0.0035 0.0035 1" src="#asset-vartiste" transparent="true" width="1023"></a-image><a-entity position="0 -0.2 0" text="value: VARTISTE by Zach Capalbo &lt;https://zachcapalbo.com&gt; @zach_geek; align: center; width: 4"></a-entity><a-entity position="0 -0.5 0" text="value: ...; align: center; width: 4" version-info=""></a-entity></a-entity><a-entity position="0.3 1.0 0"><a-entity icon-row=""><a-entity icon-button="#asset-help-circle-outline" system-click-action="system: settings-system; action: helpAction" text="value: Instructions (new window); anchor: left; xOffset: 0.3; wrapCount: 15; width: 1.35" tooltip="Instructions (new window)" translate-text=""></a-entity></a-entity><a-entity icon-row=""><a-entity icon-button="#asset-account-voice" system-click-action="system: settings-system; action: feedbackAction" text="value: Send Feedback\\n(new window); anchor: left; xOffset: 0.3; wrapCount: 15; width: 1.35" tooltip="Send Feedback"></a-entity></a-entity><a-entity icon-row=""><a-entity icon-button="#asset-web" system-click-action="system: user-media; action: showDesktop" text="value: Show window or tab in VR\\n(Great for watching tutorials!); anchor: left; xOffset: 0.3; wrapCount: 22; width: 1.35" tooltip="Show Window" translate-text=""></a-entity></a-entity><a-entity icon-row=""><a-entity icon-button="#asset-translate" popup-button="popup: language-shelf; deferred: true" text="value: Select Language; anchor: left; xOffset: 0.3; wrapCount: 15; width: 1.35" tooltip="Lanugage"></a-entity></a-entity></a-entity></a-entity>'},function(t,e){t.exports='<a-entity advanced-drawing-shelf="" grab-root="" id="advanced-drawing-shelf" scale="0.3 0.3 1" shelf="name: Advanced Drawing Shelf; closeable: true; height: 4.3; width: 4.5" visible="false"><a-entity shelf-content=""><a-entity icon-row=""><a-entity icon-row-text="Edit Functions"></a-entity></a-entity><a-entity icon-row="mergeButtons: true"><a-entity hide-shelf-on-click="" icon-button="#asset-plus-box-multiple" system-click-action="system: cut-copy-system; action: copy" tooltip="Copy to new layer"></a-entity><a-entity hide-shelf-on-click="" icon-button="#asset-transition-masked" system-click-action="system: cut-copy-system; action: cut" tooltip="Cut to new layer"></a-entity><a-entity icon-button="#asset-delete" system-click-action="system: cut-copy-system; action: clear" tooltip="Clear Active Layer"></a-entity></a-entity><a-entity icon-row=""><a-entity icon-row-text="Effects / Filters"></a-entity></a-entity><a-entity icon-row="mergeButtons: true"><a-entity icon-button="#asset-blur-linear" popup-button="popup: fx-popup; deferred: true; scale: 2 2 2" tooltip="Apply FX"></a-entity><a-entity icon-button="#asset-resize" toolbox-click-action="bumpCanvasToNormalCanvas" tooltip="Bump Map to Normal Map"></a-entity><a-entity icon-button="#asset-dots-square" system-click-action="system: shape-creation; action: autoTrace" tooltip="Trace shape"></a-entity></a-entity><a-entity icon-row=""><a-entity icon-row-text="Bump/Normal Drawing"></a-entity></a-entity><a-entity icon-row="mergeButtons: true"><a-entity icon-button="#asset-brush" system-click-action="system: normal-bump-drawing; action: drawNormal" toggle-button="useUntoggledColor: false" tooltip="Draw bumps to normal"></a-entity><a-entity icon-button="#asset-chevron-down" id="invert-normal-draw" toggle-button="target: a-scene; component: normal-bump-drawing; property: invert" tooltip="Invert Bump Drawing"></a-entity><a-entity icon-button="#asset-brightness-4" id="color-normal-draw" toggle-button="target: a-scene; component: normal-bump-drawing; property: keepColor" tooltip="Keep Color with Normal"></a-entity></a-entity><a-entity icon-row=""><a-entity icon-row-text="Other Tools"></a-entity></a-entity><a-entity icon-row="mergeButtons: true"><a-entity icon-button="#asset-badge-account-horizontal-outline" popup-button="popup: timer-shelf; deferred: true; autoScale: true" tooltip="Drawing Practice Timer"></a-entity></a-entity></a-entity></a-entity>'},function(t,e){t.exports='<a-entity class="node-shelf grab-root" shelf=""><a-entity position="0 1.2 0"><a-entity click-action="delete" icon-button="#asset-delete" tooltip="Delete Node"></a-entity></a-entity><a-entity position="-2.5 -1.3 0"></a-entity><a-entity node-output="" position="2.1 1.2 0.01"></a-entity><a-entity canvas-updater="throttle: 800" geometry="primitive: plane; width: 3; height: 2" material="shader: flat; transparent: true; npot: true"></a-entity><a-entity position="1.7 0 0"><a-entity class="clickable" geometry="primitive: plane; width: 2; height: 0.3" opacity-picker="" propogate-grab="" rotation="0 0 90"></a-entity></a-entity><a-entity material="color: #34d8eb" node-input="type: destination" position="-2.1 1.2 0.01"></a-entity></a-entity>'},function(t,e){t.exports='<a-entity brush-editor="" id="brush-editor" propogate-grab="" rotation="0 0 0" shelf="name: Brush Editor; height: 3.5; closeable: true; hideOnly: true" visible="false"><a-plane class="preview" frame="pinnable: false; closable: false; grabbable: false" height="0.65" material="transparent: true; npot: true; shader: flat" position="1.25 1.13 0.005" width="0.65"></a-plane><a-entity position="-1.5 1.35 0"><a-entity icon-row=""><a-entity icon-button="#asset-brush" radio-button="target: #brush-editor; component: brush-editor; property: type; value: ImageBrush" tooltip="Image Brush"></a-entity><a-entity icon-button="#asset-resize" radio-button="target: #brush-editor; component: brush-editor; property: type; value: StretchBrush" tooltip="Stretch Brush"></a-entity><a-entity icon-button="#asset-blur-linear" radio-button="target: #brush-editor; component: brush-editor; property: type; value: FxBrush" tooltip="FX Brush"></a-entity><a-entity position="3.4 0 0"><a-entity click-action="deleteBrush" icon-button="#asset-delete" tooltip="Delete Brush"></a-entity></a-entity></a-entity><a-entity icon-row=""><a-entity icon-button="#asset-folder-open-outline" system-click-action="system: file-upload; action: browse" tooltip="Open Image"></a-entity><a-entity click-action="useLayer" icon-button="#asset-arrow-left" tooltip="Use active layer as brush"></a-entity><a-entity position="0.73 0 0" text="value: Or drag and drop an image here; width: 1.930; wrapCount: 20.340; anchor: left"></a-entity></a-entity><a-entity icon-row=""><a-entity class="image-brush fx-brush"><a-entity icon-button="#asset-brightness-4" toggle-button="target: #brush-editor; component: brush-editor; property: textured" tooltip="Use Image Color Multiplier"></a-entity><a-entity icon-button="#asset-transition" toggle-button="target: #brush-editor; component: brush-editor; property: connected" tooltip="Connected Strokes"></a-entity><a-entity icon-button="#asset-hand-right" toggle-button="target: #brush-editor; component: brush-editor; property: requireMovement" tooltip="Require Movement"></a-entity><a-entity icon-button="#asset-cube-send" toggle-button="target: #brush-editor; component: brush-editor; property: dragRotate" tooltip="Rotation Follows Movement"></a-entity><a-entity icon-button="#asset-rotate-3d-variant" toggle-button="target: #brush-editor; component: brush-editor; property: autoRotate" tooltip="Auto Rotate"></a-entity></a-entity><a-entity class="stretch-brush"><a-entity icon-button="#asset-brightness-4" toggle-button="target: #brush-editor; component: brush-editor; property: textured" tooltip="Use Image Color Multiplier"></a-entity></a-entity></a-entity><a-entity icon-row=""><a-entity class="stretch-brush image-brush"><a-entity icon-button="#asset-blur-linear" popup-button="popup: mode-shelf; deferred: true; tooltip: Change brush blend mode; scale: 0.3 0.3 0.3"></a-entity><a-entity position="0.3 0 0" text="value: source-over; width: 1.5; wrapCount: 20; anchor: left" v-bind="source: #brush-editor; sourceComponent: brush-editor; sourceProperty: mode; component: text; property: value"></a-entity></a-entity><a-entity class="fx-brush"><a-entity dropdown-button="options: blur, nudge, scatter, noise, drip, dilate, hq-blending, oklab-blend; target: #brush-editor; component: brush-editor; property: fx" icon-button="#asset-blur-linear" text="wrapCount: 20; width: 2; anchor: left; xOffset: 0.4"></a-entity></a-entity></a-entity><a-entity icon-row=""><a-entity click-action="addBrush" icon-button="#asset-plus-box-outline" tooltip="Add Brush"></a-entity><a-entity click-action="saveAll" icon-button="#asset-floppy" tooltip="Download Brushes"></a-entity></a-entity></a-entity></a-entity>'},function(t,e){t.exports='<a-entity shelf="name: Brush Packs; closeable: true"><a-entity shelf-content=""><a-entity icon-row=""><a-entity icon-button="#asset-brush" onclick="this.sceneEl.systems[\'brush-system\'].loadPack(\'misc.vartiste-brushez\')" popup-action="close" tooltip="Load Misc Brush Pack"></a-entity><a-entity position="0.4 0 0" text="value: Misc Brush Pack; anchor: left; width: 2.5; wrapCount: 20"></a-entity></a-entity><a-entity icon-row=""><a-entity icon-button="#asset-brush" onclick="this.sceneEl.systems[\'brush-system\'].loadPack(\'fire.vartiste-brushez\')" popup-action="close" tooltip="Load Fire Brush Pack"></a-entity><a-entity position="0.4 0 0" text="value: Fire Brush Pack; anchor: left; width: 2.5; wrapCount: 20"></a-entity></a-entity><a-entity icon-row=""><a-entity icon-button="#asset-brush" onclick="this.sceneEl.systems[\'brush-system\'].loadPack(\'cloudy.vartiste-brushez\')" popup-action="close" tooltip="Load Cloudy Brush Pack"></a-entity><a-entity position="0.4 0 0" text="value: Cloudy Brush Pack; anchor: left; width: 2.5; wrapCount: 20"></a-entity></a-entity></a-entity></a-entity>'},function(t,e){t.exports='<a-entity class="node-shelf grab-root" shelf=""><a-entity position="0 1.2 0"><a-entity class="clickable" click-action="grab" icon-button="#asset-arrow-all" tooltip="Grab Node Transform"></a-entity><a-entity click-action="delete" icon-button="#asset-delete" tooltip="Delete Node"></a-entity></a-entity><a-entity position="0.2 -1.3 0"><a-entity class="mode-popup" popup-button="popup: mode-shelf; icon: #asset-blur-linear; deferred: true; tooltip: Change blend mode; scale: 0.3 0.3 0.3" position="-2.0 0.1 0"></a-entity><a-entity class="mode-text" position="0.5 0.05 0" text="value: Mode: source-over; color: #f83; width: 4"></a-entity></a-entity><a-entity click-action="convertToLayer" icon-button="#asset-archive-arrow-down-outline" position="1.6 -1.2 0" tooltip="Convert to layer"></a-entity><a-entity node-output="" position="2.1 1.2 0.01"></a-entity><a-entity canvas-updater="throttle: 800" geometry="primitive: plane; width: 3; height: 2" material="shader: flat; transparent: true; npot: true"></a-entity><a-entity class="grabbing-indicator" visible="false"><a-entity gltf-model="#asset-hand" material="shader: standard; metalness: 0.4; color: #a88d32; emissive: #a88d32; emissiveIntensity: 0.8" position="-2.1 0 0" rotation="0 0 -90" scale="1 1 0.3" shadow="cast: false; receive: false"></a-entity><a-entity gltf-model="#asset-hand" material="shader: standard; metalness: 0.4; color: #a88d32; emissive: #a88d32; emissiveIntensity: 0.8" position="2.1 0 0" rotation="0 0 90" scale="1 1 0.3" shadow="cast: false; receive: false"></a-entity></a-entity><a-entity position="1.7 0 0"><a-entity class="clickable" geometry="primitive: plane; width: 2; height: 0.3" opacity-picker="" propogate-grab="" rotation="0 0 90"></a-entity></a-entity><a-entity material="color: #34d8eb" node-input="type: destination" position="-2.1 1.2 0.01"></a-entity><a-entity node-input="type: source; index: " position="-2.1 0.7 0.01"></a-entity><a-entity node-input="type: source; index: 1" position="-2.1 0.39999999999999997 0.01"></a-entity><a-entity node-input="type: source; index: 2" position="-2.1 0.09999999999999998 0.01"></a-entity><a-entity node-input="type: source; index: 3" position="-2.1 -0.19999999999999996 0.01"></a-entity><a-entity node-input="type: source; index: 4" position="-2.1 -0.5 0.01"></a-entity></a-entity>'},function(t,e){t.exports='<a-circle class="clickable" color-picker="" id="color-picker" material="" propogate-grab=""></a-circle><a-circle position="1.25 0 0.005" radius="0.2" show-current-color=""></a-circle><a-plane height="0.4" position="1.25 0.5 0.005" show-current-brush="" width="0.4"></a-plane><a-entity position="1.7 0.5 0.005" show-current-brush-scale="" text="value: x1; wrapCount: 4; width: 0.4; anchor: center; align: center" tooltip="Brush Scale"></a-entity><a-entity brush-scale-lever="" lever="valueRange: 1 -1" position="1.9 0.5 0.005" tooltip="Scale Brush"></a-entity><a-plane brightness-picker="target:#color-picker" class="clickable" height="1.9" position="-1.35 0 0" propogate-grab="" tooltip="Color Picker Brightness" tooltip-style="offset: 0 1 0" width="0.3"></a-plane><a-plane class="clickable" height="0.2" opacity-picker="" position="0 1.35 0" propogate-grab="" tooltip="-  Opacity  +" width="1.9"></a-plane><a-entity icon-row="mergeButtons: true; mergeIcons: false" id="project-palette" palette="" position="-1.55 -1.25 0"><a-entity click-action="addToPalette" icon-button="#asset-plus-box-outline" tooltip="Add color to project palette"></a-entity><a-entity button-style="color: #FFF; intersectedColor: #aaa" icon-button="" tooltip="#FFF"></a-entity><a-entity button-style="color: #000; intersectedColor: #333" icon-button="" tooltip="#000"></a-entity></a-entity><a-entity icon-button="#asset-arrow-left" position="-1.55 -1.7 0" toggle-button="target: #advanced-color-picker; component: visible; useUntoggledColor: false" tooltip="Precise Color Selection"></a-entity><a-entity icon-row="autoPosition: false; mergeButtons: true; mergeIcons: false" id="recent-colors" palette="maxCount: 5; allowDuplicates: false" position="-1.1 -1.7 0"></a-entity><a-entity id="advanced-color-picker" position="-4 -0.25 0" propogate-grab="" rotation="0 0 0" shelf="height: 3.6" visible="false"><a-entity eye-drop-tool="" position="-2.3 -1.7 0" preactivate-tooltip="Color Picker" scale="3 3 3" tooltip-style="scale: 0.3 0.3 1.0; offset: 0 -0.3 0"></a-entity><a-entity position="0 1.35 0"><a-entity icon-row="auto"><a-entity color-selector-lever="component: hue" lever="axis: y; valueRange: 0 360; gripRadius: 0.12"><a-entity class="label" position="-1.7 0 0" text="width: 1; wrapCount: 8; anchor: left"></a-entity><a-entity class="value" edit-field="" position="0.8 0 0" text="value: 360; width: 0.8; wrapCount: 4"></a-entity></a-entity></a-entity><a-entity icon-row=""><a-entity color-selector-lever="component: saturationl" lever="axis: y; valueRange: 0 100; gripRadius: 0.12" tooltip="Saturation"><a-entity class="label" position="-1.7 0 0" text="width: 1; wrapCount: 8; anchor: left"></a-entity><a-entity class="value" edit-field="" position="0.8 0 0" text="value: 360; width: 0.8; wrapCount: 4"></a-entity></a-entity></a-entity><a-entity icon-row=""><a-entity color-selector-lever="component: lightness" lever="axis: y; valueRange: 0 100; gripRadius: 0.12"><a-entity class="label" position="-1.7 0 0" text="width: 1; wrapCount: 8; anchor: left"></a-entity><a-entity class="value" edit-field="" position="0.8 0 0" text="value: 360; width: 0.8; wrapCount: 4"></a-entity></a-entity></a-entity><a-entity icon-row=""><a-entity color-selector-lever="component: red" lever="axis: y; valueRange: 0 255; gripRadius: 0.12"><a-entity class="label" position="-1.7 0 0" text="width: 1; wrapCount: 8; anchor: left"></a-entity><a-entity class="value" edit-field="" position="0.8 0 0" text="value: 360; width: 0.8; wrapCount: 4"></a-entity></a-entity></a-entity><a-entity icon-row=""><a-entity color-selector-lever="component: green" lever="axis: y; valueRange: 0 255; gripRadius: 0.12"><a-entity class="label" position="-1.7 0 0" text="width: 1; wrapCount: 8; anchor: left"></a-entity><a-entity class="value" edit-field="" position="0.8 0 0" text="value: 360; width: 0.8; wrapCount: 4"></a-entity></a-entity></a-entity><a-entity icon-row=""><a-entity color-selector-lever="component: blue" lever="axis: y; valueRange: 0 255; gripRadius: 0.12"><a-entity class="label" position="-1.7 0 0" text="width: 1; wrapCount: 8; anchor: left"></a-entity><a-entity class="value" edit-field="" position="0.8 0 0" text="value: 360; width: 0.8; wrapCount: 4"></a-entity></a-entity></a-entity><a-entity icon-row=""><a-entity><a-entity icon-button="#asset-dice-2" position="-1.5 0 0" toggle-button="target: a-scene; component: paint-system-settings; property: jitterColor" tooltip="Jitter Color"></a-entity></a-entity><a-entity color-entry-field="" edit-field="type: string; autoClear: true; tooltip: Enter CSS Value" text="width: 1; wrapCount: 8; value: #FFFFFF"></a-entity></a-entity></a-entity></a-entity>'},function(t,e){t.exports='<a-entity bypass-hidden-updates="" lock-axes="z: 0" lock-up="" scale="0.3 0.3 0.3" shelf="frame: true; name: Layer Control; pinnable: false"><a-entity icon-row="mergeButtons: true" position="-1.5 1.2 0"><a-entity click-action="prevLayer" icon-button="#asset-arrow-left" tooltip="Previous Layer"></a-entity><a-entity click-action="newLayer" icon-button="#asset-plus-box-outline" tooltip="New Layer"></a-entity><a-entity class="clickable" click-action="deleteLayer" icon-button="#asset-delete" tooltip="Delete Layer"></a-entity><a-entity click-action="expandLayers" icon-button="#asset-newspaper-variant-outline" tooltip="Expand Layer Controls"></a-entity><a-entity click-action="nextLayer" icon-button="#asset-arrow-right" tooltip="Next Layer"></a-entity></a-entity><a-entity canvas-updater="throttle: 800" geometry="primitive: plane; width: 3; height: 2" material="shader: flat; transparent: true; npot: true" propogate-grab=""></a-entity></a-entity>'},function(t,e){t.exports='<a-entity grab-root="" shelf="name: Constraints; pinnable: false; closable: true"><a-entity shelf-content=""><a-entity icon-row=""><a-entity icon-button="#asset-hand-right" organizer-grabbable-toggle="" tooltip="Grabbable"></a-entity></a-entity><a-entity icon-row=""><a-entity icon-row-text="Lock Transformations:"></a-entity></a-entity><a-entity icon-row="mergeButtons: true"><a-entity icon-button="" position="0 -9999999 0"></a-entity><a-entity icon-row-text="x"></a-entity><a-entity icon-button="#asset-lock-outline" organizer-lock-button="axis: x; prop: lockedPositionAxes" tooltip="Lock x position"></a-entity><a-entity icon-button="#asset-lock-outline" organizer-lock-button="axis: x; prop: lockedRotationAxes" tooltip="Lock x rotation"></a-entity><a-entity icon-button="#asset-lock-outline" organizer-lock-button="axis: x; prop: lockedScaleAxes" tooltip="Lock x scale"></a-entity></a-entity><a-entity icon-row="mergeButtons: true"><a-entity icon-button="" position="0 -9999999 0"></a-entity><a-entity icon-row-text="y"></a-entity><a-entity icon-button="#asset-lock-outline" organizer-lock-button="axis: y; prop: lockedPositionAxes" tooltip="Lock y position"></a-entity><a-entity icon-button="#asset-lock-outline" organizer-lock-button="axis: y; prop: lockedRotationAxes" tooltip="Lock y rotation"></a-entity><a-entity icon-button="#asset-lock-outline" organizer-lock-button="axis: y; prop: lockedScaleAxes" tooltip="Lock y scale"></a-entity></a-entity><a-entity icon-row="mergeButtons: true"><a-entity icon-button="" position="0 -9999999 0"></a-entity><a-entity icon-row-text="z"></a-entity><a-entity icon-button="#asset-lock-outline" organizer-lock-button="axis: z; prop: lockedPositionAxes" tooltip="Lock z position"></a-entity><a-entity icon-button="#asset-lock-outline" organizer-lock-button="axis: z; prop: lockedRotationAxes" tooltip="Lock z rotation"></a-entity><a-entity icon-button="#asset-lock-outline" organizer-lock-button="axis: z; prop: lockedScaleAxes" tooltip="Lock z scale"></a-entity></a-entity><a-entity lever="initialValue: 0.0; valueRange: 1.0 0.0; handleLength: 0.6" organizer-weight-lever="" position="2.6 -1.4 0" tooltip="Weight"></a-entity></a-entity></a-entity>'},function(t,e){t.exports='<a-entity class="grab-root" shelf="name: Controller Proxy; width: 1.25; height: 2.25" six-dof-tool=""><a-entity shelf-content=""><a-entity icon-row=""><a-entity icon-button="#asset-arrow-up-bold" position="0.225 0 0" proxy-button="trigger" scale="2 1 1"></a-entity></a-entity><a-entity icon-row=""><a-entity icon-button="" proxy-button="y" text="value: y; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" proxy-button="b" text="value: b; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity></a-entity><a-entity icon-row=""><a-entity icon-button="" proxy-button="x" text="value: x; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" proxy-button="a" text="value: a; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity></a-entity><a-entity icon-row=""><a-entity icon-button="#asset-hand-right" position="0.225 0 0" proxy-button="grip" scale="2 1 1"></a-entity></a-entity></a-entity></a-entity>'},function(t,e){t.exports='<a-entity scale="0.1 0.1 0.1" shelf="name: Controller Setup; closeable: true; width: 3"><a-entity shelf-content=""><a-entity icon-row=""><a-entity icon-button="#asset-rotate-orbit" system-click-action="system: pencil-tool; action: toggleGrabRotation" tooltip="Toggle Grab Rotation Lock"></a-entity><a-entity icon-button="#asset-hand-right" system-click-action="system: pencil-tool; action: toggleTriggerGrab" toggle-button="" tooltip="Toggle Trigger As Grab"></a-entity><a-entity icon-button="#asset-ear-hearing" toggle-button="target: #left-hand; component: left-hand-controls; property: enableSpeech" tooltip="Press Y for speech recognition"></a-entity><a-entity icon-button="#asset-dots-square" popup-button="popup: grid-options-shelf; deferred: true; autoScale: true" tooltip="Grid Options"></a-entity><a-entity controller-force-profile-button="" dropdown-button="options: generic-trigger-squeeze, oculus-touch, htc-vive-focus-3, hp-mixed-reality" icon-button="#asset-translate" tooltip="Force Controller Profile"></a-entity></a-entity><a-entity icon-row="" icon-row-text="Controller Smoothing"></a-entity><a-entity icon-row=""><a-entity lever="target: #right-hand; component: smoothed-webxr-motion-controller; property: amount; valueRange: 0.95 0; initialValue: 0.8; handleLength: 0.6" position="1 0 0" tooltip="Right Hand Smoothing"></a-entity><a-entity lever="target: #left-hand; component: smoothed-webxr-motion-controller; property: amount; valueRange: 0.95 0; initialValue: 0.8; handleLength: 0.6" position=" 0 0" tooltip="Left Hand Smoothing"></a-entity></a-entity></a-entity><a-entity controller-proxy="layout: left" position="2 0 0" scale="0.6 0.6 0.6"></a-entity><a-entity controller-proxy="layout: right" position="3 0 0" scale="0.6 0.6 0.6"></a-entity></a-entity>'},function(t,e){t.exports='<div class="crash-handler" id="crash-handler"><h2>Oh no! It looks like VARTISTE Crashed </h2><p>Really sorry about that. VARTISTE is a hobby project in active development,\nso unfortunately it&#39;s bound to happen. I&#39;d definitely appreciate if you file\na bug to report the crash at the <a href="https://gitlab.com/zach-geek/vartiste/-/issues/new?issue[assignee_id]=&amp;issue[milestone_id]=&amp;issue[title]=CrashDetection">issue list</a>\nor the <a href="https://discord.gg/vRHM8MYNby">Discord chat</a></p>\n<h2>Recovery Options</h2><p>There\'s a few things we can try to salvage whatever you\'ve been working on.</p><div id="recovery-attempt-message"></div><ul><li><a click-action="saveProject" href="#">Attempt to download the project file</a></li><li><a click-action="saveGLB" href="#">Attempt to export the GLB file</a></li><li><a click-action="saveLayers" href="#">Attempt to export each layer as a PNG</a></li><li><a click-action="dismiss" href="#">Ignore. This is not actually a crash</a></li></ul><h2>Error Information</h2><p>Here is some technical information about why this crash occurred</p><p><a href="https://gitlab.com/zach-geek/vartiste/-/issues/new?issue%5Btitle%5D=Crash">Click here to report this bug</a></p><code id="crash-stack-trace"></code></div>'},function(t,e){t.exports='<div class="desktop-controls hidden-in-vr"><a class="control" click-action="draw" icon-button="#asset-lead-pencil" tooltip="Draw"></a><a class="control" click-action="rotateCamera" icon-button="#asset-arrow-all" tooltip="Rotate Camera"></a><a class="control" click-action="grab" icon-button="#asset-hand-no-lines" tooltip="Grab"></a><a class="control" click-action="sample" icon-button="#asset-transition-masked" tooltip="Pick Color"></a><a class="control" click-action="rotateLeft" icon-button="#asset-arrow-left" tooltip="Rotate View Left"></a><a class="control" click-action="rotateRight" icon-button="#asset-arrow-right" tooltip="Rotate View Right"></a></div>'},function(t,e){t.exports='<a-entity scale="0.1 0.1 0.1" shelf="width: 3; height: 4"><a-entity shelf-content=""></a-entity></a-entity>'},function(t,e){t.exports='<div class="crash-handler" id="enter-vr-failed-handler"><h2>VR Mode Failed</h2><p>Sorry, it looks like we couldn&#39;t get you into virtual reality. Please make\nsure you&#39;ve got your virtual reality headset plugged in and turned on.\nVARTISTE works best with OpenXR, so please makes sure you&#39;ve got the right\nOpenXR provider configured.</p>\n<p>Please make sure your headset is plugged-in and active <em>before</em> loading this\npage. If not you may need to refresh the page before you can enter VR.</p>\n<div class="chrome-only"><p>For Chrome/Chromium on the desktop, please make sure the run time is set\nto OpenXR. You can do this by entering <code>chrome://flags</code> in the address\nbar, then typing <code>xr</code> into the search field, and then setting\n&quot;Force WebXr Runtime&quot; to <em>Open XR</em></p>\n<p>You may also need to start the browser using the <code>--disable-features=XRSandbox</code>\ncommand line flag. E.g.:</p>\n<p><code>chrome.exe --disable-features=XRSandbox https://vartiste.xyz</code></p>\n</div><p>There are some instructions for common headset types listed below:</p>\n<ul>\n<li><p><em>Windows Mixed Reality</em>: If there&#39;s a message that says something along\nthe lines of &quot;Windows Mixed Reality is not set up to run OpenXR apps&quot; when\nstarting Windows Mixed Reality, click the &quot;Fix it&quot; button then restart the\nbrowser.</p>\n</li>\n<li><p><em>SteamVR</em>: Under SteamVR settings, in the Developer tab, click\n&quot;Set SteamVR as OpenXR Runtime&quot;, restart the browser, and try again.</p>\n</li>\n<li><p><em>Oculus</em>: Follow the instructions <a href="https://flightsimulator.zendesk.com/hc/en-us/articles/360018555179-How-to-install-OpenXR-">here</a></p>\n</li>\n</ul>\n<p>If you continue having trouble entering VR, feel free to <a href="https://gitlab.com/zach-geek/vartiste/-/issues/new?issue%5Btitle%5D=EnterVR">file an issue on the issue tracker</a> or ask a question in the <a href="https://discord.gg/vRHM8MYNby">Discord chat</a></p>\n<a href="#" id="dismiss-and-ignore-enter-vr">Dismiss and ignore this issue</a></div>'},function(t,e){t.exports='<a-entity class="grab-root" id="environment-manager" scale="0.3 0.3 1" shelf="name: Environment Shelf; closeable: true" system-click-action="system: environment-manager" visible="false"><a-entity icon-row="mergeButtons: true; autoPosition: false" position="-1.6 -1.1 0"><a-entity icon-button="#asset-backspace-outline" system-click-action="action: reset" tooltip="Remove Environment"></a-entity><a-entity icon-button="#asset-blur-linear" system-click-action="action: toneMapping" tonemapping-tooltip="" tooltip="Change Tone Mapping" tooltip-style__tonemapping="offset: 0, -0.8 0; wrapCount: 14" tooltip__tonemapping="THREE.Linear"></a-entity><a-entity icon-button="#asset-brightness-4" popup-button="popup: environment-selector-popup; deferred: true; offset: 0 0.5 1.5" tooltip="Load Environment"></a-entity><a-entity icon-button="#asset-image-filter-hdr" system-click-action="action: setBackgroundColor" tooltip="Set Background Color"></a-entity><a-entity icon-button="" scale="0 0 0" visible="false"></a-entity><a-entity icon-button="#asset-record" system-click-action="action: useFlatShading" tooltip="Use Flat Shading"></a-entity><a-entity icon-button="#asset-blur-preview" system-click-action="action: installMatcap" tooltip="Use Matcap Shading"></a-entity><a-entity icon-button="#asset-brightness-4" system-click-action="action: use3DShading" tooltip="Use 3D Shading"></a-entity></a-entity><a-entity position="0.7 -0.5 0"><a-entity hide-low-power="" icon-button="#asset-bed" toggle-button="target: #environment-place; component: visible" tooltip="Show floor"></a-entity></a-entity><a-entity position="0.5 0 0" text="width: 1.7; wrapCount: 20; value: Drag and drop an HDRI onto the window to load it."></a-entity><a-entity class="bg-exposure" lever="valueRange: 2 0; initialValue: 1.0" position="-1.35 0.3 0" scale="2 2 2" tooltip="Adjust Background Brightness"></a-entity><a-entity lever="valueRange: 2 0; initialValue: 1.0; target: a-scene; component: environment-manager; property: envMapIntensity" position="-1.8 0.3 0" scale="2 2 2" tooltip="Background Intensity"></a-entity><a-entity class="renderer-exposure" lever="valueRange: 2 0; initialValue: 1.0; target: a-scene; component:  environment-manager; property: rendererExposure" position="-0.8 0.3 0" scale="2 2 2" tooltip="Camera Exposure"></a-entity><a-entity delete-low-power="" position="2.7 0 0" rotation="40 0 0"><a-entity light-tool="" preactivate-tooltip="Spot Light"></a-entity><a-entity light-tool="" light-tool-light="shadowRadius: 5; penumbra: 0.5" position="1 0 0" preactivate-tooltip="Soft Light"></a-entity><a-entity _tooltip-style="scale: 0.2 0.2 0.2" light-bauble="" position="2 0 0" preactivate-tooltip="Sun" scale="1 1 1"></a-entity></a-entity></a-entity>'},function(t,e){t.exports='<a-entity scale="0.05 0.05 0.05" shelf="width: 3; height: 4; closeable: true"><a-entity position="-1.1 1.7 0"><a-entity icon-row=""><a-entity icon-button="#asset-brightness-4" popup-action="close" system-click-action="system: environment-manager; action: usePresetHDRI" tooltip="Colorful space (old preset)"></a-entity><a-entity position="0.3 0 0" text="value: colorful space; width: 1.5; anchor: left; wrapCount: 15"></a-entity></a-entity><a-entity icon-row=""><a-entity icon-button="#asset-brightness-4" onclick="this.sceneEl.systems[\'environment-manager\'].useEnviropack(\'tankfarm\')" popup-action="close" tooltip="Use tankfarm environment"></a-entity><a-entity position="0.3 0 0" text="value: tankfarm; width: 1.5; anchor: left; wrapCount: 15"></a-entity></a-entity><a-entity icon-row=""><a-entity icon-button="#asset-brightness-4" onclick="this.sceneEl.systems[\'environment-manager\'].useEnviropack(\'sandstone\')" popup-action="close" tooltip="Use sandstone environment"></a-entity><a-entity position="0.3 0 0" text="value: sandstone; width: 1.5; anchor: left; wrapCount: 15"></a-entity></a-entity><a-entity icon-row=""><a-entity icon-button="#asset-brightness-4" onclick="this.sceneEl.systems[\'environment-manager\'].useEnviropack(\'autumn\')" popup-action="close" tooltip="Use autumn environment"></a-entity><a-entity position="0.3 0 0" text="value: autumn; width: 1.5; anchor: left; wrapCount: 15"></a-entity></a-entity><a-entity icon-row=""><a-entity icon-button="#asset-brightness-4" onclick="this.sceneEl.systems[\'environment-manager\'].useEnviropack(\'winter\')" popup-action="close" tooltip="Use winter environment"></a-entity><a-entity position="0.3 0 0" text="value: winter; width: 1.5; anchor: left; wrapCount: 15"></a-entity></a-entity><a-entity icon-row=""><a-entity icon-button="#asset-brightness-4" onclick="this.sceneEl.systems[\'environment-manager\'].useEnviropack(\'interior\')" popup-action="close" tooltip="Use interior environment"></a-entity><a-entity position="0.3 0 0" text="value: interior; width: 1.5; anchor: left; wrapCount: 15"></a-entity></a-entity><a-entity icon-row=""><a-entity icon-button="#asset-brightness-4" onclick="this.sceneEl.systems[\'environment-manager\'].useEnviropack(\'night\')" popup-action="close" tooltip="Use night environment"></a-entity><a-entity position="0.3 0 0" text="value: night; width: 1.5; anchor: left; wrapCount: 15"></a-entity></a-entity></a-entity></a-entity>'},function(t,e){t.exports='<a-entity class="grab-root" scale="0.05 0.05 0.05" shelf="name: Export; closeable: true; height: 4.3"><a-entity shelf-content=""><a-entity icon-row=""><a-entity icon-row-text="Export Options:"></a-entity></a-entity><a-entity icon-row="mergeButtons: true"><a-entity icon-button="#asset-arrow-collapse-vertical" toggle-button="target: a-scene; component: settings-system; property: exportJPEG" tooltip="Use JPEG Compression"></a-entity></a-entity><a-entity icon-row=""><a-entity icon-row-text="2D Export Actions:"></a-entity></a-entity><a-entity icon-row=""><a-entity icon-button="#asset-camera" system-click-action="system: settings-system; action: exportAction" tooltip="Export as PNG/JPEG"></a-entity><a-entity icon-button="#asset-brightness-4" toolbox-click-action="captureRender" tooltip="Capture Rendered PNG"></a-entity><a-entity icon-button="#asset-palette-swatch-outline" toolbox-click-action="downloadAllLayers" tooltip="Download each layer individually"></a-entity></a-entity><a-entity icon-row=""><a-entity icon-row-text="Include in 3D Export:"></a-entity></a-entity><a-entity icon-row=""><a-entity icon-button="#asset-brush" toggle-button="target: a-scene; component: export-3d-helper-system; property: exportCanvas" tooltip="Include Canvas"></a-entity><a-entity icon-button="#asset-web" toggle-button="target: a-scene; component: export-3d-helper-system; property: exportMesh" tooltip="Include Drawable Mesh"></a-entity><a-entity icon-button="#asset-shape-outline" toggle-button="target: a-scene; component: export-3d-helper-system; property: exportShapes" tooltip="Include Shapes"></a-entity><a-entity icon-button="#asset-skeletonator" toggle-button="target: a-scene; component: export-3d-helper-system; property: exportReferenceObjects" tooltip="Include Reference Objects"></a-entity><a-entity icon-button="#asset-newspaper-variant-outline" toggle-button="target: a-scene; component: export-3d-helper-system; property: exportReferenceImages" tooltip="Include Reference Images"></a-entity></a-entity><a-entity icon-row=""><a-entity icon-row-text="3D Export Actions:"></a-entity></a-entity><a-entity icon-row="mergeButtons: true"><a-entity icon-button="#asset-cube-send" system-click-action="system: export-3d-helper-system; action: export3dAction" tooltip="Export GLB File"></a-entity><a-entity icon-button="#asset-skeletonator" system-click-action="system: export-3d-helper-system; action: cloneAsReference" tooltip="Create Reference Mesh"></a-entity><a-entity icon-button="#asset-sketchfab" popup-button="popup: sketchfab-shelf; deferred: true" tooltip="Sketchfab"></a-entity></a-entity></a-entity></a-entity>'},function(t,e){t.exports='<a-entity shelf="closeable: true; pinnable: false; width: 2.3"><a-entity shelf-content=""><a-entity icon-row="mergeButtons: true"><a-entity icon-button="" text="value: .; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: ,; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: :; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: /; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity></a-entity><a-entity icon-row="mergeButtons: true"><a-entity icon-button="" text="value: \\; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: [; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: ]; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: (; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity></a-entity><a-entity icon-row="mergeButtons: true"><a-entity icon-button="" text="value: ); color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: -; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: =; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: !; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity></a-entity><a-entity icon-row="mergeButtons: true"><a-entity icon-button="" text="value: @; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: #; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: $; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: %; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity></a-entity><a-entity icon-row="mergeButtons: true"><a-entity icon-button="" text="value: ^; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: &amp;; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: *; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity></a-entity></a-entity></a-entity>'},function(t,e){t.exports='<a-entity shelf="name: VARTISTE Extras; pinnable: false; closeable: true"><a-entity shelf-content=""></a-entity></a-entity>'},function(t,e){t.exports='<a-entity shelf="Name: Extras Shelf; closeable: true; height: 5; pinnable: false"><a-entity shelf-content=""><a-entity icon-row=""><a-entity icon-row-text="Load Extras:"></a-entity></a-entity><a-entity icon-row="mergeButtons: true"><a-entity icon-button="#asset-newspaper-variant-outline" tooltip="Reference Images" vartiste-extras-popup="category: reference-images; forceReference: true"></a-entity><a-entity icon-button="#asset-web" tooltip="Reference Models" vartiste-extras-popup="category: reference-models; forceReference: true"></a-entity><a-entity icon-button="#asset-lead-pencil" tooltip="Drawable Models" vartiste-extras-popup="category: reference-models; forceReference: false"></a-entity><a-entity icon-button="#asset-palette-swatch-outline" tooltip="Material Packs" vartiste-extras-popup="category: material-packs"></a-entity><a-entity icon-button="#asset-brush" tooltip="Brush Packs" vartiste-extras-popup="category: brush-packs"></a-entity><a-entity icon-button="#asset-image-filter-hdr" tooltip="HDRI Environments" vartiste-extras-popup="category: hdris"></a-entity><a-entity icon-button="#asset-folder-open-outline" tooltip="Projects" vartiste-extras-popup="category: projects"></a-entity></a-entity><a-entity icon-row=""><a-entity icon-row-text="Extras Sources:"></a-entity></a-entity><a-entity icon-row=""><a-entity position="0.4 0 0" text="value: Only add extras sources that you trust!; width: 2; wrapCount: 20; anchor: left"></a-entity><a-entity add-extras-edit-field="" icon-button="#asset-plus-box-outline" tooltip="Add Extras Source"></a-entity></a-entity><a-entity extras-sources-list="" icon-row=""></a-entity></a-entity></a-entity>'},function(t,e){t.exports='<a-entity class="node-shelf grab-root" shelf=""><a-entity position="0 1.2 0"><a-entity click-action="delete" icon-button="#asset-delete" tooltip="Delete Node"></a-entity></a-entity><a-entity class="frame-offset" edit-field="tooltip: Frame Offset" text="value: 0; width: 2; wrapCount: 5"></a-entity><a-entity node-output="" position="2.1 1.2 0.01"></a-entity><a-entity material="color: #34d8eb" node-input="type: destination" position="-2.1 1.2 0.01"></a-entity></a-entity>'},function(t,e){t.exports='<a-entity scale="0.05 0.05 0.05" shelf="width: 5; height: 4; closeable: true"><a-entity position="-1.5 1.5 0"><a-entity position="0  0"><a-entity hidden-tooltip="blur" icon-button="#asset-blur-linear" node-fx="blur" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity text="value: blur; width: 1; wrapCount: 15"></a-entity></a-entity><a-entity position="0 -0.5 0"><a-entity hidden-tooltip="nudge" icon-button="#asset-blur-linear" node-fx="nudge" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity text="value: nudge; width: 1; wrapCount: 15"></a-entity></a-entity><a-entity position="0 -1 0"><a-entity hidden-tooltip="scatter" icon-button="#asset-blur-linear" node-fx="scatter" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity text="value: scatter; width: 1; wrapCount: 15"></a-entity></a-entity><a-entity position="0 -1.5 0"><a-entity hidden-tooltip="noise" icon-button="#asset-blur-linear" node-fx="noise" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity text="value: noise; width: 1; wrapCount: 15"></a-entity></a-entity><a-entity position="0 -2 0"><a-entity hidden-tooltip="drip" icon-button="#asset-blur-linear" node-fx="drip" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity text="value: drip; width: 1; wrapCount: 15"></a-entity></a-entity><a-entity position="0 -2.5 0"><a-entity hidden-tooltip="dilate" icon-button="#asset-blur-linear" node-fx="dilate" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity text="value: dilate; width: 1; wrapCount: 15"></a-entity></a-entity><a-entity position="1.5  0"><a-entity hidden-tooltip="hq-blending" icon-button="#asset-blur-linear" node-fx="hq-blending" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity text="value: hq-blending; width: 1; wrapCount: 15"></a-entity></a-entity><a-entity position="1.5 -0.5 0"><a-entity hidden-tooltip="oklab-blend" icon-button="#asset-blur-linear" node-fx="oklab-blend" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity text="value: oklab-blend; width: 1; wrapCount: 15"></a-entity></a-entity></a-entity></a-entity>'},function(t,e){t.exports='<a-entity scale="0.05 0.05 0.05" shelf="width: 5; height: 4; closeable: true"><a-entity position="-1.5 1.5 0"><a-entity position="0  0"><a-entity hidden-tooltip="blur" icon-button="#asset-blur-linear" node-fx="blur" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity text="value: blur; width: 1; wrapCount: 15"></a-entity></a-entity><a-entity position="0 -0.5 0"><a-entity hidden-tooltip="noise" icon-button="#asset-blur-linear" node-fx="noise" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity text="value: noise; width: 1; wrapCount: 15"></a-entity></a-entity><a-entity position="0 -1 0"><a-entity hidden-tooltip="dither" icon-button="#asset-blur-linear" node-fx="dither" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity text="value: dither; width: 1; wrapCount: 15"></a-entity></a-entity><a-entity position="0 -1.5 0"><a-entity hidden-tooltip="dilate" icon-button="#asset-blur-linear" node-fx="dilate" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity text="value: dilate; width: 1; wrapCount: 15"></a-entity></a-entity><a-entity position="0 -2 0"><a-entity hidden-tooltip="erode" icon-button="#asset-blur-linear" node-fx="erode" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity text="value: erode; width: 1; wrapCount: 15"></a-entity></a-entity><a-entity position="0 -2.5 0"><a-entity hidden-tooltip="flip-x" icon-button="#asset-blur-linear" node-fx="flip-x" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity text="value: flip-x; width: 1; wrapCount: 15"></a-entity></a-entity><a-entity position="1.5  0"><a-entity hidden-tooltip="flip-y" icon-button="#asset-blur-linear" node-fx="flip-y" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity text="value: flip-y; width: 1; wrapCount: 15"></a-entity></a-entity><a-entity position="1.5 -0.5 0"><a-entity hidden-tooltip="grayscale-to-alpha" icon-button="#asset-blur-linear" node-fx="grayscale-to-alpha" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity text="value: grayscale-to-alpha; width: 1; wrapCount: 15"></a-entity></a-entity><a-entity position="1.5 -1 0"><a-entity hidden-tooltip="alpha-to-grayscale" icon-button="#asset-blur-linear" node-fx="alpha-to-grayscale" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity text="value: alpha-to-grayscale; width: 1; wrapCount: 15"></a-entity></a-entity><a-entity position="1.5 -1.5 0"><a-entity hidden-tooltip="invert" icon-button="#asset-blur-linear" node-fx="invert" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity text="value: invert; width: 1; wrapCount: 15"></a-entity></a-entity><a-entity position="1.5 -2 0"><a-entity hidden-tooltip="uv-offset" icon-button="#asset-blur-linear" node-fx="uv-offset" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity text="value: uv-offset; width: 1; wrapCount: 15"></a-entity></a-entity><a-entity position="1.5 -2.5 0"><a-entity hidden-tooltip="show-uv" icon-button="#asset-blur-linear" node-fx="show-uv" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity text="value: show-uv; width: 1; wrapCount: 15"></a-entity></a-entity><a-entity position="3  0"><a-entity hidden-tooltip="srgb-to-linear" icon-button="#asset-blur-linear" node-fx="srgb-to-linear" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity text="value: srgb-to-linear; width: 1; wrapCount: 15"></a-entity></a-entity><a-entity position="3 -0.5 0"><a-entity hidden-tooltip="linear-to-srgb" icon-button="#asset-blur-linear" node-fx="linear-to-srgb" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity text="value: linear-to-srgb; width: 1; wrapCount: 15"></a-entity></a-entity><a-entity position="3 -1 0"><a-entity hidden-tooltip="swizzle" icon-button="#asset-blur-linear" node-fx="swizzle" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity text="value: swizzle; width: 1; wrapCount: 15"></a-entity></a-entity><a-entity position="3 -1.5 0"><a-entity hidden-tooltip="bump-to-normal" icon-button="#asset-blur-linear" node-fx="bump-to-normal" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity text="value: bump-to-normal; width: 1; wrapCount: 15"></a-entity></a-entity></a-entity></a-entity>'},function(t,e){t.exports='<a-entity class="node-shelf grab-root" shelf=""><a-entity position="0 1.2 0"><a-entity click-action="delete" icon-button="#asset-delete" tooltip="Delete Node"></a-entity><a-entity click-action="freeze" icon-button="#asset-archive-arrow-down-outline" tooltip="Convert to Layer"></a-entity></a-entity><a-entity position="-2.5 -1.3 0"><a-entity class="fx-text" popup-button="tooltip: Change FX; icon: #asset-blur-linear; deferred: true; popup: fx-popup" position="0.5 0.05 0" text="value: FX: blur; color: #f83; width: 4"></a-entity></a-entity><a-entity node-output="" position="2.1 1.2 0.01"></a-entity><a-entity canvas-updater="throttle: 800" geometry="primitive: plane; width: 3; height: 2" material="shader: flat; transparent: true; npot: true"></a-entity><a-entity position="1.7 0 0"><a-entity class="clickable" geometry="primitive: plane; width: 2; height: 0.3" opacity-picker="" propogate-grab="" rotation="0 0 90"></a-entity></a-entity><a-entity material="color: #34d8eb" node-input="type: destination" position="-2.1 1.2 0.01"></a-entity><a-entity node-input="type: source; index: " position="-2.1 0.7 0.01"></a-entity></a-entity>'},function(t,e){t.exports='<a-entity shelf="name: Grid Options; closeable: true"><a-entity shelf-content=""><a-entity icon-row=""><a-entity icon-button="#asset-dots-square" toggle-button="target: a-scene; component: manipulator-snap-grid; property: enabled" tooltip="Snap to grid"></a-entity></a-entity><a-entity icon-row=""><a-entity edit-field="target: a-scene; component: manipulator-snap-grid; property: spacingCubeSize; tooltip: Grid Spacing; type: float" text="width: 3; anchor: right; align: right; xOffset: 1.5; wrapCount: 14"></a-entity></a-entity></a-entity></a-entity>'},function(t,e){t.exports='<a-entity shelf="name: Hubs Connector; closeable: true; height: 1"><a-entity shelf-content=""><a-entity icon-row=""><a-entity icon-button="" tooltip="Connect to Hubs Connector"></a-entity><a-entity icon-button="" tooltip="Set canvas mode for sharing"></a-entity></a-entity></a-entity></a-entity>'},function(t,e){t.exports='<a-entity shelf="width: 5; height: 3.4; frame: false"><a-entity shelf-content=""><a-entity icon-row=""><a-entity class="value" position="4.0 0 0" text="width: 4.8; wrapCount: 26; value:project; align: right; anchor: right"></a-entity></a-entity><a-entity icon-row="mergeButtons: true" position="0 0 0"><a-entity icon-button="" text="value: 0; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: 1; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: 2; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: 3; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: 4; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: 5; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: 6; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: 7; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: 8; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: 9; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity></a-entity><a-entity icon-row="mergeButtons: true;" position="0.0 0.0 0"><a-entity icon-button="" text="value: q; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: w; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: e; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: r; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: t; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: y; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: u; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: i; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: o; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: p; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity></a-entity><a-entity icon-row="mergeButtons: true;" position="0.2 0.0 0"><a-entity icon-button="" text="value: a; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: s; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: d; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: f; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: g; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: h; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: j; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: k; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: l; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity></a-entity><a-entity icon-row="mergeButtons: true" position="0.4 0 0"><a-entity icon-button="" text="value: z; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: x; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: c; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: v; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: b; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: n; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: m; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity></a-entity><a-entity icon-row="mergeButtons: true" position="0.0 0"><a-entity icon-button="" text="value: .; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: _; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: -; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value:  ; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="#asset-plus-box-outline" popup-button="deferred: true; autoScale: true; popup: extra-keys" tooltip="More Symbols"></a-entity><a-entity action="paste" icon-button="#asset-archive-arrow-down-outline" tooltip="paste"></a-entity><a-entity icon-button="#asset-ear-hearing" speech-recognition-button=""></a-entity><a-entity action="clear" icon-button="#asset-close" tooltip="clear"></a-entity><a-entity action="backspace" icon-button="#asset-backspace-outline" tooltip="backspace"></a-entity><a-entity action="ok" icon-button="#asset-check-outline" tooltip="ok"></a-entity></a-entity></a-entity></a-entity>'},function(t,e){t.exports='<a-entity scale="0.3 0.3 1" shelf="name: Kromophone"><a-entity icon-row="" position="-1.6 1.1 0"><a-entity icon-button="#asset-play-pause" toggle-button="target: a-scene; component: kromophone; property: active" tooltip="Play / Pause sonification"></a-entity><a-entity icon-button="#asset-brush" radio-button="target: a-scene; component: kromophone; property: source; value: paint" tooltip="Sonify paint color"></a-entity><a-entity icon-button="#asset-camera" radio-button="target: a-scene; component: kromophone; property: source; value: camera" tooltip="Sonify display center"></a-entity></a-entity></a-entity>'},function(t,e){t.exports='<a-entity scale="0.1 0.1 0.1" shelf="name: Language; closeable: true"><a-entity shelf-content=""><a-entity icon-row=""><a-entity icon-button="#asset-translate" onclick="this.sceneEl.setAttribute(\'ui-translation\', \'language: en\')" popup-action="close" tooltip="English"></a-entity><a-entity position="0.45" text="anchor: left; value: English; width: 2.5; wrapCount: 20"></a-entity></a-entity><a-entity icon-row=""><a-entity icon-button="#asset-translate" onclick="this.sceneEl.setAttribute(\'ui-translation\', \'language: pt\')" popup-action="close" tooltip="Portugus"></a-entity><a-entity position="0.45" text="anchor: left; value: Portugus; width: 2.5; wrapCount: 20"></a-entity></a-entity><a-entity icon-row=""><a-entity icon-button="#asset-translate" onclick="this.sceneEl.setAttribute(\'ui-translation\', \'language: es\')" popup-action="close" tooltip="Espaol"></a-entity><a-entity position="0.45" text="anchor: left; value: Espaol; width: 2.5; wrapCount: 20"></a-entity></a-entity></a-entity></a-entity>'},function(t,e){t.exports='<a-entity class="layer-shelf" shelf="frame: true; name: Layer Control; pinnable: false"><a-entity icon-row="mergeButtons: true" position="-1.5 1.2 0"><a-entity class="clickable" click-action="hide" icon-button="#asset-eye" tooltip="Hide Layer"></a-entity><a-entity class="clickable" click-action="edit" icon-button="#asset-brush" tooltip="Activate Layer"></a-entity><a-entity class="clickable" click-action="grab" icon-button="#asset-arrow-all" tooltip="Grab Layer"></a-entity><a-entity class="clickable" click-action="duplicate" icon-button="#asset-plus-box-multiple" tooltip="Duplicate Layer"></a-entity><a-entity class="clickable" click-action="delete" icon-button="#asset-delete" tooltip="Delete Layer"></a-entity><a-entity class="clickable" click-action="moveUp" icon-button="#asset-arrow-up-bold" tooltip="Move Layer Up"></a-entity><a-entity class="clickable" click-action="moveDown" icon-button="#asset-arrow-down-bold" tooltip="Move Layer Down"></a-entity><a-entity class="clickable" click-action="new" icon-button="#asset-plus-box-outline" tooltip="New Layer"></a-entity></a-entity><a-entity canvas-updater="throttle: 800" geometry="primitive: plane; width: 3; height: 2" material="shader: flat; transparent: true; npot: true" propogate-grab=""></a-entity><a-entity class="active-indicator" visible="false"><a-entity geometry="primitive: cone; height: 0.4; radiusBottom: 0.1; radiusTop: 0; segmentsRadial: 4; segmentsHeight: 2" material="shader: standard; metalness: 0.4; color: #a88d32; emissive: #a88d32; emissiveIntensity: 0.8" position="-2.1 0 0" rotation="0 0 -90" scale="1 1 0.3"></a-entity><a-entity geometry="primitive: cone; height: 0.4; radiusBottom: 0.1; radiusTop: 0; segmentsRadial: 4; segmentsHeight: 2" material="shader: standard; metalness: 0.4; color: #a88d32; emissive: #a88d32; emissiveIntensity: 0.8" position="2.1 0 0" rotation="0 0 90" scale="1 1 0.3"></a-entity></a-entity><a-entity class="grabbing-indicator" visible="false"><a-entity gltf-model="#asset-hand" material="shader: standard; metalness: 0.4; color: #a88d32; emissive: #a88d32; emissiveIntensity: 0.8" position="-2.1 0 0" rotation="0 0 -90" scale="1 1 0.3" shadow="cast: false; receive: false"></a-entity><a-entity gltf-model="#asset-hand" material="shader: standard; metalness: 0.4; color: #a88d32; emissive: #a88d32; emissiveIntensity: 0.8" position="2.1 0 0" rotation="0 0 90" scale="1 1 0.3" shadow="cast: false; receive: false"></a-entity></a-entity><a-entity class="invisible-indicator" geometry="primitive: plane; width: 1; height: 1" material="src: #asset-eye-off; alphaTest: 0.01; transparent: true; color: #fff" position="0 0 0.01"><a-entity geometry="primitive: plane; width: 1; height: 1" material="src: #asset-eye-off; alphaTest: 0.01; transparent: true; color: #fff; blending: subtractive" position="0 0 0.01" scale="0.9 0.9 1"></a-entity></a-entity><a-entity icon-row="autoPosition: false; mergeButtons: true; mergeIcons: false"><a-entity class="mode-popup" icon-button="#asset-blur-linear" popup-button="popup: mode-shelf; icon: #asset-blur-linear; deferred: true; tooltip: Change layer blend mode; scale: 0.3 0.3 0.3" position="-1.7 -1.3 0"></a-entity><a-entity class="mode-text" position="-1.4 -1.3 0" text="value: Mode: source-over; color: #f83; width: 4; anchor: left"></a-entity><a-entity click-action="mergeDown" icon-button="#asset-archive-arrow-down-outline" position="1.2 -1.2 0" tooltip="Stamp layer downward"></a-entity><a-entity click-action="popout" icon-button="#asset-palette-swatch-outline" position="0.75 -0.7 0" tooltip="Pop Out"></a-entity><a-entity click-action="resample" icon-button="#asset-resize" position="0.3 -0.2 0" tooltip="Resample To Size on Settings Shelf"></a-entity></a-entity><a-entity class="frame-count" position="1.0 -1.2 0" text="width: 0.5; wrapCount: 4; align: right"></a-entity><a-entity position="-1.7 0 0"><a-entity class="clickable" geometry="primitive: plane; width: 2; height: 0.3" opacity-picker="" propogate-grab="" rotation="0 0 90"></a-entity></a-entity><a-entity node-output="" position="2.1 1.2 0.01" scale="1 1 0.3"></a-entity></a-entity>'},function(t,e){t.exports='<a-entity icon-button="#asset-folder-open-outline" project-action="open" tooltip="Load Project"></a-entity><a-entity icon-button="#asset-delete" project-action="delete" tooltip="Delete Project"></a-entity><a-entity class="name" position="2.5 0 0" text="width: 3; wrapCount: 20"></a-entity><a-entity class="preview" geometry="primitive: plane; width: 0.5; height: 0.5" material="shader:flat" position="4 0 0"></a-entity>'},function(t,e){t.exports='<a-entity load-shelf="" scale="0.04 0.04 0.04" shelf="width: 4.5; height: 7; closeable: true"><a-entity position="0 3.2 0"><a-entity text="width: 3; wrapCount: 24; value: You can also load a file by drag and dropping it here." translate-text=""></a-entity><a-image position="1.8 0 0" scale="0.5 0.5 1" src="#asset-drag-and-drop"></a-image></a-entity><a-entity click-action="browse" icon-button="#asset-folder-open-outline" position="-2.0 3.2 0" tooltip="Browse for file"></a-entity><a-entity><a-entity icon-button="#asset-plus-box-outline" popup-button="popup: extras-shelf; deferred: true; autoScale: true" position="-2.0 2.65 0" tooltip="Load Extras"></a-entity></a-entity><a-entity position="-0.8 2.7 0"><a-entity edit-field="tooltip: Edit URL to Open; type: string; autoClear: true" id="load-url-field" text="value: Or Open a URL:; width: 4; wrapCount: 35"></a-entity><a-entity click-action="loadURLField" icon-button="#asset-folder-open-outline" position="2.75 0 0" tooltip="Load URL"></a-entity></a-entity><a-entity class="old-domain" visible="false"><a-entity position="0 -3.1 0" text="width: 4; wrapCount: 50; value: Looking for projects saved with old VARTISTE domain?\\nPlease download and import them into the new location"></a-entity><a-entity click-action="openOldDomain" icon-button="#asset-help-circle-outline" position="2.1 -3.1 0" tooltip="Open old domain"></a-entity></a-entity><a-entity position="-2 2.1 0"><a-entity icon-row=""><a-entity text="anchor: left; align: left; value: Mesh import options:"></a-entity></a-entity><a-entity icon-row="mergeButtons: true"><a-entity icon-button="#asset-badge-account-horizontal-outline" toggle-button="target: a-scene; component: settings-system; property: addReferences; " tooltip="Import as Reference Object"></a-entity><a-entity icon-button="#asset-close" toggle-button="target: a-scene; component: file-upload; property: replaceMesh" tooltip="Replace mesh on import"></a-entity><a-entity icon-button="#asset-resize" toggle-button="target: a-scene; component: file-upload; property: autoscaleModel" tooltip="Autoscale mesh on import"></a-entity><a-entity icon-button="#asset-transition" toggle-button="target: a-scene; component: file-upload; property: importMaterial" tooltip="Import Material"></a-entity><a-entity icon-button="#asset-arrow-collapse-vertical" toggle-button="target: a-scene; component: file-upload; property: combineMaterials" tooltip="Combine Import Materials"></a-entity><a-entity icon-button="#asset-oven" toggle-button="target: a-scene; component: file-upload; property: postProcessMesh" tooltip="Post-process Imported Mesh"></a-entity></a-entity><a-entity icon-row="" position="2 0 0"><a-entity class="projects"></a-entity></a-entity></a-entity></a-entity>'},function(t,e){t.exports='<div id="loading-page"><div class="bottom-bar"><h1>Loading VARTISTE</h1><div class="loading-bar"><div class="loading-progress"></div></div><p>Please be patient. This may take a while.</p></div></div>'},function(t,e){t.exports='<a-entity scale="0.05 0.05 0.05" shelf="name: Manipulator Info; closeable: true" six-dof-tool=""><a-entity manipulator-info-text="" text="wrapCount: 80; value: Manipulator Element Info; width: 3"></a-entity><a-entity copy-manipulator-info-text="" icon-button="#asset-palette-swatch-outline" position="1.5 -1.0 0" tooltip="Copy"></a-entity></a-entity>'},function(t,e){t.exports='<a-entity class="grab-root" scale="0.3 0.3 0.3" shelf="name: Manipulator Omnitool"><a-entity icon-row="" position="-1.5 1.0 0"><a-entity icon-button="#asset-hand-right" toggle-button="" tooltip="Weighted"></a-entity><a-entity icon-button="#asset-rotate-orbit" tooltip="Reset Orientation"></a-entity><a-entity icon-button="#asset-nudge-brush" tooltip="Summon"></a-entity><a-entity click-action="freeze" icon-button="#asset-bed" tooltip="Freeze"></a-entity><a-entity click-action="unfreeze" icon-button="#asset-cube-send" tooltip="unFreeze"></a-entity></a-entity><a-entity scale="2 2 2"></a-entity><a-entity><a-entity lever="handleLength: 1.5; gripRadius: 0.1; target: #canvas-view; component: rotation; property: y; valueRange: 90 -90" position="0 -1.5 0" rotation="0 0 -90" set-target="lever"></a-entity><a-entity lever="axis: z; handleLength: 1.5; gripRadius: 0.1; target: #canvas-view; component: rotation; property: x; valueRange: -90 90" position="-2 0 0" set-target="lever"></a-entity><a-entity lever="axis: x; handleLength: 1.5; gripRadius: 0.1; target: #canvas-view; component: rotation; property: z; valueRange: 90 -90" position="2 0 0" set-target="lever"></a-entity></a-entity></a-entity>'},function(t,e){t.exports='<a-entity class="view clickable grab-root" frame="closable: true; closePopup: true; outline: false; pinnable: false" geometry="primitive: plane; width: 1.3; height: 1.3" grab-activate="" material="shader: standard; side: double" six-dof-tool="summonable: false"><a-entity expandable-shelf="extraHeight: 0.2" position="0 -0.80 0" propogate-grab="" shelf="frame: false; width: 1.3; height: 0.295;"><a-entity position="-0.5 0 0" scale="0.45 0.45 0.45"><a-entity icon-row="mergeButtons: true"><a-entity click-action="fillMaterial" icon-button="#asset-format-color-fill" tooltip="Fill Material"></a-entity><a-entity click-action="activateMask" icon-button="#asset-brush" toggle-button="useUntoggledColor: false" tooltip="Draw with Material"></a-entity><a-entity click-action="setLayerMaterial" icon-button="#asset-resize" tooltip="Set Layer Material"></a-entity><a-entity click-action="increaseRepeat" icon-button="#asset-chevron-up" tooltip="Increase Repeat"></a-entity><a-entity click-action="decreaseRepeat" icon-button="#asset-chevron-down" tooltip="Decrease Repeat"></a-entity><a-entity click-action="rotate" icon-button="#asset-rotate-3d-variant" tooltip="Rotate"></a-entity></a-entity><a-entity class="expanded map-row" icon-row="mergeButtons: true"><a-entity icon-button="#asset-brush" map="src" tooltip="Use Material Color"></a-entity><a-entity icon-button="#asset-arrow-collapse-left" map="normalMap" tooltip="Draw Normal Map"></a-entity><a-entity icon-button="#asset-blur-linear" map="roughnessMap" tooltip="Draw Roughness Map"></a-entity><a-entity icon-button="#asset-brightness-4" map="metalnessMap" tooltip="Draw Metalness Map"></a-entity><a-entity icon-button="#asset-image-filter-hdr" map="aoMap" tootlip="Draw Ambient Occlusion Map"></a-entity></a-entity></a-entity></a-entity></a-entity>'},function(t,e){t.exports='<a-entity class="node-shelf" shelf="width: 1.5"><a-entity material="color: #34d8eb" node-input="type: canvas" position="-0.8 1.0 0.01"></a-entity><a-entity node-input="type: bumpMap" position="-0.8 0.7 0.01"></a-entity><a-entity position="-0.13 0.7 0.01" text="value: bumpMap; align: left; wrapCount: 15"></a-entity><a-entity node-input="type: displacementMap" position="-0.8 0.39999999999999997 0.01"></a-entity><a-entity position="-0.13 0.39999999999999997 0.01" text="value: displacementMap; align: left; wrapCount: 15"></a-entity><a-entity node-input="type: normalMap" position="-0.8 0.09999999999999998 0.01"></a-entity><a-entity position="-0.13 0.09999999999999998 0.01" text="value: normalMap; align: left; wrapCount: 15"></a-entity><a-entity node-input="type: emissiveMap" position="-0.8 -0.19999999999999996 0.01"></a-entity><a-entity position="-0.13 -0.19999999999999996 0.01" text="value: emissiveMap; align: left; wrapCount: 15"></a-entity><a-entity node-input="type: metalnessMap" position="-0.8 -0.5 0.01"></a-entity><a-entity position="-0.13 -0.5 0.01" text="value: metalnessMap; align: left; wrapCount: 15"></a-entity><a-entity node-input="type: roughnessMap" position="-0.8 -0.8 0.01"></a-entity><a-entity position="-0.13 -0.8 0.01" text="value: roughnessMap; align: left; wrapCount: 15"></a-entity><a-entity node-input="type: envMap" position="-0.8 -1.0999999999999999 0.01"></a-entity><a-entity position="-0.13 -1.0999999999999999 0.01" text="value: envMap; align: left; wrapCount: 15"></a-entity><a-entity node-input="type: aoMap" position="-0.8 -1.4000000000000001 0.01"></a-entity><a-entity position="-0.13 -1.4000000000000001 0.01" text="value: aoMap; align: left; wrapCount: 15"></a-entity><a-entity node-input="type: matcap" position="-0.8 -1.7 0.01"></a-entity><a-entity position="-0.13 -1.7 0.01" text="value: matcap; align: left; wrapCount: 15"></a-entity></a-entity>'},function(t,e){t.exports='<a-entity class="grab-root" id="mesh-tools-shelf" scale="0.3 0.3 1" shelf="name: Mesh Tools Shelf; closeable: true; height: 4.3; width: 4.5" visible="false"><a-entity shelf-content=""><a-entity icon-row=""><a-entity icon-row-text="UV Shape Unwrapping"></a-entity></a-entity><a-entity icon-row="mergeButtons: true"><a-entity icon-button="#asset-delete" toggle-button="target: a-scene; component: uv-unwrapper; property: autoClear" tooltip="Clear Existing UVs when unwrapping"></a-entity><a-entity icon-button="#asset-web" system-click-action="system: uv-unwrapper; action: createSphere" tooltip="Add UV Unwrap Sphere"></a-entity><a-entity icon-button="#asset-cylinder" system-click-action="system: uv-unwrapper; action: createCylinder" tooltip="Add UV Unwrap Cylinder"></a-entity><a-entity icon-button="#asset-dice-2" system-click-action="system: uv-unwrapper; action: createCube" tooltip="Add UV Unwrap Cube"></a-entity><a-entity icon-button="#asset-newspaper-variant-outline" system-click-action="system: uv-unwrapper; action: createBoundingBox" tooltip="Add UV Unwrap Bounding Box"></a-entity><a-entity icon-button="#asset-check-outline" system-click-action="system: uv-unwrapper; action: unwrap" tooltip="Unwrap"></a-entity><a-entity icon-button="#asset-close" system-click-action="system: uv-unwrapper; action: clearShapes" tooltip="Clear UV Shapes"></a-entity><a-entity icon-button="#asset-eye" toggle-button="target: a-scene; component: uv-unwrapper; property: shapesVisible" tooltip="Toggle UV Shape Visibility"></a-entity><a-entity icon-button="#asset-lead-pencil" system-click-action="system: uv-unwrapper; action: drawUVs" tooltip="Draw UV lines"></a-entity></a-entity><a-entity icon-row=""><a-entity icon-row-text="Mesh Manipulations"></a-entity></a-entity><a-entity icon-row="mergeButtons: true"><a-entity icon-button="#asset-skeletonator" popup-button="popup: morph-target-shelf; deferred: true; scale: 0.05 0.05 0.05" tooltip="Morph Targets"></a-entity><a-entity icon-button="#asset-resize" system-click-action="system: mesh-tools; action: subdivide" tooltip="Subdivide Mesh"></a-entity><a-entity icon-button="#asset-blur-preview" system-click-action="system: mesh-tools; action: simplify" tooltip="Simplify Mesh"></a-entity><a-entity icon-button="#asset-arrow-collapse-vertical" system-click-action="system: mesh-tools; action: mergeByDistance" tooltip="Merge vertices by distance"></a-entity><a-entity icon-button="#asset-oven" system-click-action="system: mesh-tools; action: bakeToVertexColors" tooltip="Bake to vertex colors"></a-entity><a-entity icon-button="#asset-spray" system-click-action="system: mesh-tools; action: bakeVertexColorsToTexture" tooltip="Layer from vertex colors"></a-entity><a-entity icon-button="#asset-palette-swatch-outline" toggle-button="target: #canvas-view; component: compositor; property: doubleSided" tooltip="Double Sided"></a-entity><a-entity icon-button="#asset-eye-off" system-click-action="system: hide-mesh-tool; action: unhideAll" tooltip="Unhide all hidden meshes"></a-entity></a-entity><a-entity icon-row="" icon-row-text="Mesh Transformations"></a-entity><a-entity icon-row="mergeButtons: true"><a-entity icon-button="#asset-dice-2" system-click-action="system: mesh-tools; action: actualScale" tooltip="View Actual Size"></a-entity><a-entity icon-button="#asset-arrow-all" system-click-action="system: mesh-tools; action: applyTransformation" tooltip="Apply All Transformations to Mesh"></a-entity><a-entity icon-button="#asset-rotate-3d-variant" system-click-action="system: mesh-tools; action: applyRotation" tooltip="Apply Rotation to Mesh"></a-entity><a-entity icon-button="#asset-resize" system-click-action="system: mesh-tools; action: applyScale" tooltip="Apply Scale to Mesh"></a-entity><a-entity icon-button="#asset-oven" system-click-action="system: mesh-tools; action: applyTransformationToVertices" tooltip="Bake transformation to vertices"></a-entity><a-entity icon-button="#asset-transition" system-click-action="system: mesh-tools; action: splitReferenceMeshes" tooltip="Split Apart Reference Mesh Entities"></a-entity></a-entity><a-entity icon-row="" icon-row-text="Cutouts / Editing"></a-entity><a-entity icon-row="mergeButtons: true"><a-entity icon-button="#asset-transition-masked" onclick="window.setTimeout(() =&gt; document.getElementById(\'mesh-tools-shelf\').setAttribute(\'visible\', \'false\'), 200)" system-click-action="system: cutout-canvas; action: startCutout" tooltip="3D Cutout"></a-entity><a-entity icon-button="#asset-arrow-up-bold" toggle-button="target: a-scene; component: cutout-canvas; property: extrude" tooltip="Extrude 3D Cutout"></a-entity><a-entity icon-button="#asset-dots-square" toggle-button="target: a-scene; component: vertex-editing; property: editMeshVertices" tooltip="Edit Mesh Vertices"></a-entity><a-entity icon-button="#asset-swap-horizontal-variant" toggle-button="target: a-scene; component: vertex-editing; property: editMeshUVs" tooltip="Edit Mesh UVs"></a-entity></a-entity></a-entity><a-entity position="2.6 0.3 0" scale="4 4 4"><a-entity action-tooltips="trigger: Hide Mesh" hide-mesh-tool="" preactivate-tooltip="Mesh Hiding Tool" rotation="-25 0 0"></a-entity><a-entity action-tooltips="trigger: Delete Mesh" hide-mesh-tool="mode: delete" position="0.18 0 0" preactivate-tooltip="Mesh Deleting Tool" rotation="-25 0 0"></a-entity><a-entity action-tooltips="trigger: Fill Mesh" mesh-fill-tool="" position="0.32 0 0" preactivate-tooltip="Mesh Fill Tool" rotation="-25 0 0"></a-entity><a-entity action-tooltips="trigger: Toggle Enabled; grip: Move Meshes" position="0.5 0 0" preactivate-tooltip="Mesh Moving Tool" rotation="-25 0 0" selection-box-tool="grabElements: false; selector: #composition-view, .reference-glb; undoable: true"></a-entity><a-entity action-tooltips="grip: Duplicate and Move; trigger: Toggle Enabled" position="0.7 0 0" preactivate-tooltip="Mesh Duplication Tool" rotation="-25 0 0" selection-box-tool="grabElements: false; selector: #composition-view, .reference-glb; undoable: true; duplicateOnGrab: true"></a-entity><a-entity ik-handle-tool="" position="1.0 0 0" preactivate-tooltip="Pose Tool" rotation="-25 0 0"></a-entity><a-entity action-tooltips="trigger: Toggle Enabled; grip: Move Meshes" id="vertex-selector" position="0.5 -1 0" preactivate-tooltip="Vertex Editing Filter Tool" rotation="-25 0 0" selection-box-tool="selectVertices: true" tooltip-style="scale: 0.3 0.3 1.0; offset: 0 -0.1 -1.3"></a-entity><a-entity position="0.75 -1 0" preactivate-tooltip="Vertex Handle Grabber" selection-box-tool="selector: a-entity[vertex-handle]" tooltip-style="scale: 0.3 0.3 1.0; offset: 0 -0.1 -1.3"></a-entity><a-entity position="1.25 -1 -0.1" preactivate-tooltip="Weighted Vertex Handle Grabber" selection-box-tool="selector: a-entity[vertex-handle]; weight: 1.5" tooltip-style="scale: 0.3 0.3 1.0; offset: 0 -0.1 -1.3"></a-entity></a-entity></a-entity>'},function(t,e){t.exports='<a-entity scale="0.35 0.35 0.35" shelf="frame: false"><a-entity position="-1 1.3 0" scale="0.66 0.66 1"><a-entity icon-button="#asset-close-circle-outline" popup-action="close" position="4.157 -3.840 0"></a-entity><a-entity position=" 0 0"><a-entity position="0  0"><a-entity hidden-tooltip="source-over" icon-button="#asset-blur-linear" layer-mode="source-over" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity position="-0.43 0 0" text="value: source-over; width: 1; wrapCount: 15; anchor: left"></a-entity></a-entity><a-entity position="0 -0.5 0"><a-entity hidden-tooltip="source-in" icon-button="#asset-blur-linear" layer-mode="source-in" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity position="-0.43 0 0" text="value: source-in; width: 1; wrapCount: 15; anchor: left"></a-entity></a-entity><a-entity position="0 -1 0"><a-entity hidden-tooltip="source-out" icon-button="#asset-blur-linear" layer-mode="source-out" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity position="-0.43 0 0" text="value: source-out; width: 1; wrapCount: 15; anchor: left"></a-entity></a-entity><a-entity position="0 -1.5 0"><a-entity hidden-tooltip="source-atop" icon-button="#asset-blur-linear" layer-mode="source-atop" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity position="-0.43 0 0" text="value: source-atop; width: 1; wrapCount: 15; anchor: left"></a-entity></a-entity><a-entity position="0 -2 0"><a-entity hidden-tooltip="destination-over" icon-button="#asset-blur-linear" layer-mode="destination-over" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity position="-0.43 0 0" text="value: destination-over; width: 1; wrapCount: 15; anchor: left"></a-entity></a-entity><a-entity position="0 -2.5 0"><a-entity hidden-tooltip="destination-in" icon-button="#asset-blur-linear" layer-mode="destination-in" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity position="-0.43 0 0" text="value: destination-in; width: 1; wrapCount: 15; anchor: left"></a-entity></a-entity><a-entity position="0 -3 0"><a-entity hidden-tooltip="destination-out" icon-button="#asset-blur-linear" layer-mode="destination-out" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity position="-0.43 0 0" text="value: destination-out; width: 1; wrapCount: 15; anchor: left"></a-entity></a-entity></a-entity><a-entity position="1.3 0 0"><a-entity position="0  0"><a-entity hidden-tooltip="screen" icon-button="#asset-blur-linear" layer-mode="screen" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity position="-0.43 0 0" text="value: screen; width: 1; wrapCount: 15; anchor: left"></a-entity></a-entity><a-entity position="0 -0.5 0"><a-entity hidden-tooltip="overlay" icon-button="#asset-blur-linear" layer-mode="overlay" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity position="-0.43 0 0" text="value: overlay; width: 1; wrapCount: 15; anchor: left"></a-entity></a-entity><a-entity position="0 -1 0"><a-entity hidden-tooltip="darken" icon-button="#asset-blur-linear" layer-mode="darken" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity position="-0.43 0 0" text="value: darken; width: 1; wrapCount: 15; anchor: left"></a-entity></a-entity><a-entity position="0 -1.5 0"><a-entity hidden-tooltip="lighten" icon-button="#asset-blur-linear" layer-mode="lighten" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity position="-0.43 0 0" text="value: lighten; width: 1; wrapCount: 15; anchor: left"></a-entity></a-entity><a-entity position="0 -2 0"><a-entity hidden-tooltip="color-dodge" icon-button="#asset-blur-linear" layer-mode="color-dodge" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity position="-0.43 0 0" text="value: color-dodge; width: 1; wrapCount: 15; anchor: left"></a-entity></a-entity><a-entity position="0 -2.5 0"><a-entity hidden-tooltip="color-burn" icon-button="#asset-blur-linear" layer-mode="color-burn" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity position="-0.43 0 0" text="value: color-burn; width: 1; wrapCount: 15; anchor: left"></a-entity></a-entity><a-entity position="0 -3 0"><a-entity hidden-tooltip="soft-light" icon-button="#asset-blur-linear" layer-mode="soft-light" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity position="-0.43 0 0" text="value: soft-light; width: 1; wrapCount: 15; anchor: left"></a-entity></a-entity><a-entity position="0 -3.5 0"><a-entity hidden-tooltip="hard-light" icon-button="#asset-blur-linear" layer-mode="hard-light" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity position="-0.43 0 0" text="value: hard-light; width: 1; wrapCount: 15; anchor: left"></a-entity></a-entity></a-entity><a-entity position="2.6 0 0"><a-entity position="0  0"><a-entity hidden-tooltip="multiply" icon-button="#asset-blur-linear" layer-mode="multiply" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity position="-0.43 0 0" text="value: multiply; width: 1; wrapCount: 15; anchor: left"></a-entity></a-entity><a-entity position="0 -0.5 0"><a-entity hidden-tooltip="difference" icon-button="#asset-blur-linear" layer-mode="difference" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity position="-0.43 0 0" text="value: difference; width: 1; wrapCount: 15; anchor: left"></a-entity></a-entity><a-entity position="0 -1 0"><a-entity hidden-tooltip="exclusion" icon-button="#asset-blur-linear" layer-mode="exclusion" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity position="-0.43 0 0" text="value: exclusion; width: 1; wrapCount: 15; anchor: left"></a-entity></a-entity><a-entity position="0 -1.5 0"><a-entity hidden-tooltip="hue" icon-button="#asset-blur-linear" layer-mode="hue" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity position="-0.43 0 0" text="value: hue; width: 1; wrapCount: 15; anchor: left"></a-entity></a-entity><a-entity position="0 -2 0"><a-entity hidden-tooltip="saturation" icon-button="#asset-blur-linear" layer-mode="saturation" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity position="-0.43 0 0" text="value: saturation; width: 1; wrapCount: 15; anchor: left"></a-entity></a-entity><a-entity position="0 -2.5 0"><a-entity hidden-tooltip="color" icon-button="#asset-blur-linear" layer-mode="color" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity position="-0.43 0 0" text="value: color; width: 1; wrapCount: 15; anchor: left"></a-entity></a-entity><a-entity position="0 -3 0"><a-entity hidden-tooltip="luminosity" icon-button="#asset-blur-linear" layer-mode="luminosity" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity position="-0.43 0 0" text="value: luminosity; width: 1; wrapCount: 15; anchor: left"></a-entity></a-entity></a-entity><a-entity position="3.9000000000000004 0 0"><a-entity position="0  0"><a-entity hidden-tooltip="bumpMap" icon-button="#asset-blur-linear" layer-mode="bumpMap" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity position="-0.43 0 0" text="value: bumpMap; width: 1; wrapCount: 15; anchor: left"></a-entity></a-entity><a-entity position="0 -0.5 0"><a-entity hidden-tooltip="displacementMap" icon-button="#asset-blur-linear" layer-mode="displacementMap" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity position="-0.43 0 0" text="value: displacementMap; width: 1; wrapCount: 15; anchor: left"></a-entity></a-entity><a-entity position="0 -1 0"><a-entity hidden-tooltip="normalMap" icon-button="#asset-blur-linear" layer-mode="normalMap" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity position="-0.43 0 0" text="value: normalMap; width: 1; wrapCount: 15; anchor: left"></a-entity></a-entity><a-entity position="0 -1.5 0"><a-entity hidden-tooltip="emissiveMap" icon-button="#asset-blur-linear" layer-mode="emissiveMap" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity position="-0.43 0 0" text="value: emissiveMap; width: 1; wrapCount: 15; anchor: left"></a-entity></a-entity><a-entity position="0 -2 0"><a-entity hidden-tooltip="metalnessMap" icon-button="#asset-blur-linear" layer-mode="metalnessMap" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity position="-0.43 0 0" text="value: metalnessMap; width: 1; wrapCount: 15; anchor: left"></a-entity></a-entity><a-entity position="0 -2.5 0"><a-entity hidden-tooltip="roughnessMap" icon-button="#asset-blur-linear" layer-mode="roughnessMap" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity position="-0.43 0 0" text="value: roughnessMap; width: 1; wrapCount: 15; anchor: left"></a-entity></a-entity><a-entity position="0 -3 0"><a-entity hidden-tooltip="envMap" icon-button="#asset-blur-linear" layer-mode="envMap" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity position="-0.43 0 0" text="value: envMap; width: 1; wrapCount: 15; anchor: left"></a-entity></a-entity><a-entity position="0 -3.5 0"><a-entity hidden-tooltip="aoMap" icon-button="#asset-blur-linear" layer-mode="aoMap" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity position="-0.43 0 0" text="value: aoMap; width: 1; wrapCount: 15; anchor: left"></a-entity></a-entity><a-entity position="0 -4 0"><a-entity hidden-tooltip="matcap" icon-button="#asset-blur-linear" layer-mode="matcap" position="-0.7 0 0" scale="0.7 0.7 1"></a-entity><a-entity position="-0.43 0 0" text="value: matcap; width: 1; wrapCount: 15; anchor: left"></a-entity></a-entity></a-entity></a-entity></a-entity>'},function(t,e){t.exports='<a-entity _six-dof-tool="reparentOnActivate: true; summonable: false" morph-target-shelf="" shelf="name: Morph Targets; closeable: true; height: 4"><a-entity shelf-content=""><a-entity icon-row=""><a-entity icon-button="#asset-lead-pencil" toggle-button="target: a-scene; component: optimize-mesh-raycast; property: ignoreMorphTargets" tooltip="Faster drawing on morphed mesh (less accurate)"></a-entity><a-entity icon-button="#asset-oven" system-click-action="system:morph-targets; action: bakeMorphTarget" tooltip="Bake Morph To Geometry"></a-entity><a-entity icon-button="#asset-plus-box-outline" system-click-action="system: morph-targets; action: newMorphTarget" tooltip="New Morph Target"></a-entity></a-entity></a-entity><a-entity class="morph-levers"></a-entity></a-entity>'},function(t,e){t.exports='<a-entity class="node-shelf grab-root" shelf=""><a-entity position="-1.3 1.2 0"><a-entity click-action="delete" icon-button="#asset-delete" tooltip="Delete Node"></a-entity><a-entity icon-button="#asset-web" system-click-action="system: networking; action: createSymmetricLink" tooltip="Copy Connection Link to Clipboard"></a-entity></a-entity><a-entity class="name" edit-field="type: string" position="0 1.2 0" text="value: Output Name; wrapCount: 20; width: 3"></a-entity><a-entity newtork-node-connection-status-indicator="" position="2.0 -1.2 0"></a-entity><a-entity node-output="" position="2.1 1.2 0.01"></a-entity><a-entity position="0 0.4 0" text="baseline: top; width: 3; wrapCount: 25; value: Note, by using a Receiver node you are connecting to whoever is currently broadcasting to that name. Names are not secured, checked, or in any other way managed by VARTISTE."></a-entity></a-entity>'},function(t,e){t.exports='<a-entity class="node-shelf grab-root" shelf=""><a-entity position="-1.3 1.2 0"><a-entity click-action="delete" icon-button="#asset-delete" tooltip="Delete Node"></a-entity><a-entity icon-button="#asset-web" system-click-action="system: networking; action: createSymmetricLink" tooltip="Copy Connection Link to Clipboard"></a-entity></a-entity><a-entity newtork-node-connection-status-indicator="" position="2.0 -1.2 0"></a-entity><a-entity class="name" edit-field="type: string; tooltip: Edit Broadcast Name" position="0 1.2 0" text="value: Output Name; wrapCount: 20; width: 3"></a-entity><a-entity material="color: #34d8eb" node-input="type: destination" position="-2.1 1.2 0.01"></a-entity><a-entity position="0 0.4 0" text="baseline: top; width: 3; wrapCount: 25; value: Please note that by using a Broadcast node, you are transmitting your canvas information to anyone who knows or can guess the name of the node. Please pick a unique name."></a-entity></a-entity>'},function(t,e){t.exports='<a-entity node-control-panel="" position="1.403297266476087 5.130829217317092 3.769096725768977" rotation="-4.991498152339761 14.69768228296985 1.731732780626299" scale="0.2094764417823207 0.2094764417823207 0.2094764417823207" shelf="height: 1.5; name: Layer / Node Control Panel" visible="false"><a-entity position="-1.5 0 0" scale="1 1 3.3333333333333335"><a-entity icon-row=""><a-entity click-action="toggleNodes" icon-button="#asset-light-switch" tooltip="Switch Layer / Nodes Mode"></a-entity><a-entity click-action="hideShelves" icon-button="#asset-eye" tooltip="Toggle Layer / Node Shelf Visibility"></a-entity><a-entity click-action="newLayer" icon-button="#asset-plus-box-outline" tooltip="New Layer"></a-entity></a-entity><a-entity icon-row=""><a-entity click-action="newNode" icon-button="#asset-arrow-collapse-vertical" new-node-type="CanvasNode" tooltip="New Composition Node"></a-entity><a-entity click-action="newNode" icon-button="#asset-arrow-right" new-node-type="PassthroughNode" tooltip="New Passthrough Node"></a-entity><a-entity click-action="newNode" icon-button="#asset-eye" new-node-type="OutputNode" tooltip="New Output Node"></a-entity></a-entity><a-entity icon-row=""><a-entity click-action="newNode" icon-button="#asset-blur-linear" new-node-type="FxNode" tooltip="New Fx Node"></a-entity><a-entity click-action="newNode" icon-button="#asset-brush" new-node-type="StyleTransferNode" tooltip="New Style Transfer Node"></a-entity><a-entity click-action="newNode" icon-button="#asset-dice-6" new-node-type="AIRenderNode" tooltip="New AI Render Node"></a-entity></a-entity><a-entity icon-row=""><a-entity click-action="newNode" icon-button="#asset-cube-send" new-node-type="NetworkOutputNode" tooltip="New Multidraw Broadcast Node"></a-entity><a-entity click-action="newNode" icon-button="#asset-resize" new-node-type="NetworkInputNode" tooltip="New Multidraw Receiver Node"></a-entity></a-entity></a-entity><a-entity position="0 1.7 0"><a-sphere class="clickable globe-control" material="wireframe: true; shader: matcap" radius="0.6" tooltip="Grab All Nodes"></a-sphere><a-entity class="spawn-point" position="0 1.4 0" scale="0.8 0.8 0.8"></a-entity></a-entity></a-entity>'},function(t,e){t.exports='<a-entity shelf="frame: false; width: 1.7; height: 3.4"><a-entity shelf-content=""><a-entity icon-row=""><a-entity class="value" position="1.2 0 0" text="width: 1.6; wrapCount: 8; value:1024; anchor: right; align: right; color: #FFF;"></a-entity></a-entity><a-entity icon-row=""><a-entity icon-button="" text="value: 1; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: 2; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: 3; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity></a-entity><a-entity icon-row=""><a-entity icon-button="" text="value: 4; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: 5; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: 6; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity></a-entity><a-entity icon-row=""><a-entity icon-button="" text="value: 7; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: 8; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: 9; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity></a-entity><a-entity icon-row=""><a-entity icon-button="" text="value: -; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: 0; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity icon-button="" text="value: .; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity></a-entity><a-entity icon-row=""><a-entity action="backspace" icon-button="#asset-backspace-outline"></a-entity><a-entity icon-button="" text="value: e; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity><a-entity action="ok" icon-button="#asset-check-outline"></a-entity></a-entity></a-entity></a-entity>'},function(t,e){t.exports='<a-entity _scale="0.03 0.05 0.05" scale="0.6 1 1" shelf="frame: false"><a-entity position="-3.1 1.8 0" scale="1.8 1 1.3"><a-entity><a-entity icon-button="" position="1 -1 0" text="value: 1; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity></a-entity><a-entity><a-entity icon-button="" position="1.7 -1 0" text="value: 2; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity></a-entity><a-entity><a-entity icon-button="" position="2.4 -1 0" text="value: 3; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity></a-entity><a-entity><a-entity icon-button="" position="1 -1.7 0" text="value: 4; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity></a-entity><a-entity><a-entity icon-button="" position="1.7 -1.7 0" text="value: 5; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity></a-entity><a-entity><a-entity icon-button="" position="2.4 -1.7 0" text="value: 6; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity></a-entity><a-entity><a-entity icon-button="" position="1 -2.4 0" text="value: 7; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity></a-entity><a-entity><a-entity icon-button="" position="1.7 -2.4 0" text="value: 8; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity></a-entity><a-entity><a-entity icon-button="" position="2.4 -2.4 0" text="value: 9; color: #FFF; wrapCount: 3; align: center; width: 0.4"></a-entity></a-entity></a-entity><a-entity position="-3.1 -1.2 0" scale="1.8 1 1.3"><a-entity><a-entity action="backspace" icon-button="#asset-backspace-outline" position="1. 0 0"></a-entity></a-entity><a-entity><a-entity icon-button="" position="1.7 0 0" text="value: 0; color: #000; wrapCount: 3; align: center; width: 0.4; color: #FFF;"></a-entity></a-entity><a-entity><a-entity action="ok" icon-button="#asset-check-outline" position="2.4 0 0"></a-entity></a-entity></a-entity><a-entity class="value" position="0.1 1.3 0" scale="1 0.5 1" text="width: 3.8; wrapCount: 8; value:1024; align: right; color: #FFF;"></a-entity></a-entity>'},function(t,e){t.exports='<a-entity grab-root="" shelf="name: 3D Animation; pinnable: false; closable: true"><a-entity shelf-content=""><a-entity icon-row="mergeButtons: true"><a-entity icon-button="#asset-play-pause" organizer-toggle-button="component: animation-3d-keyframed; property: enabled" tooltip="Enable Animation"></a-entity><a-entity icon-button="#asset-rotate-3d-variant" organizer-toggle-button="component: animation-3d-keyframed; property: wrapAnimation" tooltip="Wrap Animation"></a-entity><a-entity icon-button="#asset-plus-box-outline" object3d-view-action="keyframe" tooltip="Insert Keyframe"></a-entity><a-entity icon-button="#asset-hand-right" organizer-toggle-button="component: animation-3d-keyframed; property: puppeteering" toggle-button="" tooltip="Puppeteer"></a-entity><a-entity icon-button="#asset-hand-right" organizer-toggle-button="component: animation-3d-keyframed; property: restartAnimationOnGrab" toggle-button="" tooltip="Restart animation when puppeteering"></a-entity><a-entity icon-button="#asset-delete" object3d-view-action="deleteAllKeyframes" tooltip="Delete All Keyframes"></a-entity></a-entity><a-entity icon-row=""><a-entity icon-row-text="Timeline Controls:"></a-entity></a-entity><a-entity icon-row="mergeButtons: true"><a-entity icon-button="#asset-arrow-collapse-left" onclick="Compositor.component.jumpToFrame(0)" tooltip="Jump to First Frame"></a-entity><a-entity icon-button="#asset-arrow-left" onclick="Compositor.component.previousFrame()" tooltip="Previous Frame"></a-entity><a-entity icon-button="#asset-play-pause" onclick="Compositor.component.playPauseAnimation()" speech-alias="play; pause" tooltip="Play / Pause"></a-entity><a-entity icon-button="#asset-arrow-right" onclick="Compositor.component.nextFrame()" tooltip="Next Frame"></a-entity></a-entity></a-entity><a-entity organizer-set-target="component: timeline-tool" position="0 -2 0.1" propogate-grab=""></a-entity></a-entity>'},function(t,e){t.exports='<a-entity shelf=""></a-entity>'},function(t,e){t.exports='<a-entity shelf-content=""><a-entity icon-row="mergeButtons: true"><a-entity icon-button="#asset-cube-send" object3d-view-action="export" tooltip="Export"></a-entity><a-entity icon-button="#asset-eye-off" object3d-view-action="hide" tooltip="Toggle Visibility"></a-entity><a-entity icon-button="#asset-delete" object3d-view-action="trash" tooltip="Delete"></a-entity><a-entity icon-button="#asset-plus-box-multiple" object3d-view-action="duplicate" tooltip="Duplicate"></a-entity><a-entity icon-button="#asset-arrow-all" object3d-view-action="axesHelper" tooltip="Show Origin"></a-entity><a-entity data-new-object="" dropdown-button="optionIcon: #asset-plus-box-outline; options: entity, object" icon-button="#asset-plus-box-outline" popup-button="deferred: true; scale: 0.3 0.3 0.3; offset: 0 0 0.3" tooltip="New..."></a-entity><a-entity icon-button="#asset-folder-open-outline" object3d-view-action="loadChildren" tooltip="Load Children"></a-entity></a-entity><a-entity icon-row="mergeButtons: true"><a-entity icon-button="#asset-arrow-all" radio-button="target: #view-root; component: object3d-view; property: activeProperty; value: localPosition" tooltip="Local Position"></a-entity><a-entity icon-button="#asset-web" radio-button="target: #view-root; component: object3d-view; property: activeProperty; value: globalPosition" tooltip="Global Position"></a-entity><a-entity icon-button="#asset-resize" radio-button="target: #view-root; component: object3d-view; property: activeProperty; value: localScale" tooltip="Scale"></a-entity><a-entity icon-button="#asset-rotate-orbit" radio-button="target: #view-root; component: object3d-view; property: activeProperty; value: localRotation" tooltip="Rotation"></a-entity><a-entity icon-button="#asset-undo" object3d-view-action="resetMatrix" tooltip="Reset Local Transformation"></a-entity><a-entity icon-button="#asset-lock-outline" popup-button="popup: constraints-popup; deferred: true; autoScale: true; offset: 0 0.1 0.7" tooltip="Constraints"></a-entity><a-entity icon-button="#asset-video-vintage" popup-button="popup: object-animation-popup; deferred: true; autoScale: true; offset: 0 0.1 0.7" tooltip="Animation"></a-entity></a-entity><a-entity icon-row=""><a-entity icon-row=""><a-entity class="position x" edit-field="type: float" popup-button="offset: 0 0.0 0.7" prop-movement-lever="" text="width: 3; anchor: right; align: right; xOffset: 1.5; wrapCount: 14"></a-entity><a-entity data-axis="x" icon-button="#asset-undo" object3d-view-action="resetAxes" position="2.25 0 0" tooltip="Reset"></a-entity></a-entity><a-entity icon-row=""><a-entity class="position y" edit-field="type: float" popup-button="offset: 0 0.0 0.7" prop-movement-lever="" text="width: 3; anchor: right; align: right; xOffset: 1.5; wrapCount: 14"></a-entity><a-entity data-axis="y" icon-button="#asset-undo" object3d-view-action="resetAxes" position="2.25 0 0" tooltip="Reset"></a-entity></a-entity><a-entity icon-row=""><a-entity class="position z" edit-field="type: float" popup-button="offset: 0 0.0 0.7" prop-movement-lever="" text="width: 3; anchor: right; align: right; xOffset: 1.5; wrapCount: 14"></a-entity><a-entity data-axis="z" icon-button="#asset-undo" object3d-view-action="resetAxes" position="2.25 0 0" tooltip="Reset"></a-entity></a-entity></a-entity></a-entity><a-entity class="grab-redirector" position="-1.2 -1.2 0"></a-entity><a-entity node-input="compositionNode: false" position="-1.85 1.2 0.01" scale="1 1 0.3"></a-entity><a-entity node-output="" position="1.85 1.2 0.01" scale="1 1 0.3"></a-entity>'},function(t,e){t.exports='<a-entity class="node-shelf grab-root" shelf=""><a-entity position="0 1.2 0"><a-entity click-action="solo" icon-button="#asset-eye" tooltip="Show This Node Only"></a-entity><a-entity click-action="delete" icon-button="#asset-delete" tooltip="Delete Node"></a-entity></a-entity><a-entity class="name" edit-field="type: string" position="0 0 0" text="value: Output Name; wrapCount: 20; width: 3"></a-entity><a-entity material="color: #34d8eb" node-input="type: canvas" position="-2.1 1.2 0.01"></a-entity></a-entity>'},function(t,e){t.exports='<a-box class="grab-root node-root clickable" depth="0.3" height="0.3" width="0.3"><a-entity node-input="type: destination" position="-0.18 0 0"></a-entity><a-entity node-output="" position="0.18 0 0"></a-entity></a-box>'},function(t,e){t.exports='<a-entity popup-shelf="" position="0 0 -1.5" visible="false"><a-entity scale="0.3 0.3 0.3" shelf=""><a-entity text="value: .; width: 3.5; height: 1.5; baseline: top; "></a-entity><a-entity class="ok" icon-button="#asset-check-outline" position="0 -1.0"></a-entity></a-entity></a-entity>'},function(t,e){t.exports='<a-entity class="grab-root" id="quick-menu" position="0.02791199948583377 -0.31382646103619727 0.7253849781877566" quick-menu="" rotation="-25 0 0" scale="0.1 0.1 0.1" shelf="name: Quick Menu; width: 3; height: 1" summoner-position="el: #quick-menu-positioner"><a-entity _shelf="" id="quick-menu-positioner" position="-0.06572192790324391 1.6687909101322174 0.3699357575623226" rotation="27.343851198452143 0 0.0" scale="0.065 0.065 0.065"></a-entity><a-entity icon-row="mergeButtons: true" position="-1.1 0 0"><a-entity icon-button="#asset-floppy" quick-menu-action="quickSave" tooltip="Save"><a-entity _popup-button="scale: 0.3 0.3 0.3" edit-field="type: string; autoClear: true" id="quick-menu-project-name-edit" visible="false"></a-entity></a-entity><a-entity icon-button="#asset-undo" system-click-action="system: settings-system; action: undoAction" tooltip="Undo"></a-entity><a-entity icon-button="#asset-folder-open-outline" shelf-summoner="name: Settings Shelf" tooltip="Project / Settings"></a-entity><a-entity icon-button="#asset-brush" shelf-summoner="name: 6DoF Tool Shelf" tooltip="Tools"></a-entity><a-entity icon-button="#asset-help-circle-outline" shelf-summoner="name: Help Shelf" tooltip="Help"></a-entity><a-entity icon-button="#asset-arrow-down-bold" quick-menu-action="expandQuickMenu" tooltip="More"></a-entity></a-entity><a-entity class="message" position="0.07 -0.34 0" text="width: 3; wrapCount: 54;"></a-entity><a-entity class="quick-menu-more" icon-row="mergeButtons: true" position="-1.1 0 0" visible="false"><a-entity icon-button="#asset-image-filter-hdr" shelf-summoner="name: Environment Shelf" tooltip="Environment Options"></a-entity><a-entity icon-button="#asset-video-vintage" shelf-summoner="name: Animation Shelf" tooltip="2D Animation"></a-entity><a-entity icon-button="#asset-cylinder" shelf-summoner="name: Mesh Tools Shelf" tooltip="Mesh Tools"></a-entity><a-entity icon-button="#asset-lead-pencil" shelf-summoner="name: Advanced Drawing Shelf" tooltip="Advanced Drawing Functions"></a-entity><a-entity icon-button="#asset-format-color-fill" shelf-summoner="name: Experimental Functionality" tooltip="Experiments / Utils"></a-entity><a-entity icon-button="#asset-nudge-brush" quick-menu-action="toggleNodes" tooltip="Node Compositing System"></a-entity></a-entity><a-entity class="quick-menu-more" position="1.3 -2.33 0.01" text="width: 1.7; wrapCount: 25; align: right; anchor: right" version-info="" visible="false"></a-entity><a-entity class="quick-menu-more" icon-row="mergeButtons: true; mergeIcons: false" position="-0.885 -0.5 0" visible="false"><a-entity quick-gallery="" scale="2 2 1"></a-entity></a-entity><a-entity id="quick-menu-grabbers" position="0 -0.53 0"><a-entity globe-material="color: #6C7889" grab-redirector="target: #canvas-root; resetOnClick: true; handle: false; radius: 0.1" id="quick-scene-grabber" position="1.5 0 0" tooltip="Grab Scene" tooltip-style="offset: 0 -0.7 0"></a-entity><a-entity globe-material="src: #asset-shelf; color: red" grab-redirector="target: #ui; resetOnClick: true; handle: false; radius: 0.1" id="quick-scene-grabber" position="-1.5 0 0" tooltip="Grab UI" tooltip-style="offset: 0 -0.7 0"></a-entity></a-entity><a-entity _manipulator-weight="type: slow" _six-dof-tool="reparentOnActivate: false" id="quick-menu-pencil" pencil-tool="tipRatio: 0.35; radius: 0.01; pressureTip: true; detailTip: true" position="2.034664795181822 -0.03857531572491791 -0.021797842582531368" rotation="180 0 0" scale="7.7 7.7 7.7">)ammo-body="type: kinematic" _ammo-shape="type: box; fit: manual; halfExtents: 0.2 0.2 0.2" _ammo-fit-children=""</a-entity><a-entity busy-indicator="" position="-2 0 0"></a-entity></a-entity>'},function(t,e){t.exports='<a-entity icon-row="mergeButtons: true; autoPosition: false" position="-1.6 1.1 0"><a-entity click-action="save" icon-button="#asset-floppy" tooltip="Download project"></a-entity><a-entity click-action="storeToBrowser" icon-button="#asset-save-to-browser" tooltip="Save Project to Browser"></a-entity><a-entity icon-button="#asset-folder-open-outline" popup-button="popup: load-shelf; deferred: true; tooltip: Load;"></a-entity><a-entity click-action="export" icon-button="#asset-camera" tooltip="Save PNG"></a-entity><a-entity icon-button="#asset-cube-send" popup-button="popup: export-shelf; deferred: true; tooltip: Export;" tooltip="Export"></a-entity><a-entity icon-button="#asset-sketchfab" popup-button="popup: sketchfab-shelf; deferred: true" tooltip="Sketchfab"></a-entity><a-entity icon-button="#asset-translate" popup-button="popup: language-shelf; deferred: true" tooltip="Lanugage"></a-entity></a-entity><a-entity icon-row="mergeButtons: true; autoPosition: false" position="-1.6 0.6 0"><a-entity click-action="lowQuality" icon-button="#asset-dice-2" toggle-button="" tooltip="Low Quality"></a-entity><a-entity click-action="mediumQuality" icon-button="#asset-dice-4" toggle-button="" tooltip="Medium Quality"></a-entity><a-entity click-action="fullQuality" icon-button="#asset-dice-6" toggle-button="" tooltip="Full Quality"></a-entity><a-entity icon-button="#asset-account-voice" toggle-button="target: a-scene; component: speech; property: speak" tooltip="Toggle Screen Reader"></a-entity><a-entity icon-button="#asset-ear-hearing" speech-recognition-button="" tooltip="Listen for voice command"></a-entity><a-entity icon-button="#asset-hand-no-lines" popup-button="popup: controller-setup-shelf; deferred: true" tooltip="Controller Options"></a-entity><a-entity icon-button="#asset-video-vintage" system-click-action="system: artist-root; action: resetCameraLocation" tooltip="Reset View"></a-entity></a-entity><a-entity position="-0.3 0.1 0"><a-entity class="project-name" edit-field="tooltip: Edit Project Name; type: string" text="value: project; width: 3; wrapCount: 26; align: right; anchor: right; xOffset: 1.450"></a-entity></a-entity><a-entity icon-row="mergeButtons: true; autoPosition: false" position="0.15 -0.6 0"><a-entity class="width" edit-field="tooltip: Edit Width" position="-1.74 0 0" text="value: 1024; width: 0.56; wrapCount: 5.23"></a-entity><a-entity position="-0.829 0 0" text="value: x; width: 4; align: center"></a-entity><a-entity class="height" edit-field="tooltip: Edit Height" position="-0.556 0 0" text="value: 512; width: 0.56; wrapCount: 5.23"></a-entity></a-entity><a-entity icon-row="mergeButtons: true; autoPosition: false" position="-1.6 -1.2 0"><a-entity click-action="newComposition" icon-button="#asset-file-outline" tooltip="New Composition"></a-entity><a-entity click-action="resample" icon-button="#asset-resize" tooltip="Resize"></a-entity><a-entity click-action="resizeCanvas" icon-button="#asset-arrow-all" tooltip="Resize Canvas Only"></a-entity><a-entity click-action="resizeCanvasToCurrentLayer" icon-button="#asset-drag-and-drop" tooltip="Resize Canvas to Current Layer"></a-entity><a-entity icon-button="#asset-archive-arrow-down-outline" popup-button="popup: standard-sizes; autoScale: true; offset: 0 1 0.5" tooltip="Standard Sizes"></a-entity></a-entity><a-entity position="0.1 -1.2 0"></a-entity>'},function(t,e){t.exports='<a-entity bypass-hidden-updates="" class="grab-root" id="six-dof-shelf" scale="0.3 0.3 0.3" shelf="name: 6DoF Tool Shelf; closeable: true" summoner-position="el: #six-dof-positioner; key: six-dof" visible="false"><a-entity id="six-dof-positioner" position="4 0 0" scale="4 4 4"></a-entity><a-entity icon-row="" position="-1.5 1.1 0"><a-entity text="value: Tool Categories:; align: left; anchor: left; width: 3; height: 0.3; wrapCount: 25" translate-text=""></a-entity></a-entity><a-entity icon-row="mergeButtons: true" position="-1.5 1.1 0"><a-entity icon-button="#asset-lead-pencil" shelf-summoner="selector: #pencils-and-brushes" tooltip="Pencils / Brushes"></a-entity><a-entity icon-button="#asset-spray" shelf-summoner="selector: #cameras-and-spray-paint" tooltip="Cameras / Spray Paint"></a-entity><a-entity icon-button="#asset-web" shelf-summoner="selector: #six-dof-volumetrics" tooltip="Volumetric Tools"></a-entity><a-entity icon-button="#asset-masked-bucket" shelf-summoner="selector: #misc-six-dof-tools" tooltip="Misc Tools"></a-entity><a-entity icon-button="#asset-eye" shelf-summoner="selector: #view-six-dof-tools" tooltip="View Tools"></a-entity><a-entity icon-button="#asset-palette-swatch-outline" shelf-summoner="selector: #material-packs" tooltip="Material Packs"></a-entity><a-entity icon-button="#asset-shape-outline" shelf-summoner="selector: #primitive-shapes" tooltip="Primitive Shape Constructs"></a-entity></a-entity><a-entity icon-row="" position="-1.5 1.1 0"><a-entity text="value: Tool Options / Actions:; align: left; anchor: left; width: 3; height: 0.3; wrapCount: 25" translate-text=""></a-entity></a-entity><a-entity icon-row="" position="-1.5 1.1 0"><a-entity icon-row="mergeButtons: true; autoPosition: false" v-bind="source: #pencils-and-brushes; sourceComponent: visible; component: visible; setOnLoad: true"><a-entity icon-button="#asset-plus-box-outline" system-click-action="system: pencil-tool; action: clonePencil" tooltip="Clone Last Grabbed Tool"></a-entity><a-entity icon-button="#asset-lead-pencil" system-click-action="system: pencil-tool; action: unlockPencil" tooltip="Edit Last Grabbed Pencil Clone"></a-entity><a-entity icon-button="#asset-delete" system-click-action="system: pencil-tool; action: deletePencil" tooltip="Delete Last Grabbed Clone"></a-entity></a-entity><a-entity icon-row="mergeButtons: true; autoPosition: false" v-bind="source: #cameras-and-spray-paint; sourceComponent: visible; component: visible; setOnLoad: true"><a-entity icon-button="#asset-dice-2" system-click-action="system: spray-can-tool; action: setSprayResolutionLow" tooltip="Set Spray Cans to Low Resolution"></a-entity><a-entity icon-button="#asset-dice-4" system-click-action="system: spray-can-tool; action: setSprayResolutionMedium" tooltip="Set Spray Cans to Medium Resolution"></a-entity><a-entity icon-button="#asset-dice-6" system-click-action="system: spray-can-tool; action: setSprayResolutionHigh" tooltip="Set Spray Cans to High Resolution"></a-entity><a-entity icon-button="#asset-arrow-all" system-click-action="system: spray-can-tool; action: setSprayResolutionCanvas" tooltip="Set Spray Cans to Canvas Resolution"></a-entity></a-entity><a-entity icon-row="autoPosition: false" v-bind="source: #primitive-shapes; sourceComponent: visible; component: visible; setOnLoad: true"><a-entity icon-row="mergeButtons: true"><a-entity icon-button="#asset-collage" system-click-action="system: shape-creation; action: setSolidDrawing" tooltip="Solidify Shape Wands"></a-entity><a-entity icon-button="#asset-palette-swatch-outline" toggle-button="target: a-scene; component: primitive-constructs; property: shareMaterial" tooltip="Share Materials Across Shapes"></a-entity><a-entity icon-button="#asset-record" toggle-button="target: a-scene; component: primitive-constructs; property: allowFlat" tooltip="Allow Flat Shaded Shapes"></a-entity></a-entity><a-entity icon-row="mergeButtons: true"><a-entity icon-button="#asset-resize" system-click-action="system: primitive-constructs; action: makeDrawable" tooltip="Convert Shapes to Drawable Mesh"></a-entity><a-entity icon-button="#asset-badge-account-horizontal-outline" system-click-action="system: primitive-constructs; action: makeReference" tooltip="Convert Shapes to Reference"></a-entity><a-entity icon-button="#asset-shape-outline" system-click-action="system: primitive-constructs; action: decomposeCompositor" tooltip="Convert Drawable Mesh to Shapes"></a-entity><a-entity icon-button="#asset-transition-masked" onclick="window.setTimeout(() =&gt;document.getElementById(\'six-dof-shelf\').setAttribute(\'visible\', \'false\'), 200)" system-click-action="system: cutout-canvas; action: startShapeCutout" tooltip="Cutout to shape"></a-entity><a-entity icon-button="#asset-transition" system-click-action="system: shape-creation; action: autoCutShape" tooltip="Layer Outline to Wand Shape"></a-entity><a-entity icon-button="#asset-dots-square" system-click-action="system: cutout-canvas; action: autoCutShape" tooltip="Cut shape from layer outline"></a-entity></a-entity></a-entity><a-entity icon-row="autoPosition: false" v-bind="source: #material-packs; sourceComponent: visible; component: visible; setOnLoad: true"><a-entity icon-row="" text="width: 3; value: Drag and drop images to create new material packs; anchor: left; wrapCount: 30"></a-entity><a-entity icon-row="mergeButtons: true"><a-entity icon-button="#asset-arrow-down-bold" system-click-action="system: material-pack-system; action: addCanvasMaterial" tooltip="Create material pack from canvas"></a-entity><a-entity icon-button="#asset-floppy" system-click-action="system: material-pack-system; action: downloadUserMaterials" tooltip="Download imported materials as pack"></a-entity><a-entity icon-button="#asset-folder-open-outline" tooltip="Load Material Packs" vartiste-extras-popup="category: material-packs"></a-entity></a-entity></a-entity><a-entity v-bind="source: #six-dof-volumetrics; sourceComponent: visible; component: visible; setOnLoad: true"><a-entity icon-row="mergeButtons: true"><a-entity icon-button="#asset-undo" toggle-button="target:a-scene; component: volumetrics; property: undoEnabled" tooltip="Enable / Disable Undo"></a-entity><a-entity icon-button="#asset-transition" toggle-button="target:a-scene; component: volumetrics; property: onion" tooltip="Shell Only"></a-entity><a-entity icon-button="#asset-blur-linear" toggle-button="target:a-scene; component: volumetrics; property: bumpy" tooltip="Bumpy"></a-entity><a-entity icon-button="#asset-blur-preview" toggle-button="target:a-scene; component: volumetrics; property: hard" tooltip="Hard"></a-entity><a-entity icon-button="#asset-blur-linear" toggle-button="target:a-scene; component: volumetrics; property: noisy" tooltip="Noisy"></a-entity><a-entity icon-button="#asset-brush" toggle-button="target:a-scene; component: volumetrics; property: bristles" tooltip="Bristles"></a-entity><a-entity icon-button="#asset-nudge-brush" toggle-button="target:a-scene; component: volumetrics; property: autoDilate" tooltip="Close seams"></a-entity></a-entity></a-entity></a-entity><a-entity bypass-hidden-updates="" id="pencils-and-brushes" visible="false"><a-entity lever="valueRange: 1 0; target: #weighted-pencil; component: manipulator-weight; property: weight; initialValue: 0.7" position="-0.615 -0.177 0" scale="0.5 0.5 0.5" tooltip="Weighted Pencil Weight" tooltip-style="scale: 0.5 0.5 0.5"></a-entity><a-entity id="pencils-and-brushes-scaling" position="-0.4 0.1 0" scale="1.3 1.3 1.3"><a-entity class="pencil-top-row" position="0 0.3 0" rotation="165 0 0"><a-entity pencil-tool="" preactivate-tooltip="Crayon" tooltip-style="scale: 0.3 0.3 1.0; offset: 0 -0.2 -1.3; rotation: -165 0 0"></a-entity><a-entity pencil-tool="scaleTip: false; tipRatio: 0.5" position="0.1 0 0" preactivate-tooltip="Marker" tooltip-style="scale: 0.3 0.3 1.0; offset: 0 -0.2 -1.3; rotation: -165 0 0"></a-entity><a-entity pencil-tool="pressureTip: true; scaleTip: false" position="0.2 0 0" preactivate-tooltip="Pressure Brush" tooltip-style="scale: 0.3 0.3 1.0; offset: 0 -0.2 -1.3; rotation: -165 0 0"></a-entity></a-entity><a-entity class="pencil-mid-row" position="0 0 0.05" rotation="165 0 0" scale="1.5 1.5 1.5"><a-entity pencil-tool="tipRatio: 0.35; radius: 0.01" position="0 0 0" preactivate-tooltip="Solid Pencil" tooltip-style="scale: 0.2 0.2 1.0; offset: 0 -0.2 -1.3; rotation: -165 0 0"></a-entity><a-entity pencil-tool="tipRatio: 0.35; radius: 0.01; pressureTip: true; detailTip: true" position="0.1 0 0" preactivate-tooltip="Pressure Pencil" tooltip-style="scale: 0.2 0.2 1.0; offset: 0 -0.2 -1.3; rotation: -165 0 0"></a-entity><a-entity id="weighted-pencil" manipulator-weight="type: slow; weight: 0.7" pencil-tool="tipRatio: 0.35; radius: 0.01" position="0.2 0 0" preactivate-tooltip="Weighted Pencil" tooltip-style="scale: 0.2 0.2 1.0; offset: 0 -0.2 -1.3; rotation: -165 0 0"></a-entity><a-entity dynamic-pencil-weight="" manipulator-weight="type: slow; weight: 0.2" pencil-tool="tipRatio: 0.35; radius: 0.01" position="0.27 0 0" preactivate-tooltip="Dynamic Weighted Pencil" tooltip-style="scale: 0.2 0.2 1.0; offset: 0 -0.2 -1.3; rotation: -165 0 0"></a-entity></a-entity><a-entity class="pencil-bottom-row" position="0 -0.3 0" rotation="165 0 0"><a-entity pencil-tool="pressureTip: true; extraStates: erasing" position="0 0 0" preactivate-tooltip="Pressure Eraser" tooltip-style="scale: 0.2 0.2 1.0; offset: 0 -0.2 -1.3; rotation: -165 0 0"></a-entity><a-entity pencil-tool="tipRatio: 0.35; radius: 0.01; extraStates: erasing" position="0.1 0 0" preactivate-tooltip="Detail Eraser" tooltip-style="scale: 0.2 0.2 1.0; offset: 0 -0.2 -1.3; rotation: -165 0 0"></a-entity><a-entity pencil-tool="tipRatio: 0.35; radius: 0.01;" position="0.2 0 0" preactivate-tooltip="Locked Brush Eraser" set-brush="brushType: ProceduralBrush; connected: true; color: white; mode: destination-out" tooltip-style="scale: 0.2 0.2 1.0; offset: 0 -0.2 -1.3; rotation: -165 0 0"></a-entity></a-entity></a-entity></a-entity><a-entity bypass-hidden-updates="" id="cameras-and-spray-paint" visible="false"><a-entity camera-tool="" id="perspective-camera" manipulator-weight="weight: 0.7; type: slow" position="0.0 0.2 0" preactivate-tooltip="Perspective Camera" tooltip-style="scale: 0.3 0.3 1.0; offset: 0 -0.2 -1.3"></a-entity><a-entity camera-tool="orthographic: true" position="0.4 0.2 0" preactivate-tooltip="Ortho Camera" tooltip-style="scale: 0.3 0.3 1.0; offset: 0 -0.2 -1.3"></a-entity><a-entity camera-target="" class="clickable" geometry="primitive: dodecahedron; radius: 0.08" manipulator-weight="weight: 0.7; type: slow" material="color: #fcba03; wireframe: true" position="0.6 0.2 0" preactivate-tooltip="Camera Track Target" tooltip-style="scale: 0.3 0.3 1.0; offset: 0 -0.2 -1.3"></a-entity><a-entity position="0.0 -0.1 0" preactivate-tooltip="Spray Paint" spray-can-tool="" tooltip-style="scale: 0.3 0.3 1.0; offset: 0 -0.35 -1.3"></a-entity><a-entity position="0.4 -0.1 0" preactivate-tooltip="Spray Projector" spray-can-tool="projector: true" tooltip-style="scale: 0.3 0.3 1.0; offset: 0 -0.35 -1.3"></a-entity><a-entity position="0.7 -0.1 0" preactivate-tooltip="Material Projector" spray-can-tool="projector: true; materialProjector: true" tooltip-style="scale: 0.3 0.3 1.0; offset: 0 -0.35 -1.3"></a-entity><a-entity position="0.4 -0.5 0" preactivate-tooltip="Ortho Spray Projector" spray-can-tool="projector: true; orthographic: true" tooltip-style="scale: 0.3 0.3 1.0; offset: 0 -0.35 -1.3"></a-entity></a-entity><a-entity id="misc-six-dof-tools" visible="false"><a-entity eye-drop-tool="" position="-0.35 0 0" preactivate-tooltip="Color Picker" tooltip-style="scale: 0.3 0.3 1.0; offset: 0 -0.3 0"></a-entity><a-entity position="0 0 0" preactivate-tooltip="Multi Grabber" selection-box-tool="" tooltip-style="scale: 0.3 0.3 1.0; offset: 0 -0.1 -1.3"></a-entity><a-entity grouping-tool="" position="0.3 0 0" preactivate-tooltip="Grouping Tool" tooltip-style="scale: 0.3 0.3 1.0; offset: 0 -0.1 -1.3"></a-entity><a-entity desk-registration-tool="" position="-0.35 -0.6 0" preactivate-tooltip="Desk Alignment" tooltip-style="scale: 0.3 0.3 1.0; offset: 0 -0.3 -1.3"></a-entity><a-entity position="0 -0.6 0" preactivate-tooltip="Straight Edge" scale="5 5 5" straight-edge-tool="" tooltip-style="scale: 0.1 0.1 1.0; offset: 0 -0.47 -1.3"></a-entity><a-entity position="0.3 -0.6 0" preactivate-tooltip="Weight" tool-weight-tool="" tooltip-style="scale: 0.3 0.3 1.0; offset: 0 -0.3 -1.3"></a-entity></a-entity><a-entity id="view-six-dof-tools" visible="false"><a-entity position="0 0.5 0"><a-entity position="-0.35 0 0" preactivate-tooltip="Viewport Positioner" tooltip-style="scale: 0.3 0.3 1.0; offset: 0 -0.1 -1.3" viewport-tool=""></a-entity><a-entity class="grab-root" grab-activate="" grab-redirector="target: #canvas-root; resetOnClick: true" position="0 0.3 0" preactivate-tooltip="Scene Grabber" scale="0.3 0.3 0.3" six-dof-tool=""></a-entity><a-entity movement-tool="" position="0.3 0 0" preactivate-tooltip="Movement Tool" tooltip-style="scale: 0.3 0.3 1.0; offset: 0 -0.1 -1.3"></a-entity><a-entity clip-plane-tool="" position="-0.35 -0.6 0" preactivate-tooltip="Clipping Tool" rotation="0 45 0" scale="0.5 0.5 0.5"></a-entity></a-entity></a-entity><a-entity id="six-dof-volumetrics" visible="false"><a-entity position="-0.23 0.43 0"><a-entity scale="0.7 0.7 0.7"><a-entity position=" 0 0" preactivate-tooltip="Volumetric Sphere Brush" volume-sphere-tool=""></a-entity><a-entity position="0.3 0 0" preactivate-tooltip="Volumetric Cone Brush" volume-cone-tool=""></a-entity><a-entity position="0.6 0 0" preactivate-tooltip="Volumetric Cube Brush" volume-cube-tool=""></a-entity><a-entity position="0.8999999999999999 0 0" preactivate-tooltip="Volumetric Hairbrush" volume-brush-tool=""></a-entity></a-entity></a-entity></a-entity><a-entity class="grab-root" id="material-packs" position="4 0 0" visible="false"><a-entity class="pack-container" position="-0.2 0.2 0" scale="0.3 0.3 0.3"></a-entity></a-entity><a-entity bypass-hidden-updates="" class="grab-root" deferred-load="onVisible: true" id="primitive-shapes" position="4 0 0" visible="false"><script id="primitive-construct-template" type="text/slm"><a-entity position="0 0.3 0"><a-entity position="-0.35 0 0" preactivate-tooltip="3D Line Tool" scale="0.7 0.7 0.7" threed-line-tool=""></a-entity><a-entity position="-0.27 0 -0.1" preactivate-tooltip="3D Straight Line Tool" scale="0.7 0.7 0.7" threed-line-tool="pointToPoint: true"></a-entity><a-entity position="-0.43 0 -0.1" preactivate-tooltip="3D Line Tool" scale="0.7 0.7 0.7" threed-line-tool="shape: square"></a-entity><a-entity position="-0.35 -0.6 0" preactivate-tooltip="3D Line Tool" scale="0.7 0.7 0.7" threed-line-tool="shape: oval"></a-entity><a-entity position="-0.27 -0.6 -0.1" preactivate-tooltip="3D Line Tool" scale="0.7 0.7 0.7" threed-line-tool="shape: star"></a-entity><a-entity position="-0.43 -0.6 -0.1" preactivate-tooltip="3D Line Tool" scale="0.7 0.7 0.7" threed-line-tool="shape: heart"></a-entity></a-entity><a-entity scale="0.3 0.3 0.3"><a-entity geometry="primitive: unwrapped-box" position="0 0 0" primitive-construct-placeholder=""></a-entity><a-entity geometry="primitive: sphere; radius: 0.5; segmentsWidth: 10; segmentsHeight: 12" position="1.25 0 0" primitive-construct-placeholder=""></a-entity><a-entity geometry="primitive: cylinder; radius: 0.5; segmentsHeight: 4; segmentsRadial: 10" position="2.5 0 0" primitive-construct-placeholder=""></a-entity><a-entity geometry="primitive: unwrapped-dodecahedron; radius: 0.5" position="0 -1.25 0" primitive-construct-placeholder=""></a-entity><a-entity geometry="primitive: head-base" position="1.25 -1.25 0" primitive-construct-placeholder=""></a-entity><a-entity geometry="primitive: character-base" position="2.5 -1.25 0" primitive-construct-placeholder=""></a-entity><a-entity geometry="primitive: cone; radiusBottom: 0.5; radiusTop: 0; segmentsHeight: 5; segmentsRadial: 10" position="0 -2.5 0" primitive-construct-placeholder=""></a-entity><a-entity geometry="primitive: plane; width: 1; height: 1" position="1.25 -2.5 0" primitive-construct-placeholder=""></a-entity><a-entity geometry="primitive: triangle; width: 1; height: 1" position="2.5 -2.5 0" primitive-construct-placeholder=""></a-entity><a-entity geometry="primitive: plane; width: 2; height: 1; segmentsWidth: 8; segmentsHeight: 4" position="0 -3.75 0" primitive-construct-placeholder=""></a-entity></a-entity><\/script></a-entity></a-entity>'},function(t,e){t.exports='<a-entity class="grab-root" shelf="name: Skeletonator" summoner-position="el: #quick-menu-positioner"><a-entity shelf-summoner="selector: *[skeletonator-control-panel]"></a-entity><a-entity icon-row="" position="-1.5 1.1 0"><a-entity click-action="restPose" icon-button="#asset-bed" tooltip="Reset to Rest Pose"></a-entity><a-entity click-action="setZForward" icon-button="#asset-oven" tooltip="Bake new bones to skeleton"></a-entity><a-entity click-action="exportSkinnedMesh" icon-button="#asset-cube-send" tooltip="Export Mesh + Armature"></a-entity><a-entity click-action="clearTracks" icon-button="#asset-backspace-outline" tooltip="Clear Animation Tracks for All Bones"></a-entity><a-entity click-action="skinFromNodes" icon-button="#asset-light-switch" tooltip="Set Bone Weights from Output Nodes by Name"></a-entity><a-entity click-action="nodesFromSkin" icon-button="#asset-light-switch" tooltip="Create Output Nodes from Bone Names and Existing Weights"></a-entity><a-entity click-action="bakeToGeometry" icon-button="#asset-cylinder" tooltip="Bake Pose to Geometry"></a-entity><a-entity click-action="closeSkeletonator" icon-button="#asset-close-circle-outline" tooltip="Exit Skeletonator"></a-entity></a-entity><a-entity icon-row="" position="-1.5 1.1 0"><a-entity icon-button="#asset-eye" toggle-button="target: *[skeletonator]; component: skeletonator; property: hideSkeleton" tooltip="Toggle Material Display"></a-entity><a-entity icon-button="#asset-hand-no-lines" toggle-button="target: a-scene; component: skeletonator-system; property: lockLength" tooltip="Rotate Only"></a-entity><a-entity click-action="skinFromDistance" icon-button="#asset-swap-horizontal-variant" tooltip="Set bone weights by distance"></a-entity></a-entity><a-entity icon-row="" position="-1.5 1.1 0"><a-entity click-action="bakeAnimations" icon-button="#asset-oven" position="2.7 0 0" tooltip="Bake Animation"></a-entity><a-entity click-action="bakeMorphTarget" icon-button="#asset-cylinder" position="2.7 0 0" tooltip="Bake to Morph Target"></a-entity><a-entity class="action-name" edit-field="type: string; tooltip: Action Name" position="1.15 0 0" text="value: vartisteAction; wrapCount: 20; width: 1.56; frustumCulled: false"></a-entity><a-entity><a-entity edit-field="tooltip: Frame Count; target: *[skeletonator]; component: skeletonator; property: frameCount" position="-0.33" text="value: 100; wrapCount: 4; width: 0.56"></a-entity><a-entity icon-button="#asset-record" position="0.71 0 0" toggle-button="target: *[skeletonator]; component: skeletonator; property: recordFrameCount" tooltip="Set Frame Count from Puppetteering"></a-entity></a-entity></a-entity><a-entity icon-row="" position="0.713 1.1 0"><a-entity class="bone-name" edit-field="type: string; tooltip: Bone Name" not-frustum-culled="" position="-1.6 0 0" text="wrapCount: 20; width: 1.56;"></a-entity><a-entity click-action="deleteActiveBone" icon-button="#asset-delete" tooltip="Delete Bone"></a-entity><a-entity click-action="clearActiveBoneTracks" icon-button="#asset-backspace-outline" tooltip="Clear Bone Animation Tracks"></a-entity></a-entity><a-entity icon-row="" position="0 1.1 0"><a-entity class="frame-counter" position="-1.8 0 0" text="value: Frame #; width: 2; wrapCount: 20; align: left; anchor: left"></a-entity><a-entity icon-button="#asset-arrow-left" system-click-action="system: timeline-system; action: previousFrame" tooltip="Previous Frame"></a-entity><a-entity icon-button="#asset-play-pause" speech-alias="play; pause" system-click-action="system: timeline-system; action: playPauseAnimation" tooltip="Play / Pause"></a-entity><a-entity icon-button="#asset-arrow-right" system-click-action="system: timeline-system; action: nextFrame" tooltip="Next Frame"></a-entity></a-entity><a-entity position="0 2.0 0"><a-sphere class="clickable globe-control" material="wireframe: true" radius="0.6" tooltip="Grab Object"></a-sphere><a-entity class="spawn-point" position="0 1.4 0" scale="0.8 0.8 0.8"></a-entity></a-entity><a-entity lever="axis: x; target: a-scene; component: bone-handle-system; property: radius; valueRange: 0.05 0.001; initialValue: 0.02" position="-2 0 0" rotation="0 180 0" tooltip="Bone Handle Size" tooltip-style="rotation: 0 -180 0"></a-entity><a-entity class="grab-root" position="3.0 0 0" skeletonator-keyframes=""></a-entity><a-entity new-bone-wand="" position="2.7 0 0" preactivate-tooltip="New Bone (Click to create)" scale="5 5 5" tooltip-style="scale: 0.5 0.5 0.5"></a-entity><a-entity ik-handle-tool="" position="3.0 0 0" preactivate-tooltip="IK Solver" rotation="-15 0 0" scale="5 5 5" tooltip-style="scale: 0.5 0.5 0.5"></a-entity></a-entity>'},function(t,e){t.exports='<a-entity scale="0.3 0.3 0.3"><a-entity geometry="primitive: plane; width: 4; height: 0.88" material="src: #asset-shelf; shader: flat" position="0 0 -0.01"></a-entity><a-entity class="frame-idx" text="width: 1.6; wrapCount: 3; anchor: right"></a-entity><a-entity><a-entity click-action="jumpTo" icon-button="#asset-arrow-right" tooltip="Jump To Frame"></a-entity><a-entity click-action="delete" icon-button="#asset-delete" tooltip="Delete Keyframe"></a-entity></a-entity></a-entity>'},function(t,e){t.exports='<a-entity scale="0.1 0.1 0.1" shelf="width: 2; height: 1; frame: false"><a-entity position="0 0.288 0" text="width: 2; wrapCount: 30; value: Warning, logging in will require refreshing the page. Make sure to save your changes first."></a-entity><a-entity icon-row="" position="0.25 -0.25 0" scale="0.7 0.7 0.7"><a-entity icon-button="#asset-close-circle-outline" popup-action="close" tooltip="Cancel"></a-entity><a-entity icon-button="#asset-sketchfab" system-click-action="system: sketchfab; action: login" tooltip="Log into Sketchfab"></a-entity></a-entity></a-entity>'},function(t,e){t.exports='<a-entity class="grab-root" scale="0.1 0.1 0.1" shelf="name: Sketchfab Shelf; closeable: true"><a-entity position="-1.6 1.15 0"><a-entity icon-row=""><a-entity __system-click-action="system: sketchfab; action: login" icon-button="#asset-sketchfab" popup-button="popup: sketchfab-confirm-popup; deferred: true" tooltip="Log into Sketchfab"></a-entity><a-entity icon-button="#asset-close-circle-outline" system-click-action="system: sketchfab; action: logout" tooltip="Logout"></a-entity><a-entity position="0.8 0 0" sketchfab-user-info="" text="anchor: left; width: 2; wrapCount: 25; value: Not Logged into Sketchfab "></a-entity></a-entity><a-entity icon-row=""><a-entity icon-button="#asset-cube-send" system-click-action="system: sketchfab; action: upload" tooltip="Export to Sketchfab"></a-entity><a-entity icon-button="#asset-badge-account-horizontal-outline" toggle-button="target: a-scene; component: settings-system; property: addReferences;" tooltip="Import as reference model"></a-entity></a-entity><a-entity icon-row=""><a-entity icon-button="" system-click-action="system: sketchfab; action: purchasedModels" text="value: $$; color: #FFF; wrapCount: 3; align: center; width: 0.4" tooltip="Show purchased models"></a-entity><a-entity _toggle-button="target: a-scene; component: sketchfab; property: onlyMyModels" icon-button="#asset-account-voice" system-click-action="system: sketchfab; action: myModels" tooltip="Show my models"></a-entity><a-entity icon-button="#asset-web" system-click-action="system: sketchfab; action: executeSearch" tooltip="Search"></a-entity><a-entity edit-field="type: string; tooltip: Edit Search Query" icon-button="#asset-lead-pencil" id="sketchfab-search-field" text="align: left; anchor: left; xOffset: 0.3; value: Search; width: 1.5; wrapCount: 15"></a-entity></a-entity><a-entity icon-row="" id="sketchfab-search-results"></a-entity></a-entity></a-entity>'},function(t,e){t.exports='<a-entity class="standard-sizes" shelf="name: Standard Sizes; closeable: true"><a-entity position="0 1 0"><a-entity icon-row=""><a-entity text="width: 2; anchor: right; value: 1024x768; wrapCount: 10"></a-entity><a-entity click-action="newComposition" icon-button="#asset-file-outline" popup-action="close" position="0.5 0 0" size="width: 1024; height: 768" tooltip="New Composition"></a-entity><a-entity click-action="resample" icon-button="#asset-resize" popup-action="close" position="0.5 0 0" size="width: 1024; height: 768" tooltip="Resize"></a-entity><a-entity click-action="resizeCanvas" icon-button="#asset-arrow-all" popup-action="close" position="0.5 0 0" size="width: 1024; height: 768" tooltip="Resize Canvas Only"></a-entity></a-entity><a-entity icon-row=""><a-entity text="width: 2; anchor: right; value: 1024x1024; wrapCount: 10"></a-entity><a-entity click-action="newComposition" icon-button="#asset-file-outline" popup-action="close" position="0.5 0 0" size="width: 1024; height: 1024" tooltip="New Composition"></a-entity><a-entity click-action="resample" icon-button="#asset-resize" popup-action="close" position="0.5 0 0" size="width: 1024; height: 1024" tooltip="Resize"></a-entity><a-entity click-action="resizeCanvas" icon-button="#asset-arrow-all" popup-action="close" position="0.5 0 0" size="width: 1024; height: 1024" tooltip="Resize Canvas Only"></a-entity></a-entity><a-entity icon-row=""><a-entity text="width: 2; anchor: right; value: 2048x2048; wrapCount: 10"></a-entity><a-entity click-action="newComposition" icon-button="#asset-file-outline" popup-action="close" position="0.5 0 0" size="width: 2048; height: 2048" tooltip="New Composition"></a-entity><a-entity click-action="resample" icon-button="#asset-resize" popup-action="close" position="0.5 0 0" size="width: 2048; height: 2048" tooltip="Resize"></a-entity><a-entity click-action="resizeCanvas" icon-button="#asset-arrow-all" popup-action="close" position="0.5 0 0" size="width: 2048; height: 2048" tooltip="Resize Canvas Only"></a-entity></a-entity><a-entity icon-row=""><a-entity text="width: 2; anchor: right; value: 1024x1325; wrapCount: 10"></a-entity><a-entity click-action="newComposition" icon-button="#asset-file-outline" popup-action="close" position="0.5 0 0" size="width: 1024; height: 1325" tooltip="New Composition"></a-entity><a-entity click-action="resample" icon-button="#asset-resize" popup-action="close" position="0.5 0 0" size="width: 1024; height: 1325" tooltip="Resize"></a-entity><a-entity click-action="resizeCanvas" icon-button="#asset-arrow-all" popup-action="close" position="0.5 0 0" size="width: 1024; height: 1325" tooltip="Resize Canvas Only"></a-entity></a-entity><a-entity icon-row=""><a-entity text="width: 2; anchor: right; value: 1920x1080; wrapCount: 10"></a-entity><a-entity click-action="newComposition" icon-button="#asset-file-outline" popup-action="close" position="0.5 0 0" size="width: 1920; height: 1080" tooltip="New Composition"></a-entity><a-entity click-action="resample" icon-button="#asset-resize" popup-action="close" position="0.5 0 0" size="width: 1920; height: 1080" tooltip="Resize"></a-entity><a-entity click-action="resizeCanvas" icon-button="#asset-arrow-all" popup-action="close" position="0.5 0 0" size="width: 1920; height: 1080" tooltip="Resize Canvas Only"></a-entity></a-entity></a-entity></a-entity>'},function(t,e){t.exports='<a-entity class="node-shelf grab-root" shelf=""><a-entity position="0 1.2 0"><a-entity click-action="delete" icon-button="#asset-delete" tooltip="Delete Node"></a-entity></a-entity><a-entity position="-2.5 -1.3 0"></a-entity><a-entity node-output="" position="2.1 1.2 0.01"></a-entity><a-entity canvas-updater="throttle: 800" geometry="primitive: plane; width: 3; height: 2" material="shader: flat; transparent: true; npot: true"></a-entity><a-entity position="1.7 0 0"><a-entity class="clickable" geometry="primitive: plane; width: 2; height: 0.3" opacity-picker="" propogate-grab="" rotation="0 0 90"></a-entity></a-entity><a-entity material="color: #34d8eb" node-input="type: destination" position="-2.1 1.2 0.01"></a-entity><a-entity node-input="type: source; index: " position="-2.1 0.7 0.01"></a-entity></a-entity>'},function(t,e){t.exports='<a-entity position="0 0.2 0" propogate-grab="" shelf="width: 0.25; height: 0.65; closeable: false; pinnable: false; frame: false"><a-entity position="0 0.2 0" scale="0.4 0.4 0.4"><a-entity icon-row=""><a-entity click-action="applyKeyframe" icon-button="#asset-skeletonator" tooltip="Apply Keyframe"></a-entity></a-entity><a-entity icon-row=""><a-entity click-action="deleteKeyframe" icon-button="#asset-delete" tooltip="Remove Keyframe"></a-entity></a-entity><a-entity icon-row=""><a-entity class="frame-number" icon-row-text=""></a-entity></a-entity></a-entity></a-entity>'},function(t,e){t.exports='<a-entity class="grab-root" position="-3.0 0.0 0" scale="0.3 0.3 1" shelf="name: Animation Shelf; closeable: true" timeline-shelf="" visible="false"><a-entity position="-1.5 1.1 0"><a-entity click-action="firstFrame" icon-button="#asset-arrow-collapse-left" tooltip="Jump to First Frame"></a-entity><a-entity click-action="duplicateFrameBefore" icon-button="#asset-plus-box-multiple" tooltip="Duplicate Frame to Before"></a-entity><a-entity click-action="addFrameBefore" icon-button="#asset-plus-box-outline" tooltip="Insert Frame Before"></a-entity><a-entity click-action="previousFrame" icon-button="#asset-arrow-left" tooltip="Previous Frame"></a-entity><a-entity click-action="playPauseAnimation" icon-button="#asset-play-pause" speech-alias="play; pause" tooltip="Play / Pause"></a-entity><a-entity click-action="nextFrame" icon-button="#asset-arrow-right" tooltip="Next Frame"></a-entity><a-entity click-action="addFrameAfter" icon-button="#asset-plus-box-outline" tooltip="Insert Frame After"></a-entity><a-entity click-action="duplicateFrameAfter" icon-button="#asset-plus-box-multiple" tooltip="Duplicate Frame to After"></a-entity></a-entity><a-entity position="0 0.3 0"><a-entity class="frame-counter" text="value: Frame # / ##; width: 3.5; wrapCount: 20; align: left"></a-entity></a-entity><a-entity position="-1.5 -0.5 0"><a-entity icon-button="#asset-camera" system-click-action="system:timeline-system; action: exportFrames" tooltip="Export Number Of Frames"></a-entity><a-entity icon-button="#asset-record" system-click-action="system:timeline-system; action: exportMP4" tooltip="Export MP4 of Number Of Frames"></a-entity><a-entity icon-button="#asset-gif" system-click-action="system:timeline-system; action: exportGif" tooltip="Export GIF of Number of Frames"></a-entity><a-entity icon-button="#asset-swap-horizontal-variant" system-click-action="system:timeline-system; action: makeUVScrollable" tooltip="**EXPERIMENTAL** Make animation UV-Scrollable"></a-entity><a-entity class="number-of-frames" edit-field="tooltip: End Frame Number; target: a-scene; component: timeline-system; property: endFrameNumber; autoClear: true" position="1.7 0 0" text="value: 10; width: 0.56; wrapCount: 4;"></a-entity></a-entity><a-entity position="-1.5 -1.1 0"><a-entity click-action="deleteFrame" icon-button="#asset-delete" tooltip="Delete Frame"></a-entity><a-entity click-action="toggleOnionSkin" icon-button="#asset-transition" tooltip="Toggle Onion Skin"></a-entity></a-entity><a-entity position="1.5 -1.1 0"><a-entity button-style="toggleOnColor: #e99" click-action="record" icon-button="#asset-record" toggle-button="" tooltip="Record Movie File (Start / Stop)"></a-entity></a-entity><a-entity position="1 0.3 0"><a-entity class="fps" edit-field="tooltip: Frames Per Second" text="value: 10; width: 0.56; wrapCount: 4"></a-entity></a-entity></a-entity>'},function(t,e){t.exports='<a-entity shelf="name: Reference Timer Shelf; closeable: true"><a-entity position="-1.6 1.1 0"><a-entity icon-button="#asset-badge-account-horizontal-outline" toggle-button="target: a-scene; component: timer-system; property: switchReferences" tooltip="Switch References on Timer"></a-entity><a-entity icon-button="#asset-plus-box-multiple" toggle-button="target: a-scene; component: timer-system; property: freshLayer" tooltip="Fresh Layer on Timer"></a-entity><a-entity icon-button="#asset-dice-4" toggle-button="target: a-scene; component: timer-system; property: shuffleReferences" tooltip="Shuffle References"></a-entity><a-entity icon-button="#asset-play-pause" system-click-action="component: timer-system; action: playTimer" tooltip="Start / Pause Timer"></a-entity></a-entity><a-entity position="1.2 1.1 0"><a-entity icon-button="#asset-video-vintage" toggle-button="target: a-scene; component: timer-system; property: hideSpectatorReferences; " tooltip="Hide Reference Photos from Spectator  "></a-entity><a-entity icon-button="#asset-badge-account-horizontal-outline" toggle-button="target: a-scene; component: settings-system; property: addReferences; " tooltip="Import as Reference Photos"></a-entity></a-entity><a-entity position="-1.0 0.1 0"><a-entity class="timer-minutes" edit-field="tooltip: Timer Minutes; type: number" text="value: 00; width: 1; wrapCount: 3"></a-entity></a-entity><a-entity position="0.4 0.1 0"><a-entity class="timer-seconds" edit-field="tooltip: Timer Seconds; type: number" text="value: 00; width: 1; wrapCount: 3"></a-entity></a-entity><a-entity position="0 -1.1 0"><a-entity class="timer-display" text="value: 00:00; width: 4; wrapCount: 8; align: center"></a-entity></a-entity></a-entity>'},function(t,e){t.exports='<a-entity class="grab-root" position="-1.5 -1.5 0" scale="0.3 0.3 1" shelf="name: Experimental Functionality; closeable: true" toolbox-shelf="" visible="false"><a-entity icon-row="mergeButtons: true" position="-1.5 1.1 0"><a-entity click-action="mirrorAnimation" icon-button="#asset-horizontal-rotate-counterclockwise" tooltip="Mirror Animation"></a-entity><a-entity click-action="mergeFrames" icon-button="#asset-archive-arrow-down-outline" tooltip="Merge All Frames"></a-entity><a-entity click-action="collapseLayers" icon-button="#asset-arrow-collapse-vertical" tooltip="Collapse All Layers"></a-entity><a-entity click-action="collapseLayersPerFrame" icon-button="#asset-arrow-collapse-vertical" tooltip="Collapse All Layers Per Frames"></a-entity><a-entity click-action="toggleLathe" icon-button="#asset-axis-z-rotate-clockwise" tooltip="Toggle 3D Lathe"></a-entity><a-entity icon-button="#asset-hand-right" popup-button="popup: manipulator-info-shelf; deferred: true" tooltip="Manipulator Info"></a-entity></a-entity><a-entity icon-row="mergeButtons: true" position="-1.5 1.1 0"><a-entity click-action="recordHeadset" icon-button="#asset-account-voice" tooltip="Record Headset View"></a-entity><a-entity click-action="startSkeletonator" icon-button="#asset-skeletonator" tooltip="Skeletonator Animation Tool"></a-entity><a-entity click-action="presentation" icon-button="#asset-transition" tooltip="Set Presentation Mode (fullscreen canvas)"></a-entity><a-entity icon-button="#asset-nudge-brush" system-click-action="system: networking; action: autoStartMultiplayer" tooltip="Start Randomized Multiplayer"></a-entity></a-entity><a-entity icon-row="mergeButtons: true" position="-1.5 1.1 0"><a-entity icon-button="#asset-web" system-click-action="system: user-media; action: showDesktop" tooltip="Show Desktop"></a-entity><a-entity icon-button="#asset-video-vintage" system-click-action="system: user-media; action: showCamera" tooltip="Show Webcam"></a-entity><a-entity icon-button="#asset-hand-right" system-click-action="system: xr-controllers-only; action: enterSession" tooltip="Use VR Controllers with Desktop Display"></a-entity><a-entity click-action="defaultSpectator" icon-button="#asset-camera" tooltip="Quick Spectator Camera Setup"></a-entity><a-entity icon-button="#asset-badge-account-horizontal-outline" toggle-button="target: a-scene; component: avatar; property: importAvatar" tooltip="Import spectator avatar"></a-entity></a-entity><a-entity icon-row="mergeButtons: true" position="-1.5 1.1 0"><a-entity icon-button="#asset-account-voice" popup-button="popup: kromophone-shelf;  deferred: true; scale: 0.15 0.15 0.15" tooltip="Kromophone color sonification"></a-entity><a-entity icon-button="#asset-rotate-orbit" system-click-action="system: physx; action: startPhysX" tooltip="Start Phyics"></a-entity><a-entity icon-button="#asset-newspaper-variant-outline" system-click-action="system: scene-organizer; action: launchSceneNode" tooltip="Scene Inspector"></a-entity><a-entity icon-button="#asset-lead-pencil" system-click-action="system: scene-organizer; action: launchToolsNode" tooltip="Tool Inspector"></a-entity></a-entity><a-entity position="0 -1.4 0" text="value: *Experimental Tools*; width: 3; wrapCount: 40"></a-entity></a-entity>'},function(t,e){t.exports='<a-entity scale="0.3 0.3 0.3" shelf="name: Tools Quick Menu"><a-entity></a-entity></a-entity>'},function(t,e){t.exports='<a-entity position="-0.23 0.43 0"><a-entity scale="0.7 0.7 0.7"><a-entity position=" 0 0" preactivate-tooltip="Volumetric Sphere Brush" volume-sphere-tool=""></a-entity><a-entity position="0.3 0 0" preactivate-tooltip="Volumetric Cone Brush" volume-cone-tool=""></a-entity><a-entity position="0.6 0 0" preactivate-tooltip="Volumetric Cube Brush" volume-cube-tool=""></a-entity><a-entity position="0.8999999999999999 0 0" preactivate-tooltip="Volumetric Hairbrush" volume-brush-tool=""></a-entity></a-entity></a-entity>'},function(t,e){t.exports='<a-entity scale="0.1 0.1 0.1" shelf="width: 5; height: 5; pinnable: false; closeable: true"><a-entity position="0 2.3 0"><a-entity text="value: Welcome to VARTISTE; anchor: center; align: center; width: 2.9; wrapCount: 20"></a-entity><a-entity position="0 -0.272 0" text="value: Get started; anchor: center; align: center; width: 4.8; wrapCount: 50"></a-entity></a-entity><a-entity position="-1.25 2.0 0"><a-entity position="0 -0.5 0" text="value: Open a File; width: 2.3; wrapCount: 20; align: center"></a-entity><a-entity icon-button="#asset-folder-open-outline" position="-0.852 -0.8 0"><a-entity position="0.3 0 0" text="value: Browse for files; width: 1.4; wrapCount: 15; anchor: left"></a-entity></a-entity><a-entity position="0 -1.8 0" text="value: Drag &amp; Drop a file here to load it.\\nSupported files include .vartistez, .glb, .png, .jpg, .obj; width: 2.3; wrapCount: 20; align: center"></a-entity></a-entity><a-entity position="0.25 2.0 0"><a-entity position="0 -0.5 0" text="value: Start a new Project; width: 2.3; wrapCount: 20; align: center; anchor: left"></a-entity><a-entity position="0.202 -1 0"><a-entity icon-row=""><a-entity click-action="newComposition" icon-button="#asset-file-outline" position="0.0 0 0" size="width: 1024; height: 768" tooltip="New Composition"></a-entity><a-entity position="0.3 0 0" text="width: 1; anchor: left; value: 1024x768; wrapCount: 10"></a-entity></a-entity><a-entity icon-row=""><a-entity click-action="newComposition" icon-button="#asset-file-outline" position="0.0 0 0" size="width: 1024; height: 1024" tooltip="New Composition"></a-entity><a-entity position="0.3 0 0" text="width: 1; anchor: left; value: 1024x1024; wrapCount: 10"></a-entity></a-entity><a-entity icon-row=""><a-entity click-action="newComposition" icon-button="#asset-file-outline" position="0.0 0 0" size="width: 2048; height: 2048" tooltip="New Composition"></a-entity><a-entity position="0.3 0 0" text="width: 1; anchor: left; value: 2048x2048; wrapCount: 10"></a-entity></a-entity><a-entity icon-row=""><a-entity click-action="newComposition" icon-button="#asset-file-outline" position="0.0 0 0" size="width: 1024; height: 1325" tooltip="New Composition"></a-entity><a-entity position="0.3 0 0" text="width: 1; anchor: left; value: 1024x1325; wrapCount: 10"></a-entity></a-entity></a-entity></a-entity><a-entity position="-0.771 -1.971 0" quick-gallery="" scale="2 2 1"></a-entity></a-entity>'},function(t,e,i){"use strict";i.r(e);var n=i(0);AFRAME.registerComponent("tooltip",{schema:{default:""},multiple:!0,events:{mouseenter:function(){this.popup()},mouseleave:function(){this.hide()}},init(){this.targetY=.3;let t=document.createElement("a-entity");this.tooltip=t,t.setAttribute("geometry","primitive: plane; height: 0; width: 0"),t.setAttribute("material","color: #abe; shader: flat"),t.setAttribute("position","0 0.4 0.004"),t.setAttribute("text",`color: #000; width: 1; align: center; value: ${this.data}; wrapCount: 10; zOffset: 0.005; baseline: bottom`),t.setAttribute("text-geometry-shifter",""),t.setAttribute("class","raycast-invisible"),t.setAttribute("visible",!1),this.el.append(t)},update(t){this.el.hasLoaded&&this.tooltip.setAttribute("text",`color: #000;width: 1; align: center; value: ${this.translate(this.data)}`)},remove(){this.el.removeChild(this.tooltip),delete this.tooltip},popup(){this.tooltip.object3D.position.y=this.targetY,this.tooltip.setAttribute("visible",!0),this.el.sceneEl.components.speech.speak(this.data)},hide(){this.el.sceneEl.components.speech.cancel(this.data),this.tooltip.object3D.position.y=-99999999,this.tooltip.setAttribute("visible",!1)},translate(t){return this.el.sceneEl.systems["ui-translation"]?this.el.sceneEl.systems["ui-translation"].translate(t,this.el):t}}),AFRAME.registerComponent("tooltip-style",{dependencies:["tooltip"],multiple:!0,schema:{offset:{type:"vec3",default:new THREE.Vector3(0,0,0)},scale:{type:"vec3",default:new THREE.Vector3(1,1,1)},rotation:{type:"vec3",default:new THREE.Vector3(0,0,0)},wrapCount:{default:10}},update(t){n.Util.whenLoaded(this.el,(()=>{let e=this.el.components[this.attrName.replace("-style","")];e?(e.targetY=this.data.offset.y+.4,e.tooltip.setAttribute("text","wrapCount",this.data.wrapCount),e.tooltip.object3D.position.x=this.data.offset.x,e.tooltip.object3D.position.z=this.data.offset.z+.004,e.tooltip.object3D.scale.copy(this.data.scale),e.tooltip.object3D.rotation.set(this.data.rotation.x*Math.PI/180,this.data.rotation.y*Math.PI/180,this.data.rotation.z*Math.PI/180)):n.Util.callLater(this.update.bind(this,t))}))}}),AFRAME.registerComponent("preactivate-tooltip",{schema:{default:""},events:{activate:function(){this.el.setAttribute("action-tooltips","label",this.data),this.el.removeAttribute("tooltip"),this.el.removeAttribute("preactivate-tooltip")}},update(){this.el.setAttribute("tooltip",this.data)}}),AFRAME.registerComponent("hidden-tooltip",{schema:{default:""},init(){this.el.setAttribute("tooltip-style","offset: 0 -999999 0")},update(){this.el.setAttribute("tooltip",this.data)}}),AFRAME.registerComponent("previsible-tooltip",{init(){n.Util.whenComponentInitialized(this.el,"tooltip",(()=>{console.log("Popping up previs"),this.el.components.tooltip.popup()}))}})},function(t,e,i){"use strict";i.r(e);var n=i(0),r=i(3);AFRAME.registerSystem("frame",{init(){this.pinnedTargets={},this.el.addEventListener("startsnap",(()=>{document.querySelectorAll("*[frame]").forEach((t=>t.components.frame.hide()))})),this.el.addEventListener("endsnap",(()=>{document.querySelectorAll("*[frame]").forEach((t=>t.components.frame.unhide()))}))},pinFrameTo(t,e){this.pinnedTargets[e.id]=this.pinnedTargets[e.id]||[];let i=this.pinnedTargets[e.id];for(var n=-1;void 0!==i[++n];);return i[n]=t,n},unpinFrameFrom(t,e){this.pinnedTargets[e.id]=this.pinnedTargets[e.id]||[];let i=this.pinnedTargets[e.id].indexOf(t);i>=0&&(this.pinnedTargets[e.id][i]=void 0)}}),AFRAME.registerComponent("frame",{schema:{closable:{default:!0},pinnable:{default:!0},hideOnly:{default:!1},closePopup:{default:!1},outline:{default:!0},outlineColor:{type:"color",default:"#52402b"},tooltipStyle:{type:"string",default:"scale: 3 3 3; offset: 0 0.0 0"},buttonScale:{default:.03},geometryTarget:{type:"selector"},useBounds:{default:!1},autoHide:{default:!1},autoHideTimeout:{default:500},grabbable:{default:!0},name:{type:"string"}},events:{click:function(t){t.target.hasAttribute("frame-action")&&(this[t.target.getAttribute("frame-action")](t),t.stopPropagation())},"raycaster-intersected":function(t){this.data.autoHide&&(this.hideTiemout&&(window.clearTimeout(this.hideTiemout),this.hideTiemout=null),this.unhide())},"raycaster-intersected-cleared":function(t){this.data.autoHide&&this.startAutoHide()},componentchanged:function(t){"visible"===t.detail.name&&this.relayout()},popupshown:function(t){this.relayout()}},init(){r.Pool.init(this,{useSystem:!0});let t=this.data.geometryTarget||this.el;this.center=new THREE.Vector3,this.updateBounds();let{width:e,height:i}=this;t.addEventListener("componentinitialized",(t=>{"geometry"===t.detail.name&&this.update(this.data)})),this.buttonCount=0,this.buttonRow=document.createElement("a-entity"),this.el.append(this.buttonRow),this.buttonRow.object3D.userData.vartisteUI=!0,this.objects=[],this.data.autoHide&&n.Util.whenLoaded(this.el,(()=>this.startAutoHide()))},remove(){this.lineObject&&this.lineObject.parent&&this.lineObject.parent.remove(this.lineObject);for(let t of this.objects)t.parentEl&&t.parentEl.remove(t);this.objects=[]},updateBounds(){let t,e;if(this.data.useBounds){let i,r=this.data.geometryTarget||this.el;if(r.getObject3D("mesh")&&r.getObject3D("mesh").geometry)r.getObject3D("mesh").geometry.computeBoundingBox(),i=r.getObject3D("mesh").geometry.boundingBox,t=(i.max.x-i.min.x)*r.getObject3D("mesh").scale.x,e=(i.max.y-i.min.y)*r.getObject3D("mesh").scale.y;else{let a=this.pool("inv",THREE.Matrix4);i=n.Util.recursiveBoundingBox(r.object3D),a.copy(r.object3D.matrixWorld).invert(),i.applyMatrix4(a),i.expandByScalar(.3),i.getCenter(this.center),t=i.max.x-i.min.x,e=i.max.y-i.min.y}console.log("Bounds",i,t,e)}else{let i=(this.data.geometryTarget||this.el).getAttribute("geometry");i?(t=i.width,e=i.height):(t=1,e=1)}this.width=t,this.height=e},update(t){if(!this.objects)return;this.updateBounds();let{width:e,height:r}=this;if(this.data.closable&&!t.closable){let t=this.addButton("#asset-close-circle-outline");t.setAttribute("frame-action","closeFrame"),t.setAttribute("tooltip","Close"),t.setAttribute("tooltip-style",this.data.tooltipStyle)}else!this.data.closable&&t.closable&&this.removeButton("#asset-close-circle-outline");if(this.data.pinnable&&!t.pinnable){let t=this.addButton("#asset-hand-right");t.setAttribute("frame-action","pinFrame"),t.setAttribute("tooltip","Pin / Unpin to opposite hand"),t.setAttribute("tooltip-style",this.data.tooltipStyle)}else!this.data.pinnable&&t.pinnable&&this.removeButton("#asset-close-circle-outline");if(this.data.name&&!this.title){let{width:t,height:e}=this,n=document.createElement("a-entity");n.setAttribute("position",`${-t/2+.055+this.center.x} ${e/2+.055+this.center.y} ${this.center.z}`),n.setAttribute("text",`color: #FFF; width: ${t/2}; align: left; anchor: left; value: ${this.data.name}; wrapCount: 20; zOffset: 0.005; font: ${i(38)}`),n.setAttribute("troika-text","outlineBlur",.03),n.setAttribute("troika-text","outlineColor","#0b0804"),n.setAttribute("troika-text","outlineWidth",.03),n.setAttribute("troika-text","outlineOpacity",2),n.setAttribute("class","raycast-invisible"),this.el.append(n),n.object3D.userData.vartisteUI=!0,this.objects.push(n.object3D),this.title=n}else this.data.name&&this.data.name!==t.name&&this.title.setAttribute("text","value",this.data.name);let a=-.001;if(!this.data.outline||this.lineObject||isNaN(e)||isNaN(r))this.data.outline&&this.lineObject?(this.lineObject.geometry.vertices[0].set(-e/2,r/2,a),this.lineObject.geometry.vertices[1].set(e/2,r/2,a),this.lineObject.geometry.vertices[2].set(e/2,-r/2,a),this.lineObject.geometry.vertices[3].set(-e/2,-r/2,a),this.lineObject.geometry.vertices[4].set(-e/2,r/2,a)):!this.data.outline&&this.lineObject&&(this.el.object3D.remove(this.lineObject),delete this.lineObject,this.objects.splice(this.objects.indexOf(this.lineObject),1));else{let t=(new THREE.BufferGeometry).setFromPoints([new THREE.Vector3(-e/2,r/2,a),new THREE.Vector3(e/2,r/2,a),new THREE.Vector3(e/2,-r/2,a),new THREE.Vector3(-e/2,-r/2,a),new THREE.Vector3(-e/2,r/2,a)]),i=new THREE.Line(t,new THREE.LineBasicMaterial({color:this.data.outlineColor,linewidth:5}));i.userData.vartisteUI=!0,this.el.object3D.add(i),this.lineObject=i,this.objects.push(i)}this.data.grabbable?this.el.classList.add("clickable"):this.el.classList.remove("clickable"),this.width=e,this.height=r,this.relayout(),this.data.autoHide&&n.Util.whenLoaded(this.el,(()=>this.startAutoHide()))},addButton(t){let{width:e,height:i}=this,n=document.createElement("a-entity");return n.setAttribute("icon-button",t),n.setAttribute("button-style","buttonType: plane; color: #26211c"),n.setAttribute("scale","0.3 0.3 0.3"),n.setAttribute("tooltip-style",this.data.tooltipStyle),this.buttonRow.append(n),this.objects.push(n),this.relayout(),n},removeButton(t){let e=this.objects.find((e=>e.getAttribute("icon-button")===t));e?(idx=this.objects.indexOf(e),this.objects.splice(idx,1),this.buttonRow.remove(e)):console.warn("Can't find icon to remove button",t)},relayout(){this.needsLayout=!0,n.Util.whenLoaded(this.el,(()=>{n.Util.callLater((()=>this._relayout()))}))},_relayout(){if(!this.needsLayout)return;let t=0,{width:e,height:i}=this,n=this.pool("worldScale",THREE.Vector3),r=this.pool("parentScale",THREE.Vector3),a=this.data.buttonScale;this.el.object3D.getWorldScale(n),n.x=a/n.x,n.y=a/n.y,n.z=a/n.z,this.el.object3D.parent.getWorldScale(r);for(let a of this.buttonRow.children)a.hasAttribute("text")?a.object3D.scale.z=1:(a.object3D.position.set(e/2-.2*n.x-.55*t/r.x*n.x,i/2+.2*n.y,0),a.setAttribute("scale",n),t++);this.lineObject&&this.lineObject.position.copy(this.center),this.buttonRow.object3D.position.copy(this.center),this.needsLayout=!1},closeFrame(){this.data.closePopup?this.el.emit("popupaction","close"):this.data.hideOnly?this.el.setAttribute("visible",!1):this.el.parentEl.removeChild(this.el)},pinFrame(t){if(this.el.is("pinned"))return this.system.unpinFrameFrom(this,this.el.object3D.parent.el),this.el.object3D.parent.remove(this.el.object3D),this.originalParent.add(this.el.object3D),n.Util.applyMatrix(this.originalMatrix,this.el.object3D),void this.el.removeState("pinned");let e=t.detail.cursorEl;if(!e)throw new Error("No cursor in event",t);let i,{width:r,height:a}=(this.data.geometryTarget||this.el).getAttribute("geometry"),o=this.el.getAttribute("scale");this.originalMatrix=this.originalMatrix||new THREE.Matrix4,this.originalMatrix.copy(this.el.object3D.matrix),this.originalParent=this.el.object3D.parent;let s=this.pool("offset",THREE.Vector3),l=this.pool("pinSize",THREE.Vector3),c=r/a>4/3?4/r:3/a;if(l.set(.05*c,.05*c,.05*c),"right-hand"===e.id){i=document.querySelector("#left-hand");this.system.pinFrameTo(this,i);s.set(0,a/2*o.y*l.y,0)}else if("left-hand"===e.id){i=document.querySelector("#right-hand");this.system.pinFrameTo(this,i);s.set(0,a/2*o.y*l.y,0)}else{i=document.querySelector("#camera");let t=this.system.pinFrameTo(this,i);s.set(.04*t-.07,-.07,-.1),l.set(.01*c,.01*c,.001)}this.el.object3D.parent.remove(this.el.object3D),i.object3D.add(this.el.object3D),n.Util.positionObject3DAtTarget(this.el.object3D,i.object3D,{scale:l,transformOffset:s}),this.el.addState("pinned")},hide(){if(this.objects)for(let t of this.objects)t=t.object3D?t.object3D:t,t.visible=!1},unhide(){if(this.objects)for(let t of this.objects)t=t.object3D?t.object3D:t,t.visible=!0},startAutoHide(){this.hideTiemout||(this.hideTiemout=window.setTimeout((()=>this.hide()),this.data.autoHideTimeout))}})},function(t,e,i){"use strict";i.r(e);var n=i(0);i(270),AFRAME.registerComponent("bypass-hidden-updates",{init(){let t=this.el.object3D.updateMatrixWorld;this.el.object3D.updateMatrixWorld=function(){this.visible&&t.apply(this)}}}),AFRAME.registerComponent("remove-audio-listener",{init(){this.el.object3D.traverse((t=>{"AudioListener"===t.type&&t.parent.remove(t)}))}}),AFRAME.registerComponent("fix-light-shadow",{events:{componentchanged:function(t){this.el.sceneEl.time>2e3&&this.el.components.light.updateShadow()}},init(){VARTISTE.Util.whenLoaded(this.el,(()=>{}))},tick(t,e){t>2e3&&(this.el.components.light.updateShadow(),this.tick=function(){})}}),n.Util.registerComponentSystem("optimize-mesh-raycast",{schema:{ignoreMorphTargets:{default:!0},ignoreSkinning:{default:!1}},init(){this.oldRayCast=THREE.Mesh.prototype.raycast},update(){var t=!1,e=!1,i=this.oldRayCast,n=this.data;THREE.Mesh.prototype.raycast=function(...r){t=this.isSkinnedMesh,this.isSkinnedMesh=this.isSkinnedMesh&&this.material.skinning&&!n.ignoreSkinning,e=this.material.morphTargets,this.material.morphTargets=this.material.morphTargets&&!n.ignoreMorphTargets;let a=i.call(this,...r);return this.isSkinnedMesh=t,this.material.morphTargets=e,a}}}),AFRAME.registerComponent("raycast-bvh",{schema:{throttle:{default:-1}},events:{object3dset:function(t){this.compute()}},init(){this.el.getObject3D("mesh")&&this.compute()},update(t){this.data.throttle>=0?this.tick=AFRAME.utils.throttleTick(this.compute,this.data.throttle,this):this.tick=function(){}},compute(){this.el.object3D.traverse((t=>{t.geometry&&!t.geometry.boundsTree&&t.geometry.attributes.position&&t.geometry.attributes.position.count>6&&t.geometry.computeBoundsTree()}))},tick(t,e){}}),AFRAME.registerSystem("low-power",{schema:{lowPower:{default:n.Util.isLowPower()}},init(){console.info("Low power mode is",this.data.lowPower?"on":"off")},isLowPower(){return this.data.lowPower}}),AFRAME.registerComponent("set-low-power",{multiple:!0,schema:{target:{default:null},component:{type:"string"}},updateSchema(t){let e=t.target||this.el;if(!t.component)return;let i={};for(let n in e.components[t.component].schema)i[n]={default:null};this.extendSchema(i)},update(t){let e=this.data.target||this.el;if(!e||!this.data.component)return;if(!this.el.sceneEl.systems["low-power"].isLowPower())return;let i={};AFRAME.utils.diff(t,this.data,i);for(let t in i)"component"!==t&&"target"!==t&&null!==i[t]&&e.setAttribute(this.data.component,t,i[t])}}),AFRAME.registerComponent("hide-low-power",{init(){this.el.sceneEl.systems["low-power"].isLowPower()&&(this.el.setAttribute("bypass-hidden-updates",""),this.el.setAttribute("visible","false"))}}),AFRAME.registerComponent("delete-low-power",{init(){this.el.sceneEl.systems["low-power"].isLowPower()&&n.Util.whenLoaded(this.el,(()=>{this.el.parentEl.removeChild(this.el)}))}})},function(t,e,i){"use strict";i.r(e);var n=i(14);THREE.BufferGeometry.prototype.computeBoundsTree=n.computeBoundsTree,THREE.BufferGeometry.prototype.disposeBoundsTree=n.disposeBoundsTree,THREE.Mesh.prototype.raycast=n.acceleratedRaycast,THREE.MeshBVH=i(14)},function(t,e,i){"use strict";i.r(e);var n=i(0),r=i(8);const a=i(13),o=window.SpeechRecognition||window.webkitSpeechRecognition,s=window.SpeechGrammarList||window.webkitSpeechGrammarList;n.Util.registerComponentSystem("speech",{schema:{speak:{default:!1},autoRestart:{default:!1}},init(){this.utteranceCache={};let t=new URLSearchParams(document.location.search);"true"===t.get("speak")?this.el.setAttribute("speech",{speak:!0}):"false"===t.get("speak")?this.el.setAttribute("speech",{speak:!1}):"true"===localStorage.speak&&this.el.setAttribute("speech",{speak:!0}),o&&(this.recognition=new o,this.recognition.onresult=t=>{console.log("Speech Result",t.results),this.handleRecognitionTranscript(t.results[0][0].transcript,t.results)},this.recognition.onstart=t=>{this.isListening=!0},this.recognition.onerror=t=>{console.log("recognition error",t),this.el.emit("recognitionerror",{})},this.recognition.onend=t=>{this.isListening=!1,this.data.autoRestart&&window.setTimeout((()=>this.recognition.start()),200)},this.el.addEventListener("recognitionerror",(()=>r.a.recognitionerror(this.el))))},update(){localStorage.speak=this.data.speak},speak(t){if(!this.data.speak)return;window.speechSynthesis.cancel();let e=t;e instanceof SpeechSynthesisUtterance||(t in this.utteranceCache||(this.utteranceCache[t]=new SpeechSynthesisUtterance(t)),e=this.utteranceCache[t]),e.onend=()=>{this.currentUtterance==e&&delete this.currentUtterance},this.currentUtterance=e,window.speechSynthesis.speak(e)},cancel(t){this.data.speak&&this.currentUtterance&&(t instanceof SpeechSynthesisUtterance&&t===this.currentUtterance||this.currentUtterance.text==t)&&window.speechSynthesis.cancel()},buildGrammar(){let t=Array.from(document.querySelectorAll("*[tooltip]")),e=[];e.length=t.length;for(let i=0;i<e.length;++i){let n=t[i].getAttribute("tooltip").replace(/[^\w]/g,"");e[i]=`${n[i]} {TT${i}}`}var i=`\n    #JSGF V1.0;\n    grammar vartiste;\n    <color> = aqua | azure | beige | bisque | black | blue | brown | chocolate | coral | crimson | cyan | fuchsia | ghostwhite | gold | goldenrod | gray | green | indigo | ivory | khaki | lavender | lime | linen | magenta | maroon | moccasin | navy | olive | orange | orchid | peru | pink | plum | purple | red | salmon | sienna | silver | snow | tan | teal | thistle | tomato | turquoise | violet | white | yellow ;\n    public <command> = ${e.join(" | ")};\n    `,n=new s;n.addFromString(i,1),this.recognition.grammars=n},listen(){this.buildGrammar(),this.recognition.start()},handleRecognitionTranscript(t){r.a.recognition(this.el);let e=document.querySelector("input:focus");if(e)return"okay"===t&&e.editField?void e.editField.ok():"clear"===t?void e.editField.clear():(e.value=t,void e.dispatchEvent(new Event("input")));let i=Array.from(document.querySelectorAll("*[tooltip]")).find((e=>e.getAttribute("tooltip").toLowerCase()===t.toLowerCase()));if(i||(i=Array.from(document.querySelectorAll("*[speech-alias]")).find((e=>e.getAttribute("speech-alias").split(";").some((e=>e.trim().toLowerCase()===t.toLowerCase()))))),i)i.emit("click",{type:"speech"},!0);else{try{let e=a(t.toLowerCase()).rgb().hex();return void this.el.systems["paint-system"].selectColor(e)}catch(t){}console.warn("Text unrecognized:",t),this.el.emit("recognitionerror",{text:t})}}}),AFRAME.registerComponent("speech-recognition-button",{dependencies:["icon-button","button-style"],events:{click:function(){this.el.sceneEl.systems.speech.isListening?this.el.sceneEl.systems.speech.stopListening():this.el.sceneEl.systems.speech.listen()}},init(){n.Util.whenLoaded(this.el.sceneEl,(()=>{let t=this.el.sceneEl.systems.speech.recognition;t?(this.originalColor=this.el.components["button-style"].data.color,t.addEventListener("start",(()=>{this.inError||(this.originalColor=this.el.components["button-style"].data.color),this.inError=!1,this.el.setAttribute("button-style",{color:this.el.components["button-style"].data.toggleOnColor})})),t.addEventListener("end",(()=>{this.inError||this.el.setAttribute("button-style",{color:this.originalColor})})),this.el.sceneEl.addEventListener("recognitionerror",(()=>{this.inError=!0,this.el.setAttribute("button-style",{color:"#f50f41"}),window.setTimeout((()=>this.el.setAttribute("button-style",{color:this.originalColor})),1e3)}))):this.el.setAttribute("visible","false")}))}})},function(t,e,i){const n=AFRAME.utils,{Util:r}=i(0),{THREED_MODES:a}=i(2);function o(t,e){return e.color.set(t.color),e.fog=t.fog,t.normalMap&&(e.normalScale=t.normalScale),t.displacementMap&&(e.displacementScale=t.displacementScale,e.displacementBias=t.displacementBias),e}updateMatcapMap=function(t,e){var i=t.el,r=t.material,a=(i.sceneEl.systems.renderer,e.matcap),o={};if(o.src=a,o.offset=e.matcapTextureOffset,o.repeat=e.matcapTextureRepeat,o.wrap=e.matcapTextureWrap,a){if(a===t.matcapTextureSrc)return;return t.matcapTextureSrc=a,void i.sceneEl.systems.material.loadTexture(a,o,s)}function s(t){r.matcap=t,r.needsUpdate=!0,n.material.handleTextureEvents(i,t)}r.map&&s(null)},AFRAME.registerShader("matcap",{schema:{color:{type:"color"},displacementMap:{type:"map"},displacementScale:{default:1},displacementBias:{default:.5},displacementTextureOffset:{type:"vec2"},displacementTextureRepeat:{type:"vec2",default:{x:1,y:1}},fog:{default:!0},height:{default:256},normalMap:{type:"map"},normalScale:{type:"vec2",default:{x:1,y:1}},normalTextureOffset:{type:"vec2"},normalTextureRepeat:{type:"vec2",default:{x:1,y:1}},offset:{type:"vec2",default:{x:0,y:0}},repeat:{type:"vec2",default:{x:1,y:1}},src:{type:"map"},matcap:{type:"map",default:"#asset-matcap"},width:{default:512},wireframe:{default:!1},wireframeLinewidth:{default:2}},init:function(t){this.rendererSystem=this.el.sceneEl.systems.renderer,this.materialData={color:new THREE.Color},o(t,this.materialData),this.rendererSystem.applyColorCorrection(this.materialData.color),this.rendererSystem.applyColorCorrection(this.materialData.emissive),this.material=new THREE.MeshMatcapMaterial(this.materialData),t.wireframe&&(this.material.wireframe=t.wireframe,this.material.wireframeLinewidth=t.wireframeLinewidth),n.material.updateMap(this,t),t.normalMap&&n.material.updateDistortionMap("normal",this,t),t.displacementMap&&n.material.updateDistortionMap("displacement",this,t),t.matcap&&n.material.updateDistortionMap("matcap",this,t)},update:function(t){this.updateMaterial(t),n.material.updateMap(this,t),t.normalMap&&n.material.updateDistortionMap("normal",this,t),t.displacementMap&&n.material.updateDistortionMap("displacement",this,t),t.matcap&&updateMatcapMap(this,t)},updateMaterial:function(t){var e,i=this.material;for(e in o(t,this.materialData),this.rendererSystem.applyColorCorrection(this.materialData.color),this.materialData)i[e]=this.materialData[e]}}),AFRAME.registerComponent("apply-material-to-mesh",{dependencies:["material"],init(){r.whenLoaded(this.el,(()=>this.applyMaterial())),this.el.addEventListener("object3dset",(t=>{this.applyMaterial()})),this.el.addEventListener("componentchanged",(t=>{"material"===t.detail&&this.applyMaterial()}))},applyMaterial(t){if(!this.el.hasAttribute("material"))return;if(t||(t=this.el.getObject3D("mesh")),!t)return;let e=this.el.components.material.material;t.traverse((t=>{t.material&&(t.material=e)}))}});const s=["map"].concat(a);AFRAME.registerComponent("uv-scroll",{schema:{useGltfExtensionData:{default:!0},requireGltfExtension:{default:!1},speed:{type:"vec2"},increment:{type:"vec2"}},events:{object3dset:function(t){"mesh"===t.detail&&this.resetObjectList()},"model-loaded":function(){this.resetObjectList()}},init(){this.offset=new THREE.Vector2,this.tick=AFRAME.utils.throttleTick(this.tick,10,this),this.objs=[],this.el.getObject3D("mesh")&&this.resetObjectList()},resetObjectList(){this.objs=[],this.el.getObject3D("mesh").traverse((t=>{t.material&&(this.data.useGltfExtensionData&&t.userData&&t.userData.gltfExtensions&&t.userData.gltfExtensions.MOZ_hubs_components&&t.userData.gltfExtensions.MOZ_hubs_components["uv-scroll"]?(this.objs.push(t),this.data.speed.x=t.userData.gltfExtensions.MOZ_hubs_components["uv-scroll"].speed.x,this.data.speed.y=t.userData.gltfExtensions.MOZ_hubs_components["uv-scroll"].speed.y,this.data.increment.x=t.userData.gltfExtensions.MOZ_hubs_components["uv-scroll"].increment.x,this.data.increment.y=t.userData.gltfExtensions.MOZ_hubs_components["uv-scroll"].increment.y):this.data.requireGltfExtension||this.objs.push(t))}))},tick(t,e){if(0!==this.objs.length){this.offset.addScaledVector(this.data.speed,e/1e3),this.offset.x=this.offset.x%1,this.offset.y=this.offset.y%1;for(let t of this.objs)for(let e of s){if(!t.material[e])return;t.material[e].offset.x=this.data.increment.x?this.offset.x-this.offset.x%this.data.increment.x:this.offset.x,t.material[e].offset.y=this.data.increment.y?this.offset.y-this.offset.y%this.data.increment.y:this.offset.y}}}})},function(t,e,i){"use strict";i.r(e);var n=i(0);AFRAME.registerComponent("desktop-controls",{dependencies:["wasd-controls","look-controls"],schema:{velocity:{default:.001}},init(){this.el.setAttribute("wasd-controls","wsInverted: false; fly: true; acceleration: 1"),this.el.setAttribute("position",{x:.0130435652091113,y:1.0412983252490486,z:.6600262848245867});let t=this.el.hasAttribute("look-controls")?this.el:this.el.querySelector("*[look-controls]");n.Util.whenLoaded([t],(()=>{this.setupLookControls(t)})),this.keys={q:!1,e:!1},document.addEventListener("keydown",(t=>{t.key in this.keys&&(this.keys[t.key]=!0)})),document.addEventListener("keyup",(t=>{t.key in this.keys&&(this.keys[t.key]=!1)})),this.el.sceneEl.addEventListener("enter-vr",(()=>{document.querySelectorAll(".hidden-in-vr").forEach((t=>t.classList.add("hidden")))})),this.el.sceneEl.addEventListener("exit-vr",(()=>{document.querySelector(".desktop-controls").classList.remove("hidden")}))},setupLookControls(t){this.el.sceneEl.canvas.removeEventListener("mousedown",t.components["look-controls"].onMouseDown),document.body.oncontextmenu=t=>!1;let e=e=>{var i=this.el.sceneEl;return!t.components["look-controls"].data.enabled||i.is("vr-mode")&&i.checkHeadsetConnected()?(console.log("vr mode"),!1):!!this.el.is("looking")||!(0==e.button&&!e.shiftKey)};t.components["look-controls"].onMouseDown=function(t){var i=this.el.sceneEl;if(e(t)){var n=i&&i.canvas;return this.mouseDown=!0,(!this.previousMouseEvent||this.previousMouseEvent instanceof MouseEvent)&&(this.previousMouseEvent={}),this.previousMouseEvent.screenX=t.screenX,this.previousMouseEvent.screenY=t.screenY,this.showGrabbingCursor(),this.data.pointerLockEnabled&&!this.pointerLocked&&(n.requestPointerLock?n.requestPointerLock():n.mozRequestPointerLock&&n.mozRequestPointerLock()),!1}}.bind(t.components["look-controls"]),this.el.sceneEl.canvas.addEventListener("mousedown",t.components["look-controls"].onMouseDown)},tick(t,e){this.keys.q&&(this.el.object3D.position.y+=this.data.velocity*e),this.keys.e&&(this.el.object3D.position.y-=this.data.velocity*e)}}),AFRAME.registerSystem("desktop-controls",{init(){document.querySelectorAll(".desktop-controls *[icon-button]").forEach((t=>{let e=document.querySelector(t.getAttribute("icon-button")).cloneNode();e.setAttribute("alt",t.getAttribute("tooltip")),e.setAttribute("title",t.getAttribute("tooltip")),t.append(e),t.setAttribute("href","#"),t.addEventListener("click",(()=>{this[t.getAttribute("click-action")]()}))}))},rotateCamera(){document.querySelector("#camera-root").addState("looking"),document.querySelector("#mouse").addState("looking"),document.querySelector("#mouse").removeState("grabmode")},draw(){document.querySelector("#camera-root").removeState("looking"),document.querySelector("#mouse").removeState("looking"),document.querySelector("#mouse").removeState("grabmode"),document.querySelector("#mouse").removeState("sampling")},grab(){document.querySelector("#camera-root").addState("looking"),document.querySelector("#mouse").addState("looking"),document.querySelector("#mouse").addState("grabmode")},sample(){document.querySelector("#mouse").addState("sampling"),document.querySelector("#camera-root").removeState("looking"),document.querySelector("#mouse").removeState("looking"),document.querySelector("#mouse").removeState("grabmode")},rotateLeft(){this.el.sceneEl.systems["artist-root"].rotateLeft()},rotateRight(){this.el.sceneEl.systems["artist-root"].rotateRight()}}),AFRAME.registerComponent("desktop-button-caster",{dependencies:["button-caster"],schema:{castableButtons:{default:["a","b","x","y"]}},init(){document.addEventListener("keydown",(t=>{let e=t.key.toLowerCase();this.data.castableButtons.includes(e)&&this.el.emit(`${e}buttondown`,{})})),document.addEventListener("keyup",(t=>{let e=t.key.toLowerCase();this.data.castableButtons.includes(e)&&this.el.emit(`${e}buttonup`,{})}))}})},function(t,e,i){"use strict";i.r(e);var n=i(17),r=i(4),a=i(0),o=i(3);AFRAME.registerSystem("manipulator",{init(){this.postManipulationCallbacks=[],this.tick=AFRAME.utils.throttleTick(this.tick,5e3,this)},postManipulation(t,e){if(this.postManipulationCallbacks.length)for(let i of this.postManipulationCallbacks)i(t,e)},installConstraint:(t,e)=>(t.manipulatorConstraints||(t.manipulatorConstraints=[]),t.manipulatorConstraints.push(e),e),removeConstraint(t,e){t.manipulatorConstraints||(t.manipulatorConstraints=[]),t.manipulatorConstraints.splice(t.manipulatorConstraints.indexOf(e),1)},tick(t,e){this.el.emit("refreshobjects")}}),AFRAME.registerComponent("manipulator",{dependencies:["scalable-raycaster"],schema:{selector:{type:"string"},useRay:{type:"boolean",default:!0},useIntersections:{default:!1},printUpdates:{type:"boolean",default:!1},grabToggleTimeout:{default:200},rotateByDefault:{default:!1}},pool(t,e){return this._pool[t]||(this._pool[t]=new e),this._pool[t]},init(){if(this._pool={},this.rightHand=this.el,this.grabber=document.createElement("a-entity"),this.grabber.setAttribute("gltf-model","#asset-hand"),this.grabber.setAttribute("visible","false"),this.grabber.setAttribute("material","shader: matcap"),this.grabber.setAttribute("apply-material-to-mesh",""),this.el.append(this.grabber),this.onGripClose=this.onGripClose.bind(this),this.onGripOpen=this.onGripOpen.bind(this),this.rightHand.addEventListener("gripdown",this.onGripClose),this.rightHand.addEventListener("gripup",this.onGripOpen),this.zoomAmmount=0,this.scaleAmmount=0,this.el.addEventListener("axismove",(t=>{this.zoomAmmount=t.detail.axis[n.Axes.up_down(this.el)],this.scaleAmmount=-t.detail.axis[n.Axes.left_right(this.el)]})),this.startPoint=new THREE.Object3D,this.endPoint=new THREE.Object3D,this.startPoint.add(this.endPoint),this.el.sceneEl.object3D.add(this.startPoint),this.invM=new THREE.Matrix4,this.raycaster=this.el.components.raycaster,this.data.printUpdates){var t=new THREE.BoxGeometry(.1,.1,.1);this.startPoint.add(new THREE.Mesh(t,new THREE.MeshBasicMaterial({color:65280})))}this.grabLine=(new THREE.BufferGeometry).setFromPoints([new THREE.Vector3(0,0,0),new THREE.Vector3(0,0,4)]),this.grabLineObject=new THREE.Line(this.grabLine,new THREE.LineBasicMaterial({color:16776960,linewidth:50})),this.startPoint.add(this.grabLineObject),this.grabLineObject.visible=!1,this.endPoint.visible=!1,this.offset=new THREE.Vector3(0,0,0);let e=this.raycaster.refreshObjects;this.raycaster.refreshObjects=function(...t){e.call(this,...t);let i=0;for(let t=0;t<this.objects.length;++t){let e=this.objects[t];if(e.el.className.includes("raycast-invisible"))continue;if(!e.visible)continue;let n=!0;e.traverseAncestors((t=>n=n&&t.visible)),n&&(this.objects[i++]=e)}this.objects.length=i},this.refreshNeeded=!0,this.el.sceneEl.addEventListener("refreshobjects",(t=>{this.refreshNeeded=!0})),this.el.setAttribute("grab-options",""),this.data.rotateByDefault&&this.el.addState("rotating")},startGrab(){if(this.target.grabbingManipulator)return void(this.target=void 0);this.target.grabbingManipulator=this,this.target.addState("grabbed"),this.el.components.raycaster.pause(),this.grabOptions=this.target.hasAttribute("grab-options")?this.target.getAttribute("grab-options"):this.el.getAttribute("grab-options");let t=new THREE.Matrix4;t.copy(this.target.object3D.matrix);let e=this.target.object3D;this.grabOptions.undoable&&r.Undo.push((()=>{e.matrix.copy(t),e.matrix.decompose(e.position,e.quaternion,e.scale)})),this.el.addState("grabbing");this.el.sceneEl.systems["settings-system"];let i=this.pool("targetQuart",THREE.Quaternion);this.rightHand.object3D.getWorldQuaternion(i),this.startPoint.setRotationFromQuaternion(i),this.rightHand.object3D.getWorldPosition(this.startPoint.position),this.startPoint.updateMatrixWorld(),this.invM.copy(this.startPoint.matrixWorld).invert(),this.target.object3D.updateMatrixWorld(),this.target.object3D.getWorldPosition(this.endPoint.position),this.startPoint.worldToLocal(this.endPoint.position),this.startPoint.updateMatrixWorld();let n=this.pool("pmw",THREE.Matrix4);n.copy(this.startPoint.matrixWorld).invert(),this.target.object3D.getWorldQuaternion(i);let a=this.pool("identity",THREE.Matrix4);a.identity(),a.extractRotation(n);let o=this.pool("invQuart",THREE.Quaternion);if(o.setFromRotationMatrix(a),o.multiply(i),this.endPoint.setRotationFromQuaternion(o),this.offset){this.pool("startOffset",THREE.Vector3).copy(this.offset),this.endPoint.position.copy(this.offset),this.startPoint.worldToLocal(this.endPoint.position),this.endPoint.updateMatrixWorld();let t=this.pool("twp",THREE.Vector3);this.target.object3D.getWorldPosition(t),this.offset.sub(t);let e=this.pool("quart",THREE.Quaternion);this.target.object3D.getWorldQuaternion(e),this.offset.applyQuaternion(e.conjugate());let i=this.pool("ws",THREE.Vector3);this.target.object3D.parent.getWorldScale(i),this.offset.divide(i)}this.grabLine.attributes.position.setXYZ(1,this.endPoint.position.x,this.endPoint.position.y,this.endPoint.position.z),this.grabLine.attributes.position.needsUpdate=!0,this.grabLineObject.visible=!0,this.endPoint.visible=!0,this.grabber.object3D.visible=this.grabOptions.showHand,this.endPoint.attach(this.grabber.object3D),this.grabber.object3D.position.set(0,0,0),this.grabber.object3D.rotation.set(0,0,0),this.grabber.object3D.updateMatrixWorld();let s=this.pool("worldScale",THREE.Vector3);this.grabber.object3D.parent.getWorldScale(s),this.grabber.object3D.scale.set(.04/s.x,.04/s.y,.04/s.z)},stopGrab(){this.data.printUpdates&&this.target&&console.log(this.target,'\n\nposition="'+AFRAME.utils.coordinates.stringify(this.target.object3D.position)+'"','\n\nrotation="'+AFRAME.utils.coordinates.stringify({x:THREE.Math.radToDeg(this.target.object3D.rotation.x),y:THREE.Math.radToDeg(this.target.object3D.rotation.y),z:THREE.Math.radToDeg(this.target.object3D.rotation.z)})+'"',`\n\nscale="${AFRAME.utils.coordinates.stringify(this.target.object3D.scale)}"`),this.target&&(this.target.grabbingManipulator=void 0,this.target.removeState("grabbed")),this.target=void 0,this.grabLineObject.visible=!1,this.endPoint.visible=!1,this.el.removeState("grabbing"),this.el.components.raycaster.play()},onGripClose(t){if(t&&(t.preventDefault(),t.stopPropagation()),this.el.is("grabbing")&&this.grabToggleLocked&&(this.readyToRelease=!0),!this.el.is("grabbing")){if(this.readyToRelease=!1,this.gripClosedTime=this.el.sceneEl.time,this.data.useIntersections){let t=this.el.getObject3D("mesh");for(let e of this.raycaster.objects)if(a.Util.objectsIntersect(t,e)){let t=e.el;this.data.printUpdates&&console.log("GRABBING from intersection"),this.target=t;for(let e=t["redirect-grab"];e;e=this.target["redirect-grab"])this.data.printUpdates&&console.log("Redirecting grab to",typeof e,e),this.target=e;return this.offset.set(0,0,0),void this.startGrab()}}if(this.data.useRay){if(!this.raycaster.intersectedEls.length>0)return;let t=this.raycaster.intersectedEls[0],e=this.raycaster.getIntersection(t);if(this.data.printUpdates&&console.log("GRABBING",t,e),!t.object3D.parent)return void console.warn("Object has no parent",t);this.target=t;for(let e=t["redirect-grab"];e;e=this.target["redirect-grab"])this.data.printUpdates&&console.log("Redirecting grab to",typeof e,e),this.target=e;this.offset.copy(e.point),this.startGrab()}else this.target=document.querySelector(this.data.selector),this.offset=void 0,this.startGrab()}},onGripOpen(){this.el.sceneEl.time-this.gripClosedTime<this.data.grabToggleTimeout?this.grabToggleLocked=!0:(this.stopGrab(),this.data.printUpdates&&console.log("GripOpen"))},tick(t,e){if(this.refreshNeeded&&(this.raycaster.refreshObjects(),this.refreshNeeded=!1),this.target){if(!this.target.object3D.parent)return console.warn("Target parent disappeared!"),void this.stopGrab();if(Math.abs(this.zoomAmmount)>.08)if(this.el.is("orbiting")){let t=this.pool("axis",THREE.Vector3).set(1,0,0);t.normalize(),this.data.printUpdates&&console.log(t),this.endPoint.rotateOnAxis(t,this.zoomAmmount*e/300)}else this.endPoint.position.multiplyScalar(1-.2*this.zoomAmmount*e/100);if(Math.abs(this.scaleAmmount)>.08)if(this.el.is("orbiting")){let t=this.pool("axis",THREE.Vector3).set(0,1,0);t.normalize(),this.endPoint.rotateOnAxis(t,this.scaleAmmount*e/300)}else if(this.grabOptions.scalable){let t=1-.2*this.scaleAmmount*e/100;this.target.object3D.scale.multiplyScalar(t),this.offset.multiplyScalar(t)}this.rightHand.object3D.getWorldPosition(this.startPoint.position);var i=this.pool("quart",THREE.Quaternion);this.rightHand.object3D.getWorldQuaternion(i),this.startPoint.setRotationFromQuaternion(i),this.startPoint.updateMatrixWorld(),this.endPoint.updateMatrixWorld(),this.target.object3D.position.set(0,0,0);let n=this.pool("pmw",THREE.Matrix4);if(n.copy(this.target.object3D.parent.matrixWorld).invert(),this.endPoint.getWorldQuaternion(i),!this.grabOptions.lockRotation&&this.el.is("rotating")||this.el.is("orbiting")){let t=this.pool("identity",THREE.Matrix4);t.identity(),t.extractRotation(n);let e=this.pool("invQuart",THREE.Quaternion);e.setFromRotationMatrix(t),e.multiply(i),this.target.object3D.setRotationFromQuaternion(e)}this.endPoint.getWorldPosition(this.target.object3D.position),this.target.object3D.parent&&this.target.object3D.parent.worldToLocal(this.target.object3D.position);let r=this.pool("localOffset",THREE.Vector3);r.copy(this.offset);this.pool("pws",THREE.Vector3);if(r.applyQuaternion(this.target.object3D.quaternion),this.target.object3D.position.sub(r),this.resetZoom&&(this.zoomAmmount=0,this.scaleAmmount=0,this.resetZoom=!1),this.target.manipulatorConstraint&&this.target.manipulatorConstraint(t,e),this.target.manipulatorConstraints)for(let i of this.target.manipulatorConstraints)i(t,e,r);this.system.postManipulation(this.target,r)}}}),AFRAME.registerComponent("mouse-manipulator",{dependencies:["manipulator"],init(){this.el.setAttribute("manipulator",{useRay:!0}),document.addEventListener("mousedown",(t=>{(this.el.is("grabmode")||t.shiftKey)&&(this.el.is("grabbing")||this.el.components.manipulator.onGripClose())})),document.addEventListener("mouseup",(t=>{this.el.components.manipulator.onGripOpen()})),document.addEventListener("wheel",(t=>{(this.el.is("grabmode")||t.shiftKey)&&(t.altKey?this.el.components.manipulator.scaleAmmount=t.deltaY*(t.deltaY>50||t.deltaY<-50?.01:1):this.el.components.manipulator.zoomAmmount=t.deltaY*(t.deltaY>50||t.deltaY<-50?.01:1),this.el.components.manipulator.resetZoom=!0)}))}}),AFRAME.registerComponent("grabbable",{init(){this.el.classList.add("clickable")},remove(){this.el.classList.remove("clickable")}}),AFRAME.registerComponent("grab-root",{init(){this.el.classList.add("grab-root")},remove(){this.el.classList.remove("grab-root")}}),AFRAME.registerComponent("propogate-grab",{init(){for(let t=this.el.parentEl;t;t=t.parentEl)if(t["redirect-grab"]||t.classList.contains("clickable")||t.classList.contains("grab-root")){this.el["redirect-grab"]=t;break}},remove(){delete this.el["redirect-grab"]}}),AFRAME.registerComponent("redirect-grab",{schema:{type:"selector"},update(){this.el["redirect-grab"]=this.data}}),AFRAME.registerComponent("grab-options",{schema:{showHand:{type:"boolean",default:!0},scalable:{type:"boolean",default:!0},undoable:{type:"boolean",default:!1},lockRotation:{default:!1}}}),AFRAME.registerComponent("lock-up",{init(){o.Pool.init(this),this.constrainObject=this.constrainObject.bind(this),this.startQuartenion=new THREE.Quaternion,this.startUp=new THREE.Vector3},events:{stateadded:function(t){"grabbed"===t.detail&&this.startQuartenion.copy(this.el.object3D.quaternion)}},play(){this.el.sceneEl.systems.manipulator.installConstraint(this.el,this.constrainObject)},pause(){this.el.sceneEl.systems.manipulator.removeConstraint(this.el,this.constrainObject)},constrainObject(t,e,i){this.pool("forward",THREE.Vector3);let n=this.pool("up",THREE.Vector3),r=this.el.object3D;r.updateMatrix(),n.set(0,1,0),n.applyQuaternion(r.quaternion);let a=this.pool("quart",THREE.Quaternion);a.setFromUnitVectors(n,this.el.sceneEl.object3D.up),r.quaternion.premultiply(a);let o=this.el.grabbingManipulator;o.endPoint.getWorldPosition(r.position),r.parent&&r.parent.worldToLocal(r.position),i.copy(o.offset);this.pool("pws",THREE.Vector3);i.applyQuaternion(r.quaternion),r.position.sub(i)}}),AFRAME.registerComponent("grab-activate",{events:{stateremoved:function(t){"grab-activated"===t.detail&&t.target===this.el&&this.init()}},init(){let t=e=>{if(("grabbed"===e.detail||"wielded"===e.detail)&&e.target===this.el){if(this.el.is("grab-activated"))return;this.el.emit("activate"),this.el.removeEventListener("stateadded",t),this.el.addState("grab-activated")}};this.el.addEventListener("stateadded",t)}}),AFRAME.registerComponent("manipulator-info-text",{dependencies:["text"],init(){this.el.sceneEl.systems.manipulator.postManipulationCallbacks.push((t=>{this.el.setAttribute("text","value",`position="${AFRAME.utils.coordinates.stringify(t.object3D.position)}"\nrotation="${AFRAME.utils.coordinates.stringify({x:THREE.Math.radToDeg(t.object3D.rotation.x),y:THREE.Math.radToDeg(t.object3D.rotation.y),z:THREE.Math.radToDeg(t.object3D.rotation.z)})}"\nscale="${AFRAME.utils.coordinates.stringify(t.object3D.scale)}"`)}))}}),AFRAME.registerComponent("copy-manipulator-info-text",{events:{click:function(){let t=document.querySelector("*[manipulator-info-text]").getAttribute("text").value;t=t.replace(/\n/gm," "),console.log("Manipulator info",t),this.el.sceneEl.systems["settings-system"].copyToClipboard(t,"Manipulator Info")}}}),AFRAME.registerComponent("constrain-to-sphere",{schema:{innerRadius:{default:0},outerRadius:{default:1},constrainOnLoad:{default:!0}},init(){this.constrainObject=this.constrainObject.bind(this),a.Util.whenLoaded(this.el,(()=>{this.data.constrainOnLoad&&this.constrainObject()}))},play(){this.el.sceneEl.systems.manipulator.installConstraint(this.el,this.constrainObject)},pause(){this.el.sceneEl.systems.manipulator.removeConstraint(this.el,this.constrainObject)},constrainObject(){this.el.object3D.position.clampLength(this.data.innerRadius,this.data.outerRadius)}}),AFRAME.registerComponent("lever",{schema:{axis:{type:"string",oneOf:["x","y","z"],default:"z"},handleLength:{default:.35},gripRadius:{default:.07},angleRange:{type:"vec2",default:new THREE.Vector2(30,150)},throttle:{default:10},initialValue:{default:0},valueRange:{type:"vec2",default:new THREE.Vector2(0,1)},target:{type:"selector"},component:{type:"string"},property:{type:"string"}},init(){o.Pool.init(this);let t=document.createElement("a-entity");this.angler=t,this.el.append(t),this.el.classList.add("grab-root"),this.el.setAttribute("grab-options","showHand: false");let e=document.createElement("a-entity"),i=document.createElement("a-cylinder");i.setAttribute("rotation","90 90 90"),i.setAttribute("height",this.data.handleLength),i.setAttribute("position","0 0 "+this.data.handleLength/2),i.setAttribute("radius",.035),i.setAttribute("segments-radial",6),i.setAttribute("segments-height",1),i.setAttribute("material","side: double; src: #asset-shelf; metalness: 0.4; roughness: 0.7"),i.classList.add("clickable"),i.setAttribute("propogate-grab",""),document.getElementById("lever-handle")&&i.setAttribute("mixin","lever-handle"),this.body=i,this.bodyPositioner=e,e.append(i),t.append(e);let n=document.createElement("a-entity"),r=document.createElement("a-sphere");r.setAttribute("position",`0 ${this.data.handleLength} 0`),r.setAttribute("radius",this.data.gripRadius),r.setAttribute("segments-radial",a.Util.isLowPower()?4:6),r.setAttribute("segments-height",4),r.setAttribute("material","side: double; metalness: 0.7; roughness: 0.3"),r.setAttribute("grab-options","showHand: false; scalable: false"),document.getElementById("lever-grip")&&r.setAttribute("mixin","lever-grip"),r.classList.add("clickable"),this.gripPositioner=n,this.grip=r,t.append(r),r.manipulatorConstraint=this.constrainObject.bind(this),a.Util.whenLoaded([this.el,r,i],(()=>this.setValue(this.data.initialValue))),this.el["redirect-grab"]=this.grip,this.spherical=new THREE.Spherical,this.origin=new THREE.Vector3(0,0,0),this.forward=new THREE.Vector3(1,0,0),this.eventDetail={angle:0,percent:0,value:this.data.initialValue}},update(t){switch(this.tick=AFRAME.utils.throttleTick(this._tick,this.data.throttle,this),this.data.axis){case"x":this.angler.setAttribute("rotation","0 0 0");break;case"y":this.angler.setAttribute("rotation","90 -90 0");break;case"z":this.angler.setAttribute("rotation","0 -90 0")}this.data.gripRadius!==t.gripRadius&&this.grip.setAttribute("radius",this.data.gripRadius)},tick(){},setValue(t){let{grip:e}=this;e.object3D.position.z=0,e.object3D.position.x=Math.max(e.object3D.position.x,.001),this.spherical.setFromCartesianCoords(e.object3D.position.x,e.object3D.position.y,e.object3D.position.z),this.spherical.theta=Math.PI/2,this.spherical.radius=this.data.handleLength,this.spherical.phi=THREE.Math.mapLinear(t,this.data.valueRange.x,this.data.valueRange.y,this.data.angleRange.x*Math.PI/180,this.data.angleRange.y*Math.PI/180),e.object3D.position.setFromSpherical(this.spherical),this.bodyPositioner.object3D.matrix.lookAt(this.grip.object3D.position,this.origin,this.forward),a.Util.applyMatrix(this.bodyPositioner.object3D.matrix,this.bodyPositioner.object3D)},constrainObject(){let{grip:t}=this;t.object3D.position.z=0,t.object3D.position.x=Math.max(t.object3D.position.x,.001),this.spherical.setFromCartesianCoords(t.object3D.position.x,t.object3D.position.y,t.object3D.position.z),this.spherical.theta=Math.PI/2,this.spherical.radius=this.data.handleLength,this.spherical.phi=THREE.Math.clamp(this.spherical.phi,this.data.angleRange.x*Math.PI/180,this.data.angleRange.y*Math.PI/180),t.object3D.position.setFromSpherical(this.spherical),this.bodyPositioner.object3D.matrix.lookAt(this.grip.object3D.position,this.origin,this.forward),a.Util.applyMatrix(this.bodyPositioner.object3D.matrix,this.bodyPositioner.object3D),this.angle=this.spherical.phi,this.percent=THREE.Math.mapLinear(this.angle,this.data.angleRange.x*Math.PI/180,this.data.angleRange.y*Math.PI/180,0,1),this.percent>.99&&(this.percent=1),this.percent<.01&&(this.percent=0),this.value=THREE.Math.mapLinear(this.percent,0,1,this.data.valueRange.x,this.data.valueRange.y)},_tick(t,e){this.lastAngle!==this.angle&&(this.data.target?this.data.property.length?this.data.target===this.el.sceneEl?this.data.target.setAttribute(this.data.component,{[this.data.property]:this.value}):this.data.target.setAttribute(this.data.component,this.data.property,this.value):this.data.target.setAttribute(this.data.component,this.value):(this.eventDetail.angle=180*this.angle/Math.PI,this.eventDetail.value=this.value,this.eventDetail.percent=this.percent,this.el.emit("anglechanged",this.eventDetail),this.lastAngle=this.angle))}}),AFRAME.registerComponent("slot-machine",{dependencies:["lever"],schema:{threshold:{default:.8},debounce:{default:.05},resetSpeed:{default:.8},event:{default:"click"}},events:{anglechanged:function(t){t.detail.value>this.data.threshold&&!this.pulled?(this.el.emit("click",{type:"slot"}),this.pulled=!0):t.detail.value<this.data.threshold-this.data.debounce&&(this.pulled=!1)}},init(){this.tick=AFRAME.utils.throttleTick(this.tick,10,this)},tick(t,e){!this.el.components.lever.grip.is("grabbed")&&this.el.components.lever.value>0&&(this.el.components.lever.value=THREE.Math.clamp((this.el.components.lever.value||0)-this.data.resetSpeed*e/1e3,0,1),this.el.components.lever.setValue(this.el.components.lever.value))}}),AFRAME.registerComponent("manipulator-weight",{schema:{type:{default:"sticky",oneOf:["sticky","slow"]},weight:{default:.8}},events:{stateadded:function(t){"grabbed"===t.detail&&(this.lastPos.copy(this.el.object3D.position),this.lastRot.copy(this.el.object3D.quaternion))}},init(){this.lastPos=new THREE.Vector3,this.lastRot=new THREE.Quaternion,this.constrainObject=this.constrainObject.bind(this)},play(){this.el.sceneEl.systems.manipulator.installConstraint(this.el,this.constrainObject)},pause(){this.el.sceneEl.systems.manipulator.removeConstraint(this.el,this.constrainObject)},constrainObject(t,e){var i=this.data.weight;"slow"===this.data.type&&(i=1-THREE.Math.clamp((1-i)*e/30,0,1)),this.el.object3D.position.lerp(this.lastPos,i),this.el.object3D.quaternion.slerp(this.lastRot,i),"slow"===this.data.type&&(this.lastPos.copy(this.el.object3D.position),this.lastRot.copy(this.el.object3D.quaternion))}}),AFRAME.registerComponent("manipulator-console-debug",{events:{stateremoved:function(t){if("grabbed"===t.detail){let t=this.el.getAttribute("position"),e=this.el.getAttribute("rotation"),i=this.el.getAttribute("scale");console.log(`position="${t.x} ${t.y} ${t.z}" rotation="${e.x} ${e.y} ${e.z}" scale="${i.x} ${i.y} ${i.z}"`)}}},init(){this.el.classList.add("clickable")}}),AFRAME.registerComponent("manipulator-snap-grid",{schema:{coordinates:{oneOf:["local","global"],default:"global"},spacing:{type:"vec3",default:{x:.05,y:.05,z:.05}},spacingCubeSize:{default:.05},angleStep:{default:45},enabled:{default:!0}},init(){this.constrainObject=this.constrainObject.bind(this),this.system=this.el.sceneEl.systems.manipulator,this.postManipulation=this.postManipulation.bind(this),o.Pool.init(this,{useSystem:!0})},play(){this.el===this.el.sceneEl?this.system.postManipulationCallbacks.push(this.postManipulation):this.el.sceneEl.systems.manipulator.installConstraint(this.el,this.constrainObject)},pause(){this.el===this.el.sceneEl?this.system.postManipulationCallbacks.splice(this.system.postManipulationCallbacks.indexOf(this.postManipulation),1):this.el.sceneEl.systems.manipulator.removeConstraint(this.el,this.constrainObject)},update(t){this.data.spacingCubeSize!==t.spacingCubeSize&&this.data.spacingCubeSize>0&&(this.data.spacing.x=this.data.spacingCubeSize,this.data.spacing.y=this.data.spacingCubeSize,this.data.spacing.z=this.data.spacingCubeSize)},snapToGrid(t){if(!this.data.enabled)return;let e=t.position,i="global"===this.data.coordinates,n=t.rotation;i&&(t.getWorldPosition(e),n.setFromRotationMatrix(t.matrixWorld)),e.x=Math.floor(e.x/this.data.spacing.x)*this.data.spacing.x,e.y=Math.floor(e.y/this.data.spacing.y)*this.data.spacing.y,e.z=Math.floor(e.z/this.data.spacing.z)*this.data.spacing.z;let r=this.data.angleStep*Math.PI/180;if(n.x=Math.floor(n.x/r)*r,n.y=Math.floor(n.y/r)*r,n.z=Math.floor(n.z/r)*r,i){t.parent.worldToLocal(e);this.pool("rotationMatrix",THREE.Matrix4);let i=this.pool("world",THREE.Matrix4);i.copy(t.parent.matrixWorld),i.invert()}},constrainObject(t,e){this.snapToGrid(this.el.object3D)},postManipulation(t,e){this.snapToGrid(t.object3D)}}),AFRAME.registerComponent("manipulator-lock",{schema:{lockedPositionAxes:{type:"array",default:[]},lockedRotationAxes:{type:"array",default:[]},lockedScaleAxes:{type:"array",default:[]}},events:{stateadded:function(t){"grabbed"===t.detail&&this.setLocks()}},init(){this.lockedPosition=new THREE.Vector3,this.lockedRotation=new THREE.Euler,this.lockedScale=new THREE.Vector3,this.constrainObject=this.constrainObject.bind(this)},play(){this.el.sceneEl.systems.manipulator.installConstraint(this.el,this.constrainObject)},pause(){console.log("Removing lock constraint"),this.el.sceneEl.systems.manipulator.removeConstraint(this.el,this.constrainObject)},remove(){this.pause()},constrainObject(t,e){let i=this.el.object3D;for(let t of["x","y","z"])this.data.lockedPositionAxes.indexOf(t)>=0&&(i.position[t]=this.lockedPosition[t]),this.data.lockedRotationAxes.indexOf(t)>=0&&(i.rotation[t]=this.lockedRotation[t]),this.data.lockedScaleAxes.indexOf(t)>=0&&(i.scale[t]=this.lockedScale[t])},setLocks(){let t=this.el.object3D;this.lockedPosition.copy(t.position),this.lockedRotation.copy(t.rotation),this.lockedScale.copy(t.scale)},update(t){this.data.target&&this.setLocks()}})},function(t,e){t.exports="#version 100\nprecision mediump float;\nuniform float u_width;\nuniform float u_height;\nuniform sampler2D u_input;\nvarying vec2 vUv;\nvec3 sampleGradient(float alpha) {\n\treturn vec3(0, 0, 0);\n}\nvoid main() {\n\tvec4 color = texture2D(u_input, vec2(vUv.x, vUv.y));\n\tgl_FragColor = vec4(sampleGradient(color[3]), color[3]);\n}\n"},function(t,e){t.exports="#version 100\nprecision mediump float;\nuniform float u_width;\nuniform float u_height;\nuniform sampler2D u_input;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 color = texture2D(u_input, vec2(vUv.x, vUv.y));\n\tgl_FragColor = vec4(color[3], color[3], color[3], 1.0);\n}\n"},function(t,e){t.exports="#version 100\nprecision mediump float;\nuniform float u_width;\nuniform float u_height;\nuniform sampler2D u_input;\nvarying vec2 vUv;\n#define image u_input\n#define uv vUv\nvec4 blur(vec2 direction) {\n\tvec2 off1 = vec2(1.3846153846) * direction;\n\tvec2 off2 = vec2(3.2307692308) * direction;\n\tvec4 color1 = vec4(0.0);\n\tvec2 resolution = vec2(u_width / 2.0, u_height / 2.0);\n\tcolor1 += (texture2D(image, uv) * 0.2270270270);\n\tcolor1 += (texture2D(image, uv + (off1 / resolution)) * 0.3162162162);\n\tcolor1 += (texture2D(image, uv - (off1 / resolution)) * 0.3162162162);\n\tcolor1 += (texture2D(image, uv + (off2 / resolution)) * 0.0702702703);\n\tcolor1 += (texture2D(image, uv - (off2 / resolution)) * 0.0702702703);\n\treturn color1;\n}\nvoid main() {\n\tvec4 color = ((blur(vec2(1.0, 0.0)) + blur(vec2(0.0, -1.0))) + blur(vec2(1.0, -1.0))) + blur(vec2(1.0, 1.0));\n\tcolor /= 4.0;\n\tcolor.xyz = color.xyz * color[3];\n\tgl_FragColor = color;\n}\n"},function(t,e){t.exports="#version 100\nprecision mediump float;\nuniform float u_width;\nuniform float u_height;\nuniform sampler2D u_input;\nvarying vec2 vUv;\nfloat sampleBump(vec2 pos) {\n\tvec4 c = texture2D(u_input, pos);\n\treturn c.r * c.a;\n}\nvoid main() {\n\tconst float scale = 1.0 / 10.0;\n\tvec2 pixel = vec2(1.0 / u_width, 1.0 / u_height);\n\tfloat height_pu = sampleBump(vec2(vUv.x + pixel.x, vUv.y));\n\tfloat height_mu = sampleBump(vec2(vUv.x - pixel.x, vUv.y));\n\tfloat height_pv = sampleBump(vec2(vUv.x, vUv.y + pixel.y));\n\tfloat height_mv = sampleBump(vec2(vUv.x, vUv.y - pixel.y));\n\tfloat du = height_mu - height_pu;\n\tfloat dv = height_mv - height_pv;\n\tvec3 vec = normalize(vec3(du, dv, scale));\n\tvec.x += 0.5;\n\tvec.y += 0.5;\n\tvec = clamp(vec, vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));\n\tgl_FragColor = vec4(vec, 1.0);\n}\n"},function(t,e){t.exports="#version 100\nprecision mediump float;\nuniform float u_width;\nuniform float u_height;\nuniform sampler2D u_input;\nvarying vec2 vUv;\nvec4 pick(vec2 direction) {\n\tvec2 uv = vUv + (direction * vec2(2.0 / u_width, 2.0 / u_height));\n\treturn texture2D(u_input, uv);\n}\nvec4 maxByAlpha(vec4 c1, vec4 c2, vec4 c3, vec4 c4, vec4 c5) {\n\tfloat maxA = c1.a;\n\tmaxA = max(maxA, c2.a);\n\tmaxA = max(maxA, c3.a);\n\tmaxA = max(maxA, c4.a);\n\tmaxA = max(maxA, c5.a);\n\treturn maxA == c1.a ? c1 : maxA == c2.a ? c2 : maxA == c3.a ? c3 : maxA == c4.a ? c4 : c5;\n}\nvoid main() {\n\tvec4 color = maxByAlpha(pick(vec2(1.0, 0.0)), pick(vec2(0.0, -1.0)), pick(vec2(-1.0, 0.0)), pick(vec2(0.0, 1.0)), pick(vec2(0.0, 0.0)));\n\tgl_FragColor = color;\n}\n"},function(t,e){t.exports="#version 100\nprecision mediump float;\nuniform sampler2D u_input;\nvarying vec2 vUv;\nfloat rand(vec2 co) {\n\treturn fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\nvoid main() {\n\tvec4 color1 = texture2D(u_input, vUv);\n\tvec4 fullColor = vec4(color1.xyz / color1[3], 1.0);\n\tgl_FragColor = rand(vUv) < color1[3] ? fullColor : vec4(0.0);\n}\n"},function(t,e){t.exports="#version 100\nprecision mediump float;\nuniform float u_width;\nuniform float u_height;\nuniform sampler2D u_input;\nvarying vec2 vUv;\nvec4 pick(vec2 direction) {\n\tvec2 uv = vUv + (direction * vec2(2.0 / u_width, 2.0 / u_height));\n\treturn texture2D(u_input, uv);\n}\nvec4 minByAlpha(vec4 c1, vec4 c2, vec4 c3, vec4 c4, vec4 c5) {\n\tfloat maxA = c1.a;\n\tmaxA = min(maxA, c2.a);\n\tmaxA = min(maxA, c3.a);\n\tmaxA = min(maxA, c4.a);\n\tmaxA = min(maxA, c5.a);\n\treturn maxA == c1.a ? c1 : maxA == c2.a ? c2 : maxA == c3.a ? c3 : maxA == c4.a ? c4 : c5;\n}\nvoid main() {\n\tvec4 color = minByAlpha(pick(vec2(1.0, 0.0)), pick(vec2(0.0, -1.0)), pick(vec2(-1.0, 0.0)), pick(vec2(0.0, 1.0)), pick(vec2(0.0, 0.0)));\n\tgl_FragColor = color;\n}\n"},function(t,e){t.exports="#version 100\nprecision mediump float;\nuniform float u_width;\nuniform float u_height;\nuniform sampler2D u_input;\nvarying vec2 vUv;\nvoid main() {\n\tgl_FragColor = texture2D(u_input, vec2(1.0 - vUv.x, vUv.y));\n}\n"},function(t,e){t.exports="#version 100\nprecision mediump float;\nuniform float u_width;\nuniform float u_height;\nuniform sampler2D u_input;\nvarying vec2 vUv;\nvoid main() {\n\tgl_FragColor = texture2D(u_input, vec2(vUv.x, 1.0 - vUv.y));\n}\n"},function(t,e){t.exports="#version 100\nprecision mediump float;\nuniform float u_width;\nuniform float u_height;\nuniform sampler2D u_input;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 color = texture2D(u_input, vec2(vUv.x, vUv.y));\n\tgl_FragColor = vec4(1.0, 1.0, 1.0, dot(color.xyz, vec3(1)) / 3.0);\n}\n"},function(t,e){t.exports="#version 100\nprecision mediump float;\nuniform float u_width;\nuniform float u_height;\nuniform sampler2D u_input;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 color = texture2D(u_input, vec2(vUv.x, vUv.y));\n\tgl_FragColor = vec4(1.0 - color.xyz, color[3]);\n}\n"},function(t,e){t.exports="#version 100\nprecision mediump float;\nuniform float u_width;\nuniform float u_height;\nuniform sampler2D u_input;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 color = texture2D(u_input, vec2(vUv.x, vUv.y));\n\tcolor.r = pow(color.r, 1.0 / 2.2);\n\tcolor.g = pow(color.g, 1.0 / 2.2);\n\tcolor.b = pow(color.b, 1.0 / 2.2);\n\tgl_FragColor = color;\n}\n"},function(t,e){t.exports="#version 100\nprecision mediump float;\nuniform sampler2D u_input;\nvarying vec2 vUv;\nfloat rand(vec2 co) {\n\treturn fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\nvoid main() {\n\tvec4 color1 = texture2D(u_input, vUv);\n\tgl_FragColor = vec4((color1.xyz + (rand(vUv) - 0.5)) * color1[3], color1[3]);\n}\n"},function(t,e){t.exports="#version 100\nprecision mediump float;\nuniform float u_width;\nuniform float u_height;\nuniform sampler2D u_input;\nuniform sampler2D u_source_1;\nvarying vec2 vUv;\nvoid main() {\n\tgl_FragColor = vec4(vUv.x, vUv.y, 0.5, 1.0);\n}\n"},function(t,e){t.exports="#version 100\nprecision mediump float;\nuniform float u_width;\nuniform float u_height;\nuniform sampler2D u_input;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 color = texture2D(u_input, vec2(vUv.x, vUv.y));\n\tcolor.r = pow(color.r, 2.2);\n\tcolor.g = pow(color.g, 2.2);\n\tcolor.b = pow(color.b, 2.2);\n\tgl_FragColor = color;\n}\n"},function(t,e){t.exports="#version 100\nprecision mediump float;\nuniform float u_width;\nuniform float u_height;\nuniform sampler2D u_input;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 color = texture2D(u_input, vUv);\n\tcolor.g = 1.0 - color.g;\n\tgl_FragColor = color;\n}\n"},function(t,e){t.exports="#version 100\nprecision mediump float;\nuniform sampler2D u_input;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 color1 = texture2D(u_input, vUv);\n\tgl_FragColor = vec4(vUv.x, vUv.y, color1.z, color1[3]);\n}\n"},function(t,e){t.exports="#version 100\nprecision mediump float;\nuniform float u_width;\nuniform float u_height;\nuniform sampler2D u_input;\nuniform sampler2D u_source_1;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 offsetSample = texture2D(u_source_1, vec2(vUv.x, vUv.y));\n\tfloat xOffset = offsetSample.x * 2.0;\n\txOffset = xOffset > 1.0 ? -(xOffset - 1.0) : xOffset;\n\tfloat yOffset = offsetSample.y * 2.0;\n\tyOffset = yOffset > 1.0 ? -(yOffset - 1.0) : yOffset;\n\tgl_FragColor = texture2D(u_input, vec2(vUv.x + xOffset, vUv.y + yOffset));\n}\n"},function(t,e){t.exports="#version 100\nprecision mediump float;\nuniform sampler2D u_input;\nuniform vec3 u_color;\nvarying vec2 vUv;\nvarying float vOpacity;\nvec3 invert(vec4 c) {\n\treturn vec3(1.0 - c.r, 1.0 - c.g, 1.0 - c.b) * c.w;\n}\nvoid main() {\n\tvec4 color = texture2D(u_input, vUv);\n\tcolor.r = pow(color.r, 1.0 / 2.2);\n\tcolor.g = pow(color.g, 1.0 / 2.2);\n\tcolor.b = pow(color.b, 1.0 / 2.2);\n\tgl_FragColor = vec4((length(u_color) > 0.5 ? vec3((u_color.r * color.r) * color.w, (u_color.g * color.g) * color.w, (u_color.b * color.b) * color.w) : u_color + invert(color)) * color.w, color.w);\n}\n"},function(t,e){t.exports="#version 100\nprecision mediump float;\nuniform sampler2D u_input;\nuniform vec3 u_color;\nvarying vec2 vUv;\nvarying float vOpacity;\nvoid main() {\n\tvec4 color = texture2D(u_input, vUv);\n\tgl_FragColor = vec4(u_color * color.w, color.w);\n}\n"},function(t,e){t.exports="attribute vec4 a_position;\nattribute vec2 a_uv;\nattribute float a_opacity;\nvarying vec2 vUv;\nvarying float vOpacity;\nvoid main() {\n\tgl_Position = a_position;\n\tvUv = a_uv;\n\tvOpacity = a_opacity;\n}\n"},function(t,e){AFRAME.registerComponent("canvas-updater",{dependencies:["geometry","material"],schema:{throttle:{type:"int",default:300}},init(){this._tick=this.tick,this.data.throttle>0&&(this.tick=AFRAME.utils.throttleTick(this.tick,this.data.throttle+100*Math.random(),this))},tick(t,e){var i,n=this.el;let r=!0;if(this.el.getObject3D("mesh").traverseAncestors((t=>r=r&&t.visible)),!r)return!1;(i=n.getObject3D("mesh").material).map&&(i.map.image.getUpdateTime&&i.map.image.getUpdateTime()<this.drawnT||(i.map.needsUpdate=!0,this.drawnT=t))}}),AFRAME.registerSystem("drawable",{schema:{drawWithCursorComponent:{default:!1}},init(){this.data.drawWithCursorComponent&&(AFRAME.components.cursor.dependencies.push("hand-draw-tool"),document.querySelectorAll("*[cursor]").forEach((t=>{t.isEntity&&t.setAttribute("hand-draw-tool","")})))}}),AFRAME.registerComponent("drawable",{schema:{canvas:{type:"selector"},canvasWidth:{default:1024},canvasHeight:{default:1024},traverse:{default:!1},includeTexturelessMeshes:{default:!0}},init(){this.el.classList.add("canvas")},update(t){this.data.canvas?this.canvas=this.data.canvas:(this.canvas&&t.canvas&&(this.canvas=void 0),this.canvas||(this.canvas=document.createElement("canvas")),this.canvas.width=this.data.canvasWidth,this.canvas.height=this.data.canvasHeight),this.tex=new THREE.CanvasTexture(this.canvas),this.tex.encoding=this.el.sceneEl.getAttribute("renderer").colorManagement?THREE.GammaEncoding:THREE.LinearEncoding,this.canvas.touch=()=>this.tex.needsUpdate=!0,this.el.setAttribute("draw-canvas",{canvas:this.canvas})},tick(t,e){let i,n=this.data.traverse?this.el.object3D:this.el.getObject3D("mesh");n&&n.traverse((t=>{if(t.material){if(!t.material.map&&this.data.includeTexturelessMeshes){t.material=t.material.clone(),t.material.map=this.tex,t.material.needsUpdate=!0;let e=this.tex.image.getContext("2d");return e.fillStyle="#"+t.material.color.getHexString(),e.fillRect(0,0,e.canvas.width,e.canvas.height),void t.material.color.set(16777215)}if(t.material.map!==this.tex){i&&i!==t.material.map.image&&console.error("Drawable currently only supports objects with a single texture. Results may be unexpected"),i=t.material.map.image,t.material=t.material.clone();let e=this.tex.image.getContext("2d");e.drawImage(t.material.map.image,0,0,e.canvas.width,e.canvas.height),t.material.map.flipY!==this.tex.flipY&&this.el.sceneEl.systems["canvas-fx"].applyFX("flip-y",e.canvas),t.material.map=this.tex,t.material.needsUpdate=!0}}}))}})},function(t,e,i){"use strict";i.r(e);var n=i(17);AFRAME.registerSystem("demo-overlay",{init(){if(new URLSearchParams(document.location.search).get("demoMode")){console.info("Demo mode enabled");for(let t of["left","right"]){let e=document.createElement("a-entity");e.setAttribute("gltf-model",`https://cdn.aframe.io/controllers/oculus/oculus-touch-controller-${t}.gltf`),e.setAttribute("demo-overlay",`hand: #${t}-hand`),this.el.sceneEl.append(e)}}}}),AFRAME.registerComponent("demo-overlay",{schema:{hand:{type:"selector"},defaultColor:{default:"#535963"},pressedColor:{default:"#aced7e"}},init(){this.el.addEventListener("model-loaded",(t=>{this.model=t.detail.model,this.initializeModel()}))},initializeModel(){console.log("Initializing model"),this.el.object3D.add(this.model),"right-hand"===this.data.hand.id?(this.model.position.set(.25,-.05,-.3),this.model.rotation.set(1.8,-.2,.4)):(this.model.position.set(-.15,-.05,-.3),this.model.rotation.set(1.8,-.2,-.4));const t={buttonA:"abutton",buttonB:"bbutton",buttonX:"xbutton",buttonY:"ybutton",buttonTrigger:"trigger",buttonHand:"grip",stick:"thumbstick"};for(let e in t){let i=this.model.children.find((t=>t.name===e));if(!i)continue;i.material=new THREE.MeshStandardMaterial({color:this.data.defaultColor});let n=t[e],r=n;n.endsWith("button")?r=n[0]:"grip"===r&&(r="grab"),this.data.hand.addEventListener(n+"down",(t=>{i.material.color.set(this.data.pressedColor),this.el.sceneEl.systems.speech.speak(r)})),this.data.hand.addEventListener(n+"up",(t=>{i.material.color.set(this.data.defaultColor)}))}this.model.children.find((t=>"body"===t.name)).material=new THREE.MeshStandardMaterial({color:"#333",transparent:!0,opacity:.5}),this.data.hand.addEventListener("axismove",(t=>{let{axis:e}=t.detail,i=this.model.children.find((t=>"stick"===t.name));e.some((t=>Math.abs(t)>.3))?(i.material.color.set(this.data.pressedColor),this.moved=!0):this.moved&&(i.material.color.set(this.data.defaultColor),this.moved=!1)})),n.JoystickDirections.install({leftClick:()=>this.el.sceneEl.systems.speech.speak("Left"),rightClick:()=>this.el.sceneEl.systems.speech.speak("Right"),upClick:()=>this.el.sceneEl.systems.speech.speak("Down"),downClick:()=>this.el.sceneEl.systems.speech.speak("Up")},{targetEl:this.data.hand,whenGrabbing:!0})},tock(){let t=this.el.sceneEl.camera;t.getWorldPosition(this.el.object3D.position),t.getWorldQuaternion(this.el.object3D.quaternion)}})},function(t,e){function i(t,e){const i=this.el.components["smooth-controller"].data.amount*e;if(!this._poseVecs||this._poseVecs.length!==i){this._poseVecs=[];for(let e=0;e<i;++e)this._poseVecs[e]=new THREE.Vector3,this._poseVecs[e].copy(t.position)}this._poseVecs[i-1].copy(t.position);for(let t=1;t<i;++t)this._poseVecs[0].add(this._poseVecs[t]);this._poseVecs[0].divideScalar(i),t.position.copy(this._poseVecs[0]);for(let t=1;t<i;++t)this._poseVecs[t-1].copy(this._poseVecs[t]);if(!this._quarts||this._quarts.length!==i){this._quarts=[];for(let e=0;e<i;++e)this._quarts[e]=new THREE.Quaternion,this._quarts[e].copy(t.quaternion)}this._quarts[i-1].copy(t.quaternion);for(let t=1;t<i;++t)this._quarts[0].slerp(this._quarts[t],1/i);t.quaternion.copy(this._quarts[0]);for(let t=1;t<i;++t)this._quarts[t-1].copy(this._quarts[t])}function n(){var t,e,n=this.controller,r=this.data,a=this.el.object3D,o=this.system.vrDisplay;n&&((t=n.pose).position?(this._hasHadPose=!0,a.position.fromArray(t.position)):this._hasHadPose||r.armModel&&this.applyArmModel(a.position),t.orientation&&a.quaternion.fromArray(t.orientation),o&&t.position&&(e=this.el.sceneEl.renderer.xr.getStandingMatrix(),a.matrix.compose(a.position,a.quaternion,a.scale),a.matrix.multiplyMatrices(e,a.matrix),a.matrix.decompose(a.position,a.quaternion,a.scale)),a.rotateX(this.data.orientationOffset.x*THREE.Math.DEG2RAD),a.rotateY(this.data.orientationOffset.y*THREE.Math.DEG2RAD),a.rotateZ(this.data.orientationOffset.z*THREE.Math.DEG2RAD),i.call(this,a,1))}function r(){var t=this.el.object3D,e=this.pose;if(!e)return;t.matrix.fromArray(e.transform.matrix),t.matrix.decompose(t.position,t.rotation,t.scale);let n=this.el.components["tracked-controls"].data.orientationOffset;t.rotateX(n.x*THREE.Math.DEG2RAD),t.rotateY(n.y*THREE.Math.DEG2RAD),t.rotateZ(n.z*THREE.Math.DEG2RAD),i.call(this,t,2)}AFRAME.registerComponent("smooth-controller",{schema:{amount:{default:4}},init(){this.el.addEventListener("componentinitialized",(t=>{"tracked-controls-webvr"===t.detail.name&&this.install(),"tracked-controls-webxr"===t.detail.name&&this.install()}))},install(){console.log("Installing smooth controller"),this.el.components["tracked-controls-webvr"]&&(this.el.components["tracked-controls-webvr"].updatePose=n),this.el.components["tracked-controls-webxr"]&&(this.el.components["tracked-controls-webxr"].updatePose=r)},stabilize(t=1){i.call(this,this.el.object3D,t)}}),AFRAME.registerComponent("fix-raycaster",{dependencies:["raycaster"],init(){this.el.addEventListener("controllermodelready",(t=>{this.el.setAttribute("raycaster",{origin:[0,0,0]})}))}})},function(t,e,i){"use strict";i.r(e);var n=i(6),r=i(4),a=i(3),o=i(0);AFRAME.registerComponent("draw-canvas",{schema:{canvas:{type:"selector"},compositor:{type:"selector"},emitDrawEvents:{default:!1}},emits:{drawing:{x:0,y:0,uv:null}},init(){a.Pool.init(this),o.Util.emitsEvents(this);let t=this.el.sceneEl.systems["paint-system"];this.brush=t.brush,this.el.hasAttribute("action-tooltips")||(this.el.setAttribute("action-tooltips__right-hand","trigger: Draw; updown: Scale Brush; a: Erase; b: Pick color"),this.el.setAttribute("action-tooltips__left-hand","trigger: Draw; updown: Scale Brush;"),this.el.setAttribute("action-tooltips__mouse","trigger: Draw")),this.sampleCanvas=document.createElement("canvas"),this.sampleCanvas.width=this.brush.width,this.sampleCanvas.height=this.brush.height,document.body.append(this.sampleCanvas),this.transform=n.Layer.EmptyTransform(),this.el.sceneEl.addEventListener("brushchanged",(t=>{this.brush=t.detail.brush})),o.Util.whenLoaded([this.el,this.el.sceneEl],(()=>{this.brush=t.brush})),this.el.addEventListener("framechanged",(t=>{delete this.imageData})),this.wrappedDraw=this.wrappedDraw.bind(this)},update(t){this.data.canvas!==t.canvas&&this.data.canvas&&(this.ctx=this.data.canvas.getContext("2d"))},uvToPoint(t,e=null,{useTransform:i=!0}={}){let{width:n,height:r}=e||this.data.canvas,{translation:a,scale:o}=this.transform,{width:s,height:l}=this.data.compositor||e||this.data.canvas;if(!t)return{x:0,y:0};let c=(1+t.y%1)%1,u=(1+t.x%1)%1;if(this.data.compositor&&!Compositor.component.data.flipY||(c=1-c),!i)return{x:s*u,y:l*c};let h=s*u-(a.x-n/2*o.x+n/2),d=l*c-(a.y-r/2*o.y+r/2);return h/=o.x,d/=o.y,{x:h,y:d}},wrap(t,e,i,n,r,...a){let{wrapX:o,wrapY:s}=this.el.sceneEl.systems["paint-system"].data;r(t,e,...a),o&&(r(t+i,e,...a),r(t-i,e,...a)),s&&(r(t,e+n,...a),r(t,e-n,...a)),s&&o&&(r(t+i,e+n,...a),r(t-i,e-n,...a),r(t+i,e-n,...a),r(t-i,e+n,...a))},wrappedDraw(t,e,i,n,r){n.drawTo(i,t,e,r)},drawUV(t,{pressure:e=1,canvas:i=null,ctx:n=null,rotation:a=0,sourceEl:o,distance:s=0,scale:l=1,lastParams:c,brush:u}){null===i&&(i=this.data.canvas),i.touch&&i.touch(),u||(u=this.brush),n||(n=this.data.canvas===i?this.ctx:i.getContext("2d"));let h,{width:d,height:p}=i,{x:f,y:m}=this.uvToPoint(t,i);this.data.emitDrawEvents&&(this.emitDetails.drawing.x=f,this.emitDetails.drawing.y=m,this.emitDetails.drawing.uv=t,this.el.emit("drawing",this.emitDetails.drawing));let g=!this.el.sceneEl.systems["settings-system"]||this.el.sceneEl.systems["settings-system"].quality>.75,y=u.hqBlending&&g&&u.opacity<.3;y=y||"always"===this.brush.hqBlending;let b=!this.wasDrawing;if(this.wasDrawing=!0,b&&o){this.el.emit("startcanvasdrawing"),r.Undo.pushCanvas(i),o.addEventListener("enddrawing",(t=>{this.wasDrawing=!1,u.endDrawing&&u.endDrawing(n),delete this.imageData,this.el.emit("endcanvasdrawing")}),{once:!0}),this.undoFrame=this.currentFrame;let t=document.getElementById("recent-colors");t&&t.components.palette.addToPalette()}else o&&this.currentFrame!==this.undoFrame&&(r.Undo.pushCanvas(i),this.undoFrame=this.currentFrame);if(u.dragRotate||u.minMovement){let t=4/p,e=4/d;if(u.minMovement&&(e=u.minMovement,t=u.minMovement),!c)return;let n=this.uvToPoint(c.uv,i);if(Math.abs(m-n.y)<t&&Math.abs(f-n.x)<e)return;a=Math.atan2(m-n.y,f-n.x),c.rotation=a}try{if(b&&u.startDrawing){let t={rotation:a,pressure:e,distance:s,imageData:h,scale:l};u.startDrawing(n,f,m,t)}if(u.connected&&g&&c){let t=this.uvToPoint(c.uv,i),r=Math.sqrt((t.x-f)*(t.x-f)+(t.y-m)*(t.y-m)),o=Math.max(Math.floor(r),1),s={hqBlending:y};o>100&&(o=-1);for(let i=0;i<o;i++){let h=i/o,g=THREE.Math.lerp(t.x,f,h),y=THREE.Math.lerp(t.y,m,h);s.rotation=THREE.Math.lerp(c.rotation,a,h),s.pressure=THREE.Math.lerp(c.pressure,e,h),s.distance=THREE.Math.lerp(c.distance,r,h),s.scale=THREE.Math.lerp(c.scale,l,h),this.wrap(g,y,d,p,this.wrappedDraw,n,u,s)}}else{let t={rotation:a,pressure:e,distance:s,imageData:h,scale:l};this.wrap(f,m,d,p,this.wrappedDraw,n,u,t)}}catch(t){console.error("Drawing error",t)}n.globalAlpha=1},drawOutlineUV(t,e,{canvas:i=null,rotation:n=0,brush:r}={}){null===i&&(i=this.data.canvas);let{width:a,height:o}=i,{x:s,y:l}=this.uvToPoint(e,i);r||(r=this.brush),r.drawOutline(t,s,l,{rotation:n});let{wrapX:c,wrapY:u}=this.el.sceneEl.systems["paint-system"].data;c&&(r.drawOutline(t,s+a,l),r.drawOutline(t,s-a,l)),u&&(r.drawOutline(t,s,l+o),r.drawOutline(t,s,l-o)),u&&c&&(r.drawOutline(t,s+a,l+o),r.drawOutline(t,s-a,l-o),r.drawOutline(t,s+a,l-o),r.drawOutline(t,s-a,l+o))},pickColorUV(t,{canvas:e=null}={}){let i=!0;if(null!==e||this.data.compositor||(e=this.data.canvas),null===e){let t=document.getElementById("canvas-view").components.compositor;t.activeLayer.mode.endsWith("Map")?e=t.activeLayer.frame(t.currentFrame):t.data.usePreOverlayCanvas?(e=t.preOverlayCanvas,i=!1):(e=t.compositeCanvas,i=!1)}let n=this.sampleCanvas,r=n.getContext("2d"),a=Math.max(Math.round(this.brush.width),1),o=Math.max(Math.round(this.brush.height),1);if(void 0===a||!isFinite(a))return;if(void 0===o||!isFinite(o))return;this.sampleCanvas.width=a,this.sampleCanvas.height=o,r.clearRect(0,0,n.width,n.height);let{x:s,y:l}=this.uvToPoint(t,void 0,{useTransform:i});r.drawImage(e,s-a/2,l-o/2,a,o,0,0,a,o),r.save(),r.globalCompositeOperation="destination-in",this.brush.drawTo(r,a/2,o/2),r.restore();let c=r.getImageData(0,0,a,o),u={r:0,g:0,b:0,alpha:0};for(let t=0;t<o;++t)for(let e=0;e<a;++e)u.r+=c.data[4*(t*a+e)+0]/255*c.data[4*(t*a+e)+3]/255,u.g+=c.data[4*(t*a+e)+1]/255*c.data[4*(t*a+e)+3]/255,u.b+=c.data[4*(t*a+e)+2]/255*c.data[4*(t*a+e)+3]/255,u.alpha+=c.data[4*(t*a+e)+3]/255;if(u.alpha>1e-5?(u.r/=u.alpha,u.g/=u.alpha,u.b/=u.alpha):(u.r=0,u.g=0,u.b=0),isNaN(u.r)||isNaN(u.g)||isNaN(u.b))throw new Error("Color sampling error. NAN",t,s,l,u,e,n,a,o);return`rgba(${Math.round(255*u.r)}, ${Math.round(255*u.g)}, ${Math.round(255*u.b)}, 1.0)`},eraseUV(t,e={}){let{pressure:i=1,canvas:n=null,rotation:a=0,scale:o=1,sourceEl:s,brush:l}=e;if(null==n&&(n=this.data.canvas),n.touch&&n.touch(),l||(l=this.brush),!this.wasErasing&&s){console.log("Pushing erase canvas"),r.Undo.pushCanvas(n);const t=e=>{"erasing"===e.detail&&(console.log("Clearing erase undo canvas"),this.wasErasing=!1,s.removeEventListener("stateremoved",t),s.removeEventListener("fakeclearstate",t))};s.addEventListener("stateremoved",t),s.addEventListener("fakeclearstate",t),this.wasErasing=!0}let c=n.getContext("2d"),{width:u,height:h}=n;c.save();let{x:d,y:p}=this.uvToPoint(t,n);c.globalCompositeOperation="destination-out",this.wrap(d,p,u,h,this.wrappedDraw,c,l,Object.assign({eraser:!0},e)),c.restore()}})},function(t,e,i){"use strict";var n=i(26),r=i(302),a=i(306),o=i(307)||0;function s(){return r(o)}t.exports=s,t.exports.generate=s,t.exports.seed=function(e){return n.seed(e),t.exports},t.exports.worker=function(e){return o=e,t.exports},t.exports.characters=function(t){return void 0!==t&&n.characters(t),n.shuffled()},t.exports.isValid=a},function(t,e,i){"use strict";var n=1;t.exports={nextValue:function(){return(n=(9301*n+49297)%233280)/233280},seed:function(t){n=t}}},function(t,e,i){"use strict";var n,r,a=i(303);i(26);t.exports=function(t){var e="",i=Math.floor(.001*(Date.now()-1567752802062));return i===r?n++:(n=0,r=i),e+=a(7),e+=a(t),n>0&&(e+=a(n)),e+=a(i)}},function(t,e,i){"use strict";var n=i(26),r=i(304),a=i(305);t.exports=function(t){for(var e,i=0,o="";!e;)o+=a(r,n.get(),1),e=t<Math.pow(16,i+1),i++;return o}},function(t,e,i){"use strict";var n,r="object"==typeof window&&(window.crypto||window.msCrypto);n=r&&r.getRandomValues?function(t){return r.getRandomValues(new Uint8Array(t))}:function(t){for(var e=[],i=0;i<t;i++)e.push(Math.floor(256*Math.random()));return e},t.exports=n},function(t,e){t.exports=function(t,e,i){for(var n=(2<<Math.log(e.length-1)/Math.LN2)-1,r=-~(1.6*n*i/e.length),a="";;)for(var o=t(r),s=r;s--;)if((a+=e[o[s]&n]||"").length===+i)return a}},function(t,e,i){"use strict";var n=i(26);t.exports=function(t){return!(!t||"string"!=typeof t||t.length<6)&&!new RegExp("[^"+n.get().replace(/[|\\{}()[\]^$+*?.-]/g,"\\$&")+"]").test(t)}},function(t,e,i){"use strict";t.exports=0},function(t,e,i){"use strict";i.r(e);var n=i(3),r=i(8),a=i(9),o=i.n(a);AFRAME.registerComponent("hand-draw-tool",{dependencies:["raycaster"],schema:{throttle:{type:"int",default:10}},init(){n.Pool.init(this),this.system=this.el.sceneEl.systems["paint-system"],this.intersects=[],this.clickStamp=0,this.distanceScale=1,this.id=o.a.generate(),this.el.addEventListener("triggerchanged",(t=>{this.pressure=(0+t.detail.value-.1)/.9;let e=this.isDrawing;this.isDrawing=this.pressure>.1,this.isDrawing&&!e&&this.startDraw(),!this.isDrawing&&e&&this.endDraw()})),this.el.hasAttribute("cursor")&&(document.addEventListener("mousedown",(t=>{0===t.button&&(t.shiftKey||this.el.is("looking")||(this.pressure=1,this.isDrawing=!0,this.startDraw()))})),document.addEventListener("mouseup",(t=>{0===t.button&&(this.el.is("looking")||this.isDrawing&&(this.isDrawing=!1,this.endDraw()))})),document.addEventListener("touchstart",(t=>{1===t.touches.length&&(t.shiftKey||this.el.is("looking")||(this.pressure=1,this.isDrawing=!0,this.startDraw()))})),document.addEventListener("touchend",(t=>{this.el.is("looking")||this.isDrawing&&(this.isDrawing=!1,this.endDraw())})),document.addEventListener("wheel",(t=>{t.shiftKey||this.el.sceneEl.systems["paint-system"].scaleBrush(-t.deltaY*(t.deltaY>50||t.deltaY<-50?1:100))}))),this._tick=this.tick,this.tick=AFRAME.utils.throttleTick(this.tick,this.data.throttle,this),this.params={pressure:0,rotation:0,el:this.el,sourceEl:this.el,distance:0,scale:1,intersection:null,brush:this.system.brush},this.lastParams=Object.assign({},this.params),this.overlayParam={uv:null,el:this.el,params:this.params}},startDraw(){this.el.emit("startdrawing")},endDraw(){this.el.emit("enddrawing"),this.lastParams.active=!1},tick(){if(this.lastCompositor&&delete this.lastCompositor.components.compositor.overlays[this.id],0==this.el.components.raycaster.intersections.length)return;let t,e,i=9999;for(let n of this.el.components.raycaster.intersections)e=n.distance,e<i&&(t=n,i=e);if(!t)return;let n,a=t.object.el,o=!1;"draw-canvas"in a.components?(o=!0,n=a.components["draw-canvas"]):"forward-draw"in a.components&&(o=!0,n=a.components["forward-draw"]);let s=0,l=this.system.brush.useNormal,c=this.system.data.rotateBrush,u=this.pool("objRot",THREE.Quaternion),h=this.pool("objUp",THREE.Vector3),d=this.pool("objForward",THREE.Vector3),p=this.pool("objRight",THREE.Vector3),f=this.pool("thisRot",THREE.Quaternion),m=this.pool("thisUp",THREE.Vector3);if(c||l){t.object.getWorldQuaternion(u),h.set(0,1,0),h.applyQuaternion(u),d.copy(t.point);let e=this.pool("thisPos",THREE.Vector3);this.el.object3D.getWorldPosition(e),d.sub(e),d.normalize(),p.crossVectors(d,h),this.el.object3D.getWorldQuaternion(f),m.copy(this.el.object3D.up),m.applyQuaternion(f)}c&&(s=Math.atan2(m.dot(h),m.dot(p)),s=t.object.el.hasAttribute("geometry")?Math.PI/2-s:Math.PI/2+s),l&&(this.pressure=m.dot(h));let g=this.params;if(g.pressure=this.pressure,g.rotation=s,g.sourceEl=this.el,g.distance=t.distance,g.scale=this.distanceScale,g.intersection=t,g.brush=this.system.brush,g.lastParams=null,(!this.hasDrawn||!this.singleShot)&&(this.isDrawing&&!this.el.is("erasing")&&(this.hasDrawn=!0,o?(r.a.draw(this.el),this.lastParams.active&&(g.lastParams=this.lastParams),n.drawUV(t.uv,g),Object.assign(this.lastParams,g),this.lastParams.active=!0,this.lastParams.uv=t.uv):a.emit("draw",g)),this.el.is("sampling")&&o&&this.system.selectColor(n.pickColorUV(t.uv)),this.el.is("erasing")&&o&&n.eraseUV(t.uv,g),o)){let e=(n.target||n).el;e.components.compositor&&(this.params.uv=t.uv,e.components.compositor.overlays[this.id]=this.params,this.lastCompositor=e)}}}),AFRAME.registerSystem("button-caster",{init(){this.casters=[],this.installedButtons=new Set,this.triggeredEls={}},register(t){this.casters.push(t);for(let e of this.installedButtons)t.addEventListener(e+"down",(i=>{this.forwardDownEvent(t,e,i)})),t.addEventListener(e+"up",(i=>{this.forwardUpEvent(t,e,i)}))},install(t){for(let e of t)if(!this.installedButtons.has(e)){for(let t of this.casters)t.addEventListener(e+"down",(i=>{this.forwardDownEvent(t,e,i)})),t.addEventListener(e+"up",(i=>{this.forwardUpEvent(t,e,i)}));this.triggeredEls[e]=new Set,this.installedButtons.add(e)}},forwardDownEvent(t,e,i){if(console.log("Forwarding button",t,e,i),0==t.components.raycaster.intersections.length)return;let n=t.components.raycaster.intersections.sort((t=>navigator.xr?t.distance:-t.distance))[0].object.el;this.triggeredEls[e].has(n)||(n.emit(e+"down",i.detail),this.triggeredEls[e].add(n))},forwardUpEvent(t,e,i){for(let t of this.triggeredEls[e])t.emit(e+"up",i.detail),this.triggeredEls[e].delete(t)}}),AFRAME.registerComponent("button-caster",{init(){this.system.register(this.el)}})},function(t,e,i){"use strict";i.r(e);var n=i(5),r=i(1),a=i(9),o=i.n(a),s=i(0);AFRAME.registerSystem("paint-system",{schema:{color:{type:"color",default:"#000"},opacity:{type:"float",default:.7},brushScale:{type:"float",default:1},brushIndex:{type:"int",default:0},rotateBrush:{type:"bool",default:!0},wrapX:{type:"bool",default:!1},wrapY:{type:"bool",default:!1},jitterColor:{default:!1}},init(){this.linearBrushScale=0,this.color3=new THREE.Color,this.jitterColor=new THREE.Color,this.brush=n.a[this.data.brushIndex],this.brush.changeColor(this.data.color),this.tick=AFRAME.utils.throttleTick(this.tick,50,this)},selectColor(t){this.data.color=t,this.brush.changeColor(t),this.color3.set(t),this.el.emit("colorchanged",{color:t}),this.el.sceneEl.emit("updatemateriallighting",null)},selectOpacity(t){this.data.opacity=t,this.brush.changeOpacity(t),this.el.emit("opacitychanged",{opacity:t})},scaleBrush(t){console.log("Scaling brush by",t),this.linearBrushScale+=t/1e3,this.data.brushScale=Math.exp(this.linearBrushScale),this.brush.changeScale(this.data.brushScale),this.el.emit("brushscalechanged",{brushScale:this.data.brushScale})},prevBrush(){let t=this.data.brushIndex-1;t<0&&(t+=n.a.length),this.selectBrush(t%n.a.length)},nextBrush(){this.selectBrush((this.data.brushIndex+1)%n.a.length)},selectBrush(t){t instanceof r.Brush?(this.data.brushIndex=n.a.indexOf(t),this.brush=t,t=this.data.brushIndex):(this.data.brushIndex=t,this.brush=n.a[this.data.brushIndex]),this.brush.changeColor(this.data.color),this.brush.changeScale(this.data.brushScale),this.brush.changeOpacity(this.data.opacity),this.el.emit("brushchanged",{brush:this.brush,index:t})},setRotateBrush(t){this.data.rotateBrush=t,this.el.emit("rotatebrushchanged",t)},applyJittter(){if(this.brush.solo)return;this.jitterColor.copy(this.color3),this.jitterColor.r=THREE.Math.clamp(this.jitterColor.r+.1*(Math.random()-.5),0,1),this.jitterColor.g+=THREE.Math.clamp(this.jitterColor.g+.1*(Math.random()-.5),0,1),this.jitterColor.b+=THREE.Math.clamp(this.jitterColor.b+.1*(Math.random()-.5),0,1),this.brush.changeColor(this.jitterColor.getStyle())},tick(t,e){this.data.jitterColor&&this.applyJittter()}}),s.Util.registerComponentSystem("paint-system-settings",{schema:AFRAME.systems["paint-system"].prototype.schema,init(){},update(t){for(let[e,i]of Object.entries(AFRAME.utils.diff(t,this.data)))this.el.systems["paint-system"].data[e]=i}}),AFRAME.registerComponent("set-brush",{schema:{brushType:{type:"string"},activationEvent:{default:"set-brush"}},init(){this.activate=this.activate.bind(this)},updateSchema(t){this.data&&t.brushType===this.data.brushType||this.extendSchema(r[t.brushType].schema())},update(t){switch(this.data.activationEvent!==t.activationEvent&&(t.activationEvent&&this.el.removeEventListener(t.activationEvent,this.activate),this.el.addEventListener(this.data.activationEvent,this.activate)),console.log("Brush update",this.data,t),this.data.brushType){case"ImageBrush":this.brush=new r.ImageBrush(o.a.generate(),this.data.image,this.data);break;case"ProceduralBrush":this.brush=new r.ProceduralBrush(o.a.generate(),this.data);break;case"StretchBrush":this.brush=new r.StretchBrush(o.a.generate,this.data.image,this.data);break;default:return void console.error("Brush type not yet supported",this.data.brushType)}console.log("Loaded brush",this.data.color,this.brush),this.brush.changeScale(this.data.scale),this.brush.changeColor(this.data.color),this.brush.changeOpacity(this.data.opacity),(this.el.components["hand-draw-tool"]||this.el.sceneEl===this.el)&&this.activate()},activate(){this.brush&&(this.el.components["hand-draw-tool"]?this.el.components["hand-draw-tool"].system.brush=this.brush:this.el.sceneEl.systems["paint-system"].brush=this.brush)}})},function(t,e,i){t.exports=i.p+"asset/279229f6c9700c62f1e4b86df9d741e4.png"},function(t,e,i){t.exports=i.p+"asset/776824d8dee0d303eee931d604b0932f.png"},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAADU0lEQVR4nO3ZTYzdYxTH8arSaqsVbZMWsavEQiIjmohYFBuReLew8JpSolVBoqgIM0YtNBIrsaSLxkKCbmwkRAkiYW2Figgi3l8687E455/7N52ZO+n933kyN883ubk3uXfxO+ee83vOc/7LllUqlUqlUqlUKp2Dk7ASq0prWXQwhptxPrZhbWlNiwY24Hn8jUN4HFeU1rUoYAW2ZuBT+BcTeBCbSusbKtnz63ADPssKmMZPGMfdI98KWI078GX++1OZhHfxBLaX1jhUcDr24NcM/FjrfbRbIVtgIx7AUUE7CT/iGezAmtJ6OwfLcTb24fMMuklC0wrvZCtcVlpv52QFnIFd+KQVtNbn0W4FrMWt+DgDblfBsfz8Q7bCXVhdWnOn5ClwIz6YkYCZrfB2DkiXlNbcKViTc8CRGcE3zNYKG0vr7gxx+bkGBzPY2WiS8H22wp04rbT2TsgEXIX9rZ6fyXTr9QYew7bS2jsBJ4sb4AH8PkcC2lXQ3BX2jEwr4Mws7W/nSUA7Cd/l72+31HcHYhbYJBz+SJ8EtFvhdezFWOkYBkacBPfisNlPgtmq4J9WK2woHcNACCO8Wm8n0I8mCd/gadxSOoaBwCm4FC+JnUA/mgHpLz0vWF46jhNGbIUuEEfhzwtIAHFkfopHLfXpUBjhFrEF+kJ/H2hojPDC0jEMjLgVPoyX8fUCE/BbJm1Haf0DI06C64WpHdS/FabF4DSBe0rrHxixHDlLzPnjeEuYXL8k7MdD2Fw6hoERY/F5YkX2HN439/2g4c+sgvuwonQMAyNOhIuEux/Q3xSn8Yrwj3NK6+8ErMLleFKY4ld9quDD/O2VpbV3gjgW1+M6CzPFP7INdpbW3hnCFLeIhyYT5jfFaUxid2ndneJ4U3zP3KY4KS5Gp5bW3Sl6prgXL/j/84M2r+IRnFtac+cIU9xuflM8LFZlF5fW2zmON8XX9EyxqYZmYXpbab1DYYYpjuNNvcfpza7wWdxfWuvQSFPcmqY4maY41UrCZH639CfCuUhTHGuZ4tFWEl7MBKwrrXOoiBVaY4qH8Esej/vEQ5aVpTUOlZYpXounxDb5I6M2CM1HmuJm3JRlv7Q3wydCJmF9aR2VSqVSqVQqlUpl9PkPn81+mfYD7REAAAAASUVORK5CYII="},function(t,e,i){t.exports=i.p+"asset/ae7a888a46682301ccce24fad3b07434.png"},function(t,e,i){t.exports=i.p+"asset/c9ae99a6c8f4819980833ca61eed6ac1.png"},function(t,e,i){t.exports=i.p+"asset/ea4adcdc9ff49a633f900ae2e8e31b8f.png"},function(t,e,i){t.exports=i.p+"asset/d17dbf9425ab68af0154cded8191561a.png"},function(t,e,i){t.exports=i.p+"asset/e86e1558b355e463e454ed0eff114e62.png"},function(t,e,i){t.exports=i.p+"asset/48a68c29e8c8f2244bf667c96dce888a.png"},function(t,e,i){t.exports=i.p+"asset/353d1a7628e95e00fc0a07d0f30cb628.png"},function(t,e,i){t.exports=i.p+"asset/5d67c3aaf2b4efc1dc849ce4d8eec611.png"},function(t,e,i){t.exports=i.p+"asset/2af1fe366206f3c9a8e76f8fb584d20d.png"},function(t,e,i){t.exports=i.p+"asset/135c8bf1e8ed570734c9883ea8a10cbe.png"},function(t,e,i){t.exports=i.p+"asset/1f0e8e7dc8ed9b7456c80e1eab132476.png"},function(t,e,i){t.exports=i.p+"asset/8dff4a52b812b27f9ac7f33187f99cdf.png"},function(t,e,i){t.exports=i.p+"asset/e7d5d89bb44fc0356ea6542f07cfd632.png"},function(t,e,i){t.exports=i.p+"asset/fd0a3bb2aea499c34fbc3bdc08e8a1e0.png"},function(t,e,i){t.exports=i.p+"asset/27dd3a80b7d1320a4533c7c342b6eb1a.png"},function(t,e,i){t.exports=i.p+"asset/79d40be42b667c9c33178a4c5308227e.png"},function(t,e,i){t.exports=i.p+"asset/bd026a92ac7392ec0f194de0dcb74219.png"},function(t,e,i){t.exports=i.p+"asset/131229d120822b77a4ec79ac3ef648de.png"},function(t,e,i){t.exports=i.p+"asset/7292e261aff86324f542bc8b182348c8.png"},function(t,e,i){var n={"./apply-uv-spray.glsl":333,"./blur.glsl":334,"./dilate.glsl":335,"./drip.glsl":336,"./erode.glsl":337,"./hq-blending.glsl":40,"./noise.glsl":338,"./nudge.glsl":339,"./oklab-blend.glsl":340,"./ryb-blend.glsl":341,"./scatter.glsl":342,"./util.glsl":343};function r(t){var e=a(t);return i(e)}function a(t){if(!i.o(n,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return n[t]}r.keys=function(){return Object.keys(n)},r.resolve=a,t.exports=r,r.id=332},function(t,e){t.exports="#version 100\nprecision mediump float;\nuniform sampler2D u_input;\nuniform float u_width;\nuniform float u_height;\nuniform sampler2D u_brush;\nuniform float u_brush_width;\nuniform float u_brush_height;\nuniform float u_brush_rotation;\nuniform float u_x;\nuniform float u_y;\nuniform float u_opacity;\nuniform vec3 u_color;\nuniform float u_t;\nuniform sampler2D u_uvCapture;\nvarying vec2 vUv;\nfloat rand(vec2 co) {\n\treturn fract(sin(dot(co.xy + u_t, vec2(12.9898, 78.233))) * 43758.5453);\n}\nvec2 calcBrushUv(float x, float y) {\n\tvec2 point = vec2(((vUv.x - ((x - (u_brush_width / 2.0)) / u_width)) * u_width) / u_brush_width, ((vUv.y - ((y - (u_brush_height / 2.0)) / u_height)) * u_height) / u_brush_height);\n\tvec2 offsetPoint = point - 0.5;\n\tfloat len = length(offsetPoint);\n\tfloat angle = atan(offsetPoint.y, offsetPoint.x);\n\tangle -= u_brush_rotation;\n\tpoint.x = (len * cos(angle)) + 0.5;\n\tpoint.y = (len * sin(angle)) + 0.5;\n\treturn point;\n}\nfloat remix0(vec3 resColor, vec4 canvasBaseColor, float opacity, vec2 brushUv) {\n\tconst int channel = 0;\n\tif (opacity < (1.0 / 256.0))\n\t\treturn resColor[channel];\n\tif ((resColor[channel] - canvasBaseColor[channel]) > (5.0 / 256.0))\n\t\treturn resColor[channel];\n\treturn u_color[channel];\n\tif (u_color[channel] > canvasBaseColor[channel])\n\t\treturn resColor[channel] + ((4.0 * (rand(brushUv) - 0.5)) / 256.0);\n\treturn resColor[channel] - ((2.0 * (rand(brushUv) - 0.5)) / 256.0);\n}\nfloat remix1(vec3 resColor, vec4 canvasBaseColor, float opacity, vec2 brushUv) {\n\tconst int channel = 1;\n\tif (opacity < (1.0 / 256.0))\n\t\treturn resColor[channel];\n\tif ((resColor[channel] - canvasBaseColor[channel]) > (5.0 / 256.0))\n\t\treturn resColor[channel];\n\treturn u_color[channel];\n\tif (u_color[channel] > canvasBaseColor[channel])\n\t\treturn resColor[channel] + ((4.0 * (rand(brushUv) - 0.5)) / 256.0);\n\treturn resColor[channel] - ((4.0 * (rand(brushUv) - 0.5)) / 256.0);\n}\nfloat remix2(vec3 resColor, vec4 canvasBaseColor, float opacity, vec2 brushUv) {\n\tconst int channel = 2;\n\tif (opacity < (1.0 / 256.0))\n\t\treturn resColor[channel];\n\tif ((resColor[channel] - canvasBaseColor[channel]) > (5.0 / 256.0))\n\t\treturn resColor[channel];\n\treturn u_color[channel];\n\tif (u_color[channel] > canvasBaseColor[channel])\n\t\treturn resColor[channel] + ((4.0 * (rand(brushUv) - 0.5)) / 256.0);\n\treturn resColor[channel] - ((4.0 * (rand(brushUv) - 0.5)) / 256.0);\n}\nvoid main() {\n\tvec4 canvasBaseColor = texture2D(u_input, vUv);\n\tvec2 brushUv = calcBrushUv(u_x, u_y);\n\tvec4 brushColor = texture2D(u_brush, brushUv);\n\tvec4 brushUvLast = texture2D(u_brush, calcBrushUv(u_x - 1.0, u_y - 1.0));\n\tfloat opacity = brushColor[3];\n\topacity = opacity * u_opacity;\n\topacity = opacity < 0.000001 ? -99.0 : opacity;\n\topacity += ((4.0 * (rand(brushUv) - 0.5)) / 256.0);\n\topacity = (brushUv.x > 1.0) || (brushUv.y > 1.0) ? 0.0 : opacity;\n\topacity = (brushUv.x < 0.0) || (brushUv.y < 0.0) ? 0.0 : opacity;\n\topacity = clamp(opacity, 0.0, 1.0);\n\tvec3 resColor = mix(canvasBaseColor.xyz, u_color, opacity);\n\tfloat resOpacity = mix(canvasBaseColor[3], 1.0, opacity);\n\tgl_FragColor = opacity < (1.0 / 256.0) ? canvasBaseColor : vec4(resColor, resOpacity);\n}\n"},function(t,e){t.exports="#version 100\nprecision mediump float;\nuniform sampler2D u_input;\nuniform float u_width;\nuniform float u_height;\nuniform sampler2D u_brush;\nuniform float u_brush_width;\nuniform float u_brush_height;\nuniform float u_brush_rotation;\nuniform float u_x;\nuniform float u_y;\nuniform float u_opacity;\nuniform vec3 u_color;\nuniform float u_t;\nvarying vec2 vUv;\nfloat rand(vec2 co) {\n\treturn fract(sin(dot(co.xy + u_t, vec2(12.9898, 78.233))) * 43758.5453);\n}\nvec2 calcBrushUv(float x, float y) {\n\tvec2 point = vec2(((vUv.x - ((x - (u_brush_width / 2.0)) / u_width)) * u_width) / u_brush_width, ((vUv.y - ((y - (u_brush_height / 2.0)) / u_height)) * u_height) / u_brush_height);\n\tvec2 offsetPoint = point - 0.5;\n\tfloat len = length(offsetPoint);\n\tfloat angle = atan(offsetPoint.y, offsetPoint.x);\n\tangle -= u_brush_rotation;\n\tpoint.x = (len * cos(angle)) + 0.5;\n\tpoint.y = (len * sin(angle)) + 0.5;\n\treturn point;\n}\nvec4 mixByBrush(vec4 color) {\n\tvec4 canvasBaseColor = texture2D(u_input, vUv);\n\tvec2 brushUv = calcBrushUv(u_x, u_y);\n\tvec4 brushColor = texture2D(u_brush, brushUv);\n\tfloat opacity = brushColor[3];\n\topacity = opacity * u_opacity;\n\topacity = opacity < 0.000001 ? -99.0 : opacity;\n\topacity += ((4.0 * (rand(brushUv) - 0.5)) / 256.0);\n\topacity = (brushUv.x > 1.0) || (brushUv.y > 1.0) ? 0.0 : opacity;\n\topacity = (brushUv.x < 0.0) || (brushUv.y < 0.0) ? 0.0 : opacity;\n\topacity = clamp(opacity, 0.0, 1.0);\n\treturn mix(canvasBaseColor, color, opacity);\n}\nvec4 scatter() {\n\tvec2 uv = vec2(vUv.x + ((((rand(vUv) - 0.5) * u_brush_width) / u_width) * 0.5), vUv.y + ((((rand(vUv * 7.414556064744165) - 0.5) * u_brush_height) / u_height) * 0.5));\n\treturn texture2D(u_input, uv);\n}\nvec4 blur(vec2 direction) {\n\tvec2 off1 = vec2(1.3846153846) * direction;\n\tvec2 off2 = vec2(3.2307692308) * direction;\n\tvec4 color1 = vec4(0.0);\n\tvec2 resolution = vec2(u_width / 2.0, u_height / 2.0);\n\tcolor1 += (scatter() * 0.2270270270);\n\tcolor1 += (texture2D(u_input, vUv + (off1 / resolution)) * 0.3162162162);\n\tcolor1 += (texture2D(u_input, vUv - (off1 / resolution)) * 0.3162162162);\n\tcolor1 += (texture2D(u_input, vUv + (off2 / resolution)) * 0.0702702703);\n\tcolor1 += (texture2D(u_input, vUv - (off2 / resolution)) * 0.0702702703);\n\treturn color1;\n}\nvoid main() {\n\tvec4 color = ((blur(vec2(1.0, 0.0)) + blur(vec2(0.0, -1.0))) + blur(vec2(1.0, -1.0))) + blur(vec2(1.0, 1.0));\n\tcolor += (0.5 * (((blur(vec2(2.0, 0.0)) + blur(vec2(0.0, -2.0))) + blur(vec2(2.0, -2.0))) + blur(vec2(2.0, 2.0))));\n\tcolor /= 6.0;\n\tgl_FragColor = mixByBrush(color);\n}\n"},function(t,e){t.exports="#version 100\nprecision mediump float;\nuniform sampler2D u_input;\nuniform float u_width;\nuniform float u_height;\nuniform sampler2D u_brush;\nuniform float u_brush_width;\nuniform float u_brush_height;\nuniform float u_brush_rotation;\nuniform float u_x;\nuniform float u_y;\nuniform float u_opacity;\nuniform vec3 u_color;\nuniform float u_t;\nvarying vec2 vUv;\nfloat rand(vec2 co) {\n\treturn fract(sin(dot(co.xy + u_t, vec2(12.9898, 78.233))) * 43758.5453);\n}\nvec2 calcBrushUv(float x, float y) {\n\tvec2 point = vec2(((vUv.x - ((x - (u_brush_width / 2.0)) / u_width)) * u_width) / u_brush_width, ((vUv.y - ((y - (u_brush_height / 2.0)) / u_height)) * u_height) / u_brush_height);\n\tvec2 offsetPoint = point - 0.5;\n\tfloat len = length(offsetPoint);\n\tfloat angle = atan(offsetPoint.y, offsetPoint.x);\n\tangle -= u_brush_rotation;\n\tpoint.x = (len * cos(angle)) + 0.5;\n\tpoint.y = (len * sin(angle)) + 0.5;\n\treturn point;\n}\nvec4 mixByBrush(vec4 color) {\n\tvec4 canvasBaseColor = texture2D(u_input, vUv);\n\tvec2 brushUv = calcBrushUv(u_x, u_y);\n\tvec4 brushColor = texture2D(u_brush, brushUv);\n\tfloat opacity = brushColor[3];\n\topacity = opacity * u_opacity;\n\topacity = opacity < 0.000001 ? -99.0 : opacity;\n\topacity += ((4.0 * (rand(brushUv) - 0.5)) / 256.0);\n\topacity = (brushUv.x > 1.0) || (brushUv.y > 1.0) ? 0.0 : opacity;\n\topacity = (brushUv.x < 0.0) || (brushUv.y < 0.0) ? 0.0 : opacity;\n\topacity = clamp(opacity, 0.0, 1.0);\n\treturn mix(canvasBaseColor, color, opacity);\n}\nvec4 pick(vec2 direction) {\n\tvec2 uv = vUv + (direction * vec2(2.0 / u_width, 2.0 / u_height));\n\treturn texture2D(u_input, uv);\n}\nvec4 maxByAlpha(vec4 c1, vec4 c2, vec4 c3, vec4 c4, vec4 c5) {\n\tfloat maxA = c1.a;\n\tmaxA = max(maxA, c2.a);\n\tmaxA = max(maxA, c3.a);\n\tmaxA = max(maxA, c4.a);\n\tmaxA = max(maxA, c5.a);\n\treturn maxA == c1.a ? c1 : maxA == c2.a ? c2 : maxA == c3.a ? c3 : maxA == c4.a ? c4 : c5;\n}\nvoid main() {\n\tvec4 color = maxByAlpha(pick(vec2(0.0, 0.0)), pick(vec2(1.0, 0.0)), pick(vec2(0.0, -1.0)), pick(vec2(-1.0, 0.0)), pick(vec2(0.0, 1.0)));\n\tgl_FragColor = mixByBrush(color);\n}\n"},function(t,e){t.exports="#version 100\nprecision mediump float;\nuniform sampler2D u_input;\nuniform float u_width;\nuniform float u_height;\nuniform sampler2D u_brush;\nuniform float u_brush_width;\nuniform float u_brush_height;\nuniform float u_brush_rotation;\nuniform float u_x;\nuniform float u_y;\nuniform float u_opacity;\nuniform vec3 u_color;\nuniform float u_t;\nvarying vec2 vUv;\nfloat rand(vec2 co) {\n\treturn fract(sin(dot(co.xy + u_t, vec2(12.9898, 78.233))) * 43758.5453);\n}\nvec2 calcBrushUv(float x, float y) {\n\tvec2 point = vec2(((vUv.x - ((x - (u_brush_width / 2.0)) / u_width)) * u_width) / u_brush_width, ((vUv.y - ((y - (u_brush_height / 2.0)) / u_height)) * u_height) / u_brush_height);\n\tvec2 offsetPoint = point - 0.5;\n\tfloat len = length(offsetPoint);\n\tfloat angle = atan(offsetPoint.y, offsetPoint.x);\n\tangle -= u_brush_rotation;\n\tpoint.x = (len * cos(angle)) + 0.5;\n\tpoint.y = (len * sin(angle)) + 0.5;\n\treturn point;\n}\nvoid main() {\n\tvec2 brushUv = calcBrushUv(u_x, u_y);\n\tvec4 brushColor = texture2D(u_brush, brushUv);\n\tvec4 nudgeColor = texture2D(u_input, vUv - vec2(cos(u_brush_rotation) / u_width, sin(u_brush_rotation) / u_height));\n\tvec2 nudgeBrushUv = calcBrushUv(u_x - (cos(u_brush_rotation) / u_width), u_y - (sin(u_brush_rotation) / u_height));\n\tvec4 nudgeBrushColor = texture2D(u_brush, nudgeBrushUv);\n\tfloat opacity = brushColor[3];\n\topacity = (brushUv.x > 1.0) || (brushUv.y > 1.0) ? 0.0 : opacity;\n\topacity = (brushUv.x < 0.0) || (brushUv.y < 0.0) ? 0.0 : opacity;\n\topacity = clamp(opacity, 0.0, 1.0);\n\tfloat nudgeAmmount = nudgeBrushColor[3];\n\tnudgeAmmount = (nudgeBrushUv.x > 1.0) || (nudgeBrushUv.y > 1.0) ? 0.0 : nudgeAmmount;\n\tnudgeAmmount = (nudgeBrushUv.x < 0.0) || (nudgeBrushUv.y < 0.0) ? 0.0 : nudgeAmmount;\n\tnudgeAmmount = clamp(nudgeAmmount, 0.0, 1.0);\n\tvec4 currentColor = texture2D(u_input, vUv - (nudgeAmmount * vec2(cos(u_brush_rotation) / u_width, sin(u_brush_rotation) / u_height)));\n\tvec4 upColor = texture2D(u_input, vUv + (vec2(0, -1) / u_height));\n\tvec4 downColor = texture2D(u_input, vUv + (vec2(0, 1) / u_height));\n\tfloat resistance = downColor[3];\n\tresistance = vUv.y >= ((u_height - 1.0) / u_height) ? 1.0 : resistance;\n\tvec4 res = currentColor;\n\tres = mix(currentColor, upColor, 1.0 - resistance);\n\tres = mix(res, brushColor, opacity);\n\tres = mix(currentColor, res, u_opacity);\n\tgl_FragColor = res;\n}\n"},function(t,e){t.exports="#version 100\nprecision mediump float;\nuniform sampler2D u_input;\nuniform float u_width;\nuniform float u_height;\nuniform sampler2D u_brush;\nuniform float u_brush_width;\nuniform float u_brush_height;\nuniform float u_brush_rotation;\nuniform float u_x;\nuniform float u_y;\nuniform float u_opacity;\nuniform vec3 u_color;\nuniform float u_t;\nvarying vec2 vUv;\nfloat rand(vec2 co) {\n\treturn fract(sin(dot(co.xy + u_t, vec2(12.9898, 78.233))) * 43758.5453);\n}\nvec2 calcBrushUv(float x, float y) {\n\tvec2 point = vec2(((vUv.x - ((x - (u_brush_width / 2.0)) / u_width)) * u_width) / u_brush_width, ((vUv.y - ((y - (u_brush_height / 2.0)) / u_height)) * u_height) / u_brush_height);\n\tvec2 offsetPoint = point - 0.5;\n\tfloat len = length(offsetPoint);\n\tfloat angle = atan(offsetPoint.y, offsetPoint.x);\n\tangle -= u_brush_rotation;\n\tpoint.x = (len * cos(angle)) + 0.5;\n\tpoint.y = (len * sin(angle)) + 0.5;\n\treturn point;\n}\nvec4 mixByBrush(vec4 color) {\n\tvec4 canvasBaseColor = texture2D(u_input, vUv);\n\tvec2 brushUv = calcBrushUv(u_x, u_y);\n\tvec4 brushColor = texture2D(u_brush, brushUv);\n\tfloat opacity = brushColor[3];\n\topacity = opacity * u_opacity;\n\topacity = opacity < 0.000001 ? -99.0 : opacity;\n\topacity += ((4.0 * (rand(brushUv) - 0.5)) / 256.0);\n\topacity = (brushUv.x > 1.0) || (brushUv.y > 1.0) ? 0.0 : opacity;\n\topacity = (brushUv.x < 0.0) || (brushUv.y < 0.0) ? 0.0 : opacity;\n\topacity = clamp(opacity, 0.0, 1.0);\n\treturn mix(canvasBaseColor, color, opacity);\n}\nvec4 pick(vec2 direction) {\n\tvec2 uv = vUv + (direction * vec2(2.0 / u_width, 2.0 / u_height));\n\treturn texture2D(u_input, uv);\n}\nvec4 minByAlpha(vec4 c1, vec4 c2, vec4 c3, vec4 c4, vec4 c5) {\n\tfloat maxA = c1.a;\n\tmaxA = min(maxA, c2.a);\n\tmaxA = min(maxA, c3.a);\n\tmaxA = min(maxA, c4.a);\n\tmaxA = min(maxA, c5.a);\n\treturn maxA == c1.a ? c1 : maxA == c2.a ? c2 : maxA == c3.a ? c3 : maxA == c4.a ? c4 : c5;\n}\nvoid main() {\n\tvec4 color = minByAlpha(pick(vec2(1.0, 0.0)), pick(vec2(0.0, -1.0)), pick(vec2(-1.0, 0.0)), pick(vec2(0.0, 1.0)), pick(vec2(0.0, 0.0)));\n\tgl_FragColor = mixByBrush(color);\n}\n"},function(t,e){t.exports="#version 100\nprecision mediump float;\nuniform sampler2D u_input;\nuniform float u_width;\nuniform float u_height;\nuniform sampler2D u_brush;\nuniform float u_brush_width;\nuniform float u_brush_height;\nuniform float u_brush_rotation;\nuniform float u_x;\nuniform float u_y;\nuniform float u_opacity;\nuniform vec3 u_color;\nuniform float u_t;\nvarying vec2 vUv;\nfloat rand(vec2 co) {\n\treturn fract(sin(dot(co.xy + u_t, vec2(12.9898, 78.233))) * 43758.5453);\n}\nvec2 calcBrushUv(float x, float y) {\n\tvec2 point = vec2(((vUv.x - ((x - (u_brush_width / 2.0)) / u_width)) * u_width) / u_brush_width, ((vUv.y - ((y - (u_brush_height / 2.0)) / u_height)) * u_height) / u_brush_height);\n\tvec2 offsetPoint = point - 0.5;\n\tfloat len = length(offsetPoint);\n\tfloat angle = atan(offsetPoint.y, offsetPoint.x);\n\tangle -= u_brush_rotation;\n\tpoint.x = (len * cos(angle)) + 0.5;\n\tpoint.y = (len * sin(angle)) + 0.5;\n\treturn point;\n}\nvec4 noise() {\n\tfloat alpha = rand(vUv);\n\treturn vec4(rand(vUv * 7.414556064744165) * alpha, rand(vUv * 4.27784067165961246) * alpha, rand(vUv * 1.1248013561030275073) * alpha, alpha);\n}\nvoid main() {\n\tvec4 color = noise();\n\tvec4 canvasBaseColor = texture2D(u_input, vUv);\n\tvec2 brushUv = calcBrushUv(u_x, u_y);\n\tvec4 brushColor = texture2D(u_brush, brushUv);\n\tfloat opacity = brushColor[3] * color[3];\n\topacity = opacity * u_opacity;\n\topacity = opacity < 0.000001 ? -99.0 : opacity;\n\topacity += ((4.0 * (rand(brushUv) - 0.5)) / 256.0);\n\tif (rand(vUv * 2.1394786121788317696) < opacity)\n\t\topacity = 0.0;\n\topacity = (brushUv.x > 1.0) || (brushUv.y > 1.0) ? 0.0 : opacity;\n\topacity = (brushUv.x < 0.0) || (brushUv.y < 0.0) ? 0.0 : opacity;\n\topacity = clamp(opacity, 0.0, 1.0);\n\tvec4 resColor = mix(canvasBaseColor, color, opacity);\n\tgl_FragColor = resColor;\n}\n"},function(t,e){t.exports="#version 100\nprecision mediump float;\nuniform sampler2D u_input;\nuniform float u_width;\nuniform float u_height;\nuniform sampler2D u_brush;\nuniform float u_brush_width;\nuniform float u_brush_height;\nuniform float u_brush_rotation;\nuniform float u_x;\nuniform float u_y;\nuniform float u_opacity;\nuniform vec3 u_color;\nuniform float u_t;\nvarying vec2 vUv;\nfloat rand(vec2 co) {\n\treturn fract(sin(dot(co.xy + u_t, vec2(12.9898, 78.233))) * 43758.5453);\n}\nvec2 calcBrushUv(float x, float y) {\n\tvec2 point = vec2(((vUv.x - ((x - (u_brush_width / 2.0)) / u_width)) * u_width) / u_brush_width, ((vUv.y - ((y - (u_brush_height / 2.0)) / u_height)) * u_height) / u_brush_height);\n\tvec2 offsetPoint = point - 0.5;\n\tfloat len = length(offsetPoint);\n\tfloat angle = atan(offsetPoint.y, offsetPoint.x);\n\tangle -= u_brush_rotation;\n\tpoint.x = (len * cos(angle)) + 0.5;\n\tpoint.y = (len * sin(angle)) + 0.5;\n\treturn point;\n}\nvec4 blur(vec2 direction) {\n\tvec2 off1 = vec2(1.3846153846) * direction;\n\tvec2 off2 = vec2(3.2307692308) * direction;\n\tvec4 color1 = vec4(0.0);\n\tvec2 resolution = vec2(u_width / 2.0, u_height / 2.0);\n\tcolor1 += (texture2D(u_input, vUv) * 0.2270270270);\n\tcolor1 += (texture2D(u_input, vUv + (off1 / resolution)) * 0.3162162162);\n\tcolor1 += (texture2D(u_input, vUv - (off1 / resolution)) * 0.3162162162);\n\tcolor1 += (texture2D(u_input, vUv + (off2 / resolution)) * 0.0702702703);\n\tcolor1 += (texture2D(u_input, vUv - (off2 / resolution)) * 0.0702702703);\n\treturn color1;\n}\nvoid main() {\n\tvec4 canvasBaseColor = texture2D(u_input, vUv);\n\tvec4 color = texture2D(u_input, vUv - vec2(cos(u_brush_rotation) / u_width, sin(u_brush_rotation) / u_height));\n\tvec2 brushUv = calcBrushUv(u_x, u_y);\n\tvec4 brushColor = texture2D(u_brush, brushUv);\n\tfloat opacity = brushColor[3];\n\topacity = opacity * u_opacity;\n\topacity = opacity < 0.000001 ? -99.0 : opacity;\n\topacity += ((4.0 * (rand(brushUv) - 0.5)) / 256.0);\n\topacity = (brushUv.x > 1.0) || (brushUv.y > 1.0) ? 0.0 : opacity;\n\topacity = (brushUv.x < 0.0) || (brushUv.y < 0.0) ? 0.0 : opacity;\n\topacity = clamp(opacity, 0.0, 1.0);\n\tvec4 resColor = mix(canvasBaseColor, color, opacity);\n\tgl_FragColor = resColor;\n}\n"},function(t,e){t.exports="#version 100\nprecision mediump float;\nuniform sampler2D u_input;\nuniform float u_width;\nuniform float u_height;\nuniform sampler2D u_brush;\nuniform float u_brush_width;\nuniform float u_brush_height;\nuniform float u_brush_rotation;\nuniform float u_x;\nuniform float u_y;\nuniform float u_opacity;\nuniform vec3 u_color;\nuniform float u_t;\nvarying vec2 vUv;\nfloat rand(vec2 co) {\n\treturn fract(sin(dot(co.xy + u_t, vec2(12.9898, 78.233))) * 43758.5453);\n}\nvec2 calcBrushUv(float x, float y) {\n\tvec2 point = vec2(((vUv.x - ((x - (u_brush_width / 2.0)) / u_width)) * u_width) / u_brush_width, ((vUv.y - ((y - (u_brush_height / 2.0)) / u_height)) * u_height) / u_brush_height);\n\tvec2 offsetPoint = point - 0.5;\n\tfloat len = length(offsetPoint);\n\tfloat angle = atan(offsetPoint.y, offsetPoint.x);\n\tangle -= u_brush_rotation;\n\tpoint.x = (len * cos(angle)) + 0.5;\n\tpoint.y = (len * sin(angle)) + 0.5;\n\treturn point;\n}\nfloat min(float a, float b, float c) {\n\treturn min(min(a, b), c);\n}\nfloat max(float a, float b, float c) {\n\treturn max(max(a, b), c);\n}\nvec3 oklab_mix(vec3 colA, vec3 colB, float h) {\n\tconst mat3 kCONEtoLMS = mat3(0.4121656120, 0.2118591070, 0.0883097947, 0.5362752080, 0.6807189584, 0.2818474174, 0.0514575653, 0.1074065790, 0.6302613616);\n\tconst mat3 kLMStoCONE = mat3(4.0767245293, -1.2681437731, -0.0041119885, -3.3072168827, 2.6093323231, -0.7034763098, 0.2307590544, -0.3411344290, 1.7068625689);\n\tvec3 lmsA = pow(kCONEtoLMS * colA, vec3(1.0 / 3.0));\n\tvec3 lmsB = pow(kCONEtoLMS * colB, vec3(1.0 / 3.0));\n\tvec3 lms = mix(lmsA, lmsB, h);\n\treturn kLMStoCONE * ((lms * lms) * lms);\n}\nfloat remix0(vec3 resColor, vec4 canvasBaseColor, float opacity, vec2 brushUv) {\n\tconst int channel = 0;\n\tif (opacity < (1.0 / 256.0))\n\t\treturn resColor[channel];\n\tif ((resColor[channel] - canvasBaseColor[channel]) > (5.0 / 256.0))\n\t\treturn resColor[channel];\n\treturn u_color[channel];\n\tif (u_color[channel] > canvasBaseColor[channel])\n\t\treturn resColor[channel] + ((4.0 * (rand(brushUv) - 0.5)) / 256.0);\n\treturn resColor[channel] - ((2.0 * (rand(brushUv) - 0.5)) / 256.0);\n}\nfloat remix1(vec3 resColor, vec4 canvasBaseColor, float opacity, vec2 brushUv) {\n\tconst int channel = 1;\n\tif (opacity < (1.0 / 256.0))\n\t\treturn resColor[channel];\n\tif ((resColor[channel] - canvasBaseColor[channel]) > (5.0 / 256.0))\n\t\treturn resColor[channel];\n\treturn u_color[channel];\n\tif (u_color[channel] > canvasBaseColor[channel])\n\t\treturn resColor[channel] + ((4.0 * (rand(brushUv) - 0.5)) / 256.0);\n\treturn resColor[channel] - ((4.0 * (rand(brushUv) - 0.5)) / 256.0);\n}\nfloat remix2(vec3 resColor, vec4 canvasBaseColor, float opacity, vec2 brushUv) {\n\tconst int channel = 2;\n\tif (opacity < (1.0 / 256.0))\n\t\treturn resColor[channel];\n\tif ((resColor[channel] - canvasBaseColor[channel]) > (5.0 / 256.0))\n\t\treturn resColor[channel];\n\treturn u_color[channel];\n\tif (u_color[channel] > canvasBaseColor[channel])\n\t\treturn resColor[channel] + ((4.0 * (rand(brushUv) - 0.5)) / 256.0);\n\treturn resColor[channel] - ((4.0 * (rand(brushUv) - 0.5)) / 256.0);\n}\nvoid main() {\n\tvec4 canvasBaseColor = texture2D(u_input, vUv);\n\tvec2 brushUv = calcBrushUv(u_x, u_y);\n\tvec4 brushColor = texture2D(u_brush, brushUv);\n\tfloat opacity = brushColor[3];\n\topacity = opacity * u_opacity;\n\topacity = opacity < (1.0 / 255.0) ? -99.0 : opacity;\n\topacity += ((4.0 * (rand(brushUv) - 0.5)) / 255.0);\n\topacity = (brushUv.x > 1.0) || (brushUv.y > 1.0) ? 0.0 : opacity;\n\topacity = (brushUv.x < 0.0) || (brushUv.y < 0.0) ? 0.0 : opacity;\n\topacity = clamp(opacity, 0.0, 1.0);\n\tfloat resOpacity = clamp(opacity + (canvasBaseColor.a * (1.0 - opacity)), 0.0, 1.0);\n\tvec3 resColor = oklab_mix(canvasBaseColor.xyz, u_color, opacity);\n\tgl_FragColor = resOpacity < (20.0 / 255.0) ? canvasBaseColor : vec4(resColor, resOpacity);\n}\n"},function(t,e){t.exports="#version 100\nprecision mediump float;\nuniform sampler2D u_input;\nuniform float u_width;\nuniform float u_height;\nuniform sampler2D u_brush;\nuniform float u_brush_width;\nuniform float u_brush_height;\nuniform float u_brush_rotation;\nuniform float u_x;\nuniform float u_y;\nuniform float u_opacity;\nuniform vec3 u_color;\nuniform float u_t;\nvarying vec2 vUv;\nfloat rand(vec2 co) {\n\treturn fract(sin(dot(co.xy + u_t, vec2(12.9898, 78.233))) * 43758.5453);\n}\nvec2 calcBrushUv(float x, float y) {\n\tvec2 point = vec2(((vUv.x - ((x - (u_brush_width / 2.0)) / u_width)) * u_width) / u_brush_width, ((vUv.y - ((y - (u_brush_height / 2.0)) / u_height)) * u_height) / u_brush_height);\n\tvec2 offsetPoint = point - 0.5;\n\tfloat len = length(offsetPoint);\n\tfloat angle = atan(offsetPoint.y, offsetPoint.x);\n\tangle -= u_brush_rotation;\n\tpoint.x = (len * cos(angle)) + 0.5;\n\tpoint.y = (len * sin(angle)) + 0.5;\n\treturn point;\n}\nfloat min(float a, float b, float c) {\n\treturn min(min(a, b), c);\n}\nfloat max(float a, float b, float c) {\n\treturn max(max(a, b), c);\n}\nvec3 rgb2ryb(vec3 rgb) {\n\tfloat white = min(rgb.r, rgb.g, rgb.b);\n\tvec3 noWhite = vec3(rgb.r - white, rgb.g - white, rgb.b - white);\n\tif (max(noWhite.r, noWhite.g, noWhite.b) < 0.001) {\n\t\treturn vec3(1.0 - rgb.r, 1.0 - rgb.g, 1.0 - rgb.b);\n\t}\n\tvec3 ryb = vec3(noWhite.r - min(noWhite.r, noWhite.g), (noWhite.g + min(noWhite.r, noWhite.g)) / 2.0, ((noWhite.b + noWhite.g) - min(noWhite.r, noWhite.g)) / 2.0);\n\tfloat n = max(ryb.r, ryb.g, ryb.b) / max(noWhite.r, noWhite.g, noWhite.b);\n\tn = n < 0.0001 ? 1.0 : n;\n\tryb /= n;\n\tfloat black = min(1.0 - rgb.r, 1.0 - rgb.g, 1.0 - rgb.b);\n\treturn vec3(clamp(ryb.r + black, 0.0, 1.0), clamp(ryb.g + black, 0.0, 1.0), clamp(ryb.b + black, 0.0, 1.0));\n}\nvec3 ryb2rgb(vec3 ryb) {\n\tfloat white = min(ryb.r, ryb.g, ryb.b);\n\tvec3 noWhite = vec3(ryb.r - white, ryb.g - white, ryb.b - white);\n\tif (max(noWhite.r, noWhite.g, noWhite.b) < 0.01) {\n\t\treturn vec3(1.0 - ryb.r, 1.0 - ryb.g, 1.0 - ryb.b);\n\t}\n\tvec3 rgb = vec3((noWhite.r + noWhite.g) - min(noWhite.g, noWhite.b), noWhite.g + (2.0 * min(noWhite.g, noWhite.b)), 2.0 * (noWhite.b - min(noWhite.g, noWhite.b)));\n\tfloat n = max(rgb.r, rgb.g, rgb.b) / max(noWhite.r, noWhite.g, noWhite.b);\n\tn = n < 0.001 ? 1.0 : n;\n\trgb /= n;\n\tfloat black = min(1.0 - ryb.r, 1.0 - ryb.g, 1.0 - ryb.b);\n\treturn vec3(clamp(rgb.r + black, 0.0, 1.0), clamp(rgb.g + black, 0.0, 1.0), clamp(rgb.b + black, 0.0, 1.0));\n}\nvec3 mixRYB(vec3 base, vec3 paint, float opacity) {\n\tvec3 baseRYB = rgb2ryb(base);\n\tvec3 paintRYB = rgb2ryb(paint);\n\tvec3 mixed = mix(baseRYB, paintRYB, opacity);\n\treturn ryb2rgb(mixed);\n}\nfloat remix0(vec3 resColor, vec4 canvasBaseColor, float opacity, vec2 brushUv) {\n\tconst int channel = 0;\n\tif (opacity < (1.0 / 256.0))\n\t\treturn resColor[channel];\n\tif ((resColor[channel] - canvasBaseColor[channel]) > (5.0 / 256.0))\n\t\treturn resColor[channel];\n\treturn u_color[channel];\n\tif (u_color[channel] > canvasBaseColor[channel])\n\t\treturn resColor[channel] + ((4.0 * (rand(brushUv) - 0.5)) / 256.0);\n\treturn resColor[channel] - ((2.0 * (rand(brushUv) - 0.5)) / 256.0);\n}\nfloat remix1(vec3 resColor, vec4 canvasBaseColor, float opacity, vec2 brushUv) {\n\tconst int channel = 1;\n\tif (opacity < (1.0 / 256.0))\n\t\treturn resColor[channel];\n\tif ((resColor[channel] - canvasBaseColor[channel]) > (5.0 / 256.0))\n\t\treturn resColor[channel];\n\treturn u_color[channel];\n\tif (u_color[channel] > canvasBaseColor[channel])\n\t\treturn resColor[channel] + ((4.0 * (rand(brushUv) - 0.5)) / 256.0);\n\treturn resColor[channel] - ((4.0 * (rand(brushUv) - 0.5)) / 256.0);\n}\nfloat remix2(vec3 resColor, vec4 canvasBaseColor, float opacity, vec2 brushUv) {\n\tconst int channel = 2;\n\tif (opacity < (1.0 / 256.0))\n\t\treturn resColor[channel];\n\tif ((resColor[channel] - canvasBaseColor[channel]) > (5.0 / 256.0))\n\t\treturn resColor[channel];\n\treturn u_color[channel];\n\tif (u_color[channel] > canvasBaseColor[channel])\n\t\treturn resColor[channel] + ((4.0 * (rand(brushUv) - 0.5)) / 256.0);\n\treturn resColor[channel] - ((4.0 * (rand(brushUv) - 0.5)) / 256.0);\n}\nvoid main() {\n\tvec4 canvasBaseColor = texture2D(u_input, vUv);\n\tvec2 brushUv = calcBrushUv(u_x, u_y);\n\tvec4 brushColor = texture2D(u_brush, brushUv);\n\tvec4 brushUvLast = texture2D(u_brush, calcBrushUv(u_x - 1.0, u_y - 1.0));\n\tfloat opacity = brushColor[3];\n\topacity = opacity * u_opacity;\n\topacity = opacity < 0.000001 ? -99.0 : opacity;\n\topacity += ((4.0 * (rand(brushUv) - 0.5)) / 256.0);\n\topacity = (brushUv.x > 1.0) || (brushUv.y > 1.0) ? 0.0 : opacity;\n\topacity = (brushUv.x < 0.0) || (brushUv.y < 0.0) ? 0.0 : opacity;\n\topacity = clamp(opacity, 0.0, 1.0);\n\tfloat resOpacity = clamp(opacity + (canvasBaseColor.a * (1.0 - opacity)), 0.0, 1.0);\n\tvec3 resColor = mixRYB(canvasBaseColor.xyz, u_color, opacity);\n\tgl_FragColor = opacity < (1.0 / 256.0) ? canvasBaseColor : vec4(resColor, resOpacity);\n}\n"},function(t,e){t.exports="#version 100\nprecision mediump float;\nuniform sampler2D u_input;\nuniform float u_width;\nuniform float u_height;\nuniform sampler2D u_brush;\nuniform float u_brush_width;\nuniform float u_brush_height;\nuniform float u_brush_rotation;\nuniform float u_x;\nuniform float u_y;\nuniform float u_opacity;\nuniform vec3 u_color;\nuniform float u_t;\nvarying vec2 vUv;\nfloat rand(vec2 co) {\n\treturn fract(sin(dot(co.xy + u_t, vec2(12.9898, 78.233))) * 43758.5453);\n}\nvec2 calcBrushUv(float x, float y) {\n\tvec2 point = vec2(((vUv.x - ((x - (u_brush_width / 2.0)) / u_width)) * u_width) / u_brush_width, ((vUv.y - ((y - (u_brush_height / 2.0)) / u_height)) * u_height) / u_brush_height);\n\tvec2 offsetPoint = point - 0.5;\n\tfloat len = length(offsetPoint);\n\tfloat angle = atan(offsetPoint.y, offsetPoint.x);\n\tangle -= u_brush_rotation;\n\tpoint.x = (len * cos(angle)) + 0.5;\n\tpoint.y = (len * sin(angle)) + 0.5;\n\treturn point;\n}\nvec4 scatter() {\n\tvec2 uv = vec2(vUv.x + ((((rand(vUv) - 0.5) * u_brush_width) / u_width) * 0.5), vUv.y + ((((rand(vUv * 7.414556064744165) - 0.5) * u_brush_height) / u_height) * 0.5));\n\treturn texture2D(u_input, uv);\n}\nvoid main() {\n\tvec4 color = scatter();\n\tvec4 canvasBaseColor = texture2D(u_input, vUv);\n\tvec2 brushUv = calcBrushUv(u_x, u_y);\n\tvec4 brushColor = texture2D(u_brush, brushUv);\n\tfloat opacity = brushColor[3];\n\topacity = opacity * u_opacity;\n\topacity = opacity < 0.000001 ? -99.0 : opacity;\n\topacity += ((4.0 * (rand(brushUv) - 0.5)) / 256.0);\n\tif (rand(vUv * 2.1394786121788317696) > (brushColor[3] * u_opacity))\n\t\topacity = 0.0;\n\tif (opacity > 0.001) {\n\t\topacity = max(0.25, opacity);\n\t}\n\topacity = (brushUv.x > 1.0) || (brushUv.y > 1.0) ? 0.0 : opacity;\n\topacity = (brushUv.x < 0.0) || (brushUv.y < 0.0) ? 0.0 : opacity;\n\topacity = clamp(opacity, 0.0, 1.0);\n\tvec4 resColor = mix(canvasBaseColor, color, opacity);\n\tgl_FragColor = resColor;\n}\n"},function(t,e){t.exports="vec2 calcBrushUv(float x, float y) {\n\tvec2 point = vec2(((vUv.x - ((x - (u_brush_width / 2.0)) / u_width)) * u_width) / u_brush_width, ((vUv.y - ((y - (u_brush_height / 2.0)) / u_height)) * u_height) / u_brush_height);\n\tvec2 offsetPoint = point - 0.5;\n\tfloat len = length(offsetPoint);\n\tfloat angle = atan(offsetPoint.y, offsetPoint.x);\n\tangle -= u_brush_rotation;\n\tpoint.x = (len * cos(angle)) + 0.5;\n\tpoint.y = (len * sin(angle)) + 0.5;\n\treturn point;\n}\nvec2 calcBrushUvScale(float x, float y, float scale) {\n\tvec2 point = vec2(((vUv.x - ((x - ((u_brush_width * scale) / 2.0)) / u_width)) * u_width) / (u_brush_width * scale), ((vUv.y - ((y - ((u_brush_height * scale) / 2.0)) / u_height)) * u_height) / (u_brush_height * scale));\n\tvec2 offsetPoint = point - 0.5;\n\tfloat len = length(offsetPoint);\n\tfloat angle = atan(offsetPoint.y, offsetPoint.x);\n\tangle -= u_brush_rotation;\n\tpoint.x = (len * cos(angle)) + 0.5;\n\tpoint.y = (len * sin(angle)) + 0.5;\n\treturn point;\n}\nfloat rand(vec2 co) {\n\treturn fract(sin(dot(co.xy + u_t, vec2(12.9898, 78.233))) * 43758.5453);\n}\nvec3 hsv2rgb(vec3 c) {\n\tvec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n\tvec3 p = abs((fract(c.xxx + K.xyz) * 6.0) - K.www);\n\treturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\nvec4 mixByBrush(vec4 color) {\n\tvec4 canvasBaseColor = texture2D(u_input, vUv);\n\tvec2 brushUv = calcBrushUv(u_x, u_y);\n\tvec4 brushColor = texture2D(u_brush, brushUv);\n\tfloat opacity = brushColor[3];\n\topacity = opacity * u_opacity;\n\topacity = opacity < 0.000001 ? -99.0 : opacity;\n\topacity += ((4.0 * (rand(brushUv) - 0.5)) / 256.0);\n\topacity = (brushUv.x > 1.0) || (brushUv.y > 1.0) ? 0.0 : opacity;\n\topacity = (brushUv.x < 0.0) || (brushUv.y < 0.0) ? 0.0 : opacity;\n\topacity = clamp(opacity, 0.0, 1.0);\n\treturn mix(canvasBaseColor, color, opacity);\n}\n"},function(t,e,i){var n={"./color-wheel-oklab.glsl":345,"./color-wheel-rgb.glsl":346};function r(t){var e=a(t);return i(e)}function a(t){if(!i.o(n,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return n[t]}r.keys=function(){return Object.keys(n)},r.resolve=a,t.exports=r,r.id=344},function(t,e){t.exports="#define M_PI2 6.28318530718\n#define M_PI 3.1415926535897932384626433832795\nuniform float brightness;\nvarying vec2 vUv;\nvec3 oklab_mix(vec3 colA, vec3 colB, float h) {\n\tconst mat3 kCONEtoLMS = mat3(0.4121656120, 0.2118591070, 0.0883097947, 0.5362752080, 0.6807189584, 0.2818474174, 0.0514575653, 0.1074065790, 0.6302613616);\n\tconst mat3 kLMStoCONE = mat3(4.0767245293, -1.2681437731, -0.0041119885, -3.3072168827, 2.6093323231, -0.7034763098, 0.2307590544, -0.3411344290, 1.7068625689);\n\tvec3 lmsA = pow(kCONEtoLMS * colA, vec3(1.0 / 3.0));\n\tvec3 lmsB = pow(kCONEtoLMS * colB, vec3(1.0 / 3.0));\n\tvec3 lms = mix(lmsA, lmsB, h);\n\treturn kLMStoCONE * ((lms * lms) * lms);\n}\nfloat cbrt(float f) {\n\treturn pow(f, 1.0 / 3.0);\n}\nfloat srgb_transfer_function(float a) {\n\treturn .0031308 >= a ? 12.92 * a : (1.055 * pow(a, .4166666666666667)) - .055;\n}\nvec3 srgb_transfer_function(vec3 a) {\n\treturn vec3(srgb_transfer_function(a.r), srgb_transfer_function(a.g), srgb_transfer_function(a.b));\n}\nvec3 linear_srgb_to_oklab(vec3 c) {\n\tfloat l = ((0.4122214708f * c.r) + (0.5363325363f * c.g)) + (0.0514459929f * c.b);\n\tfloat m = ((0.2119034982f * c.r) + (0.6806995451f * c.g)) + (0.1073969566f * c.b);\n\tfloat s = ((0.0883024619f * c.r) + (0.2817188376f * c.g)) + (0.6299787005f * c.b);\n\tfloat l_ = cbrt(l);\n\tfloat m_ = cbrt(m);\n\tfloat s_ = cbrt(s);\n\treturn vec3(((0.2104542553f * l_) + (0.7936177850f * m_)) - (0.0040720468f * s_), ((1.9779984951f * l_) - (2.4285922050f * m_)) + (0.4505937099f * s_), ((0.0259040371f * l_) + (0.7827717662f * m_)) - (0.8086757660f * s_));\n}\nvec3 oklab_to_linear_srgb(vec3 c) {\n\tfloat l_ = (c.r + (0.3963377774f * c.g)) + (0.2158037573f * c.b);\n\tfloat m_ = (c.r - (0.1055613458f * c.g)) - (0.0638541728f * c.b);\n\tfloat s_ = (c.r - (0.0894841775f * c.g)) - (1.2914855480f * c.b);\n\tfloat l = (l_ * l_) * l_;\n\tfloat m = (m_ * m_) * m_;\n\tfloat s = (s_ * s_) * s_;\n\treturn vec3(((+4.0767416621f * l) - (3.3077115913f * m)) + (0.2309699292f * s), ((-1.2684380046f * l) + (2.6097574011f * m)) - (0.3413193965f * s), ((-0.0041960863f * l) - (0.7034186147f * m)) + (1.7076147010f * s));\n}\nfloat toe_inv(float x) {\n\tconst float k_1 = 0.206;\n\tconst float k_2 = 0.03;\n\tconst float k_3 = (1.0 + k_1) / (1.0 + k_2);\n\treturn ((x * x) + (k_1 * x)) / (k_3 * (x + k_2));\n}\nfloat compute_max_saturation(float a, float b) {\n\tfloat k0, k1, k2, k3, k4, wl, wm, ws;\n\tif (((-1.88170328 * a) - (0.80936493 * b)) > 1.0) {\n\t\tk0 = +1.19086277;\n\t\tk1 = +1.76576728;\n\t\tk2 = +0.59662641;\n\t\tk3 = +0.75515197;\n\t\tk4 = +0.56771245;\n\t\twl = +4.0767416621;\n\t\twm = -3.3077115913;\n\t\tws = +0.2309699292;\n\t}\n\telse if (((1.81444104 * a) - (1.19445276 * b)) > 1.0) {\n\t\tk0 = +0.73956515;\n\t\tk1 = -0.45954404;\n\t\tk2 = +0.08285427;\n\t\tk3 = +0.12541070;\n\t\tk4 = +0.14503204;\n\t\twl = -1.2684380046;\n\t\twm = +2.6097574011;\n\t\tws = -0.3413193965;\n\t}\n\telse {\n\t\tk0 = +1.35733652;\n\t\tk1 = -0.00915799;\n\t\tk2 = -1.15130210;\n\t\tk3 = -0.50559606;\n\t\tk4 = +0.00692167;\n\t\twl = -0.0041960863;\n\t\twm = -0.7034186147;\n\t\tws = +1.7076147010;\n\t}\n\tfloat S = (((k0 + (k1 * a)) + (k2 * b)) + ((k3 * a) * a)) + ((k4 * a) * b);\n\tfloat k_l = (+0.3963377774 * a) + (0.2158037573 * b);\n\tfloat k_m = (-0.1055613458 * a) - (0.0638541728 * b);\n\tfloat k_s = (-0.0894841775 * a) - (1.2914855480 * b);\n\t{\n\t\tfloat l_ = 1.0 + (S * k_l);\n\t\tfloat m_ = 1.0 + (S * k_m);\n\t\tfloat s_ = 1.0 + (S * k_s);\n\t\tfloat l = (l_ * l_) * l_;\n\t\tfloat m = (m_ * m_) * m_;\n\t\tfloat s = (s_ * s_) * s_;\n\t\tfloat l_dS = ((3.0 * k_l) * l_) * l_;\n\t\tfloat m_dS = ((3.0 * k_m) * m_) * m_;\n\t\tfloat s_dS = ((3.0 * k_s) * s_) * s_;\n\t\tfloat l_dS2 = ((6.0 * k_l) * k_l) * l_;\n\t\tfloat m_dS2 = ((6.0 * k_m) * k_m) * m_;\n\t\tfloat s_dS2 = ((6.0 * k_s) * k_s) * s_;\n\t\tfloat f = ((wl * l) + (wm * m)) + (ws * s);\n\t\tfloat f1 = ((wl * l_dS) + (wm * m_dS)) + (ws * s_dS);\n\t\tfloat f2 = ((wl * l_dS2) + (wm * m_dS2)) + (ws * s_dS2);\n\t\tS = S - ((f * f1) / ((f1 * f1) - ((0.5 * f) * f2)));\n\t}\n\treturn S;\n}\nvec2 find_cusp(float a, float b) {\n\tfloat S_cusp = compute_max_saturation(a, b);\n\tvec3 rgb_at_max = oklab_to_linear_srgb(vec3(1.0, S_cusp * a, S_cusp * b));\n\tfloat L_cusp = cbrt(1.0 / max(max(rgb_at_max[0], rgb_at_max[1]), rgb_at_max[2]));\n\tfloat C_cusp = L_cusp * S_cusp;\n\treturn vec2(L_cusp, C_cusp);\n}\nfloat find_gamut_intersection(float a, float b, float L1, float C1, float L0, vec2 cusp) {\n\tfloat t;\n\tif ((((L1 - L0) * cusp[1]) - ((cusp[0] - L0) * C1)) <= 0.0) {\n\t\tt = (cusp[1] * L0) / ((C1 * cusp[0]) + (cusp[1] * (L0 - L1)));\n\t}\n\telse {\n\t\tt = (cusp[1] * (L0 - 1.0)) / ((C1 * (cusp[0] - 1.0)) + (cusp[1] * (L0 - L1)));\n\t\t{\n\t\t\tfloat dL = L1 - L0;\n\t\t\tfloat dC = C1;\n\t\t\tfloat k_l = (+0.3963377774 * a) + (0.2158037573 * b);\n\t\t\tfloat k_m = (-0.1055613458 * a) - (0.0638541728 * b);\n\t\t\tfloat k_s = (-0.0894841775 * a) - (1.2914855480 * b);\n\t\t\tfloat l_dt = dL + (dC * k_l);\n\t\t\tfloat m_dt = dL + (dC * k_m);\n\t\t\tfloat s_dt = dL + (dC * k_s);\n\t\t\t{\n\t\t\t\tfloat L = (L0 * (1.0 - t)) + (t * L1);\n\t\t\t\tfloat C = t * C1;\n\t\t\t\tfloat l_ = L + (C * k_l);\n\t\t\t\tfloat m_ = L + (C * k_m);\n\t\t\t\tfloat s_ = L + (C * k_s);\n\t\t\t\tfloat l = (l_ * l_) * l_;\n\t\t\t\tfloat m = (m_ * m_) * m_;\n\t\t\t\tfloat s = (s_ * s_) * s_;\n\t\t\t\tfloat ldt = ((3.0 * l_dt) * l_) * l_;\n\t\t\t\tfloat mdt = ((3.0 * m_dt) * m_) * m_;\n\t\t\t\tfloat sdt = ((3.0 * s_dt) * s_) * s_;\n\t\t\t\tfloat ldt2 = ((6.0 * l_dt) * l_dt) * l_;\n\t\t\t\tfloat mdt2 = ((6.0 * m_dt) * m_dt) * m_;\n\t\t\t\tfloat sdt2 = ((6.0 * s_dt) * s_dt) * s_;\n\t\t\t\tfloat r = (((4.0767416621 * l) - (3.3077115913 * m)) + (0.2309699292 * s)) - 1.0;\n\t\t\t\tfloat r1 = ((4.0767416621 * ldt) - (3.3077115913 * mdt)) + (0.2309699292 * sdt);\n\t\t\t\tfloat r2 = ((4.0767416621 * ldt2) - (3.3077115913 * mdt2)) + (0.2309699292 * sdt2);\n\t\t\t\tfloat u_r = r1 / ((r1 * r1) - ((0.5 * r) * r2));\n\t\t\t\tfloat t_r = -r * u_r;\n\t\t\t\tfloat g = (((-1.2684380046 * l) + (2.6097574011 * m)) - (0.3413193965 * s)) - 1.0;\n\t\t\t\tfloat g1 = ((-1.2684380046 * ldt) + (2.6097574011 * mdt)) - (0.3413193965 * sdt);\n\t\t\t\tfloat g2 = ((-1.2684380046 * ldt2) + (2.6097574011 * mdt2)) - (0.3413193965 * sdt2);\n\t\t\t\tfloat u_g = g1 / ((g1 * g1) - ((0.5 * g) * g2));\n\t\t\t\tfloat t_g = -g * u_g;\n\t\t\t\tfloat b = (((-0.0041960863 * l) - (0.7034186147 * m)) + (1.7076147010 * s)) - 1.0;\n\t\t\t\tfloat b1 = ((-0.0041960863 * ldt) - (0.7034186147 * mdt)) + (1.7076147010 * sdt);\n\t\t\t\tfloat b2 = ((-0.0041960863 * ldt2) - (0.7034186147 * mdt2)) + (1.7076147010 * sdt2);\n\t\t\t\tfloat u_b = b1 / ((b1 * b1) - ((0.5 * b) * b2));\n\t\t\t\tfloat t_b = -b * u_b;\n\t\t\t\tt_r = u_r >= 0.0 ? t_r : 10.0e5;\n\t\t\t\tt_g = u_g >= 0.0 ? t_g : 10.0e5;\n\t\t\t\tt_b = u_b >= 0.0 ? t_b : 10.0e5;\n\t\t\t\tt += min(t_r, min(t_g, t_b));\n\t\t\t}\n\t\t}\n\t}\n\treturn t;\n}\nfloat find_gamut_intersection(float a, float b, float L1, float C1, float L0) {\n\tvec2 cusp = find_cusp(a, b);\n\treturn find_gamut_intersection(a, b, L1, C1, L0, cusp);\n}\nvec2 get_ST_max(float a_, float b_, vec2 cusp) {\n\tfloat L = cusp[0];\n\tfloat C = cusp[1];\n\treturn vec2(C / L, C / (1.0 - L));\n}\nvec3 get_Cs(float L, float a_, float b_) {\n\tvec2 cusp = find_cusp(a_, b_);\n\tfloat C_max = find_gamut_intersection(a_, b_, L, 1.0, L, cusp);\n\tvec2 ST_max = get_ST_max(a_, b_, cusp);\n\tfloat S_mid = 0.11516993 + (1.0 / ((+7.44778970 + (4.15901240 * b_)) + (a_ * ((-2.19557347 + (1.75198401 * b_)) + (a_ * ((-2.13704948 - (10.02301043 * b_)) + (a_ * ((-4.24894561 + (5.38770819 * b_)) + (4.69891013 * a_)))))))));\n\tfloat T_mid = 0.11239642 + (1.0 / ((+1.61320320 - (0.68124379 * b_)) + (a_ * ((+0.40370612 + (0.90148123 * b_)) + (a_ * ((-0.27087943 + (0.61223990 * b_)) + (a_ * ((+0.00299215 - (0.45399568 * b_)) - (0.14661872 * a_)))))))));\n\tfloat k = C_max / min(L * ST_max[0], (1.0 - L) * ST_max[1]);\n\tfloat C_mid;\n\t{\n\t\tfloat C_a = L * S_mid;\n\t\tfloat C_b = (1.0 - L) * T_mid;\n\t\tC_mid = (0.9 * k) * sqrt(sqrt(1.0 / ((1.0 / (((C_a * C_a) * C_a) * C_a)) + (1.0 / (((C_b * C_b) * C_b) * C_b)))));\n\t}\n\tfloat C_0;\n\t{\n\t\tfloat C_a = L * 0.4;\n\t\tfloat C_b = (1.0 - L) * 0.8;\n\t\tC_0 = sqrt(1.0 / ((1.0 / (C_a * C_a)) + (1.0 / (C_b * C_b))));\n\t}\n\treturn vec3(C_0, C_mid, C_max);\n}\nvec3 okhsl_to_srgb(vec3 hsl) {\n\tfloat h = hsl.r;\n\tfloat s = hsl.g;\n\tfloat l = hsl.b;\n\tif (l == 1.0) {\n\t\treturn vec3(1.0, 1.0, 1.0);\n\t}\n\telse if (l == 0.0) {\n\t\treturn vec3(0.0, 0.0, 0.0);\n\t}\n\tfloat a_ = cos((2.0 * M_PI) * h);\n\tfloat b_ = sin((2.0 * M_PI) * h);\n\tfloat L = toe_inv(l);\n\tvec3 Cs = get_Cs(L, a_, b_);\n\tfloat C_0 = Cs[0];\n\tfloat C_mid = Cs[1];\n\tfloat C_max = Cs[2];\n\tfloat C, t, k_0, k_1, k_2;\n\tif (s < 0.8) {\n\t\tt = 1.25 * s;\n\t\tk_0 = 0.0;\n\t\tk_1 = 0.8 * C_0;\n\t\tk_2 = 1.0 - (k_1 / C_mid);\n\t}\n\telse {\n\t\tt = 5.0 * (s - 0.8);\n\t\tk_0 = C_mid;\n\t\tk_1 = ((((0.2 * C_mid) * C_mid) * 1.25) * 1.25) / C_0;\n\t\tk_2 = 1.0 - (k_1 / (C_max - C_mid));\n\t}\n\tC = k_0 + ((t * k_1) / (1.0 - (k_2 * t)));\n\tvec3 rgb = oklab_to_linear_srgb(vec3(L, C * a_, C * b_));\n\treturn srgb_transfer_function(rgb);\n}\nvoid main() {\n\tvec2 toCenter = vec2(0.5) - vUv;\n\tfloat angle = atan(toCenter.y, toCenter.x);\n\tfloat radius = length(toCenter) * 2.0;\n\tvec3 color = okhsl_to_srgb(vec3((angle / M_PI2) + 0.5, radius, brightness));\n\tgl_FragColor = vec4(color, 1.0);\n}\n"},function(t,e){t.exports="#define M_PI2 6.28318530718\nuniform float brightness;\nvarying vec2 vUv;\nvec3 hsb2rgb(in vec3 c) {\n\tvec3 rgb = clamp(abs(mod((c.x * 6.0) + vec3(0.0, 4.0, 2.0), 6.0) - 3.0) - 1.0, 0.0, 1.0);\n\trgb = (rgb * rgb) * (3.0 - (2.0 * rgb));\n\treturn c.z * mix(vec3(1.0), rgb, c.y);\n}\nvoid main() {\n\tvec2 toCenter = vec2(0.5) - vUv;\n\tfloat angle = atan(toCenter.y, toCenter.x);\n\tfloat radius = length(toCenter) * 2.0;\n\tvec3 color = hsb2rgb(vec3((angle / M_PI2) + 0.5, radius, brightness));\n\tgl_FragColor = vec4(color, 1.0);\n}\n"},function(t,e){t.exports="varying vec2 vUv;\nuniform vec3 u_color;\n#define M_PI2 6.28318530718\n#define M_PI 3.1415926535897932384626433832795\nfloat cbrt(float f) {\n\treturn pow(f, 1.0 / 3.0);\n}\nfloat srgb_transfer_function(float a) {\n\treturn .0031308 >= a ? 12.92 * a : (1.055 * pow(a, .4166666666666667)) - .055;\n}\nvec3 srgb_transfer_function(vec3 a) {\n\treturn vec3(srgb_transfer_function(a.r), srgb_transfer_function(a.g), srgb_transfer_function(a.b));\n}\nfloat srgb_transfer_function_inv(float a) {\n\treturn .04045 < a ? pow((a + .055) / 1.055, 2.4) : a / 12.92;\n}\nvec3 srgb_transfer_function_inv(vec3 a) {\n\treturn vec3(srgb_transfer_function_inv(a[0]), srgb_transfer_function_inv(a[1]), srgb_transfer_function_inv(a[2]));\n}\nvec3 linear_srgb_to_oklab(vec3 c) {\n\tfloat l = ((0.4122214708f * c.r) + (0.5363325363f * c.g)) + (0.0514459929f * c.b);\n\tfloat m = ((0.2119034982f * c.r) + (0.6806995451f * c.g)) + (0.1073969566f * c.b);\n\tfloat s = ((0.0883024619f * c.r) + (0.2817188376f * c.g)) + (0.6299787005f * c.b);\n\tfloat l_ = cbrt(l);\n\tfloat m_ = cbrt(m);\n\tfloat s_ = cbrt(s);\n\treturn vec3(((0.2104542553f * l_) + (0.7936177850f * m_)) - (0.0040720468f * s_), ((1.9779984951f * l_) - (2.4285922050f * m_)) + (0.4505937099f * s_), ((0.0259040371f * l_) + (0.7827717662f * m_)) - (0.8086757660f * s_));\n}\nvec3 oklab_to_linear_srgb(vec3 c) {\n\tfloat l_ = (c.r + (0.3963377774f * c.g)) + (0.2158037573f * c.b);\n\tfloat m_ = (c.r - (0.1055613458f * c.g)) - (0.0638541728f * c.b);\n\tfloat s_ = (c.r - (0.0894841775f * c.g)) - (1.2914855480f * c.b);\n\tfloat l = (l_ * l_) * l_;\n\tfloat m = (m_ * m_) * m_;\n\tfloat s = (s_ * s_) * s_;\n\treturn vec3(((+4.0767416621f * l) - (3.3077115913f * m)) + (0.2309699292f * s), ((-1.2684380046f * l) + (2.6097574011f * m)) - (0.3413193965f * s), ((-0.0041960863f * l) - (0.7034186147f * m)) + (1.7076147010f * s));\n}\nfloat toe_inv(float x) {\n\tconst float k_1 = 0.206;\n\tconst float k_2 = 0.03;\n\tconst float k_3 = (1.0 + k_1) / (1.0 + k_2);\n\treturn ((x * x) + (k_1 * x)) / (k_3 * (x + k_2));\n}\nfloat toe(float x) {\n\tconst float k_1 = 0.206;\n\tconst float k_2 = 0.03;\n\tconst float k_3 = (1.0 + k_1) / (1.0 + k_2);\n\treturn 0.5 * (((k_3 * x) - k_1) + sqrt((((k_3 * x) - k_1) * ((k_3 * x) - k_1)) + (((4.0 * k_2) * k_3) * x)));\n}\nfloat compute_max_saturation(float a, float b) {\n\tfloat k0, k1, k2, k3, k4, wl, wm, ws;\n\tif (((-1.88170328 * a) - (0.80936493 * b)) > 1.0) {\n\t\tk0 = +1.19086277;\n\t\tk1 = +1.76576728;\n\t\tk2 = +0.59662641;\n\t\tk3 = +0.75515197;\n\t\tk4 = +0.56771245;\n\t\twl = +4.0767416621;\n\t\twm = -3.3077115913;\n\t\tws = +0.2309699292;\n\t}\n\telse if (((1.81444104 * a) - (1.19445276 * b)) > 1.0) {\n\t\tk0 = +0.73956515;\n\t\tk1 = -0.45954404;\n\t\tk2 = +0.08285427;\n\t\tk3 = +0.12541070;\n\t\tk4 = +0.14503204;\n\t\twl = -1.2684380046;\n\t\twm = +2.6097574011;\n\t\tws = -0.3413193965;\n\t}\n\telse {\n\t\tk0 = +1.35733652;\n\t\tk1 = -0.00915799;\n\t\tk2 = -1.15130210;\n\t\tk3 = -0.50559606;\n\t\tk4 = +0.00692167;\n\t\twl = -0.0041960863;\n\t\twm = -0.7034186147;\n\t\tws = +1.7076147010;\n\t}\n\tfloat S = (((k0 + (k1 * a)) + (k2 * b)) + ((k3 * a) * a)) + ((k4 * a) * b);\n\tfloat k_l = (+0.3963377774 * a) + (0.2158037573 * b);\n\tfloat k_m = (-0.1055613458 * a) - (0.0638541728 * b);\n\tfloat k_s = (-0.0894841775 * a) - (1.2914855480 * b);\n\t{\n\t\tfloat l_ = 1.0 + (S * k_l);\n\t\tfloat m_ = 1.0 + (S * k_m);\n\t\tfloat s_ = 1.0 + (S * k_s);\n\t\tfloat l = (l_ * l_) * l_;\n\t\tfloat m = (m_ * m_) * m_;\n\t\tfloat s = (s_ * s_) * s_;\n\t\tfloat l_dS = ((3.0 * k_l) * l_) * l_;\n\t\tfloat m_dS = ((3.0 * k_m) * m_) * m_;\n\t\tfloat s_dS = ((3.0 * k_s) * s_) * s_;\n\t\tfloat l_dS2 = ((6.0 * k_l) * k_l) * l_;\n\t\tfloat m_dS2 = ((6.0 * k_m) * k_m) * m_;\n\t\tfloat s_dS2 = ((6.0 * k_s) * k_s) * s_;\n\t\tfloat f = ((wl * l) + (wm * m)) + (ws * s);\n\t\tfloat f1 = ((wl * l_dS) + (wm * m_dS)) + (ws * s_dS);\n\t\tfloat f2 = ((wl * l_dS2) + (wm * m_dS2)) + (ws * s_dS2);\n\t\tS = S - ((f * f1) / ((f1 * f1) - ((0.5 * f) * f2)));\n\t}\n\treturn S;\n}\nvec2 find_cusp(float a, float b) {\n\tfloat S_cusp = compute_max_saturation(a, b);\n\tvec3 rgb_at_max = oklab_to_linear_srgb(vec3(1.0, S_cusp * a, S_cusp * b));\n\tfloat L_cusp = cbrt(1.0 / max(max(rgb_at_max[0], rgb_at_max[1]), rgb_at_max[2]));\n\tfloat C_cusp = L_cusp * S_cusp;\n\treturn vec2(L_cusp, C_cusp);\n}\nfloat find_gamut_intersection(float a, float b, float L1, float C1, float L0, vec2 cusp) {\n\tfloat t;\n\tif ((((L1 - L0) * cusp[1]) - ((cusp[0] - L0) * C1)) <= 0.0) {\n\t\tt = (cusp[1] * L0) / ((C1 * cusp[0]) + (cusp[1] * (L0 - L1)));\n\t}\n\telse {\n\t\tt = (cusp[1] * (L0 - 1.0)) / ((C1 * (cusp[0] - 1.0)) + (cusp[1] * (L0 - L1)));\n\t\t{\n\t\t\tfloat dL = L1 - L0;\n\t\t\tfloat dC = C1;\n\t\t\tfloat k_l = (+0.3963377774 * a) + (0.2158037573 * b);\n\t\t\tfloat k_m = (-0.1055613458 * a) - (0.0638541728 * b);\n\t\t\tfloat k_s = (-0.0894841775 * a) - (1.2914855480 * b);\n\t\t\tfloat l_dt = dL + (dC * k_l);\n\t\t\tfloat m_dt = dL + (dC * k_m);\n\t\t\tfloat s_dt = dL + (dC * k_s);\n\t\t\t{\n\t\t\t\tfloat L = (L0 * (1.0 - t)) + (t * L1);\n\t\t\t\tfloat C = t * C1;\n\t\t\t\tfloat l_ = L + (C * k_l);\n\t\t\t\tfloat m_ = L + (C * k_m);\n\t\t\t\tfloat s_ = L + (C * k_s);\n\t\t\t\tfloat l = (l_ * l_) * l_;\n\t\t\t\tfloat m = (m_ * m_) * m_;\n\t\t\t\tfloat s = (s_ * s_) * s_;\n\t\t\t\tfloat ldt = ((3.0 * l_dt) * l_) * l_;\n\t\t\t\tfloat mdt = ((3.0 * m_dt) * m_) * m_;\n\t\t\t\tfloat sdt = ((3.0 * s_dt) * s_) * s_;\n\t\t\t\tfloat ldt2 = ((6.0 * l_dt) * l_dt) * l_;\n\t\t\t\tfloat mdt2 = ((6.0 * m_dt) * m_dt) * m_;\n\t\t\t\tfloat sdt2 = ((6.0 * s_dt) * s_dt) * s_;\n\t\t\t\tfloat r = (((4.0767416621 * l) - (3.3077115913 * m)) + (0.2309699292 * s)) - 1.0;\n\t\t\t\tfloat r1 = ((4.0767416621 * ldt) - (3.3077115913 * mdt)) + (0.2309699292 * sdt);\n\t\t\t\tfloat r2 = ((4.0767416621 * ldt2) - (3.3077115913 * mdt2)) + (0.2309699292 * sdt2);\n\t\t\t\tfloat u_r = r1 / ((r1 * r1) - ((0.5 * r) * r2));\n\t\t\t\tfloat t_r = -r * u_r;\n\t\t\t\tfloat g = (((-1.2684380046 * l) + (2.6097574011 * m)) - (0.3413193965 * s)) - 1.0;\n\t\t\t\tfloat g1 = ((-1.2684380046 * ldt) + (2.6097574011 * mdt)) - (0.3413193965 * sdt);\n\t\t\t\tfloat g2 = ((-1.2684380046 * ldt2) + (2.6097574011 * mdt2)) - (0.3413193965 * sdt2);\n\t\t\t\tfloat u_g = g1 / ((g1 * g1) - ((0.5 * g) * g2));\n\t\t\t\tfloat t_g = -g * u_g;\n\t\t\t\tfloat b = (((-0.0041960863 * l) - (0.7034186147 * m)) + (1.7076147010 * s)) - 1.0;\n\t\t\t\tfloat b1 = ((-0.0041960863 * ldt) - (0.7034186147 * mdt)) + (1.7076147010 * sdt);\n\t\t\t\tfloat b2 = ((-0.0041960863 * ldt2) - (0.7034186147 * mdt2)) + (1.7076147010 * sdt2);\n\t\t\t\tfloat u_b = b1 / ((b1 * b1) - ((0.5 * b) * b2));\n\t\t\t\tfloat t_b = -b * u_b;\n\t\t\t\tt_r = u_r >= 0.0 ? t_r : 10.0e5;\n\t\t\t\tt_g = u_g >= 0.0 ? t_g : 10.0e5;\n\t\t\t\tt_b = u_b >= 0.0 ? t_b : 10.0e5;\n\t\t\t\tt += min(t_r, min(t_g, t_b));\n\t\t\t}\n\t\t}\n\t}\n\treturn t;\n}\nfloat find_gamut_intersection(float a, float b, float L1, float C1, float L0) {\n\tvec2 cusp = find_cusp(a, b);\n\treturn find_gamut_intersection(a, b, L1, C1, L0, cusp);\n}\nvec2 get_ST_max(float a_, float b_, vec2 cusp) {\n\tfloat L = cusp[0];\n\tfloat C = cusp[1];\n\treturn vec2(C / L, C / (1.0 - L));\n}\nvec3 get_Cs(float L, float a_, float b_) {\n\tvec2 cusp = find_cusp(a_, b_);\n\tfloat C_max = find_gamut_intersection(a_, b_, L, 1.0, L, cusp);\n\tvec2 ST_max = get_ST_max(a_, b_, cusp);\n\tfloat S_mid = 0.11516993 + (1.0 / ((+7.44778970 + (4.15901240 * b_)) + (a_ * ((-2.19557347 + (1.75198401 * b_)) + (a_ * ((-2.13704948 - (10.02301043 * b_)) + (a_ * ((-4.24894561 + (5.38770819 * b_)) + (4.69891013 * a_)))))))));\n\tfloat T_mid = 0.11239642 + (1.0 / ((+1.61320320 - (0.68124379 * b_)) + (a_ * ((+0.40370612 + (0.90148123 * b_)) + (a_ * ((-0.27087943 + (0.61223990 * b_)) + (a_ * ((+0.00299215 - (0.45399568 * b_)) - (0.14661872 * a_)))))))));\n\tfloat k = C_max / min(L * ST_max[0], (1.0 - L) * ST_max[1]);\n\tfloat C_mid;\n\t{\n\t\tfloat C_a = L * S_mid;\n\t\tfloat C_b = (1.0 - L) * T_mid;\n\t\tC_mid = (0.9 * k) * sqrt(sqrt(1.0 / ((1.0 / (((C_a * C_a) * C_a) * C_a)) + (1.0 / (((C_b * C_b) * C_b) * C_b)))));\n\t}\n\tfloat C_0;\n\t{\n\t\tfloat C_a = L * 0.4;\n\t\tfloat C_b = (1.0 - L) * 0.8;\n\t\tC_0 = sqrt(1.0 / ((1.0 / (C_a * C_a)) + (1.0 / (C_b * C_b))));\n\t}\n\treturn vec3(C_0, C_mid, C_max);\n}\nvec3 okhsl_to_srgb(vec3 hsl) {\n\tfloat h = hsl.r;\n\tfloat s = hsl.g;\n\tfloat l = hsl.b;\n\tif (l == 1.0) {\n\t\treturn vec3(1.0, 1.0, 1.0);\n\t}\n\telse if (l == 0.0) {\n\t\treturn vec3(0.0, 0.0, 0.0);\n\t}\n\tfloat a_ = cos((2.0 * M_PI) * h);\n\tfloat b_ = sin((2.0 * M_PI) * h);\n\tfloat L = toe_inv(l);\n\tvec3 Cs = get_Cs(L, a_, b_);\n\tfloat C_0 = Cs[0];\n\tfloat C_mid = Cs[1];\n\tfloat C_max = Cs[2];\n\tfloat C, t, k_0, k_1, k_2;\n\tif (s < 0.8) {\n\t\tt = 1.25 * s;\n\t\tk_0 = 0.0;\n\t\tk_1 = 0.8 * C_0;\n\t\tk_2 = 1.0 - (k_1 / C_mid);\n\t}\n\telse {\n\t\tt = 5.0 * (s - 0.8);\n\t\tk_0 = C_mid;\n\t\tk_1 = ((((0.2 * C_mid) * C_mid) * 1.25) * 1.25) / C_0;\n\t\tk_2 = 1.0 - (k_1 / (C_max - C_mid));\n\t}\n\tC = k_0 + ((t * k_1) / (1.0 - (k_2 * t)));\n\tvec3 rgb = oklab_to_linear_srgb(vec3(L, C * a_, C * b_));\n\treturn srgb_transfer_function(rgb);\n}\nvec3 srgb_to_okhsl(vec3 color) {\n\tfloat r = color.r;\n\tfloat g = color.g;\n\tfloat b = color.b;\n\tvec3 lab = linear_srgb_to_oklab(vec3(srgb_transfer_function_inv(r), srgb_transfer_function_inv(g), srgb_transfer_function_inv(b)));\n\tfloat C = sqrt((lab[1] * lab[1]) + (lab[2] * lab[2]));\n\tfloat a_ = lab[1] / C;\n\tfloat b_ = lab[2] / C;\n\tfloat L = lab[0];\n\tfloat h = 0.5 + ((0.5 * atan(-lab[2], -lab[1])) / M_PI);\n\tvec3 Cs = get_Cs(L, a_, b_);\n\tfloat C_0 = Cs[0];\n\tfloat C_mid = Cs[1];\n\tfloat C_max = Cs[2];\n\tfloat s;\n\tif (C < C_mid) {\n\t\tfloat k_0 = 0.0;\n\t\tfloat k_1 = 0.8 * C_0;\n\t\tfloat k_2 = 1.0 - (k_1 / C_mid);\n\t\tfloat t = (C - k_0) / (k_1 + (k_2 * (C - k_0)));\n\t\ts = t * 0.8;\n\t}\n\telse {\n\t\tfloat k_0 = C_mid;\n\t\tfloat k_1 = ((((0.2 * C_mid) * C_mid) * 1.25) * 1.25) / C_0;\n\t\tfloat k_2 = 1.0 - (k_1 / (C_max - C_mid));\n\t\tfloat t = (C - k_0) / (k_1 + (k_2 * (C - k_0)));\n\t\ts = 0.8 + (0.2 * t);\n\t}\n\ts = clamp(s, 0.0, 1.0);\n\tfloat l = toe(L);\n\treturn vec3(h, s, l);\n}\nvoid main() {\n\tvec3 ok = srgb_to_okhsl(u_color);\n\tvec3 color = okhsl_to_srgb(vec3(ok[0], ok[1], vUv.y));\n\tgl_FragColor = vec4(color, 1.0);\n}\n"},function(t,e){t.exports="varying vec2 vUv;\nvoid main() {\n\tvec3 fgColor = vec3(1.0, 1.0, 1.0);\n\tgl_FragColor = vec4(fgColor, vUv.x);\n}\n"},function(t,e,i){(function(e){var n=i(41),r=i(28),a=i(16),o=i(29),s=i(168),l=i(350),c=i(20).EventEmitter,u=i(42).gestureListener,h=i(167),d=i(12),p=t.exports=function(t){var r=void 0!==e&&e.versions&&e.versions.node,a=this;t=d.defaults(t||{},{inNode:r}),this.inNode=t.inNode,t=d.defaults(t||{},{frameEventName:this.useAnimationLoop()?"animationFrame":"deviceFrame",suppressAnimationLoop:!this.useAnimationLoop(),loopWhileDisconnected:!0,useAllPlugins:!1,checkVersion:!0}),this.animationFrameRequested=!1,this.onAnimationFrame=function(t){a.lastConnectionFrame.valid&&a.emit("animationFrame",a.lastConnectionFrame),a.emit("frameEnd",t),a.loopWhileDisconnected&&(!1!==a.connection.focusedState||a.connection.opts.background)?window.requestAnimationFrame(a.onAnimationFrame):a.animationFrameRequested=!1},this.suppressAnimationLoop=t.suppressAnimationLoop,this.loopWhileDisconnected=t.loopWhileDisconnected,this.frameEventName=t.frameEventName,this.useAllPlugins=t.useAllPlugins,this.history=new s(200),this.lastFrame=n.Invalid,this.lastValidFrame=n.Invalid,this.lastConnectionFrame=n.Invalid,this.accumulatedGestures=[],this.checkVersion=t.checkVersion,void 0===t.connectionType?this.connectionType=this.inBrowser()?i(351):i(352):this.connectionType=t.connectionType,this.connection=new this.connectionType(t),this.streamingCount=0,this.devices={},this.plugins={},this._pluginPipelineSteps={},this._pluginExtendedMethods={},t.useAllPlugins&&this.useRegisteredPlugins(),this.setupFrameEvents(t),this.setupConnectionEvents(),this.startAnimationLoop()};p.prototype.gesture=function(t,e){var i=u(this,t);return void 0!==e&&i.stop(e),i},p.prototype.setBackground=function(t){return this.connection.setBackground(t),this},p.prototype.setOptimizeHMD=function(t){return this.connection.setOptimizeHMD(t),this},p.prototype.inBrowser=function(){return!this.inNode},p.prototype.useAnimationLoop=function(){return this.inBrowser()&&!this.inBackgroundPage()},p.prototype.inBackgroundPage=function(){return"undefined"!=typeof chrome&&chrome.extension&&chrome.extension.getBackgroundPage&&chrome.extension.getBackgroundPage()===window},p.prototype.connect=function(){return this.connection.connect(),this},p.prototype.streaming=function(){return this.streamingCount>0},p.prototype.connected=function(){return!!this.connection.connected},p.prototype.startAnimationLoop=function(){this.suppressAnimationLoop||this.animationFrameRequested||(this.animationFrameRequested=!0,window.requestAnimationFrame(this.onAnimationFrame))},p.prototype.disconnect=function(){return this.connection.disconnect(),this},p.prototype.frame=function(t){return this.history.get(t)||n.Invalid},p.prototype.loop=function(t){return t&&("function"==typeof t?this.on(this.frameEventName,t):this.setupFrameEvents(t)),this.connect()},p.prototype.addStep=function(t){this.pipeline||(this.pipeline=new l(this)),this.pipeline.addStep(t)},p.prototype.processFrame=function(t){t.gestures&&(this.accumulatedGestures=this.accumulatedGestures.concat(t.gestures)),this.lastConnectionFrame=t,this.startAnimationLoop(),this.emit("deviceFrame",t)},p.prototype.processFinishedFrame=function(t){if(this.lastFrame=t,t.valid&&(this.lastValidFrame=t),t.controller=this,t.historyIdx=this.history.push(t),t.gestures){t.gestures=this.accumulatedGestures,this.accumulatedGestures=[];for(var e=0;e!=t.gestures.length;e++)this.emit("gesture",t.gestures[e],t)}this.pipeline&&((t=this.pipeline.run(t))||(t=n.Invalid)),this.emit("frame",t),this.emitHandEvents(t)},p.prototype.emitHandEvents=function(t){for(var e=0;e<t.hands.length;e++)this.emit("hand",t.hands[e])},p.prototype.setupFrameEvents=function(t){t.frame&&this.on("frame",t.frame),t.hand&&this.on("hand",t.hand)},p.prototype.setupConnectionEvents=function(){var t=this;this.connection.on("frame",(function(e){t.processFrame(e)})),this.on(this.frameEventName,(function(e){t.processFinishedFrame(e)}));var e=function(){if(t.connection.opts.requestProtocolVersion<5&&0==t.streamingCount){t.streamingCount=1;var i={attached:!0,streaming:!0,type:"unknown",id:"Lx00000000000"};t.devices[i.id]=i,t.emit("deviceAttached",i),t.emit("deviceStreaming",i),t.emit("streamingStarted",i),t.connection.removeListener("frame",e)}},i=function(){if(t.streamingCount>0){for(var e in t.devices)t.emit("deviceStopped",t.devices[e]),t.emit("deviceRemoved",t.devices[e]);for(var e in t.emit("streamingStopped",t.devices[e]),t.streamingCount=0,t.devices)delete t.devices[e]}};this.connection.on("focus",(function(){t.loopWhileDisconnected&&t.startAnimationLoop(),t.emit("focus")})),this.connection.on("blur",(function(){t.emit("blur")})),this.connection.on("protocol",(function(e){e.on("beforeFrameCreated",(function(e){t.emit("beforeFrameCreated",e)})),e.on("afterFrameCreated",(function(e,i){t.emit("afterFrameCreated",e,i)})),t.emit("protocol",e)})),this.connection.on("ready",(function(){t.checkVersion&&!t.inNode&&t.checkOutOfDate(),t.emit("ready")})),this.connection.on("connect",(function(){t.emit("connect"),t.connection.removeListener("frame",e),t.connection.on("frame",e)})),this.connection.on("disconnect",(function(){t.emit("disconnect"),i()})),this.connection.on("deviceConnect",(function(n){n.state?(t.emit("deviceConnected"),t.connection.removeListener("frame",e),t.connection.on("frame",e)):(t.emit("deviceDisconnected"),i())})),this.connection.on("deviceEvent",(function(e){var i=e.state,n=t.devices[i.id],r={};for(var a in i)n&&n.hasOwnProperty(a)&&n[a]==i[a]||(r[a]=!0);t.devices[i.id]=i,r.attached&&t.emit(i.attached?"deviceAttached":"deviceRemoved",i),r.streaming&&(i.streaming?(t.streamingCount++,t.emit("deviceStreaming",i),1==t.streamingCount&&t.emit("streamingStarted",i),r.attached||t.emit("deviceConnected")):r.attached&&i.attached||(t.streamingCount--,t.emit("deviceStopped",i),0==t.streamingCount&&t.emit("streamingStopped",i),t.emit("deviceDisconnected")))})),this.on("newListener",(function(t,e){"deviceConnected"!=t&&"deviceDisconnected"!=t||console.warn(t+" events are depricated.  Consider using 'streamingStarted/streamingStopped' or 'deviceStreaming/deviceStopped' instead")}))},p.prototype.checkOutOfDate=function(){console.assert(this.connection&&this.connection.protocol);var t=this.connection.protocol.serviceVersion,e=this.connection.protocol.version,i=this.connectionType.defaultProtocolVersion;return i>e&&(console.warn("Your Protocol Version is v"+e+", this app was designed for v"+i),h.warnOutOfDate({sV:t,pV:e}),!0)},p._pluginFactories={},p.plugin=function(t,e){return this._pluginFactories[t]&&console.warn('Plugin "'+t+'" already registered'),this._pluginFactories[t]=e},p.plugins=function(){return d.keys(this._pluginFactories)};var f=function(t,e,i){-1!=["beforeFrameCreated","afterFrameCreated"].indexOf(e)?this.on(e,i):(this.pipeline||(this.pipeline=new l(this)),this._pluginPipelineSteps[t]||(this._pluginPipelineSteps[t]=[]),this._pluginPipelineSteps[t].push(this.pipeline.addWrappedStep(e,i)))},m=function(t,e,i){var s;switch(this._pluginExtendedMethods[t]||(this._pluginExtendedMethods[t]=[]),e){case"frame":s=n;break;case"hand":s=r;break;case"pointable":s=a,d.extend(o.prototype,i),d.extend(o.Invalid,i);break;case"finger":s=o;break;default:throw t+' specifies invalid object type "'+e+'" for prototypical extension'}d.extend(s.prototype,i),d.extend(s.Invalid,i),this._pluginExtendedMethods[t].push([s,i])};p.prototype.use=function(t,e){var i,n,r,a;if(!(n="function"==typeof t?t:p._pluginFactories[t]))throw"Leap Plugin "+t+" not found.";if(e||(e={}),this.plugins[t])return d.extend(this.plugins[t],e),this;for(r in this.plugins[t]=e,a=n.call(this,e))"function"==typeof(i=a[r])?f.call(this,t,r,i):m.call(this,t,r,i);return this},p.prototype.stopUsing=function(t){var e,i=this._pluginPipelineSteps[t],n=this._pluginExtendedMethods[t],r=0;if(this.plugins[t]){if(i)for(r=0;r<i.length;r++)this.pipeline.removeStep(i[r]);if(n)for(r=0;r<n.length;r++)for(var a in e=n[r][0],n[r][1])delete e.prototype[a],delete e.Invalid[a];return delete this.plugins[t],this}},p.prototype.useRegisteredPlugins=function(){for(var t in p._pluginFactories)this.use(t)},d.extend(p.prototype,c.prototype)}).call(this,i(21))},function(t,e){var i=t.exports=function(t){this.steps=[],this.controller=t};i.prototype.addStep=function(t){this.steps.push(t)},i.prototype.run=function(t){for(var e=this.steps.length,i=0;i!=e&&t;i++)t=this.steps[i](t);return t},i.prototype.removeStep=function(t){var e=this.steps.indexOf(t);if(-1===e)throw"Step not found in pipeline";this.steps.splice(e,1)},i.prototype.addWrappedStep=function(t,e){var i=this.controller,n=function(n){var r,a,o;for(a=0,o=(r="frame"==t?[n]:n[t+"s"]||[]).length;a<o;a++)e.call(i,r[a]);return n};return this.addStep(n),n}},function(t,e,i){var n=t.exports=i(169),r=i(12),a=t.exports=function(t){n.call(this,t);var e=this;this.on("ready",(function(){e.startFocusLoop()})),this.on("disconnect",(function(){e.stopFocusLoop()}))};r.extend(a.prototype,n.prototype),a.__proto__=n,a.prototype.useSecure=function(){return"https:"===location.protocol},a.prototype.getScheme=function(){return this.useSecure()?"wss:":"ws:"},a.prototype.getPort=function(){return this.useSecure()?6436:6437},a.prototype.setupSocket=function(){var t=this,e=new WebSocket(this.getUrl());return e.onopen=function(){t.handleOpen()},e.onclose=function(e){t.handleClose(e.code,e.reason)},e.onmessage=function(e){t.handleData(e.data)},e.onerror=function(e){t.useSecure()&&"wss:"===t.scheme&&(t.scheme="ws:",t.port=6437,t.disconnect(),t.connect())},e},a.prototype.startFocusLoop=function(){if(!this.focusDetectorTimer){var t=this,e=null;e=void 0!==document.hidden?"hidden":void 0!==document.mozHidden?"mozHidden":void 0!==document.msHidden?"msHidden":void 0!==document.webkitHidden?"webkitHidden":void 0,void 0===t.windowVisible&&(t.windowVisible=void 0===e||!1===document[e]);var i=window.addEventListener("focus",(function(e){t.windowVisible=!0,r()})),n=window.addEventListener("blur",(function(e){t.windowVisible=!1,r()}));this.on("disconnect",(function(){window.removeEventListener("focus",i),window.removeEventListener("blur",n)}));var r=function(){var i=void 0===e||!1===document[e];t.reportFocus(i&&t.windowVisible)};r(),this.focusDetectorTimer=setInterval(r,100)}},a.prototype.stopFocusLoop=function(){this.focusDetectorTimer&&(clearTimeout(this.focusDetectorTimer),delete this.focusDetectorTimer)}},function(t,e,i){var n=i(353),r=i(169),a=i(12),o=t.exports=function(t){r.call(this,t);var e=this;this.on("ready",(function(){e.reportFocus(!0)}))};a.extend(o.prototype,r.prototype),o.__proto__=r,o.prototype.setupSocket=function(){var t=this,e=new n(this.getUrl());return e.on("open",(function(){t.handleOpen()})),e.on("message",(function(e){t.handleData(e)})),e.on("close",(function(e,i){t.handleClose(e,i)})),e.on("error",(function(){t.startReconnection()})),e}},function(t,e,i){(function(e){t.exports=function(){return e.WebSocket||e.MozWebSocket}}).call(this,i(19))},function(t,e,i){e.UI={Region:i(355),Cursor:i(356)}},function(t,e,i){var n=i(20).EventEmitter,r=i(12),a=t.exports=function(t,e){this.start=new Vector(t),this.end=new Vector(e),this.enteredFrame=null};a.prototype.hasPointables=function(t){for(var e=0;e!=t.pointables.length;e++){var i=t.pointables[e].tipPosition;if(i.x>=this.start.x&&i.x<=this.end.x&&i.y>=this.start.y&&i.y<=this.end.y&&i.z>=this.start.z&&i.z<=this.end.z)return!0}return!1},a.prototype.listener=function(t){var e=this;return t&&t.nearThreshold&&this.setupNearRegion(t.nearThreshold),function(t){return e.updatePosition(t)}},a.prototype.clipper=function(){var t=this;return function(e){return t.updatePosition(e),t.enteredFrame?e:null}},a.prototype.setupNearRegion=function(t){var e=this.nearRegion=new a([this.start.x-t,this.start.y-t,this.start.z-t],[this.end.x+t,this.end.y+t,this.end.z+t]),i=this;e.on("enter",(function(t){i.emit("near",t)})),e.on("exit",(function(t){i.emit("far",t)})),i.on("exit",(function(t){i.emit("near",t)}))},a.prototype.updatePosition=function(t){return this.nearRegion&&this.nearRegion.updatePosition(t),this.hasPointables(t)&&null==this.enteredFrame?(this.enteredFrame=t,this.emit("enter",this.enteredFrame)):this.hasPointables(t)||null==this.enteredFrame||(this.enteredFrame=null,this.emit("exit",this.enteredFrame)),t},a.prototype.normalize=function(t){return new Vector([(t.x-this.start.x)/(this.end.x-this.start.x),(t.y-this.start.y)/(this.end.y-this.start.y),(t.z-this.start.z)/(this.end.z-this.start.z)])},a.prototype.mapToXY=function(t,e,i){var n=this.normalize(t),r=n.x,a=n.y;return r>1?r=1:r<-1&&(r=-1),a>1?a=1:a<-1&&(a=-1),[(r+1)/2*e,(1-a)/2*i,n.z]},r.extend(a.prototype,n.prototype)},function(t,e){t.exports=function(){return function(t){var e=t.pointables.sort((function(t,e){return t.z-e.z}))[0];return e&&e.valid&&(t.cursorPosition=e.tipPosition),t}}},function(t,e){t.exports={full:"0.6.4",major:0,minor:6,dot:4}},function(t,e,i){"use strict";i.r(e);var n=i(0),r=i(3),a=i(8);n.Util.registerComponentSystem("hand-tracking",{schema:{autoConnect:{default:!0}},init(){this.el.sceneEl.addEventListener("leap-connect",(()=>{this.data.autoConnect&&this.initLeapHands()})),this.data.autoConnect&&this.el.sceneEl.systems.leap.isConnected()&&this.initLeapHands()},initLeapHands(){if(!this.usingLeapHands){console.log("Initializing Leap Motion Hands");for(let t of["left","right"]){let e=document.querySelector(`#${t}-hand`);n.Util.whenLoaded(e,(()=>{e.setAttribute("leap-hand",`hand: ${t}; pinchButton: pinch`),e.setAttribute("hand-helper",`hand: ${t}`);for(let t of["valve-index-controls","oculus-touch-controls","vive-controls","tracked-controls-webxr","tracked-controls-webvr","tracked-controls"])t in e.components&&e.components[t].isPlaying&&e.components[t].pause();e.object3D.position.set(0,0,0),e.object3D.rotation.set(0,0,0)}))}this.usingLeapHands=!0,this.el.emit("hands-connected",{type:"leap"})}},async initHandsFree(){let t=new(0,(await i.e(4).then(i.t.bind(null,400,7))).default)({handpose:{enabled:!0,backend:"webgl",maxContinuousChecks:1/0,detectionConfidence:.8,iouThreshold:.3,scoreThreshold:.75}});this.handsfree=t,t.enablePlugins("browser"),t.start(),this.setHandsFree=!1,t.use("logger",(t=>{if(t.handpose&&!(t.handpose.handInViewConfidence<.8)){if(window.lastHandPose=t,!this.setHandsFree){let e=this.el.sceneEl,i=t.handpose.meshes[0].parent;i.scale.set(1/this.el.sceneEl.canvas.width,1/this.el.sceneEl.canvas.width,1/this.el.sceneEl.canvas.width),i.position.set(0,1.5,.1),i.rotation.set(0,Math.PI,0),this.handsObject=i,e.object3D.add(i),this.setHandsFree=!0}for(let t of this.handsObject.children)t.updateMatrix()}}))}}),AFRAME.registerComponent("hand-touch-button",{schema:{outerSize:{default:.17},innerSize:{default:.1},color:{default:"#abe"},throttle:{default:50},icon:{type:"selector"}},init(){let t=document.createElement("a-entity");t.setAttribute("geometry","primitive: box;"),t.setAttribute("material","shader: matcap; wireframe: true; color: #aea"),this.el.append(t),this.outerBox=t;let e=document.createElement("a-entity");e.setAttribute("geometry","primitive: box;"),e.setAttribute("material","shader: matcap; wireframe: false"),this.innerBox=e,this.el.append(e),r.Pool.init(this),this.el.hasAttribute("tooltip")&&!this.el.hasAttribute("tooltip-style")&&n.Util.whenLoaded(this.el,(()=>this.el.setAttribute("tooltip-style","scale: 0.2 0.2 1.0; offset: 0 -0.3 0"))),this.tick=AFRAME.utils.throttleTick(this.tick,this.data.throttle,this)},update(t){this.outerBox.setAttribute("geometry","width",this.data.outerSize),this.outerBox.setAttribute("geometry","height",this.data.outerSize),this.outerBox.setAttribute("geometry","depth",this.data.outerSize),this.outerBox.setAttribute("material","color",this.data.color),n.Util.whenLoaded(this.outerBox,(()=>{this.outerBox.getObject3D("mesh").geometry.computeBoundingBox(),this.outerBox.object3D.visible=!1})),this.innerBox.setAttribute("geometry","width",this.data.innerSize),this.innerBox.setAttribute("geometry","height",this.data.innerSize),this.innerBox.setAttribute("geometry","depth",this.data.innerSize),this.innerBox.setAttribute("material","color",this.data.color),n.Util.whenLoaded(this.innerBox,(()=>this.innerBox.getObject3D("mesh").geometry.computeBoundingBox())),this.data.icon&&!this.iconBox&&(this.iconBox=!0,n.Util.whenLoaded(this.innerBox,(()=>{this.iconBox=new THREE.Object3D;let t=new THREE.MeshBasicMaterial({transparent:!0,color:"#FFF"});this.iconBox.add(new THREE.Mesh(this.innerBox.getObject3D("mesh").geometry,t)),this.iconBox.scale.set(1.1,1.1,1.1),this.iconBox.position.z+=.01,t.map=new THREE.Texture,t.map.image=this.data.icon,t.map.needsUpdate=!0,this.innerBox.object3D.add(this.iconBox),console.log("Added iconbox",this.iconBox)})))},checkIntersection(t){if(!this.el.object3D.visible)return;let e=!0;if(this.el.object3D.traverseAncestors((t=>e=e&&t.visible)),!e)return!1;let i=this.pool("otherPos",THREE.Vector3);t.object3D.getWorldPosition(i),this.el.object3D.worldToLocal(i),this.outerBox.getObject3D("mesh").geometry.boundingBox.containsPoint(i)?this.hovered||(this.el.emit("mouseenter"),this.hovered=!0,this.activeHand=t,this.el.addState("hovered")):this.hovered&&(console.log("leaving",i,Math.abs(i.x)<this.data.outerSize&&Math.abs(i.y)<this.data.outerSize&&Math.abs(i.z)<this.data.outerSize),this.el.emit("mouseleave"),this.hovered=!1,this.el.removeState("hovered")),this.innerBox.getObject3D("mesh").geometry.boundingBox.containsPoint(i)?this.clicked||(a.a.click(this.el),this.el.emit("click"),this.el.addState("clicked"),this.clicked=!0):this.clicked&&(console.log("Remove click state"),this.el.removeState("clicked"),this.clicked=!1)},tick(t,e){this.el.handEl&&this.checkIntersection(this.el.handEl)}}),AFRAME.registerComponent("hand-helper",{schema:{hand:{oneOf:["left","right"]}},events:{gripdown:function(t){t.detail&&"hand"===t.detail.type&&this.otherHandHelper.showGripMenu()},gripup:function(t){t.detail&&"hand"===t.detail.type&&this.otherHandHelper.hideGripMenu()},pinchdown:function(t){this.otherHandHelper.showPinchMenu()},pinchup:function(t){this.otherHandHelper.hidePinchMenu()},click:function(t){t.target.hasAttribute("click-action")&&this[t.target.getAttribute("click-action")](t)}},init(){this.otherHandEl=document.querySelector(`#${"left"===this.data.hand?"right":"left"}-hand`),n.Util.whenLoaded(this.otherHandEl,(()=>this.otherHandHelper=this.otherHandEl.components["hand-helper"]));let t=document.createElement("a-entity");this.el.append(t),t.innerHTML=i(159),this.menu=t,n.Util.whenLoaded(t,(()=>{t.querySelectorAll(".menu").forEach((t=>t.setAttribute("visible",!1))),t.querySelectorAll("*[hand-touch-button]").forEach((t=>{t.handEl=this.el,t.otherHandEl=this.otherHandEl})),document.querySelector("#camera-root").object3D.add(t.object3D)}));let e=document.createElement("a-sphere");e.setAttribute("radius",.01),this.el.append(e),r.Pool.init(this)},updateMenu(){n.Util.positionObject3DAtTarget(this.menu.object3D,this.el.object3D),this.menu.object3D.rotation.set(0,0,0);let t=document.getElementById("camera").getObject3D("camera-matrix-helper"),e=this.pool("cameraForward",THREE.Vector3);t.getWorldDirection(e),t.getWorldDirection(e),e.y=0,e.normalize(),this.menu.object3D.matrix.lookAt(e,this.pool("origin",THREE.Vector3),this.el.sceneEl.object3D.up),this.menu.object3D.quaternion.setFromRotationMatrix(this.menu.object3D.matrix),this.menu.querySelectorAll(".menu").forEach((t=>t.setAttribute("visible",!1))),this.gripMenu?this.menu.querySelector(".grip-menu").setAttribute("visible",!0):this.pinchMenu&&this.menu.querySelector(".pinch-menu").setAttribute("visible",!0)},showGripMenu(){this.gripMenu=!0,this.updateMenu()},hideGripMenu(){this.gripMenu=!1,this.updateMenu()},showPinchMenu(){this.pinchMenu=!0,this.updateMenu()},hidePinchMenu(){this.pinchMenu=!1,this.updateMenu()},hideMenu(){this.gripMenu=!1,this.pinchMenu=!1,this.updateMenu()},click(){this.otherHandEl.emit("triggerdown"),this.otherHandEl.emit("triggerup")},toggleRotation(){this.otherHandEl.is("rotating")?this.otherHandEl.removeState("rotating"):this.otherHandEl.addState("rotating")}}),AFRAME.registerComponent("zoom-touch-button",{dependencies:["hand-touch-button"],schema:{direction:{oneOf:["out","in"]}},init(){},events:{stateadded:function(t){if(console.log("stateadded",t.detail),this.el.is("clicked")){console.log("Zoooming",t.detail);let e=this.el.components["hand-touch-button"].activeHand,i=this.el.otherHandEl;switch(i||(i=document.querySelector("#"+("right-hand"===e.id?"left-hand":"right-hand"))),this.data.direction){case"in":i.components.manipulator.zoomAmmount=.2;break;case"out":i.components.manipulator.zoomAmmount=-.2;break;case"small":i.components.manipulator.scaleAmmount=.2;break;case"big":i.components.manipulator.scaleAmmount=-.2}}},stateremoved:function(t){if(!this.el.is("clicked")){console.log("unZoooming",t.detail);let e=this.el.components["hand-touch-button"].activeHand,i=this.el.otherHandEl;switch(i||(i=document.querySelector("#"+("right-hand"===e.id?"left-hand":"right-hand"))),this.data.direction){case"in":case"out":i.components.manipulator.zoomAmmount=0;break;case"small":case"big":i.components.manipulator.scaleAmmount=0}}}}})},function(t,e){var i=AFRAME.utils.trackedControls.checkControllerPresentAndSetup,n=AFRAME.utils.device.isWebXRAvailable,r="oculus-oculus-rift-s",a="oculus-touch";AFRAME.registerComponent("fix-oculus-steamvr",{dependencies:["oculus-touch-controls"],init(){let t=this.el.components["oculus-touch-controls"];t.checkIfControllerPresent;t.checkIfControllerPresent=function(){if(n){if(this.controllerPresent)return i(this,this.webXRId,{hand:this.data.hand}),void(this.controllerPresent||(this.webXRId=void 0));this.webXRId=a,i(this,a,{hand:this.data.hand}),this.controllerPresent||(this.webXRId=r,i(this,r,{hand:this.data.hand}),this.controllerPresent||(this.webXRId=void 0))}else i(this,"Oculus Touch",{hand:this.data.hand})}.bind(t),t.injectTrackedControls=function(){var t=this.data,e=this.webXRId,i="right"===t.hand?"Oculus Touch (Right)":"Oculus Touch (Left)",r=n?e:i;this.el.setAttribute("tracked-controls",{id:r,hand:t.hand,orientationOffset:t.orientationOffset}),this.loadModel()}.bind(t)}}),AFRAME.registerSystem("fix-webgl-context",{init(){navigator.xr&&this.el.sceneEl.renderer.getContext().makeXRCompatible()}})},function(t,e,i){"use strict";i.r(e);var n=i(0),r=i(3);n.Util.registerComponentSystem("artist-root",{schema:{rotationAmount:{default:.785},autoResetPosition:{default:!0},resetPositioner:{default:"#camera-reset-el"}},events:{entervr:function(){}},init(){r.Pool.init(this),document.querySelectorAll("*[cursor], *[webxr-laser]").forEach((t=>{t.addEventListener("buttonchanged",(t=>{this.acceptOrientationPrompt()&&(t.preventDefault(),t.stopPropagation())}))})),document.querySelectorAll("*[cursor], *[webxr-laser]").forEach((t=>{t.addEventListener("mouseup",(()=>this.acceptOrientationPrompt()))}));let t=this.el.sceneEl.querySelector("#reset-orientation-box");t||(t=document.createElement("a-box"),t.setAttribute("width","500"),t.setAttribute("depth","500"),t.setAttribute("height","500"),t.setAttribute("material","src: #asset-reset-orientation; side: back; shader: flat"),t.setAttribute("visible",!1),this.el.sceneEl.append(t)),this.resetBox=t,n.Util.whenLoaded(this.el.sceneEl,(()=>{if(this.el.sceneEl.is("vr-mode")){if(AFRAME.utils.device.isMobile()&&!AFRAME.utils.device.isMobileVR())return;if(!this.data.autoResetPosition)return;this.resetCameraLocation()}})),window.addEventListener("keyup",(t=>{this.acceptOrientationPrompt()}))},rotateLeft(){document.querySelector("#camera-offsetter").components["between-target-positioner"].resetPosition(),document.querySelector("#artist-root").object3D.rotation.y+=this.data.rotationAmount},rotateRight(){document.querySelector("#camera-offsetter").components["between-target-positioner"].resetPosition(),document.querySelector("#artist-root").object3D.rotation.y-=this.data.rotationAmount},resetPosition(){document.querySelector("#camera-offsetter").components["between-target-positioner"].resetPosition()},resetCameraLocation(){this.resetPosition();let t=this.el.sceneEl.querySelector("#artist-root").object3D,e=this.el.sceneEl.querySelector(this.data.resetPositioner);n.Util.positionObject3DAtTarget(t,e.object3D);let i=this.pool("cameraWorld",THREE.Vector3),r=n.Util.cameraObject3D();r.getWorldPosition(i),console.log("cameraWorld",i),t.position.y-=i.y-e.object3D.position.y,this.resetPosition(),t.rotation.set(0,0,0),t.updateMatrixWorld(),r.getWorldDirection(i);let a=new THREE.Spherical;a.setFromCartesianCoords(i.x,i.y,i.z),t.rotation.y=-a.theta},showOrientationResetPrompt(){this.waitingForPrompt=!0;let t=this.el.sceneEl.querySelector("#world-root");t&&t.setAttribute("visible",!1),this.resetBox.setAttribute("visible",!0),this.el.sceneEl.emit("refreshobjects")},acceptOrientationPrompt(){if(!this.waitingForPrompt)return!1;this.waitingForPrompt=!1,this.resetCameraLocation();let t=this.el.sceneEl.querySelector("#world-root");return t&&t.setAttribute("visible",!0),this.resetBox.setAttribute("visible",!1),this.el.sceneEl.emit("refreshobjects"),!0}}),AFRAME.registerComponent("between-target-positioner",{schema:{root:{type:"selector"},target:{type:"selector"}},init(){r.Pool.init(this)},resetPosition(){let t=this.data.target.object3D,e=this.data.root.object3D,i=this.el.object3D,n=e.position.y,r=(e.matrix.extractRotation(new THREE.Matrix4),this.pool("diff",THREE.Vector3));r.copy(t.position),r.add(i.position),r.applyQuaternion(e.quaternion),e.position.add(r),e.position.y=n,i.position.x=-t.position.x,i.position.z=-t.position.z}}),AFRAME.registerComponent("reset-transform-on-vr",{dependencies:["look-controls"],init(){this.el.components["look-controls"].onEnterVR=function(){this.saveCameraPose(),this.el.object3D.position.set(0,0,0),!AFRAME.utils.device.isMobile()||AFRAME.utils.device.isMobileVR()?this.el.sceneEl.systems["artist-root"].showOrientationResetPrompt():this.el.sceneEl.systems["artist-root"].resetCameraLocation()}.bind(this.el.components["look-controls"])}}),AFRAME.registerComponent("camera-matrix-helper",{dependencies:["camera"],init(){this.obj=new THREE.Object3D,this.el.setObject3D("camera-matrix-helper",this.obj),this.el.object3D.parent.add(this.obj),n.Util.whenLoaded(document.getElementById("camera-root"),(()=>this.cameraObject=document.getElementById("camera-root").object3D))},tick(){this.obj.matrix.compose(this.cameraObject.position,this.cameraObject.quaternion,this.cameraObject.scale),this.obj.matrix.decompose(this.obj.position,this.obj.quaternion,this.obj.scale)}}),AFRAME.registerComponent("artist-shadow",{tick(){n.Util.cameraObject3D().getWorldPosition(this.el.object3D.position),this.el.object3D.position.y=.01}}),AFRAME.registerComponent("position-at-target",{schema:{target:{type:"selector"},throttle:{default:0}},update(t){this.tick=AFRAME.utils.throttleTick(this._tick,this.data.throttle,this)},tick(t,e){},_tick(t,e){this.data.target&&(this.data.target.hasAttribute("camera")&&this.data.target.getAttribute("camera").active?n.Util.positionObject3DAtTarget(this.el.object3D,n.Util.cameraObject3D()):n.Util.positionObject3DAtTarget(this.el.object3D,this.data.target.object3D))}})},function(t,e,i){"use strict";i.r(e);i(0),i(3);var n=i(4),r=(i(30),i(10)),a=i(2);AFRAME.registerSystem("canvas-fx",{init(){this.processors={},this.availableFX=a.FX},processorFor(t){return this.processors[t]=new r.CanvasShaderProcessor({fx:t}),this.processors[t]},applyFX(t,e){let i=this.processorFor(t);return this.applyProcessor(i,e)},applyProcessor(t,e){e||(e=Compositor.drawableCanvas),e instanceof AFRAME.AEntity&&(e=e.getObject3D("mesh").material.map.image),n.Undo.pushCanvas(e),t.setInputCanvas(e),t.update();let i=e.getContext("2d"),r=i.globalCompositeOperation;return i.globalCompositeOperation="source-over",i.clearRect(0,0,e.width,e.height),i.drawImage(t.canvas,0,0,t.canvas.width,t.canvas.height,0,0,e.width,e.height),i.globalCompositeOperation=r,e.touch&&e.touch(),e}})},function(t,e){var i=0,n=1,r=2,a=3,o=4,s=5121,l=5123,c=5126,u=5125,h=34962,d=34963,p=9728,f=9729,m=9984,g=9985,y=9986,b=9987,A=33071,v=33648,w=10497,E={};E[THREE.NearestFilter]=p,E[THREE.NearestMipmapNearestFilter]=m,E[THREE.NearestMipmapLinearFilter]=y,E[THREE.LinearFilter]=f,E[THREE.LinearMipmapNearestFilter]=g,E[THREE.LinearMipmapLinearFilter]=b,E[THREE.ClampToEdgeWrapping]=A,E[THREE.RepeatWrapping]=w,E[THREE.MirroredRepeatWrapping]=v;var _={scale:"scale",position:"translation",quaternion:"rotation",morphTargetInfluences:"weights"};THREE.GLTFExporter=function(){},THREE.GLTFExporter.prototype={constructor:THREE.GLTFExporter,parse:function(t,e,p){var f={binary:!1,trs:!1,onlyVisible:!0,bypassVARTISTEUi:!0,truncateDrawRange:!0,embedImages:!0,maxTextureSize:1/0,animations:[],forceIndices:!1,forcePowerOfTwoTextures:!1,includeCustomExtensions:!1,mimeType:"image/png",imageQuality:void 0,postProcessJSON:function(t){return t}};(p=Object.assign({},f,p)).animations.length>0&&(p.trs=!0);var m,g={asset:{version:"2.0",generator:"THREE.GLTFExporter"}},y=0,b=[],A=[],v=new Map,w=[],x={},T={meshes:new Map,attributes:new Map,attributesNormalized:new Map,materials:new Map,textures:new Map,images:new Map},M=new Map,C=0;function k(t){return M.has(t)||M.set(t,C++),M.get(t)}function R(t,e){return t.length===e.length&&t.every((function(t,i){return t===e[i]}))}function S(t){return 4*Math.ceil(t/4)}function D(t,e){e=e||0;var i=S(t.byteLength);if(i!==t.byteLength){var n=new Uint8Array(i);if(n.set(new Uint8Array(t)),0!==e)for(var r=t.byteLength;r<i;r++)n[r]=e;return n.buffer}return t}function O(t,e){if(0!==Object.keys(t.userData).length)try{var i=JSON.parse(JSON.stringify(t.userData));if(p.includeCustomExtensions&&i.gltfExtensions){for(var n in void 0===e.extensions&&(e.extensions={}),i.gltfExtensions)e.extensions[n]=i.gltfExtensions[n],x[n]=!0;delete i.gltfExtensions}Object.keys(i).length>0&&(e.extras=i)}catch(e){console.warn("THREE.GLTFExporter: userData of '"+t.name+"' won't be serialized because of JSON.stringify error - "+e.message)}}function P(t,e){var i=!1,n={};0===e.offset.x&&0===e.offset.y||(n.offset=e.offset.toArray(),i=!0),0!==e.rotation&&(n.rotation=e.rotation,i=!0),1===e.repeat.x&&1===e.repeat.y||(n.scale=e.repeat.toArray(),i=!0),i&&(t.extensions=t.extensions||{},t.extensions.KHR_texture_transform=n,x.KHR_texture_transform=!0)}function F(t){return g.buffers||(g.buffers=[{byteLength:0}]),b.push(t),0}function U(t,e,i,n){var r;if(t.array.constructor===Float32Array)r=c;else if(t.array.constructor===Uint32Array)r=u;else if(t.array.constructor===Uint16Array)r=l;else{if(t.array.constructor!==Uint8Array)throw new Error("THREE.GLTFExporter: Unsupported bufferAttribute component type.");r=s}if(void 0===i&&(i=0),void 0===n&&(n=t.count),p.truncateDrawRange&&void 0!==e&&null===e.index){var a=i+n,o=e.drawRange.count===1/0?t.count:e.drawRange.start+e.drawRange.count;i=Math.max(i,e.drawRange.start),(n=Math.min(a,o)-i)<0&&(n=0)}if(0===n)return null;var f,m=function(t,e,i){for(var n={min:new Array(t.itemSize).fill(Number.POSITIVE_INFINITY),max:new Array(t.itemSize).fill(Number.NEGATIVE_INFINITY)},r=e;r<e+i;r++)for(var a=0;a<t.itemSize;a++){var o=t.array[r*t.itemSize+a];n.min[a]=Math.min(n.min[a],o),n.max[a]=Math.max(n.max[a],o)}return n}(t,i,n);void 0!==e&&(f=t===e.index?d:h);var b=function(t,e,i,n,r){var a;g.bufferViews||(g.bufferViews=[]),a=e===s?1:e===l?2:4;for(var o=S(n*t.itemSize*a),d=new DataView(new ArrayBuffer(o)),p=0,f=i;f<i+n;f++)for(var m=0;m<t.itemSize;m++){var b=t.array[f*t.itemSize+m];e===c?d.setFloat32(p,b,!0):e===u?d.setUint32(p,b,!0):e===l?d.setUint16(p,b,!0):e===s&&d.setUint8(p,b),p+=a}var A={buffer:F(d.buffer),byteOffset:y,byteLength:o};return void 0!==r&&(A.target=r),r===h&&(A.byteStride=t.itemSize*a),y+=o,g.bufferViews.push(A),{id:g.bufferViews.length-1,byteLength:0}}(t,r,i,n,f),A={bufferView:b.id,byteOffset:b.byteOffset,componentType:r,count:n,max:m.max,min:m.min,type:{1:"SCALAR",2:"VEC2",3:"VEC3",4:"VEC4",16:"MAT4"}[t.itemSize]};return g.accessors||(g.accessors=[]),g.accessors.push(A),g.accessors.length-1}function B(t,e,i){T.images.has(t)||T.images.set(t,{});var n=T.images.get(t),r=e===THREE.RGBAFormat?p.mimeType:"image/jpeg",a=r+":flipY/"+i.toString();if(void 0!==n[a])return n[a];g.images||(g.images=[]);var o={mimeType:r};if(p.embedImages){var s=m=m||document.createElement("canvas");s.width=Math.min(t.width,p.maxTextureSize),s.height=Math.min(t.height,p.maxTextureSize),p.forcePowerOfTwoTextures&&!function(t){return THREE.Math.isPowerOfTwo(t.width)&&THREE.Math.isPowerOfTwo(t.height)}(s)&&(console.warn("GLTFExporter: Resized non-power-of-two image.",t),s.width=THREE.Math.floorPowerOfTwo(s.width),s.height=THREE.Math.floorPowerOfTwo(s.height));var l=s.getContext("2d");!0===i&&(l.translate(0,s.height),l.scale(1,-1)),l.drawImage(t,0,0,s.width,s.height),!0===p.binary?A.push(new Promise((function(t){s.toBlob((function(e){(function(t){return g.bufferViews||(g.bufferViews=[]),new Promise((function(e){var i=new window.FileReader;i.readAsArrayBuffer(t),i.onloadend=function(){var t=D(i.result),n={buffer:F(t),byteOffset:y,byteLength:t.byteLength};y+=t.byteLength,g.bufferViews.push(n),e(g.bufferViews.length-1)}}))})(e).then((function(e){o.bufferView=e,t()}))}),r,p.imageQuality)}))):o.uri=s.toDataURL(r,p.imageQuality)}else o.uri=t.src;g.images.push(o);var c=g.images.length-1;return n[a]=c,c}function I(t){g.samplers||(g.samplers=[]);var e={magFilter:E[t.magFilter],minFilter:E[t.minFilter],wrapS:E[t.wrapS],wrapT:E[t.wrapT]};return g.samplers.push(e),g.samplers.length-1}function j(t){if(T.textures.has(t))return T.textures.get(t);g.textures||(g.textures=[]);var e={sampler:I(t),source:B(t.image,t.format,t.flipY)};t.name&&(e.name=t.name),g.textures.push(e);var i=g.textures.length-1;return T.textures.set(t,i),i}function L(t){if(T.materials.has(t))return T.materials.get(t);if(g.materials||(g.materials=[]),t.isShaderMaterial&&!t.isGLTFSpecularGlossinessMaterial)return console.warn("GLTFExporter: THREE.ShaderMaterial not supported."),null;var e={pbrMetallicRoughness:{}};t.isMeshBasicMaterial?(e.extensions={KHR_materials_unlit:{}},x.KHR_materials_unlit=!0):t.isGLTFSpecularGlossinessMaterial?(e.extensions={KHR_materials_pbrSpecularGlossiness:{}},x.KHR_materials_pbrSpecularGlossiness=!0):t.isMeshStandardMaterial||console.warn("GLTFExporter: Use MeshStandardMaterial or MeshBasicMaterial for best results.");var i=t.color.toArray().concat([t.opacity]);if(R(i,[1,1,1,1])||(e.pbrMetallicRoughness.baseColorFactor=i),t.isMeshStandardMaterial?(e.pbrMetallicRoughness.metallicFactor=t.metalness,e.pbrMetallicRoughness.roughnessFactor=t.roughness):t.isMeshBasicMaterial?(e.pbrMetallicRoughness.metallicFactor=0,e.pbrMetallicRoughness.roughnessFactor=.9):(e.pbrMetallicRoughness.metallicFactor=.5,e.pbrMetallicRoughness.roughnessFactor=.5),t.isGLTFSpecularGlossinessMaterial){e.pbrMetallicRoughness.baseColorFactor&&(e.extensions.KHR_materials_pbrSpecularGlossiness.diffuseFactor=e.pbrMetallicRoughness.baseColorFactor);var n=[1,1,1];t.specular.toArray(n,0),e.extensions.KHR_materials_pbrSpecularGlossiness.specularFactor=n,e.extensions.KHR_materials_pbrSpecularGlossiness.glossinessFactor=t.glossiness}if(t.metalnessMap||t.roughnessMap)if(t.metalnessMap===t.roughnessMap){var r={index:j(t.metalnessMap)};P(r,t.metalnessMap),e.pbrMetallicRoughness.metallicRoughnessTexture=r}else console.warn("THREE.GLTFExporter: Ignoring metalnessMap and roughnessMap because they are not the same Texture.");if(t.map){var a={index:j(t.map)};P(a,t.map),t.isGLTFSpecularGlossinessMaterial&&(e.extensions.KHR_materials_pbrSpecularGlossiness.diffuseTexture=a),e.pbrMetallicRoughness.baseColorTexture=a}if(t.isGLTFSpecularGlossinessMaterial&&t.specularMap){var o={index:j(t.specularMap)};P(o,t.specularMap),e.extensions.KHR_materials_pbrSpecularGlossiness.specularGlossinessTexture=o}if(t.emissive){var s=t.emissive.clone().multiplyScalar(t.emissiveIntensity).toArray();if(R(s,[0,0,0])||(e.emissiveFactor=s),t.emissiveMap){var l={index:j(t.emissiveMap)};P(l,t.emissiveMap),e.emissiveTexture=l}}if(t.normalMap){var c={index:j(t.normalMap)};t.normalScale&&-1!==t.normalScale.x&&(t.normalScale.x!==t.normalScale.y&&console.warn("THREE.GLTFExporter: Normal scale components are different, ignoring Y and exporting X."),c.scale=t.normalScale.x),P(c,t.normalMap),e.normalTexture=c}if(t.aoMap){var u={index:j(t.aoMap),texCoord:1};1!==t.aoMapIntensity&&(u.strength=t.aoMapIntensity),P(u,t.aoMap),e.occlusionTexture=u}t.transparent?e.alphaMode="BLEND":t.alphaTest>0&&(e.alphaMode="MASK",e.alphaCutoff=t.alphaTest),t.side===THREE.DoubleSide&&(e.doubleSided=!0),""!==t.name&&(e.name=t.name),O(t,e),g.materials.push(e);var h=g.materials.length-1;return T.materials.set(t,h),h}function N(t){var e=t.geometry.uuid+":"+t.material.uuid;if(T.meshes.has(e))return T.meshes.get(e);var s,l=t.geometry;if(t.isLineSegments)s=n;else if(t.isLineLoop)s=r;else if(t.isLine)s=a;else if(t.isPoints)s=i;else{if(!l.isBufferGeometry){console.warn("GLTFExporter: Exporting THREE.Geometry will increase file size. Use THREE.BufferGeometry instead.");var c=new THREE.BufferGeometry;c.fromGeometry(l),l=c}s=t.material.wireframe?n:o}var u={},h={},d=[],f=[],m={uv:"TEXCOORD_0",uv2:"TEXCOORD_1",color:"COLOR_0",skinWeight:"WEIGHTS_0",skinIndex:"JOINTS_0"},y=l.getAttribute("normal");void 0===y||function(t){if(T.attributesNormalized.has(t))return!1;for(var e=new THREE.Vector3,i=0,n=t.count;i<n;i++)if(Math.abs(e.fromArray(t.array,3*i).length()-1)>5e-4)return!1;return!0}(y)||(console.warn("THREE.GLTFExporter: Creating normalized normal attribute from the non-normalized one."),l.setAttribute("normal",function(t){if(T.attributesNormalized.has(t))return T.attributesNormalized.get(t);if(!t.clone)return t;for(var e=t.clone(),i=new THREE.Vector3,n=0,r=e.count;n<r;n++)i.fromArray(e.array,3*n),0===i.x&&0===i.y&&0===i.z?i.setX(1):i.normalize(),i.toArray(e.array,3*n);return T.attributesNormalized.set(t,e),e}(y)));var b=null;for(var A in l.attributes)if("morph"!==A.substr(0,5)){var v=l.attributes[A];A=m[A]||A.toUpperCase();if(/^(POSITION|NORMAL|TANGENT|TEXCOORD_\d+|COLOR_\d+|JOINTS_\d+|WEIGHTS_\d+)$/.test(A)||(A="_"+A),T.attributes.has(k(v)))h[A]=T.attributes.get(k(v));else{b=null;var w=v.array;"JOINTS_0"!==A||w instanceof Uint16Array||w instanceof Uint8Array||(console.warn('GLTFExporter: Attribute "skinIndex" converted to type UNSIGNED_SHORT.'),b=new THREE.BufferAttribute(new Uint16Array(w),v.itemSize,v.normalized));var E=U(b||v,l);null!==E&&(h[A]=E,T.attributes.set(k(v),E))}}if(void 0!==y&&l.setAttribute("normal",y),0===Object.keys(h).length)return null;if(void 0!==t.morphTargetInfluences&&t.morphTargetInfluences.length>0){var _=[],x=[],M={};if(void 0!==t.morphTargetDictionary)for(var C in t.morphTargetDictionary)M[t.morphTargetDictionary[C]]=C;for(var R=0;R<t.morphTargetInfluences.length;++R){var S={},D=!1;for(var A in l.morphAttributes)if("position"===A||"normal"===A){v=l.morphAttributes[A][R];var P=A.toUpperCase(),F=l.attributes[A];if(T.attributes.has(k(v)))S[P]=T.attributes.get(k(v));else{var B=v.clone();if(!l.morphTargetsRelative)for(var I=0,j=v.count;I<j;I++)B.setXYZ(I,v.getX(I)-F.getX(I),v.getY(I)-F.getY(I),v.getZ(I)-F.getZ(I));S[P]=U(B,l),T.attributes.set(k(F),S[P])}}else D||(console.warn("GLTFExporter: Only POSITION and NORMAL morph are supported."),D=!0);f.push(S),_.push(t.morphTargetInfluences[R]),void 0!==t.morphTargetDictionary&&x.push(M[R])}u.weights=_,x.length>0&&(u.extras={},u.extras.targetNames=x)}var N=p.forceIndices,H=Array.isArray(t.material);if(H&&0===l.groups.length)return null;!N&&null===l.index&&H&&(console.warn("THREE.GLTFExporter: Creating index for non-indexed multi-material mesh."),N=!0);var z=!1;if(null===l.index&&N){for(var V=[],G=(R=0,l.attributes.position.count);R<G;R++)V[R]=R;l.setIndex(V),z=!0}var W=H?t.material:[t.material],X=H?l.groups:[{materialIndex:0,start:void 0,count:void 0}];for(R=0,G=X.length;R<G;R++){var Y={mode:s,attributes:h};if(O(l,Y),f.length>0&&(Y.targets=f),null!==l.index){e=k(l.index);void 0===X[R].start&&void 0===X[R].count||(e+=":"+X[R].start+":"+X[R].count),T.attributes.has(e)?Y.indices=T.attributes.get(e):(Y.indices=U(l.index,l,X[R].start,X[R].count),T.attributes.set(e,Y.indices)),null===Y.indices&&delete Y.indices}var Q=L(W[X[R].materialIndex]);null!==Q&&(Y.material=Q),d.push(Y)}z&&l.setIndex(null),u.primitives=d,g.meshes||(g.meshes=[]),g.meshes.push(u);var q=g.meshes.length-1;return T.meshes.set(e,q),q}function H(t,e){g.animations||(g.animations=[]),console.warn("Skipping morph target merging");for(var i=t.tracks,n=[],r=[],a=0;a<i.length;++a){var o=i[a];console.log("Track",o.name,o);var s=THREE.PropertyBinding.parseTrackName(o.name),l=THREE.PropertyBinding.findNode(e,s.nodeName),c=_[s.propertyName];if("bones"===s.objectName&&(l=!0===l.isSkinnedMesh?l.skeleton.getBoneByName(s.objectIndex):void 0),!l||!c)return console.warn('THREE.GLTFExporter: Could not export animation track "%s".',o.name),null;var u,h=o.values.length/o.times.length;c===_.morphTargetInfluences&&(console.log("t",o,c,l,s,h,l.morphTargetInfluences.length),h/=l.morphTargetInfluences.length,h=Math.max(1,Math.round(h))),!0===o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline?(u="CUBICSPLINE",h/=3):u=o.getInterpolation()===THREE.InterpolateDiscrete?"STEP":"LINEAR",r.push({input:U(new THREE.BufferAttribute(o.times,1)),output:U(new THREE.BufferAttribute(o.values,h)),interpolation:u}),n.push({sampler:r.length-1,target:{node:v.get(l),path:c}})}return g.animations.push({name:t.name||"clip_"+g.animations.length,samplers:r,channels:n}),g.animations.length-1}function z(t){var e=g.nodes[v.get(t)],i=t.skeleton,n=t.skeleton.bones[0];if(void 0===n)return null;for(var r=[],a=new Float32Array(16*i.bones.length),o=new THREE.Matrix4,s=0;s<i.bones.length;++s)r.push(v.get(i.bones[s])),o.copy(i.boneInverses[s]),o.multiply(t.bindMatrix).toArray(a,16*s);return void 0===g.skins&&(g.skins=[]),g.skins.push({inverseBindMatrices:U(new THREE.BufferAttribute(a,16)),joints:r,skeleton:v.get(n)}),e.skin=g.skins.length-1}function V(t){var e={};t.name&&(e.name=t.name),e.color=t.color.toArray(),e.intensity=t.intensity,t.isDirectionalLight?e.type="directional":t.isPointLight?(e.type="point",t.distance>0&&(e.range=t.distance)):t.isSpotLight&&(e.type="spot",t.distance>0&&(e.range=t.distance),e.spot={},e.spot.innerConeAngle=(t.penumbra-1)*t.angle*-1,e.spot.outerConeAngle=t.angle),void 0!==t.decay&&2!==t.decay&&console.warn("THREE.GLTFExporter: Light decay may be lost. glTF is physically-based, and expects light.decay=2."),!t.target||t.target.parent===t&&0===t.target.position.x&&0===t.target.position.y&&-1===t.target.position.z||console.warn("THREE.GLTFExporter: Light direction may be lost. For best results, make light.target a child of the light with position 0,0,-1.");var i=g.extensions.KHR_lights_punctual.lights;return i.push(e),i.length-1}function G(t){g.nodes||(g.nodes=[]);var e={};if(p.trs){var i=t.quaternion.toArray(),n=t.position.toArray(),r=t.scale.toArray();R(i,[0,0,0,1])||(e.rotation=i),R(n,[0,0,0])||(e.translation=n),R(r,[1,1,1])||(e.scale=r)}else t.matrixAutoUpdate&&t.updateMatrix(),R(t.matrix.elements,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])||(e.matrix=t.matrix.elements);if(""!==t.name&&(e.name=String(t.name)),O(t,e),t.isMesh||t.isLine||t.isPoints){var a=N(t);null!==a&&(e.mesh=a)}else if(t.isCamera)e.camera=function(t){g.cameras||(g.cameras=[]);var e=t.isOrthographicCamera,i={type:e?"orthographic":"perspective"};return e?i.orthographic={xmag:2*t.right,ymag:2*t.top,zfar:t.far<=0?.001:t.far,znear:t.near<0?0:t.near}:i.perspective={aspectRatio:t.aspect,yfov:THREE.Math.degToRad(t.fov),zfar:t.far<=0?.001:t.far,znear:t.near<0?0:t.near},""!==t.name&&(i.name=t.type),g.cameras.push(i),g.cameras.length-1}(t);else if(t.isDirectionalLight||t.isPointLight||t.isSpotLight)x.KHR_lights_punctual||(g.extensions=g.extensions||{},g.extensions.KHR_lights_punctual={lights:[]},x.KHR_lights_punctual=!0),e.extensions=e.extensions||{},e.extensions.KHR_lights_punctual={light:V(t)};else if(t.isLight)return console.warn("THREE.GLTFExporter: Only directional, point, and spot lights are supported.",t),null;if(t.isSkinnedMesh&&w.push(t),t.children.length>0){for(var o=[],s=0,l=t.children.length;s<l;s++){var c=t.children[s];if(c.visible||!1===p.onlyVisible){if(p.bypassVARTISTEUi&&c.userData&&c.userData.vartisteUI)continue;var u=G(c);null!==u&&o.push(u)}}o.length>0&&(e.children=o)}g.nodes.push(e);var h=g.nodes.length-1;return v.set(t,h),h}function W(t){g.scenes||(g.scenes=[],g.scene=0);var e={nodes:[]};""!==t.name&&(e.name=t.name),t.userData&&Object.keys(t.userData).length>0&&(e.extras=O(t)),g.scenes.push(e);for(var i=[],n=0,r=t.children.length;n<r;n++){var a=t.children[n];if(a.visible||!1===p.onlyVisible){if(p.bypassVARTISTEUi&&a.userData&&a.userData.vartisteUI)continue;var o=G(a);null!==o&&i.push(o)}}i.length>0&&(e.nodes=i),O(t,e)}!function(t){t=t instanceof Array?t:[t];for(var e=[],i=0;i<t.length;i++)t[i]instanceof THREE.Scene?W(t[i]):e.push(t[i]);for(e.length>0&&function(t){var e=new THREE.Scene;e.name="AuxScene";for(var i=0;i<t.length;i++)e.children.push(t[i]);W(e)}(e),i=0;i<w.length;++i)z(w[i]);for(i=0;i<p.animations.length;++i)H(p.animations[i],t[0])}(t),Promise.all(A).then((function(){var t=new Blob(b,{type:"application/octet-stream"});p.postProcessJSON(g);var i=Object.keys(x);if(i.length>0&&(g.extensionsUsed=i),g.buffers&&g.buffers.length>0){g.buffers[0].byteLength=t.size;var n=new window.FileReader;if(!0===p.binary){n.readAsArrayBuffer(t),n.onloadend=function(){var t=D(n.result),i=new DataView(new ArrayBuffer(8));i.setUint32(0,t.byteLength,!0),i.setUint32(4,5130562,!0);var r=D(function(t){if(void 0!==window.TextEncoder)return(new TextEncoder).encode(t).buffer;for(var e=new Uint8Array(new ArrayBuffer(t.length)),i=0,n=t.length;i<n;i++){var r=t.charCodeAt(i);e[i]=r>255?32:r}return e.buffer}(JSON.stringify(g)),32),a=new DataView(new ArrayBuffer(8));a.setUint32(0,r.byteLength,!0),a.setUint32(4,1313821514,!0);var o=new ArrayBuffer(12),s=new DataView(o);s.setUint32(0,1179937895,!0),s.setUint32(4,2,!0);var l=12+a.byteLength+r.byteLength+i.byteLength+t.byteLength;s.setUint32(8,l,!0);var c=new Blob([o,a,r,i,t],{type:"application/octet-stream"}),u=new window.FileReader;u.readAsArrayBuffer(c),u.onloadend=function(){e(u.result)}}}else n.readAsDataURL(t),n.onloadend=function(){var t=n.result;g.buffers[0].uri=t,e(g)}}else e(g)}))}},THREE.GLTFExporter.Utils={insertKeyframe:function(t,e){var i,n=.001,r=t.getValueSize(),a=new t.TimeBufferType(t.times.length+1),o=new t.ValueBufferType(t.values.length+r),s=t.createInterpolant(new t.ValueBufferType(r));if(0===t.times.length){a[0]=e;for(var l=0;l<r;l++)o[l]=0;i=0}else if(e<t.times[0]){if(Math.abs(t.times[0]-e)<n)return 0;a[0]=e,a.set(t.times,1),o.set(s.evaluate(e),0),o.set(t.values,r),i=0}else if(e>t.times[t.times.length-1]){if(Math.abs(t.times[t.times.length-1]-e)<n)return t.times.length-1;a[a.length-1]=e,a.set(t.times,0),o.set(t.values,0),o.set(s.evaluate(e),t.values.length),i=a.length-1}else for(l=0;l<t.times.length;l++){if(Math.abs(t.times[l]-e)<n)return l;if(t.times[l]<e&&t.times[l+1]>e){a.set(t.times.slice(0,l+1),0),a[l+1]=e,a.set(t.times.slice(l+1),l+2),o.set(t.values.slice(0,(l+1)*r),0),o.set(s.evaluate(e),(l+1)*r),o.set(t.values.slice((l+1)*r),(l+2)*r),i=l+1;break}}return t.times=a,t.values=o,i},mergeMorphTargetTracks:function(t,e){for(var i=[],n={},r=t.tracks,a=0;a<r.length;++a){var o=r[a],s=THREE.PropertyBinding.parseTrackName(o.name),l=THREE.PropertyBinding.findNode(e,s.nodeName);if("morphTargetInfluences"===s.propertyName&&void 0!==s.propertyIndex){if(o.createInterpolant!==o.InterpolantFactoryMethodDiscrete&&o.createInterpolant!==o.InterpolantFactoryMethodLinear){if(o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline)throw new Error("THREE.GLTFExporter: Cannot merge tracks with glTF CUBICSPLINE interpolation.");console.warn("THREE.GLTFExporter: Morph target interpolation mode not yet supported. Using LINEAR instead."),(o=o.clone()).setInterpolation(THREE.InterpolateLinear)}var c,u=l.morphTargetInfluences.length,h=l.morphTargetDictionary[s.propertyIndex];if(void 0===h&&(h=parseInt(s.propertyIndex),console.warn("Using",s.propertyIndex,"as target index")),void 0!==n[l.uuid]){var d=o.createInterpolant(new o.ValueBufferType(1));c=n[l.uuid];for(m=0;m<c.times.length;m++)c.values[m*u+h]=d.evaluate(c.times[m]);for(m=0;m<o.times.length;m++){var p=this.insertKeyframe(c,o.times[m]);c.values[p*u+h]=o.values[m]}}else{for(var f=new((c=o.clone()).ValueBufferType)(u*c.times.length),m=0;m<c.times.length;m++)f[m*u+h]=c.values[m];c.name=".morphTargetInfluences",c.values=f,n[l.uuid]=c,i.push(c)}}else i.push(o)}return t.tracks=i,t}}},function(t,e){t.exports="#version 100\nprecision mediump float;\nuniform sampler2D u_input;\nuniform sampler2D u_roughness;\nvarying vec2 vUv;\n#define u_metalness u_input\nvoid main() {\n\tvec4 metalness = texture2D(u_metalness, vUv);\n\tvec4 roughness = texture2D(u_roughness, vUv);\n\tgl_FragColor = vec4(1.0, roughness.g, metalness.b, 1.0);\n}\n"},function(t,e,i){AFRAME.registerComponent("scalable-raycaster",{dependencies:["raycaster"],init(){new THREE.Vector3;let t=this.el.components.raycaster.updateOriginDirection;this.el.components.raycaster.updateOriginDirection=AFRAME.utils.bind((function(){t.call(this);let e=this.data;var i=this.raycaster;i.far=e.far,i.near=e.near,this.unitLineEndVec3.copy(e.origin).add(e.direction).normalize()}),this.el.components.raycaster)}}),AFRAME.registerComponent("raycaster-layers",{dependencies:["raycaster"],schema:{layers:{type:"array",default:["default"]}},init(){this.system=this.el.sceneEl.systems["camera-layers"]},update(t){let e=this.el.components.raycaster.raycaster.layers;e.mask=0;for(let t of this.data.layers){let i=parseInt(t);if(isNaN(i)&&(i=this.system.camera_layers[t],isNaN(i)))return void console.error("No such layer",i,t);e.enable(i)}}})},function(t,e,i){"use strict";i.r(e);var n=i(3),r=i(0),a=i(4),o=i(6),s=i(178),l=i.n(s),c=i(2);AFRAME.registerSystem("camera-layers",{init(){this.CAMERA_LAYERS=c.CAMERA_LAYERS,this.camera_layers={};for(let[t,e]of Object.entries(c.CAMERA_LAYERS))this.camera_layers[t.toLowerCase().replace(/\_/g,"-")]=e;r.Util.whenLoaded(this.el,(()=>{this.el.sceneEl.camera.layers.enable(c.CAMERA_LAYERS.LEFT_EYE)}))}}),AFRAME.registerComponent("camera-layers",{schema:{layers:{type:"array",default:["default"]},throttle:{default:500}},events:{object3dset:function(){this.refresh()},"child-attached":function(){this.refresh()}},update(t){this.data.tick<0?this.tick=function(){}:this.tick=AFRAME.utils.throttleTick(this.refresh,this.data.tick,this);let e=this.el.object3D.layers;e.mask=0;for(let t of this.data.layers){let i=parseInt(t);if(isNaN(i)&&(i=this.system.camera_layers[t],isNaN(i)))return void console.error("No such layer",i,t);e.enable(i)}this.refresh()},refresh(){this.el.object3D.traverse((t=>{t.layers.mask=this.el.object3D.layers.mask}))},tick(t,e){this.refresh()}}),AFRAME.registerSystem("camera-capture",{getTempCanvas(){let{width:t,height:e}=Compositor.component;return this.tempCanvas?(this.tempCanvas.width===t&&this.tempCanvas.height===e||(this.tempCanvas.width=t,this.tempCanvas.height=e),this.tempCanvas):(this.tempCanvas=document.createElement("canvas"),this.tempCanvas.width=t,this.tempCanvas.height=e,this.tempCanvas)},getTargetTempCanvas(){let{width:t,height:e}=Compositor.component;return t*=3,e*=3,this.targetTempCanvas?(this.targetTempCanvas.width===t&&this.targetTempCanvas.height===e||(this.targetTempCanvas.width=t,this.targetTempCanvas.height=e),this.targetTempCanvas):(this.targetTempCanvas=document.createElement("canvas"),this.targetTempCanvas.width=t,this.targetTempCanvas.height=e,this.targetTempCanvas)},captureToCanvas(t,e){e||(e=this.getTempCanvas()).getContext("2d").clearRect(0,0,e.width,e.height);let i=this.el.sceneEl.renderer,n=i.xr.enabled;i.xr.enabled=!1;let r=i.getRenderTarget(),{width:a,height:o}=e,s=this.getTargetTempCanvas(),l=new THREE.WebGLRenderTarget(s.width,s.height);l.texture.encoding=i.outputEncoding,i.setRenderTarget(l);let c=s.getContext("2d");i.render(this.el.sceneEl.object3D,t);let u=c.getImageData(0,0,s.width,s.height);i.readRenderTargetPixels(l,0,0,s.width,s.height,u.data),c.putImageData(u,0,0);let h=e.getContext("2d");return h.translate(0,e.height),h.scale(1,-1),h.drawImage(s,0,0,e.width,e.height),h.scale(1,-1),h.translate(0,-e.height),i.xr.enabled=n,i.setRenderTarget(r),l.dispose(),e},capturePixelData(t,{data:e,width:i,height:n}){let r=this.el.sceneEl.renderer,a=r.xr.enabled;r.xr.enabled=!1;let o=r.getRenderTarget(),s=(this.getTargetTempCanvas(),new THREE.WebGLRenderTarget(i,n));e||(e=new Uint8Array(4*i*n)),s.texture.encoding=r.outputEncoding,r.setRenderTarget(s),r.render(this.el.sceneEl.object3D,t);let l=r.getContext();return l.readPixels(0,0,i,n,l.RGBA,l.UNSIGNED_BYTE,e),r.xr.enabled=a,r.setRenderTarget(o),s.dispose(),e},raytraceToCanvas(t,e){e||(e=this.getTempCanvas()).getContext("2d").clearRect(0,0,e.width,e.height);let i=this.el.sceneEl.renderer,n=i.xr.enabled;i.xr.enabled=!1;let a=i.getRenderTarget(),{width:o,height:s}=e,l=this.getTargetTempCanvas(),c=new THREE.WebGLRenderTarget(l.width,l.height);c.texture.encoding=i.outputEncoding,i.setRenderTarget(c);let u=l.getContext("2d"),h=document.createElement("canvas");h.width=640,h.height=480;let d=new RayTracingRenderer({canvas:h});d.setSize(640,480),d.sync(this.el.sceneEl.time),d.renderWhenOffFocus=!0,d.maxHardwareUsage=!0,d.needsUpdate=!0,d.onSampleRendered=(t,e)=>{console.log("Sample Rendered!!",t,e),r.Util.debugCanvas(d.domElement)};try{let e;e=window.setInterval((()=>{let i=new Map;this.el.sceneEl.object3D.traverse((t=>{t.material&&"MeshStandardMaterial"!==t.material.type&&(t.visible=!1,i.set(t,t.material),t.material=new THREE.MeshStandardMaterial)}));try{let n=console.warn;console.warn=function(){},d.render(this.el.sceneEl.object3D,t),console.warn=n}finally{for(let[t,e]of i.entries())t.visible=!0,t.material=e;d.getTotalSamplesRendered()>128&&(window.clearInterval(e),r.Util.debugCanvas(d.domElement))}}),10),window.tracer=d}catch(t){return void console.error(t)}u.drawImage(d.domElement,0,0);let p=u.getImageData(0,0,l.width,l.height);i.readRenderTargetPixels(c,0,0,l.width,l.height,p.data),u.putImageData(p,0,0);let f=e.getContext("2d");return f.translate(0,e.height),f.scale(1,-1),f.drawImage(l,0,0,e.width,e.height),f.scale(1,-1),f.translate(0,-e.height),i.xr.enabled=n,i.setRenderTarget(a),c.dispose(),e},capturePanorama(){new l.a(this.el.sceneEl.renderer,!0).update(document.querySelector("#camera").getObject3D("camera"),this.el.sceneEl.object3D)}}),AFRAME.registerComponent("camera-tool",{dependencies:["grab-activate","six-dof-tool"],schema:{orthographic:{default:!1},fov:{default:45},autoCamera:{default:!0},near:{default:.1},far:{default:10},preview:{default:!0},previewThrottle:{default:300},previewLive:{default:!1},aspectAdjust:{default:1},captureType:{oneOf:["overlay","newFrame","newLayer","download","spectator"],default:"overlay"},captureMaterial:{default:!1}},events:{click:function(t){this.data.captureMaterial?this.takeMaterialPicture():this.takePicture()},activate:function(){this.activate()},stateadded:function(t){"grabbed"===t.detail&&(this.el.sceneEl.systems["pencil-tool"].lastGrabbed=this)}},init(){n.Pool.init(this),this.el.classList.add("grab-root"),this.el.classList.add("clickable"),this.el.setAttribute("grab-options","showHand: false");r.Util.whenLoaded([Compositor.el,this.el.sceneEl],(()=>{if(!this.data.autoCamera)return;let{width:t,height:e}=Compositor.el.getAttribute("geometry");Compositor.el.object3D.updateMatrixWorld();let i,n=this.pool("scale",THREE.Vector3);n.setFromMatrixScale(Compositor.el.object3D.matrixWorld),t*=n.x,e*=n.y,this.el.setAttribute("six-dof-tool","orientation",new THREE.Vector3(0,0,1)),i=this.data.orthographic?new THREE.OrthographicCamera(-t/2,t/2,e/2,-e/2,.1,10):new THREE.PerspectiveCamera(this.data.fov,t/e*this.data.aspectAdjust,this.data.near,this.data.far),this.el.object3D.add(i),this.camera=i;let a=document.createElement("a-entity");if(a.setAttribute("gltf-model","#asset-camera-body"),a.setAttribute("scale",`${.3/1.15} ${.3/1.15} ${.3/1.15}`),a.setAttribute("propogate-grab",""),a.setAttribute("position","0 0 "+(-.05-.001)),a.setAttribute("material","src:#asset-shelf; metalness: 0.4; roughness: 0.6"),a.setAttribute("apply-material-to-mesh",""),a.classList.add("clickable"),this.el.append(a),!this.data.orthographic){let t=document.createElement("a-entity");t.setAttribute("lever",`axis: x; valueRange: 0.1 180; initialValue: ${this.data.fov}`),t.addEventListener("anglechanged",(t=>{this.data.fov=t.detail.value,this.camera.fov=t.detail.value,this.camera.updateProjectionMatrix(),this.helper.update()})),t.setAttribute("scale","0.3 0.3 0.3"),t.setAttribute("position","0.14 0 -0.05"),t.setAttribute("tooltip","Adjust Field of View"),t.setAttribute("tooltip-style","rotation: 0 0 0; scale: 0.5 0.5 0.5"),this.el.append(t);let e=document.createElement("a-entity");e.setAttribute("lever",`axis: x; valueRange: 0.1 3; initialValue: ${this.data.aspectAdjust}`),e.addEventListener("anglechanged",(t=>{this.data.aspectAdjust=t.detail.value,this.camera.aspect=Compositor.component.width/Compositor.component.height*t.detail.value,this.camera.updateProjectionMatrix(),this.helper.update()})),e.setAttribute("scale","0.3 0.3 0.3"),e.setAttribute("position","-0.14 0 -0.05"),e.setAttribute("rotation","0 180 0"),e.setAttribute("tooltip","Adjust Aspect Ratio"),e.setAttribute("tooltip-style","rotation: 0 180 0; scale: 0.5 0.5 0.5"),this.el.append(e);let i=document.createElement("a-entity");if(i.setAttribute("lever",`axis: z; valueRange: 10 0.1; initialValue: ${this.data.far}`),10===this.data.far){let t=this.el.sceneEl.camera.far;this.data.far=t,this.camera.far=t,this.camera.updateProjectionMatrix()}i.addEventListener("anglechanged",(t=>{let{value:e}=t.detail;t.detail.percent<=.1&&(e=this.el.sceneEl.camera.far),this.data.far=e,this.camera.far=e,this.camera.updateProjectionMatrix(),this.helper.update()})),i.setAttribute("scale","0.3 0.3 0.3"),i.setAttribute("position","0.1 0 -0.0"),i.setAttribute("tooltip","Adjust Far Plane"),i.setAttribute("tooltip-style","rotation: 0 0 0; scale: 0.5 0.5 0.5"),this.el.append(i),this.el.components["six-dof-tool"]&&this.el.components["six-dof-tool"].data.lockedClone&&(this.el.addState("grab-activated"),this.el.removeAttribute("summonable"),r.Util.whenLoaded(this.el,(()=>this.activate())))}Compositor.el.addEventListener("resized",(t=>{if(!this.data.autoCamera)return;let{width:e,height:i}=t.detail;this.camera.aspect=Compositor.component.width/Compositor.component.height*this.data.aspectAdjust,this.camera.updateProjectionMatrix(),this.helper&&this.helper.update()}))})),this.tick=AFRAME.utils.throttleTick(this.tick,this.data.previewThrottle,this)},update(t){this.data.captureType!==t.captureType&&"spectator"===this.data.captureType&&this.toggleSpectator()},takePicture(){if(console.log("Taking picture"),"spectator"===this.data.captureType)return;let t;if("newLayer"===this.data.captureType?Compositor.component.addLayer():"newFrame"===this.data.captureType&&Compositor.component.addFrameAfter(),"download"===this.data.captureType?(t=document.createElement("canvas"),t.width=Compositor.component.width,t.height=Compositor.component.height):(t=Compositor.component.activeLayer.frame(Compositor.component.currentFrame),a.Undo.pushCanvas(t)),this.el.sceneEl.emit("startsnap",{source:this.el}),this.helper.visible=!1,this.el.sceneEl.systems["camera-capture"].captureToCanvas(this.camera,t),Compositor.component.activeLayer.touch(),this.helper.visible=!0,this.el.sceneEl.emit("endsnap",{source:this.el}),"download"===this.data.captureType){let e=this.el.sceneEl.systems["settings-system"];e.download(t.toDataURL(e.imageURLType(),e.compressionQuality()),{extension:e.imageExtension(),suffix:"snapshot"},"Snapshot")}},takeMaterialPicture(){let t=Compositor.component.activeLayer,e=new Map,i=new Map;this.el.sceneEl.object3D.traverseVisible((t=>{!t.material||"MeshBasicMaterial"!==t.material.type&&"MeshStandardMaterial"!==t.material.type&&"MeshMatcapMaterial"!==t.material.type?t.material&&i.set(t,t.material):e.set(t,t.material)}));for(let[t,i]of e.entries())t.material=new THREE.MeshBasicMaterial({color:i.color,map:i.map,side:i.side,transparent:i.transparent,opacity:i.opacity,clippingPlanes:this.el.sceneEl.systems["mesh-clipping"]?this.el.sceneEl.systems["mesh-clipping"].clippingPlanes:[]});this.takePicture();for(let t of i.keys())t.visible=!1;const n=[{map:"metalnessMap",value:"metalness"},{map:"roughnessMap",value:"roughness"},{map:"normalMap",value:"normalScale"}];for(let{map:t,value:i}of n){let n=Compositor.component.layers.find((e=>e.mode===t));n||(n=new o.Layer(Compositor.component.width,Compositor.component.height),Compositor.component.addLayer(0,{layer:n}),Compositor.component.setLayerBlendMode(n,t)),Compositor.component.activateLayer(n),r.Util.fillDefaultCanvasForMap(n.frame(Compositor.component.currentFrame),t,{replace:!this.keepExistingMaterials});for(let[n,r]of e.entries())n.material="normalMap"===t?new THREE.MeshNormalMaterial({normalMap:r.normalMap||null,normalMapType:r.normalMapType,normalScale:r.normalScale,side:r.side,transparent:r.transparent,clippingPlanes:this.el.sceneEl.systems["mesh-clipping"]?this.el.sceneEl.systems["mesh-clipping"].clippingPlanes:[]}):new THREE.MeshBasicMaterial({color:new THREE.Color(r[i],r[i],r[i]),map:r[t],side:r.side,transparent:r.transparent,opacity:r.opacity,visible:"MeshStandardMaterial"===r.type,clippingPlanes:this.el.sceneEl.systems["mesh-clipping"]?this.el.sceneEl.systems["mesh-clipping"].clippingPlanes:[]});this.keepExistingMaterials&&"normalMap"===t&&this.el.sceneEl.systems["canvas-fx"].applyFX("swizzle"),this.takePicture(),"normalMap"===t&&this.el.sceneEl.systems["canvas-fx"].applyFX("swizzle"),n.touch()}for(let[t,i]of e.entries())t.material=i;for(let t of i.keys())t.visible=!0;Compositor.component.activateLayer(t)},activate(){var t=new THREE.CameraHelper(this.camera);if(this.helper=t,this.el.sceneEl.object3D.add(t),this.helper.layers.disable(0),this.helper.layers.enable(c.CAMERA_LAYERS.LEFT_EYE),this.helper.layers.enable(c.CAMERA_LAYERS.RIGHT_EYE),this.helper.traverse((t=>{t.layers.disable(0),t.layers.enable(c.CAMERA_LAYERS.LEFT_EYE),t.layers.enable(c.CAMERA_LAYERS.RIGHT_EYE)})),(this.el.hasAttribute("action-tooltips")&&this.el.getAttribute("action-tooltips").trigger||"Summon ").startsWith("Summon")&&this.el.setAttribute("action-tooltips","trigger: Take Picture"),this.data.autoCamera&&this.data.preview&&!this.preview){let t=.3,e=document.createElement("a-entity");this.data.orthographic?e.setAttribute("geometry",`primitive: plane; width: ${t}; height: ${t/(this.camera.right-this.camera.left)*(this.camera.top-this.camera.bottom)}`):e.setAttribute("geometry",`primitive: plane; width: ${t}; height: ${t/this.camera.aspect}`),e.setAttribute("position",`0 -${t/2} 0`),e.setAttribute("frame","closable: false; pinnable: false");let i=new THREE.WebGLRenderTarget(256,Math.round(256*this.camera.aspect));this.previewTarget=i,this.preview=e,e.setAttribute("material",{npot:!0,side:"double"}),this.el.append(e)}if(this.data.autoCamera){let t=document.createElement("a-entity");t.setAttribute("icon-row",""),t.setAttribute("scale","0.1 0.1 0.1"),t.setAttribute("position","-0.11 0 -0.01"),t.addEventListener("click",(function(t){return t.stopPropagation(),t.preventDefault(),!0})),this.el.append(t);for(let[e,i,n]of[["#asset-brush","overlay","Overlay Current Layer"],["#asset-plus-box-outline","newLayer","New Layer On Capture"],["#asset-arrow-right","newFrame","New Frame On Capture"],["#asset-floppy","download","Download Snapshot"],["#asset-camera","spectator","Spectator Camera"]]){let r=document.createElement("a-entity");t.append(r),r.setAttribute("icon-button",e),r.setAttribute("radio-button",{target:this.el,component:"camera-tool",property:"captureType",value:i}),r.setAttribute("tooltip",n)}t=document.createElement("a-entity"),this.el.append(t),t.setAttribute("scale","0.1 0.1 0.1"),t.setAttribute("position","-0.11 -0.05 -0.01"),t.addEventListener("click",(function(t){return t.stopPropagation(),t.preventDefault(),!0}));let e=document.createElement("a-entity");t.append(e),e.setAttribute("icon-button","#asset-brightness-4"),e.setAttribute("tooltip","Capture Material Textures"),e.setAttribute("toggle-button",{target:this.el,component:"camera-tool",property:"captureMaterial"}),e=document.createElement("a-entity"),t.append(e),e.setAttribute("icon-button","#asset-play-pause"),e.setAttribute("tooltip","Update preview live"),e.setAttribute("toggle-button",{target:this.el,component:"camera-tool",property:"previewLive"}),this.camera.layers.enable(c.CAMERA_LAYERS.SPECTATOR)}this.activate=function(){},this.el.components["six-dof-tool"]&&!this.el.components["six-dof-tool"].data.lockedComponent&&(this.el.components["six-dof-tool"].data.lockedClone=!0,this.el.components["six-dof-tool"].data.lockedComponent="camera-tool",this.el.components["six-dof-tool"].data.lockedComponentDependencies=["manipulator-weight"],console.log("Setting camera locked component",this.el.components["six-dof-tool"].data))},createLockedClone(){let t=document.createElement("a-entity");t.setAttribute("camera-tool",this.el.getAttribute("camera-tool")),t.setAttribute("six-dof-tool",{lockedClone:!0,lockedComponent:"camera-tool"}),this.el.parentEl.append(t),r.Util.whenLoaded(t,(()=>{r.Util.positionObject3DAtTarget(t.object3D,this.el.object3D)}))},toggleSpectator(){let t=this.el.sceneEl.systems["spectator-camera"];this.camera.layers.enable(c.CAMERA_LAYERS.SPECTATOR),t.data.camera=this.camera,t.data.state=d},tick(t,e){if(!this.preview)return;if(!(this.el.is("grabbed")||this.el.is("cursor-hovered")||this.data.previewLive))return;if(!this.preview.components.material)return;this.el.sceneEl.emit("startsnap",{source:this.el}),this.helper.visible=!1;let i=this.el.sceneEl.renderer,n=i.xr.enabled;i.xr.enabled=!1;let r=i.getRenderTarget(),a=this.previewTarget;this.preview.components.material&&this.preview.components.material.material&&(this.preview.components.material.material.map=null),a.texture.encoding=i.outputEncoding,i.setRenderTarget(a),i.render(this.el.sceneEl.object3D,this.camera),this.preview.components.material.material.map=a,this.preview.components.material.material.needsUpdate=!0,i.xr.enabled=n,i.setRenderTarget(r),this.helper.visible=!0,this.el.sceneEl.emit("endsnap",{source:this.el}),this.preview.getObject3D("mesh").material.map.needsUpdate=!0}}),AFRAME.registerSystem("spray-can-tool",{init(){this.dilateProc=new CanvasShaderProcessor({fx:"dilate"})},setSprayResolution(t,e){this.el.sceneEl.querySelectorAll("*[spray-can-tool]").forEach((i=>{i.getAttribute("spray-can-tool").locked||i.setAttribute("spray-can-tool","canvasSize",`${t} ${e}`)}))},setSprayResolutionLow(){this.setSprayResolution(24,24)},setSprayResolutionMedium(){this.setSprayResolution(64,64)},setSprayResolutionHigh(){this.setSprayResolution(256,256)},setSprayResolutionCanvas(){this.setSprayResolution(Compositor.component.width,Compositor.component.height)}}),AFRAME.registerComponent("spray-can-tool",{dependencies:["camera-tool"],schema:{locked:{default:!1},projector:{default:!1},materialProjector:{default:!1},canvasSize:{type:"vec2",default:{x:64,y:64}},autoDilate:{default:!0},orthographic:{default:!1},brush:{default:void 0,type:"string",parse:t=>t},paintSystemData:{default:void 0,type:"string",parse:t=>t},lockedColor:{type:"color"}},events:{stateadded:function(t){"grabbed"===t.detail&&(this.el.sceneEl.systems["pencil-tool"].lastGrabbed=this,this.updateBrushSize())}},init(){n.Pool.init(this),this.el.setAttribute("camera-tool",{autoCamera:!1,orthographic:this.data.orthographic}),this.takePicture=this.takePicture.bind(this.el.components["camera-tool"]),this.el.components["camera-tool"].takePicture=this.takePicture,this.el.setAttribute("action-tooltips","trigger: Spray Paint"),this.el.setAttribute("six-dof-tool","orientation",new THREE.Vector3(0,0,1)),function(t){this.cameraCanvas=document.createElement("canvas"),this.cameraCanvas.width=t.data.canvasSize.x,this.cameraCanvas.height=t.data.canvasSize.y,this.targetCanvas=document.createElement("canvas"),this.targetCanvas.width=1024,this.targetCanvas.height=512,this.sprayCanTool=t;let e=this.data.orthographic?new THREE.OrthographicCamera(-.5,.5,.5,-.5,.1,1):new THREE.PerspectiveCamera(5,1,.1,1);e.layers.set(c.CAMERA_LAYERS.SPRAY_PAINT_MASK),this.el.object3D.add(e),this.camera=e;let i=document.createElement("a-cylinder");i.setAttribute("radius",.1),i.setAttribute("height",.3),i.setAttribute("propogate-grab",""),i.setAttribute("segments-radial",10),i.setAttribute("segments-height",1),i.setAttribute("position","0 -.17 "+(-.05-.001)),i.setAttribute("material","src:#asset-shelf; metalness: 0.7; side: double"),i.classList.add("clickable"),this.el.append(i),this.captureToCanvas=t.captureToCanvas,t.updateBrushSize=t.updateBrushSize.bind(this),this.updateBrushSize=t.updateBrushSize,this.keepExistingMaterials=!0,this.wasDrawing=!1,this.el.sceneEl.addEventListener("brushscalechanged",(()=>{this.savedBrush=void 0,this.el.is("grabbed")&&this.updateBrushSize()}))}.call(this.el.components["camera-tool"],this),this.tick=AFRAME.utils.throttleTick(this.tick,50,this)},update(t){(function(e){let i=!1;this.data.projector=e.data.projector,this.data.materialProjector=e.data.materialProjector,this.data.projector&&(this.data.near=.2),t.canvasSize&&(!e.data.canvasSize||e.data.canvasSize.x===t.canvasSize.x&&e.data.canvasSize.y===t.canvasSize.y)||(this.cameraCanvas.width=e.data.canvasSize.x,this.cameraCanvas.height=e.data.canvasSize.y,delete this.buffer,delete this.savedBrush,delete this.newTarget,i=!0),this.data.projector!==t.projector&&this.data.projector&&!this.projectorCanvas&&(this.projectorCanvas=document.createElement("canvas"),i=!0),i&&this.projectorCanvas&&(this.projectorCanvas.width=this.cameraCanvas.width,this.projectorCanvas.height=this.cameraCanvas.height,this.projectorData=this.projectorCanvas.getContext("2d").getImageData(0,0,this.projectorCanvas.width,this.projectorCanvas.height))}).call(this.el.components["camera-tool"],this)},updateBrushSize(){let t=this.sprayCanTool.data.locked?this.sprayCanTool.brush:this.el.sceneEl.systems["paint-system"].brush;if(this.savedBrush!=t){if(this.savedBrush=t,!t.overlayCanvas)return console.error("Cannot spray paint brush with no canvas"),delete this.savedBrush,!1;if(this.brushData=t.overlayCanvas.getContext("2d").getImageData(0,0,t.width,t.height),this.data.orthographic){const e=.1;this.camera.left=-t.width/t.baseWidth/2*e,this.camera.right=-this.camera.left,this.camera.top=t.height/t.baseHeight/2*e,this.camera.bottom=-this.camera.top,this.camera.near=this.data.near}else this.camera.fov=5*t.width/t.baseWidth,this.camera.aspect=t.width/t.height,this.camera.near=this.data.near;this.camera.updateProjectionMatrix(),this.helper.update()}return!0},captureToCanvas(t,e,i){let n=this.el.sceneEl.renderer,r=n.xr.enabled;n.xr.enabled=!1;let a=n.getRenderTarget(),{width:o,height:s}=e;this.newTarget||(this.newTarget=new THREE.WebGLRenderTarget(o,s));let l=this.newTarget;return l.texture.encoding=n.outputEncoding,n.setRenderTarget(l),n.render(this.el.sceneEl.object3D,t),n.readRenderTargetPixels(l,0,0,o,s,i.data),n.xr.enabled=r,n.setRenderTarget(a),i},takePicture(){Date.now();this.helper.visible=!1;let t=this.sprayCanTool.data.locked?this.sprayCanTool.brush:this.el.sceneEl.systems["paint-system"].brush,e=(t.color3,Compositor.material),n=this.shaderMaterial;n||(this.shaderMaterial=new THREE.ShaderMaterial({fragmentShader:i(366).default,vertexShader:i(27),clipping:!0,clippingPlanes:this.el.sceneEl.systems["mesh-clipping"]?this.el.sceneEl.systems["mesh-clipping"].clippingPlanes:[]}),n=this.shaderMaterial),n.side=e.side,Compositor.meshRoot.traverse((t=>{"Mesh"!==t.type&&"SkinnedMesh"!==t.type||(t.material=n,t.layers.enable(c.CAMERA_LAYERS.SPRAY_PAINT_MASK))})),this.data.projector&&(document.getElementById("world-root").object3D.traverse((t=>{"Mesh"!==t.type&&"SkinnedMesh"!==t.type||t.layers.test(this.camera.layers)||t.layers.enable(c.CAMERA_LAYERS.PROJECTOR_MASK)})),this.data.materialProjector&&Compositor.meshRoot.traverse((t=>{"Mesh"!==t.type&&"SkinnedMesh"!==t.type||(t.material=n,t.layers.disable(c.CAMERA_LAYERS.PROJECTOR_MASK))})));let r=this.cameraCanvas;this.buffer||(this.buffer=this.cameraCanvas.getContext("2d").getImageData(0,0,this.cameraCanvas.width,this.cameraCanvas.height));let a,o=this.captureToCanvas(this.camera,this.cameraCanvas,this.buffer),s=this.targetCanvas,l=Compositor.component.activeLayer.frame(Compositor.component.currentFrame);Compositor.meshRoot.traverse((t=>{"Mesh"!==t.type&&"SkinnedMesh"!==t.type||(t.material=e)})),this.data.projector&&(this.camera.layers.set(c.CAMERA_LAYERS.PROJECTOR_MASK),a=this.captureToCanvas(this.camera,this.projectorCanvas,this.projectorData).data,this.camera.layers.set(c.CAMERA_LAYERS.SPRAY_PAINT_MASK)),s.width===l.width&&s.height===l.height||(console.log("Resizing target canvas"),s.width=l.width,s.height=l.height),this.targetContext||(this.targetContext=s.getContext("2d"));let{targetContext:u}=this;this.targetData||(this.targetData=u.getImageData(0,0,s.width,s.height));let h=this.targetData;if(!this.updateBrushSize())return;let d=this.brushData;var p,f,m,g,y,b,A,v,w,E,_,x,T,M;let C=Compositor.component.data.flipY;this.touchedPixels||(this.touchedPixels={});let k=this.touchedPixels,R=2*Math.PI*Math.random(),S=this.pool("projectorColor",THREE.Color);for(f=0;f<r.height;f++)for(p=0;p<r.width;p++){if(m=o.data[4*(f*r.width+p)+0],g=o.data[4*(f*r.width+p)+1],y=o.data[4*(f*r.width+p)+2],b=o.data[4*(f*r.width+p)+3],t.autoRotate){if(A=p/r.width-.5,v=f/r.height-.5,T=Math.sqrt(A*A+v*v),M=Math.atan2(v,A),M-=R,A=Math.floor((T*Math.cos(M)+.5)*t.width),v=Math.floor((T*Math.sin(M)+.5)*t.height),A>t.width||A<0||v>t.height||v<0)continue}else A=Math.floor(p/r.width*t.width),v=Math.floor(f/r.height*t.height);w=(256*((240&y)>>4)+m)/4096,E=(256*(15&y)+g)/4096,E=C?1-E:E,_=Math.round(w*s.width),k[4*((x=Math.round(E*s.height))*s.width+_)]=!0,this.data.projector?(S.setRGB(a[4*(f*r.width+p)+0]/255,a[4*(f*r.width+p)+1]/255,a[4*(f*r.width+p)+2]/255),h.data[4*(x*s.width+_)+0]=Math.round(255*S.r),h.data[4*(x*s.width+_)+1]=Math.round(255*S.g),h.data[4*(x*s.width+_)+2]=Math.round(255*S.b),h.data[4*(x*s.width+_)+3]+=d.data[4*(v*t.overlayCanvas.width+A)+3]*a[4*(f*r.width+p)+3]/255):(h.data[4*(x*s.width+_)+0]=255*t.color3.r,h.data[4*(x*s.width+_)+1]=255*t.color3.g,h.data[4*(x*s.width+_)+2]=255*t.color3.b,h.data[4*(x*s.width+_)+3]+=d.data[4*(v*t.overlayCanvas.width+A)+3]*b/255)}u.putImageData(h,0,0),this.sprayCanTool.data.autoDilate&&(this.sprayCanTool.system.dilateProc.setInputCanvas(u.canvas),this.sprayCanTool.system.dilateProc.update(),s=this.sprayCanTool.system.dilateProc.canvas);let D,O=l.getContext("2d"),P=O.globalAlpha;if(O.globalAlpha=t.opacity,O.drawImage(s,0,0),O.globalAlpha=P,Compositor.component.activeLayer.touch(),this.data.projector)for(D in this.touchedPixels)D=parseInt(D),a[D+0]=0,a[D+1]=0,a[D+2]=0,a[D+3]=0;for(D in this.touchedPixels)D=parseInt(D),h.data[D+0]=0,h.data[D+1]=0,h.data[D+2]=0,h.data[D+3]=0,delete this.touchedPixels[D];this.helper.visible=!0},tick(t,e){let i=this.wasDrawing;this.wasDrawing=!1,this.el.components["camera-tool"].helper&&this.el.is("grabbed")&&this.el.grabbingManipulator&&(this.el.grabbingManipulator.el.hasAttribute("mouse-manipulator")||this.el.grabbingManipulator.el.components["hand-draw-tool"].isDrawing)&&(i||a.Undo.pushCanvas(Compositor.drawableCanvas),this.data.materialProjector?this.el.components["camera-tool"].takeMaterialPicture():this.takePicture(),this.wasDrawing=!0)},createLockedClone(){let t=document.createElement("a-entity");t.setAttribute("camera-tool",{autoCamera:!1}),this.el.parentEl.append(t),t.setAttribute("spray-can-tool","locked: true"),t.setAttribute("six-dof-tool",{lockedClone:!0,lockedComponent:"spray-can-tool"}),r.Util.whenLoaded(t,(()=>{r.Util.positionObject3DAtTarget(t.object3D,this.el.object3D),t.components["spray-can-tool"].brush=this.el.sceneEl.systems["paint-system"].brush.clone()}))}}),AFRAME.registerComponent("eye-drop-tool",{dependencies:["camera-tool"],schema:{locked:{default:!1}},events:{stateadded:function(t){}},init(){n.Pool.init(this),this.el.setAttribute("camera-tool",{autoCamera:!1}),this.takePicture=this.takePicture.bind(this.el.components["camera-tool"]),this.el.components["camera-tool"].takePicture=this.takePicture,function(t){this.cameraCanvas=document.createElement("canvas"),this.cameraCanvas.width=64,this.cameraCanvas.height=64,this.eyeDropTool=t;let e=new THREE.OrthographicCamera(-.035,.035,.035,-.035,.2,1);this.el.object3D.add(e),this.camera=e;let i=document.createElement("a-sphere");i.setAttribute("radius",.07),i.setAttribute("propogate-grab",""),i.setAttribute("segments-radial",8),i.setAttribute("segments-height",8),i.setAttribute("position","0 0 "+(-.05-.001)),i.setAttribute("material","side: double"),i.setAttribute("show-current-color",""),r.Util.whenLoaded(i,(()=>i.setAttribute("material",{shader:"standard"}))),i.classList.add("clickable"),this.el.append(i)}.call(this.el.components["camera-tool"],this),this.tick=AFRAME.utils.throttleTick(this.tick,10,this)},takePicture(){Date.now();console.log("Sampling Color picture"),this.el.sceneEl.emit("startsnap",{source:this.el}),this.helper.visible=!1;let t=64;this.buffer&&16384===this.buffer.length||(this.buffer=new Uint8Array(16384)),this.el.sceneEl.systems["camera-capture"].capturePixelData(this.camera,{data:this.buffer,width:t,height:64});let e=this.buffer,i={r:0,g:0,b:0,alpha:0};for(let n=0;n<64;n++)for(let r=0;r<t;r++)i.r+=e[4*(n*t+r)+0]/255*e[4*(n*t+r)+3]/255,i.g+=e[4*(n*t+r)+1]/255*e[4*(n*t+r)+3]/255,i.b+=e[4*(n*t+r)+2]/255*e[4*(n*t+r)+3]/255,i.alpha+=e[4*(n*t+r)+3]/255;i.alpha>1e-5?(i.r/=i.alpha,i.g/=i.alpha,i.b/=i.alpha):(i.r=0,i.g=0,i.b=0),this.helper.visible=!0,this.el.sceneEl.emit("endsnap",{source:this.el});let n=`rgba(${Math.round(255*i.r)}, ${Math.round(255*i.g)}, ${Math.round(255*i.b)}, 1.0)`;this.el.sceneEl.systems["paint-system"].selectColor(n)},tick(t,e){this.el.components["camera-tool"].helper&&this.el.is("grabbed")&&this.el.grabbingManipulator&&(this.el.grabbingManipulator.el.hasAttribute("mouse-manipulator")||this.el.grabbingManipulator.el.components["hand-draw-tool"].isDrawing)&&this.takePicture()}}),AFRAME.registerComponent("slow-spectator-camera",{dependencies:["grab-activate"],schema:{fps:{default:15}},events:{activate:function(){this.activate()}},init(){},update(){this.tick=AFRAME.utils.throttleTick(this._tick,Math.round(1e3/this.data.fps),this)},activate(){let t=document.createElement("canvas");t.width=256,t.height=256,t.classList.add("spectator-canvas"),document.body.append(t),this.canvas=t;let e=new THREE.PerspectiveCamera(45,2,.1,1e4);this.el.object3D.add(e),this.camera=e;let i=new THREE.WebGLRenderTarget(t.width,t.height);this.renderTarget=i},tick(t,e){},_tick(t,e){this.camera&&this.el.sceneEl.systems["camera-capture"].captureToCanvas(this.camera,this.canvas)}});const[u,h,d]=["SPECTATOR_NONE","SPECTATOR_MIRROR","SPECTATOR_CAMERA"];r.Util.registerComponentSystem("spectator-camera",{schema:{state:{type:"string",default:u,oneOf:[u,d,h]},camera:{type:"selector",default:"#camera"},throttle:{default:20},spectatorCursor:{type:"selector",default:"#mouse"}},events:{"exit-vr":function(t){this.data.spectatorCursor&&this.spectatorCursorOrigin&&(this.spectatorCursorOrigin.add(this.data.spectatorCursor.object3D),this.data.spectatorCursor.sceneEl=this.el.sceneEl)}},init(){n.Pool.init(this),this.gl=this.el.sceneEl.canvas.getContext("webgl2"),this.fakeNotSceneProxy=new Proxy({},{get:(t,e,i)=>"isScene"!==e&&Reflect.get(this.el.sceneEl.object3D,e,i)}),this.lightMap=new Map},update(t){this.tock=AFRAME.utils.throttleTick(this._tock,this.data.throttle,this)},tock(t,e){},_tock(t,e){if(!navigator.xr)return;if(!this.el.sceneEl.renderer.xr)return;if(!this.el.sceneEl.renderer.xr.enabled)return;let i=this.el.sceneEl.renderer.xr.getSession();if(i){if(this.data.state===h){let t=this.el.sceneEl.object3D.autoUpdate,e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,null);let i=this.el.sceneEl.camera;this.el.sceneEl.object3D.autoUpdate=!1,this.el.sceneEl.renderer.render(this.fakeNotSceneProxy,i),this.el.sceneEl.object3D.autoUpdate=t,e.bindFramebuffer(e.FRAMEBUFFER,this.el.sceneEl.renderer.xr.getSession().renderState.baseLayer.framebuffer)}if(this.data.state===d){this.el.sceneEl.object3D.traverseVisible((t=>{t.isLight&&t.shadow&&t.shadow.autoUpdate&&(this.lightMap.set(t,!0),t.shadow.autoUpdate=!1)}));let t=this.el.sceneEl.object3D.autoUpdate,e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,null);let n,r=this.el.sceneEl.renderer;if(n=this.data.state===h?this.el.sceneEl.camera:this.data.camera.isCamera?this.data.camera:this.data.camera.getObject3D("camera"),this.data.spectatorCursor&&!this.spectatorCursorOrigin){console.log("Setting spectatorCursor",n,this.data.spectatorCursor),this.spectatorCursorOrigin=this.data.spectatorCursor.object3D.parent,n.parent.add(this.data.spectatorCursor.object3D);let t=new Proxy(this.el.sceneEl,{get:function(t,e,i){if("camera"==e)return n;let r=Reflect.get(t,e,i);return r.bind&&(r=r.bind(t)),r}});this.data.spectatorCursor.sceneEl=t,this.data.spectatorCursor.setAttribute("raycaster","near",.1)}let a=r.xr.getCamera(n).cameras;if(0===a.length)return;n.far=this.el.sceneEl.camera.far,n.updateProjectionMatrix();let o=this.pool("worldMat",THREE.Matrix4);o.copy(n.matrixWorld);let s=this.pool("projMat",THREE.Matrix4);s.copy(n.projectionMatrix);let l=r.xr.getCamera;r.xr.getCamera=()=>{let t=l(n);return t.cameras=[t.cameras[0]],t.matrix.identity(),t.matrixWorld.copy(o),t.matrixWorldInverse.copy(o).invert(),t.cameras[0].matrixWorld.copy(o),t.cameras[0].matrixWorldInverse.copy(o).invert(),t.cameras[0].layers.enable(c.CAMERA_LAYERS.SPECTATOR),t.cameras[0].layers.disable(c.CAMERA_LAYERS.LEFT_EYE),t.cameras[0].projectionMatrix.copy(s),t.cameras[0].viewport.z=this.el.sceneEl.canvas.width,t.cameras[0].viewport.w=this.el.sceneEl.canvas.height,e.viewport(0,0,t.cameras[0].viewport.z/1,t.cameras[0].viewport.w/1),window.lastViewport=t.cameras[0].viewport,t.layers.enable(c.CAMERA_LAYERS.SPECTATOR),t},this.el.sceneEl.object3D.autoUpdate=!1,this.el.sceneEl.renderer.render(this.fakeNotSceneProxy,n),this.el.sceneEl.object3D.autoUpdate=t,a[0].layers.disable(c.CAMERA_LAYERS.SPECTATOR),a[0].layers.enable(c.CAMERA_LAYERS.LEFT_EYE),r.xr.getCamera=l,r.xr.getCamera(n).cameras=a,e.bindFramebuffer(e.FRAMEBUFFER,i.renderState.baseLayer.framebuffer);for(let t of this.lightMap.keys())t.shadow.autoUpdate=!0;this.lightMap.clear()}}}}),AFRAME.registerComponent("camera-target",{dependencies:["grab-activate","material"],events:{activate:function(t){this.tracking=!0,this.el.setAttribute("camera-layers","layers: left-eye, right-eye; throttle: 2000"),this.cameras=Array.from(document.querySelectorAll("a-entity[camera-tool]")).filter((t=>t.getAttribute("camera-tool").autoCamera))},click:function(t){this.tracking=!this.tracking,this.el.setAttribute("material","color",this.tracking?this.originalColor:"#000")}},init(){this.flipQuaternion=new THREE.Quaternion(0,1,0,0),this.worldPos=new THREE.Vector3,this.originalColor=this.el.getAttribute("material").color,this.el.setAttribute("six-dof-tool","lockedComponent: camera-target")},tick(t,e){if(this.el.is("grab-activated")&&this.tracking){this.el.object3D.getWorldPosition(this.worldPos);for(let t of this.cameras)t.object3D.lookAt(this.worldPos),t.object3D.quaternion.multiply(this.flipQuaternion)}}})},function(t,e,i){"use strict";i.r(e),e.default="/*\nuniform float u_width;\nuniform float u_height;\nuniform sampler2D u_input;\nuniform sampler2D u_source_1; */\nvarying vec2 vUv;\n\n#if NUM_CLIPPING_PLANES > 0\nvarying vec3 vClipPosition;\nuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n\n\nvoid main() {\n  /* gl_FragColor = vec4(vUv.x, vUv.y, 1.0, 1.0) */\n/*\n  int u = int(vUv.x);\n  int v = int(vUv.y); */\n  #if NUM_CLIPPING_PLANES > 0\n  \tvec4 plane;\n  \t#pragma unroll_loop_start\n  \tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n  \t\tplane = clippingPlanes[ i ];\n  \t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n  \t}\n  \t#pragma unroll_loop_end\n  \t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n  \t\tbool clipped = true;\n  \t\t#pragma unroll_loop_start\n  \t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n  \t\t\tplane = clippingPlanes[ i ];\n  \t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n  \t\t}\n  \t\t#pragma unroll_loop_end\n  \t\tif ( clipped ) discard;\n  \t#endif\n  #endif\n\n  float u = floor(vUv.x * 4096.0 + 0.5);\n  float v = floor(vUv.y * 4096.0 + 0.5);\n\n  float fudge = vUv.x >= 0.5 ? 1.0 : 0.0;\n\n  gl_FragColor = vec4(\n      floor(mod(u, 256.0)) / 256.0,\n      floor(mod(v, 256.0)) / 256.0,\n      (floor(u / 256.0) * 16.0 + floor(v / 256.0)) / 256.0 + fudge / 255.0,\n      1.0\n    );\n\n  /* gl_FragColor = vec4(mod(u, 256.0) / 255.0,  floor(u / 256.0) / 255.0, mod(v, 256.0) / 255.0, floor(v / 256.0) / 255.0); */\n}\n"},function(t,e,i){if("undefined"==typeof PHYSX&&i(368),"undefined"==typeof VARTISTE){const{Pool:t}=i(3)}const n={object3DPhysXTransform:(()=>{let t=new THREE.Vector3,e=new THREE.Quaternion;return function(i){return i.getWorldPosition(t),i.getWorldQuaternion(e),{translation:{x:t.x,y:t.y,z:t.z},rotation:{w:e.w,x:e.x,y:e.y,z:e.z}}}})(),matrixToTransform:(()=>{let t=new THREE.Vector3,e=new THREE.Quaternion,i=new THREE.Vector3;new THREE.Matrix4,new THREE.Matrix4;return function(n){return n.decompose(t,e,i),{translation:{x:t.x,y:t.y,z:t.z},rotation:{w:e.w,x:e.x,y:e.y,z:e.z}}}})(),layersToMask:(()=>{let t=new THREE.Layers;return function(e){t.disableAll();for(let i of e)t.enable(parseInt(i));return t.mask}})(),axisArrayToEnums:function(t){let e=[];for(let i of t){if("swing"===i){e.push(r.PxD6Axis.eSWING1),e.push(r.PxD6Axis.eSWING2);continue}let t=`e${i.toUpperCase()}`;t in r.PxD6Axis||console.warn(`Unknown axis ${i} (PxD6Axis::${t})`),e.push(r.PxD6Axis[t])}return e}};let r;AFRAME.registerSystem("physx",{schema:{delay:{default:5e3},throttle:{default:10},autoLoad:{default:!1},speed:{default:1},wasmUrl:{default:""},useDefaultScene:{default:!0},wrapBounds:{default:!1},groundCollisionLayers:{default:[2]},groundCollisionMask:{default:[1,2,3,4]},gravity:{type:"vec3",default:{x:0,y:-9.8,z:0}}},init(){this.PhysXUtil=n,this.objects=new Map,this.shapeMap=new Map,this.jointMap=new Map,this.boundaryShapes=new Set,this.worldHelper=new THREE.Object3D,this.el.object3D.add(this.worldHelper),this.tock=AFRAME.utils.throttleTick(this.tock,this.data.throttle,this),this.collisionObject={thisShape:null,otherShape:null,points:[],impulses:[],otherComponent:null};let t=document.createElement("a-entity");this.el.append(t),this.defaultTarget=t,this.initializePhysX=new Promise(((t,e)=>{this.fulfillPhysXPromise=t})),this.el.addEventListener("inspectortoggle",(t=>{console.log("Inspector toggle",t),!0===t.detail&&(this.running=!1)}))},findWasm(){if(this.data.wasmUrl)return this.data.wasmUrl;let t=i(371);return window.VARTISTE_TOOLKIT_URL?`${window.VARTISTE_TOOLKIT_URL}/${t}`:t},async startPhysX(){this.running=!0;let t,e=this,i=new Promise(((e,i)=>t=e));r=PHYSX({locateFile:t=>t.endsWith(".wasm")?e.findWasm():t,onRuntimeInitialized(){t()}}),r instanceof Promise&&(r=await r),this.PhysX=r,await i,e.startPhysXScene(),e.physXInitialized=!0,e.fulfillPhysXPromise(),e.el.emit("physx-started",{})},startPhysXScene(){console.info("Starting PhysX scene");const t=r.PxCreateFoundation(r.PX_PHYSICS_VERSION,new r.PxDefaultAllocator,new r.PxDefaultErrorCallback);this.foundation=t;const e=r.PxSimulationEventCallback.implement({onContactBegin:(t,e,i,n)=>{let r=this.shapeMap.get(t.$$.ptr),a=this.shapeMap.get(e.$$.ptr);a!==r&&(r&&r.data.emitCollisionEvents&&(this.collisionObject.thisShape=t,this.collisionObject.otherShape=e,this.collisionObject.points=i,this.collisionObject.impulses=n,this.collisionObject.otherComponent=a,r.el.emit("contactbegin",this.collisionObject)),a&&a.data.emitCollisionEvents&&(this.collisionObject.thisShape=e,this.collisionObject.otherShape=t,this.collisionObject.points=i,this.collisionObject.impulses=n,this.collisionObject.otherComponent=r,a.el.emit("contactbegin",this.collisionObject)))},onContactEnd:(t,e)=>{let i=this.shapeMap.get(t.$$.ptr),n=this.shapeMap.get(e.$$.ptr);n!==i&&(i&&i.data.emitCollisionEvents&&(this.collisionObject.thisShape=t,this.collisionObject.otherShape=e,this.collisionObject.points=null,this.collisionObject.impulses=null,this.collisionObject.otherComponent=n,i.el.emit("contactend",this.collisionObject)),n&&n.data.emitCollisionEvents&&(this.collisionObject.thisShape=e,this.collisionObject.otherShape=t,this.collisionObject.points=null,this.collisionObject.impulses=null,this.collisionObject.otherComponent=i,n.el.emit("contactend",this.collisionObject)))},onContactPersist:()=>{},onTriggerBegin:()=>{},onTriggerEnd:()=>{},onConstraintBreak:t=>{let e=this.jointMap.get(t.$$.ptr);e&&e.el.emit("constraintbreak",{})}});let i=new r.PxTolerancesScale;this.physics=r.PxCreatePhysics(r.PX_PHYSICS_VERSION,t,i,!1,null),r.PxInitExtensions(this.physics,null),this.cooking=r.PxCreateCooking(r.PX_PHYSICS_VERSION,t,new r.PxCookingParams(i));const n=r.getDefaultSceneDesc(this.physics.getTolerancesScale(),0,e);this.scene=this.physics.createScene(n),this.setupDefaultEnvironment()},setupDefaultEnvironment(){this.defaultActorFlags=new r.PxShapeFlags(r.PxShapeFlag.eSCENE_QUERY_SHAPE.value|r.PxShapeFlag.eSIMULATION_SHAPE.value),this.defaultFilterData=new r.PxFilterData(n.layersToMask(this.data.groundCollisionLayers),n.layersToMask(this.data.groundCollisionMask),0,0),this.scene.setGravity(this.data.gravity),this.data.useDefaultScene&&(this.createGroundPlane(),this.createBoundingCylinder()),this.defaultTarget.setAttribute("physx-body","type","static")},createGroundPlane(){let t=new r.PxPlaneGeometry,e=this.physics.createMaterial(.8,.8,.1);const i=this.physics.createShape(t,e,!1,this.defaultActorFlags);i.setQueryFilterData(this.defaultFilterData),i.setSimulationFilterData(this.defaultFilterData);let n=this.physics.createRigidStatic({translation:{x:0,y:0,z:-5},rotation:{w:.707107,x:0,y:0,z:.707107}});n.attachShape(i),this.scene.addActor(n,null),this.ground=n,this.rigidBody=n},createBoundingCylinder(){let t=new r.PxPlaneGeometry,e=this.physics.createMaterial(.1,.1,.8),i=new THREE.Spherical;i.radius=30;let n=new THREE.Quaternion,a=new THREE.Vector3,o=new THREE.Euler;for(let r=0;r<16;++r){i.theta=2*r*Math.PI/16,a.setFromSphericalCoords(i.radius,i.theta,i.phi),a.x=-a.y,a.y=0,o.set(0,i.theta,0),n.setFromEuler(o);const s=this.physics.createShape(t,e,!1,this.defaultActorFlags);s.setQueryFilterData(this.defaultFilterData),s.setSimulationFilterData(this.defaultFilterData);const l={translation:{x:a.x,y:a.y,z:a.z},rotation:{w:n.w,x:n.x,y:n.y,z:n.z}};this.boundaryShapes.add(s.$$.ptr);let c=this.physics.createRigidStatic(l);c.attachShape(s),this.scene.addActor(c,null)}},async registerComponentBody(t,{type:e}){await this.initializePhysX;const i=n.object3DPhysXTransform(t.el.object3D);let a;a="dynamic"===e||"kinematic"===e?this.physics.createRigidDynamic(i):this.physics.createRigidStatic(i);let o=!0,s=!1,l=new r.VectorPxReal;for(let e of t.createShapes(this.physics,this.defaultActorFlags))a.attachShape(e),isFinite(e.density)?(s=!0,l.push_back(e.density)):(o=!1,s&&console.warn("Densities not set for all shapes. Will use total mass instead.",t.el));"dynamic"!==e&&"kinematic"!==e||(o&&s?(console.log("Setting density vector",l),a.updateMassAndInertia(l)):a.setMassAndUpdateInertia(t.data.mass)),l.delete(),this.scene.addActor(a,null),this.objects.set(t.el.object3D,a),t.rigidBody=a},registerShape(t,e){this.shapeMap.set(t.$$.ptr,e)},registerJoint(t,e){this.jointMap.set(t.$$.ptr,e)},removeBody(t){let e=t.rigidBody;this.objects.delete(t.el.object3D),e.release()},tock(t,e){if(!(t<this.data.delay)&&(this.physXInitialized||!this.data.autoLoad||this.running||this.startPhysX(),this.physXInitialized&&this.running)){this.scene.simulate(THREE.Math.clamp(e*this.data.speed/1e3,0,.03*this.data.speed),!0),this.scene.fetchResults(!0);for(let[t,e]of this.objects){const i=e.getGlobalPose();this.worldHelper.position.copy(i.translation),this.worldHelper.quaternion.copy(i.rotation),t.getWorldScale(this.worldHelper.scale),VARTISTE.Util.positionObject3DAtTarget(t,this.worldHelper)}}}}),AFRAME.registerComponent("physx-material",{schema:{staticFriction:{default:.2},dynamicFriction:{default:.2},restitution:{default:.2},density:{type:"number",default:NaN},collisionLayers:{default:[1],type:"array"},collidesWithLayers:{default:[1,2,3,4],type:"array"},collisionGroup:{default:0},contactOffset:{default:-1},restOffset:{default:-1}}}),AFRAME.registerComponent("physx-body",{dependencies:["physx-material"],schema:{type:{default:"dynamic",oneOf:["dynamic","static","kinematic"]},mass:{default:1},angularDamping:{default:0},linearDamping:{default:0},emitCollisionEvents:{default:!1},highPrecision:{default:!1},shapeOffset:{type:"vec3",default:{x:0,y:0,z:0}}},events:{stateadded:function(t){"grabbed"===t.detail&&this.rigidBody.setRigidBodyFlag(r.PxRigidBodyFlag.eKINEMATIC,!0)},stateremoved:function(t){"grabbed"===t.detail&&(this.floating&&this.rigidBody.setLinearVelocity({x:0,y:0,z:0},!0),"kinematic"!==this.data.type&&this.rigidBody.setRigidBodyFlag(r.PxRigidBodyFlag.eKINEMATIC,!1))},bbuttonup:function(t){this.toggleGravity()},object3dset:function(t){if(this.rigidBody){for(let t of this.shapes)this.rigidBody.detachShape(t,!1);let t=!0,e=!1,i=new r.VectorPxReal,n=this,a=this.data.type,o=this.rigidBody;for(let r of n.createShapes(this.system.physics,this.system.defaultActorFlags))o.attachShape(r),isFinite(r.density)?(e=!0,i.push_back(r.density)):(t=!1,e&&console.warn("Densities not set for all shapes. Will use total mass instead.",n.el));"dynamic"!==a&&"kinematic"!==a||(t&&e?(console.log("Setting density vector",i),o.updateMassAndInertia(i)):o.setMassAndUpdateInertia(n.data.mass))}},contactbegin:function(t){}},init(){this.system=this.el.sceneEl.systems.physx,this.physxRegisteredPromise=this.system.registerComponentBody(this,{type:this.data.type}),this.el.setAttribute("grab-options","scalable",!1),this.kinematicMove=this.kinematicMove.bind(this),this.el.sceneEl.systems["button-caster"]&&this.el.sceneEl.systems["button-caster"].install(["bbutton"]),this.physxRegisteredPromise.then((()=>this.update()))},update(){this.rigidBody&&"dynamic"===this.data.type&&(this.rigidBody.setAngularDamping(this.data.angularDamping),this.rigidBody.setLinearDamping(this.data.linearDamping),this.data.highPrecision&&(this.rigidBody.setSolverIterationCounts(4,2),this.rigidBody.setRigidBodyFlag(r.PxRigidBodyFlag.eENABLE_CCD,!0)))},remove(){this.system.removeBody(this)},createGeometry(t){if(t.el.hasAttribute("geometry")){let e=t.el.getAttribute("geometry");switch(e.primitive){case"sphere":return new r.PxSphereGeometry(e.radius*this.el.object3D.scale.x*.98);case"box":return new r.PxBoxGeometry(e.width/2,e.height/2,e.depth/2);default:return this.createConvexMeshGeometry(t.el.getObject3D("mesh"))}}},createConvexMeshGeometry(t,e){let i=new r.PxVec3Vector,n=t.geometry.attributes.position;if(!n)return;if(n.count<3)return;if(3!=n.itemSize)return;let a=new THREE.Vector3;if(e){let r=new THREE.Matrix4;t.updateMatrix(),r.copy(t.matrix);let o=t.parent;for(;o&&o!==e;)o.updateMatrix(),r.premultiply(o.matrix),o=o.parent;for(let t=0;t<n.count;++t)a.fromBufferAttribute(n,t),a.applyMatrix4(r),i.push_back(Object.assign({},a))}else for(let t=0;t<n.count;++t)a.fromBufferAttribute(n,t),i.push_back(Object.assign({},a));let o=new THREE.Vector3,s=e||t;s.updateMatrixWorld(),s.getWorldScale(o);let l=this.system.cooking.createConvexMesh(i,this.system.physics);return new r.PxConvexMeshGeometry(l,new r.PxMeshScale({x:o.x,y:o.y,z:o.z},{w:1,x:0,y:0,z:0}),new r.PxConvexMeshGeometryFlags(r.PxConvexMeshGeometryFlag.eTIGHT_BOUNDS.value))},createShape(t,e,i){let a=t.createMaterial(i.staticFriction,i.dynamicFriction,i.restitution),o=t.createShape(e,a,!1,this.system.defaultActorFlags);return o.setQueryFilterData(new r.PxFilterData(n.layersToMask(i.collisionLayers),n.layersToMask(i.collidesWithLayers),i.collisionGroup,0)),o.setSimulationFilterData(new r.PxFilterData(n.layersToMask(i.collisionLayers),n.layersToMask(i.collidesWithLayers),i.collisionGroup,0)),i.contactOffset>=0&&o.setContactOffset(i.contactOffset),i.restOffset>=0&&o.setRestOffset(i.restOffset),o.density=i.density,this.system.registerShape(o,this),o},createShapes(t){if(this.el.hasAttribute("geometry")){let e=this.createGeometry(this.el.object3D);if(!e)return;let i=this.el.components["physx-material"].data;return this.shapes=[this.createShape(t,e,i)],this.shapes}let e=[];return this.el.object3D.traverse((i=>{if((!i.el||!i.el.hasAttribute("physx-no-collision"))&&(!i.el||i.el.object3D.visible||i.el.hasAttribute("physx-hidden-collision"))&&i.geometry){let n,r;if(n=this.createConvexMeshGeometry(i,this.el.object3D),!n)return void console.warn("Couldn't create geometry",i);r=i.el&&i.el.hasAttribute("physx-material")?i.el.getAttribute("physx-material"):this.el.components["physx-material"].data;let a=this.createShape(t,n,r);e.push(a)}})),this.shapes=e,e},toggleGravity(){this.rigidBody.setActorFlag(r.PxActorFlag.eDISABLE_GRAVITY,!this.floating),this.floating=!this.floating},resetBodyPose(){this.rigidBody.setGlobalPose(n.object3DPhysXTransform(this.el.object3D),!0)},kinematicMove(){this.rigidBody.setKinematicTarget(n.object3DPhysXTransform(this.el.object3D))},tock(t,e){this.rigidBody&&"kinematic"===this.data.type&&!this.setKinematic&&(this.rigidBody.setRigidBodyFlag(r.PxRigidBodyFlag.eKINEMATIC,!0),this.setKinematic=!0),this.rigidBody&&("kinematic"===this.data.type||this.el.is("grabbed"))&&this.kinematicMove()}}),AFRAME.registerComponent("physx-joint-driver",{dependencies:["physx-joint"],multiple:!0,schema:{axes:{type:"array",default:[]},stiffness:{default:1},damping:{default:1},forceLimit:{default:34028234663852886e22},useAcceleration:{default:!0},linearVelocity:{type:"vec3",default:{x:0,y:0,z:0}},angularVelocity:{type:"vec3",default:{x:0,y:0,z:0}},lockOtherAxes:{default:!1},slerpRotation:{default:!0}},events:{"physx-jointcreated":function(t){this.setJointDriver()}},init(){this.el.setAttribute("phsyx-custom-constraint","")},setJointDriver(){if(this.enumAxes||this.update(),"D6"!==this.el.components["physx-joint"].data.type)return void console.warn("Only D6 joint drivers supported at the moment");let t=this.el.sceneEl.systems.physx.PhysX;this.joint=this.el.components["physx-joint"].joint,this.data.lockOtherAxes&&(this.joint.setMotion(t.PxD6Axis.eX,t.PxD6Motion.eLOCKED),this.joint.setMotion(t.PxD6Axis.eY,t.PxD6Motion.eLOCKED),this.joint.setMotion(t.PxD6Axis.eZ,t.PxD6Motion.eLOCKED),this.joint.setMotion(t.PxD6Axis.eSWING1,t.PxD6Motion.eLOCKED),this.joint.setMotion(t.PxD6Axis.eSWING2,t.PxD6Motion.eLOCKED),this.joint.setMotion(t.PxD6Axis.eTWIST,t.PxD6Motion.eLOCKED));for(let e of this.enumAxes)this.joint.setMotion(e,t.PxD6Motion.eFREE);let e=new t.PxD6JointDrive;e.stiffness=this.data.stiffness,e.damping=this.data.damping,e.forceLimit=this.data.forceLimit,e.setAccelerationFlag(this.data.useAcceleration);for(let t of this.driveAxes)this.joint.setDrive(t,e);console.log("Setting joint driver",this.driveAxes,this.enumAxes),this.joint.setDrivePosition({translation:{x:0,y:0,z:0},rotation:{w:1,x:0,y:0,z:0}},!0),this.joint.setDriveVelocity(this.data.linearVelocity,this.data.angularVelocity,!0)},update(t){if(r){this.enumAxes=[];for(let t of this.data.axes){if("swing"===t){this.enumAxes.push(r.PxD6Axis.eSWING1),this.enumAxes.push(r.PxD6Axis.eSWING2);continue}let e=`e${t.toUpperCase()}`;e in r.PxD6Axis||console.warn(`Unknown axis ${t} (PxD6Axis::${e})`),this.enumAxes.push(r.PxD6Axis[e])}this.driveAxes=[];for(let t of this.data.axes){if("swing"===t){this.data.slerpRotation?this.driveAxes.push(r.PxD6Drive.eSLERP):this.driveAxes.push(r.PxD6Drive.eSWING);continue}if("twist"===t&&this.data.slerpRotation){this.driveAxes.push(r.PxD6Drive.eSLERP);continue}let e=`e${t.toUpperCase()}`;e in r.PxD6Drive||console.warn(`Unknown axis ${t} (PxD6Axis::${e})`),this.driveAxes.push(r.PxD6Drive[e])}}}}),AFRAME.registerComponent("physx-joint-constraint",{multiple:!0,schema:{lockedAxes:{type:"array",default:[]},constrainedAxes:{type:"array",default:[]},freeAxes:{type:"array",default:[]},linearLimit:{type:"vec2"},limitCone:{type:"vec2"},twistLimit:{type:"vec2"},damping:{default:0},restitution:{default:0},stiffness:{default:0}},events:{"physx-jointcreated":function(t){this.setJointConstraint()}},init(){this.el.setAttribute("phsyx-custom-constraint","")},setJointConstraint(){if("D6"!==this.el.components["physx-joint"].data.type)return void console.warn("Only D6 joint constraints supported at the moment");this.constrainedAxes||this.update();let t=this.el.components["physx-joint"].joint,e=()=>{let t=new r.PxJointLinearLimitPair(new r.PxTolerancesScale,this.data.linearLimit.x,this.data.linearLimit.y);return t.siffness=this.data.stiffness,t.damping=this.data.damping,t.restitution=this.data.restitution,t};for(let e of this.freeAxes)t.setMotion(e,r.PxD6Motion.eFREE);for(let e of this.lockedAxes)t.setMotion(e,r.PxD6Motion.eLOCKED);for(let i of this.constrainedAxes){if(i===r.PxD6Axis.eX||i===r.PxD6Axis.eY||i===r.PxD6Axis.eZ){t.setMotion(i,r.PxD6Motion.eLIMITED),t.setLinearLimit(i,e());continue}if(i===r.eTWIST){t.setMotion(r.PxD6Axis.eTWIST,r.PxD6Motion.eLIMITED);let e=new r.PxJointAngularLimitPair(this.data.limitTwist.x,this.data.limitTwist.y);e.stiffness=this.data.stiffness,e.damping=this.data.damping,e.restitution=this.data.restitution,t.setTwistLimit(e);continue}t.setMotion(i,r.PxD6Motion.eLIMITED);let n=new r.PxJointLimitCone(this.data.limitCone.x,this.data.limitCone.y);n.damping=this.data.damping,n.stiffness=this.data.stiffness,n.restitution=this.data.restitution,t.setSwingLimit(n)}},update(t){r&&(this.constrainedAxes=n.axisArrayToEnums(this.data.constrainedAxes),this.lockedAxes=n.axisArrayToEnums(this.data.lockedAxes),this.freeAxes=n.axisArrayToEnums(this.data.freeAxes))}}),AFRAME.registerComponent("physx-joint",{multiple:!0,schema:{type:{default:"Spherical",oneOf:["Fixed","Spherical","Distance","Revolute","Prismatic","D6"]},target:{type:"selector"},breakForce:{type:"vec2",default:{x:-1,y:-1}},removeElOnBreak:{default:!1},collideWithTarget:{default:!1},softFixed:{default:!1}},events:{constraintbreak:function(t){this.data.removeElOnBreak&&this.el.remove()}},init(){this.system=this.el.sceneEl.systems.physx;let t=this.el;for(;t&&!t.hasAttribute("physx-body");)t=t.parentEl;t?(this.bodyEl=t,this.worldHelper=new THREE.Object3D,this.worldHelperParent=new THREE.Object3D,this.el.sceneEl.object3D.add(this.worldHelperParent),this.targetScale=new THREE.Vector3(1,1,1),this.worldHelperParent.add(this.worldHelper),this.data.target||(this.data.target=this.system.defaultTarget),VARTISTE.Util.whenLoaded([this.el,this.bodyEl,this.data.target],(()=>{this.createJoint()}))):console.warn("physx-joint must be used within a physx-body")},remove(){this.joint&&(this.joint.release(),this.joint=null,this.bodyEl.components["physx-body"].rigidBody.wakeUp(),this.data.target.components["physx-body"].rigidBody.wakeUp&&this.data.target.components["physx-body"].rigidBody.wakeUp())},update(){if(this.joint&&(this.data.breakForce.x>=0&&this.data.breakForce.y>=0&&this.joint.setBreakForce(this.data.breakForce.x,this.data.breakForce.y),this.joint.setConstraintFlag(r.PxConstraintFlag.eCOLLISION_ENABLED,this.data.collideWithTarget),!this.el.hasAttribute("phsyx-custom-constraint")))switch(this.data.type){case"D6":if(this.data.softFixed){this.joint.setMotion(r.PxD6Axis.eX,r.PxD6Motion.eFREE),this.joint.setMotion(r.PxD6Axis.eY,r.PxD6Motion.eFREE),this.joint.setMotion(r.PxD6Axis.eZ,r.PxD6Motion.eFREE),this.joint.setMotion(r.PxD6Axis.eSWING1,r.PxD6Motion.eFREE),this.joint.setMotion(r.PxD6Axis.eSWING2,r.PxD6Motion.eFREE),this.joint.setMotion(r.PxD6Axis.eTWIST,r.PxD6Motion.eFREE);let t=new r.PxD6JointDrive;t.stiffness=1e3,t.damping=500,t.forceLimit=1e3,t.setAccelerationFlag(!1),this.joint.setDrive(r.PxD6Drive.eX,t),this.joint.setDrive(r.PxD6Drive.eY,t),this.joint.setDrive(r.PxD6Drive.eZ,t),this.joint.setDrive(r.PxD6Drive.eSLERP,t),this.joint.setDrivePosition({translation:{x:0,y:0,z:0},rotation:{w:1,x:0,y:0,z:0}},!0),this.joint.setDriveVelocity({x:0,y:0,z:0},{x:0,y:0,z:0},!0)}}},getTransform(t){return VARTISTE.Util.positionObject3DAtTarget(this.worldHelperParent,t.object3D,{scale:this.targetScale}),VARTISTE.Util.positionObject3DAtTarget(this.worldHelper,this.el.object3D,{scale:this.targetScale}),n.matrixToTransform(this.worldHelper.matrix)},async createJoint(){await VARTISTE.Util.whenComponentInitialized(this.bodyEl,"physx-body"),await VARTISTE.Util.whenComponentInitialized(this.data.target,"physx-body"),await this.bodyEl.components["physx-body"].physxRegisteredPromise,await this.data.target.components["physx-body"].physxRegisteredPromise,this.joint&&(this.joint.release(),this.joint=null);let t=this.getTransform(this.bodyEl),e=this.getTransform(this.data.target);this.joint=r[`Px${this.data.type}JointCreate`](this.system.physics,this.bodyEl.components["physx-body"].rigidBody,t,this.data.target.components["physx-body"].rigidBody,e),this.system.registerJoint(this.joint,this),this.update(),this.el.emit("physx-jointcreated",this.joint)}}),AFRAME.registerComponent("dual-wieldable",{schema:{grabbedState:{default:"wielded"}},init(){let t=document.createElement("a-entity");this.el.parentEl.append(t),this.el.hasAttribute("manipulator-weight")&&t.setAttribute("manipulator-weight",this.el.getAttribute("manipulator-weight")),t.setAttribute("dual-wield-target",{target:this.el,grabbedState:this.data.grabbedState}),this.el.setAttribute("redirect-grab",t),this.el.classList.add("grab-root")}}),AFRAME.registerSystem("dual-wield-target",{schema:{movementEvents:{default:["teleported"]}},init(){this.handleMovement=this.handleMovement.bind(this);for(let t of this.data.movementEvents)this.el.addEventListener(t,this.handleMovement)},handleMovement(t){let e=new THREE.Vector3,i=(new THREE.Quaternion,new THREE.Vector3);this.el.querySelectorAll("*[dual-wield-target]").forEach((t=>{if(!t.components)return;let n=t.components["dual-wield-target"];if(!n.data.target.is(n.data.grabbedState))return;let r=n.joints.find((t=>t.is("grabbed")));if(!r)return;let a=r.components["physx-body"].rigidBody.getGlobalPose();e.copy(a.translation),r.object3D.getWorldPosition(i),i.sub(e),console.log("Teleporting diff",i),n.data.target.object3D.position.add(i),n.data.target.components["physx-body"].resetBodyPose()}))}}),AFRAME.registerComponent("dual-wield-target",{schema:{numberOfJoints:{default:2},target:{type:"selector"},wobblySword:{default:!1},grabbedState:{default:"wielded"}},events:{stateadded:function(t){if("grabbed"===t.detail){this.el["redirect-grab"]=this.joints.find((t=>!t.is("grabbed")))||this.nullTarget;let e=VARTISTE.Util.resolveGrabRedirection(t.target);if(e===this.nullTarget)return void console.warn("Used up all dual-wield-targets. not grabbing.");console.log("starting dual grab target for",t,e);e.components["physx-body"].rigidBody;VARTISTE.Util.callLater((()=>{let t=e.grabbingManipulator;console.log("manipulator",t),t.offset.set(0,0,0),VARTISTE.Util.positionObject3DAtTarget(e.object3D,t.endPoint),e.components["physx-body"].resetBodyPose(),e.hasAttribute("manipulator-weight")&&(e.components["manipulator-weight"].lastPos.copy(e.object3D.position),e.components["manipulator-weight"].lastRot.copy(e.object3D.quaternion)),e.setAttribute("physx-joint","type: D6"),this.updateHandParameters()}))}},stateremoved:function(t){if("grabbed"===t.detail){let e=t.target;console.log("Ending dual wield",e),e.removeAttribute("physx-joint"),this.el["redirect-grab"]=this.joints.find((t=>!t.is("grabbed")))||this.nullTarget,this.updateHandParameters()}}},init(){this.jointMap=new Map,this.joints=[];for(let t=0;t<this.data.numberOfJoints;++t){let t=document.createElement("a-entity");this.el.append(t),t.classList.add("dual-wield-joint"),t.setAttribute("physx-material","collidesWithLayers: 0; collisionLayers: 0"),t.setAttribute("physx-body","type: kinematic"),this.el.hasAttribute("manipulator-weight")&&t.setAttribute("manipulator-weight",this.el.getAttribute("manipulator-weight")),this.joints.push(t)}this.el["redirect-grab"]=this.joints[0];let t=document.createElement("a-entity");this.el.append(t),this.nullTarget=t},updateHandParameters(){let t=0;for(let e of this.joints)e.hasAttribute("physx-joint")&&t++;1===t?this.setSingleHandParameters():t>1&&this.setMultiHandParameters(),t>0?this.data.target.addState(this.data.grabbedState):this.data.target.removeState(this.data.grabbedState)},setSingleHandParameters(){for(let t of this.joints)t.hasAttribute("physx-joint")&&(this.data.wobblySword?(t.setAttribute("physx-joint-constraint",{limitCone:{x:.001,y:.001},stiffness:1e3,damping:100,restitution:0,limitTwist:{x:0,y:0}}),t.setAttribute("physx-joint",{type:"D6",target:this.data.target})):t.setAttribute("physx-joint",{type:"D6",target:this.data.target,softFixed:!0,breakForce:{x:10,y:10}}))},setMultiHandParameters(){for(let t of this.joints)t.hasAttribute("physx-joint")&&(this.data.wobblySword?(t.setAttribute("physx-joint-constraint",{limitCone:{x:Math.PI/2,y:Math.PI/2},stiffness:.5,damping:1,restitution:0,limitTwist:{x:-Math.PI/2,y:Math.PI/2}}),t.setAttribute("physx-joint",{type:"D6",target:this.data.target})):t.setAttribute("physx-joint",{type:"D6",target:this.data.target,softFixed:!0}))}}),AFRAME.registerSystem("physx-contact-event",{init(){this.worldHelper=new THREE.Object3D,this.el.sceneEl.object3D.add(this.worldHelper)}}),AFRAME.registerComponent("physx-contact-event",{dependencies:["physx-body"],schema:{impulseThreshold:{default:.01},maxDistance:{default:10},maxDuration:{default:5},startDelay:{default:6e3},positionAtContact:{default:!1}},events:{contactbegin:function(t){if(this.el.sceneEl.time<this.data.startDelay)return;let e=this.eventDetail.positionWorld,i=(this.pool("cameraWorld",THREE.Vector3),t.detail.impulses),n=0;for(let t=0;t<i.size();++t)n+=i.get(t);if(n<this.data.impulseThreshold)return;e.set(0,0,0);let r=0;if(this.data.positionAtContact){for(let n=0;n<i.size();++n){r=i.get(n);let a=t.detail.points.get(n);e.x+=a.x*r,e.y+=a.y*r,e.z+=a.z*r}e.multiplyScalar(1/n),this.system.worldHelper.position.copy(e),VARTISTE.Util.positionObject3DAtTarget(this.localHelper,this.system.worldHelper),this.eventDetail.position.copy(this.localHelper.position)}else e.set(0,0,0),this.eventDetail.position.set(0,0,0);this.eventDetail.impulse=n,this.eventDetail.contact=t.detail,this.el.emit("contactevent",this.eventDetail)}},init(){if(VARTISTE.Pool.init(this),this.eventDetail={impulse:0,positionWorld:new THREE.Vector3,position:new THREE.Vector3,contact:null},this.data.debug){let t=document.createElement("a-entity");t.setAttribute("geometry","primitive: sphere; radius: 0.1"),t.setAttribute("physx-no-collision","")}this.localHelper=new THREE.Object3D,this.el.object3D.add(this.localHelper),this.el.setAttribute("physx-body","emitCollisionEvents",!0)},remove(){this.el.object3D.remove(this.localHelper)}}),AFRAME.registerComponent("physx-contact-sound",{dependencies:["physx-contact-event"],schema:{src:{type:"string"},impulseThreshold:{default:.01},maxDistance:{default:10},maxDuration:{default:5},startDelay:{default:6e3},positionAtContact:{default:!1}},events:{contactevent:function(t){this.data.positionAtContact&&this.sound.object3D.position.copy(t.detail.position),this.sound.components.sound.stopSound(),this.sound.components.sound.playSound()}},init(){let t=document.createElement("a-entity");this.el.append(t),t.setAttribute("sound",{src:this.data.src}),this.sound=t,this.el.setAttribute("physx-body","emitCollisionEvents",!0)},update(t){this.el.setAttribute("physx-contact-event",this.data)}}),AFRAME.registerComponent("gltf-entities",{dependencies:["gltf-model"],schema:{setId:{default:!1},idPrefix:{default:""},autoPropogateGrab:{default:!0},copyAttributes:{type:"array"},allowedAttributes:{type:"array"}},events:{"model-loaded":function(t){this.setupEntities()}},init(){},setupEntities(){let t=this.el.getObject3D("mesh");t&&this.setupObject(t,this.el)},setupObject(t,e){if(t.userData["a-entity"]){let i=document.createElement("a-entity"),n=t.userData["a-entity"];if(i.innerHTML=n,i.innerHTML=`<a-entity ${i.innerText}></a-entity>`,i=i.children[0],this.data.allowedAttributes.length)for(let t of i.attributes)this.data.allowedAttributes.includes(t.name)||i.removeAttribute(t.name);this.data.setId&&t.name&&(i.id=`${this.data.idPrefix}${t.name}`);for(let t of this.data.copyAttributes)this.el.hasAttribute(t)&&i.setAttribute(t,this.el.getAttribute(t));this.data.autoPropogateGrab&&this.el.classList.contains("clickable")&&(i.setAttribute("propogate-grab",""),i.classList.add("clickable")),e.append(i),VARTISTE.Util.whenLoaded(i,(()=>{i.setObject3D("mesh",t),t.updateMatrix(),VARTISTE.Util.applyMatrix(t.matrix,i.object3D),t.matrix.identity(),VARTISTE.Util.applyMatrix(t.matrix,t)})),e=i}for(let i of t.children)this.setupObject(i,e)}}),AFRAME.registerComponent("breakable-bodies",{dependencies:["physx-material"],schema:{autoBody:{default:!1},breakForce:{type:"vec2",default:{x:100,y:100}},breakDelay:{default:6e3}},events:{object3dset:function(t){t.target===this.el&&(this.data.autoBody&&this.setupAutobody(this.el.object3D),this.findTarget(this.el),this.setupJoints(),this.jointTime=this.el.sceneEl.time)}},init(){this.el.setAttribute("physx-material","collisionGroup",Math.round(1e3*Math.random())+1)},findTarget(t){if(t.hasAttribute("physx-body"))return this.target=t,!0;for(let e of t.children)if(this.findTarget(e))return!0;return!1},setupJoints(t){void 0===t&&(t=this.el),t.hasAttribute("physx-body")&&t.setAttribute("physx-joint__breakable",{type:"Fixed",breakForce:this.data.breakDelay<=0?this.data.breakForce:{x:-1,y:-1},target:this.target});for(let e of t.children)this.setupJoints(e)},setupAutobody(t){if("Mesh"===t.type){let e=document.createElement("a-entity");return e.setAttribute("physx-material",this.el.getAttribute("physx-material")),e.setAttribute("physx-body","type: dynamic"),this.el.classList.contains("clickable")&&e.classList.add("clickable"),this.el.append(e),void VARTISTE.Util.whenLoaded(e,(()=>{e.setObject3D("mesh",t),t.updateMatrix(),VARTISTE.Util.applyMatrix(t.matrix,e.object3D),t.matrix.identity(),VARTISTE.Util.applyMatrix(t.matrix,t)}))}for(let e of t.children)this.setupAutobody(e)},tick(t,e){this.jointTime&&(this.data.breakDelay<=0||t-this.jointTime<this.data.breakDelay||(console.log("Setting break force"),this.el.querySelectorAll("a-entity[physx-joint__breakable]").forEach((t=>t.setAttribute("physx-joint__breakable","breakForce",this.data.breakForce))),delete this.jointTime))}})},function(t,e,i){i(369)(i(370))},function(t,e){t.exports=function(t){function e(t){"undefined"!=typeof console&&(console.error||console.log)("[Script Loader]",t)}try{"undefined"!=typeof execScript&&"undefined"!=typeof attachEvent&&"undefined"==typeof addEventListener?execScript(t):"undefined"!=typeof eval?eval.call(null,t):e("EvalError: No eval function available")}catch(t){e(t)}}},function(t,e){t.exports='\nvar PHYSX = (function() {\n  var _scriptDir = typeof document !== \'undefined\' && document.currentScript ? document.currentScript.src : undefined;\n  if (typeof __filename !== \'undefined\') _scriptDir = _scriptDir || __filename;\n  return (\nfunction(PHYSX) {\n  PHYSX = PHYSX || {};\n\nvar Module=typeof PHYSX!=="undefined"?PHYSX:{};var readyPromiseResolve,readyPromiseReject;Module["ready"]=new Promise(function(resolve,reject){readyPromiseResolve=resolve;readyPromiseReject=reject});if(!Object.getOwnPropertyDescriptor(Module["ready"],"_main")){Object.defineProperty(Module["ready"],"_main",{configurable:true,get:function(){abort("You are getting _main on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}});Object.defineProperty(Module["ready"],"_main",{configurable:true,set:function(){abort("You are setting _main on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})}if(!Object.getOwnPropertyDescriptor(Module["ready"],"_malloc")){Object.defineProperty(Module["ready"],"_malloc",{configurable:true,get:function(){abort("You are getting _malloc on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}});Object.defineProperty(Module["ready"],"_malloc",{configurable:true,set:function(){abort("You are setting _malloc on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})}if(!Object.getOwnPropertyDescriptor(Module["ready"],"_free")){Object.defineProperty(Module["ready"],"_free",{configurable:true,get:function(){abort("You are getting _free on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}});Object.defineProperty(Module["ready"],"_free",{configurable:true,set:function(){abort("You are setting _free on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})}if(!Object.getOwnPropertyDescriptor(Module["ready"],"_stackSave")){Object.defineProperty(Module["ready"],"_stackSave",{configurable:true,get:function(){abort("You are getting _stackSave on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}});Object.defineProperty(Module["ready"],"_stackSave",{configurable:true,set:function(){abort("You are setting _stackSave on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})}if(!Object.getOwnPropertyDescriptor(Module["ready"],"_stackRestore")){Object.defineProperty(Module["ready"],"_stackRestore",{configurable:true,get:function(){abort("You are getting _stackRestore on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}});Object.defineProperty(Module["ready"],"_stackRestore",{configurable:true,set:function(){abort("You are setting _stackRestore on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})}if(!Object.getOwnPropertyDescriptor(Module["ready"],"_stackAlloc")){Object.defineProperty(Module["ready"],"_stackAlloc",{configurable:true,get:function(){abort("You are getting _stackAlloc on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}});Object.defineProperty(Module["ready"],"_stackAlloc",{configurable:true,set:function(){abort("You are setting _stackAlloc on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})}if(!Object.getOwnPropertyDescriptor(Module["ready"],"___data_end")){Object.defineProperty(Module["ready"],"___data_end",{configurable:true,get:function(){abort("You are getting ___data_end on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}});Object.defineProperty(Module["ready"],"___data_end",{configurable:true,set:function(){abort("You are setting ___data_end on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})}if(!Object.getOwnPropertyDescriptor(Module["ready"],"___wasm_call_ctors")){Object.defineProperty(Module["ready"],"___wasm_call_ctors",{configurable:true,get:function(){abort("You are getting ___wasm_call_ctors on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}});Object.defineProperty(Module["ready"],"___wasm_call_ctors",{configurable:true,set:function(){abort("You are setting ___wasm_call_ctors on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})}if(!Object.getOwnPropertyDescriptor(Module["ready"],"_fflush")){Object.defineProperty(Module["ready"],"_fflush",{configurable:true,get:function(){abort("You are getting _fflush on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}});Object.defineProperty(Module["ready"],"_fflush",{configurable:true,set:function(){abort("You are setting _fflush on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})}if(!Object.getOwnPropertyDescriptor(Module["ready"],"___errno_location")){Object.defineProperty(Module["ready"],"___errno_location",{configurable:true,get:function(){abort("You are getting ___errno_location on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}});Object.defineProperty(Module["ready"],"___errno_location",{configurable:true,set:function(){abort("You are setting ___errno_location on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})}if(!Object.getOwnPropertyDescriptor(Module["ready"],"_htons")){Object.defineProperty(Module["ready"],"_htons",{configurable:true,get:function(){abort("You are getting _htons on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}});Object.defineProperty(Module["ready"],"_htons",{configurable:true,set:function(){abort("You are setting _htons on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})}if(!Object.getOwnPropertyDescriptor(Module["ready"],"_ntohs")){Object.defineProperty(Module["ready"],"_ntohs",{configurable:true,get:function(){abort("You are getting _ntohs on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}});Object.defineProperty(Module["ready"],"_ntohs",{configurable:true,set:function(){abort("You are setting _ntohs on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})}if(!Object.getOwnPropertyDescriptor(Module["ready"],"_memcpy")){Object.defineProperty(Module["ready"],"_memcpy",{configurable:true,get:function(){abort("You are getting _memcpy on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}});Object.defineProperty(Module["ready"],"_memcpy",{configurable:true,set:function(){abort("You are setting _memcpy on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})}if(!Object.getOwnPropertyDescriptor(Module["ready"],"_htonl")){Object.defineProperty(Module["ready"],"_htonl",{configurable:true,get:function(){abort("You are getting _htonl on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}});Object.defineProperty(Module["ready"],"_htonl",{configurable:true,set:function(){abort("You are setting _htonl on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})}if(!Object.getOwnPropertyDescriptor(Module["ready"],"_emscripten_main_thread_process_queued_calls")){Object.defineProperty(Module["ready"],"_emscripten_main_thread_process_queued_calls",{configurable:true,get:function(){abort("You are getting _emscripten_main_thread_process_queued_calls on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}});Object.defineProperty(Module["ready"],"_emscripten_main_thread_process_queued_calls",{configurable:true,set:function(){abort("You are setting _emscripten_main_thread_process_queued_calls on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})}if(!Object.getOwnPropertyDescriptor(Module["ready"],"onRuntimeInitialized")){Object.defineProperty(Module["ready"],"onRuntimeInitialized",{configurable:true,get:function(){abort("You are getting onRuntimeInitialized on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}});Object.defineProperty(Module["ready"],"onRuntimeInitialized",{configurable:true,set:function(){abort("You are setting onRuntimeInitialized on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")}})}var moduleOverrides={};var key;for(key in Module){if(Module.hasOwnProperty(key)){moduleOverrides[key]=Module[key]}}var arguments_=[];var thisProgram="./this.program";var quit_=function(status,toThrow){throw toThrow};var ENVIRONMENT_IS_WEB=false;var ENVIRONMENT_IS_WORKER=false;var ENVIRONMENT_IS_NODE=false;var ENVIRONMENT_IS_SHELL=false;ENVIRONMENT_IS_WEB=typeof window==="object";ENVIRONMENT_IS_WORKER=typeof importScripts==="function";ENVIRONMENT_IS_NODE=typeof process==="object"&&typeof process.versions==="object"&&typeof process.versions.node==="string";ENVIRONMENT_IS_SHELL=!ENVIRONMENT_IS_WEB&&!ENVIRONMENT_IS_NODE&&!ENVIRONMENT_IS_WORKER;if(Module["ENVIRONMENT"]){throw new Error("Module.ENVIRONMENT has been deprecated. To force the environment, use the ENVIRONMENT compile-time option (for example, -s ENVIRONMENT=web or -s ENVIRONMENT=node)")}var scriptDirectory="";function locateFile(path){if(Module["locateFile"]){return Module["locateFile"](path,scriptDirectory)}return scriptDirectory+path}var read_,readAsync,readBinary,setWindowTitle;var nodeFS;var nodePath;if(ENVIRONMENT_IS_NODE){if(ENVIRONMENT_IS_WORKER){scriptDirectory=require("path").dirname(scriptDirectory)+"/"}else{scriptDirectory=__dirname+"/"}read_=function shell_read(filename,binary){if(!nodeFS)nodeFS=require("fs");if(!nodePath)nodePath=require("path");filename=nodePath["normalize"](filename);return nodeFS["readFileSync"](filename,binary?null:"utf8")};readBinary=function readBinary(filename){var ret=read_(filename,true);if(!ret.buffer){ret=new Uint8Array(ret)}assert(ret.buffer);return ret};if(process["argv"].length>1){thisProgram=process["argv"][1].replace(/\\\\/g,"/")}arguments_=process["argv"].slice(2);process["on"]("uncaughtException",function(ex){if(!(ex instanceof ExitStatus)){throw ex}});process["on"]("unhandledRejection",abort);quit_=function(status){process["exit"](status)};Module["inspect"]=function(){return"[Emscripten Module object]"}}else if(ENVIRONMENT_IS_SHELL){if(typeof read!="undefined"){read_=function shell_read(f){return read(f)}}readBinary=function readBinary(f){var data;if(typeof readbuffer==="function"){return new Uint8Array(readbuffer(f))}data=read(f,"binary");assert(typeof data==="object");return data};if(typeof scriptArgs!="undefined"){arguments_=scriptArgs}else if(typeof arguments!="undefined"){arguments_=arguments}if(typeof quit==="function"){quit_=function(status){quit(status)}}if(typeof print!=="undefined"){if(typeof console==="undefined")console={};console.log=print;console.warn=console.error=typeof printErr!=="undefined"?printErr:print}}else if(ENVIRONMENT_IS_WEB||ENVIRONMENT_IS_WORKER){if(ENVIRONMENT_IS_WORKER){scriptDirectory=self.location.href}else if(document.currentScript){scriptDirectory=document.currentScript.src}if(_scriptDir){scriptDirectory=_scriptDir}if(scriptDirectory.indexOf("blob:")!==0){scriptDirectory=scriptDirectory.substr(0,scriptDirectory.lastIndexOf("/")+1)}else{scriptDirectory=""}{read_=function shell_read(url){var xhr=new XMLHttpRequest;xhr.open("GET",url,false);xhr.send(null);return xhr.responseText};if(ENVIRONMENT_IS_WORKER){readBinary=function readBinary(url){var xhr=new XMLHttpRequest;xhr.open("GET",url,false);xhr.responseType="arraybuffer";xhr.send(null);return new Uint8Array(xhr.response)}}readAsync=function readAsync(url,onload,onerror){var xhr=new XMLHttpRequest;xhr.open("GET",url,true);xhr.responseType="arraybuffer";xhr.onload=function xhr_onload(){if(xhr.status==200||xhr.status==0&&xhr.response){onload(xhr.response);return}onerror()};xhr.onerror=onerror;xhr.send(null)}}setWindowTitle=function(title){document.title=title}}else{throw new Error("environment detection error")}var out=Module["print"]||console.log.bind(console);var err=Module["printErr"]||console.warn.bind(console);for(key in moduleOverrides){if(moduleOverrides.hasOwnProperty(key)){Module[key]=moduleOverrides[key]}}moduleOverrides=null;if(Module["arguments"])arguments_=Module["arguments"];if(!Object.getOwnPropertyDescriptor(Module,"arguments"))Object.defineProperty(Module,"arguments",{configurable:true,get:function(){abort("Module.arguments has been replaced with plain arguments_ (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)")}});if(Module["thisProgram"])thisProgram=Module["thisProgram"];if(!Object.getOwnPropertyDescriptor(Module,"thisProgram"))Object.defineProperty(Module,"thisProgram",{configurable:true,get:function(){abort("Module.thisProgram has been replaced with plain thisProgram (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)")}});if(Module["quit"])quit_=Module["quit"];if(!Object.getOwnPropertyDescriptor(Module,"quit"))Object.defineProperty(Module,"quit",{configurable:true,get:function(){abort("Module.quit has been replaced with plain quit_ (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)")}});assert(typeof Module["memoryInitializerPrefixURL"]==="undefined","Module.memoryInitializerPrefixURL option was removed, use Module.locateFile instead");assert(typeof Module["pthreadMainPrefixURL"]==="undefined","Module.pthreadMainPrefixURL option was removed, use Module.locateFile instead");assert(typeof Module["cdInitializerPrefixURL"]==="undefined","Module.cdInitializerPrefixURL option was removed, use Module.locateFile instead");assert(typeof Module["filePackagePrefixURL"]==="undefined","Module.filePackagePrefixURL option was removed, use Module.locateFile instead");assert(typeof Module["read"]==="undefined","Module.read option was removed (modify read_ in JS)");assert(typeof Module["readAsync"]==="undefined","Module.readAsync option was removed (modify readAsync in JS)");assert(typeof Module["readBinary"]==="undefined","Module.readBinary option was removed (modify readBinary in JS)");assert(typeof Module["setWindowTitle"]==="undefined","Module.setWindowTitle option was removed (modify setWindowTitle in JS)");assert(typeof Module["TOTAL_MEMORY"]==="undefined","Module.TOTAL_MEMORY has been renamed Module.INITIAL_MEMORY");if(!Object.getOwnPropertyDescriptor(Module,"read"))Object.defineProperty(Module,"read",{configurable:true,get:function(){abort("Module.read has been replaced with plain read_ (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)")}});if(!Object.getOwnPropertyDescriptor(Module,"readAsync"))Object.defineProperty(Module,"readAsync",{configurable:true,get:function(){abort("Module.readAsync has been replaced with plain readAsync (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)")}});if(!Object.getOwnPropertyDescriptor(Module,"readBinary"))Object.defineProperty(Module,"readBinary",{configurable:true,get:function(){abort("Module.readBinary has been replaced with plain readBinary (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)")}});if(!Object.getOwnPropertyDescriptor(Module,"setWindowTitle"))Object.defineProperty(Module,"setWindowTitle",{configurable:true,get:function(){abort("Module.setWindowTitle has been replaced with plain setWindowTitle (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)")}});var STACK_ALIGN=16;function dynamicAlloc(size){assert(DYNAMICTOP_PTR);var ret=HEAP32[DYNAMICTOP_PTR>>2];var end=ret+size+15&-16;assert(end<=HEAP8.length,"failure to dynamicAlloc - memory growth etc. is not supported there, call malloc/sbrk directly");HEAP32[DYNAMICTOP_PTR>>2]=end;return ret}function getNativeTypeSize(type){switch(type){case"i1":case"i8":return 1;case"i16":return 2;case"i32":return 4;case"i64":return 8;case"float":return 4;case"double":return 8;default:{if(type[type.length-1]==="*"){return 4}else if(type[0]==="i"){var bits=Number(type.substr(1));assert(bits%8===0,"getNativeTypeSize invalid bits "+bits+", type "+type);return bits/8}else{return 0}}}}function warnOnce(text){if(!warnOnce.shown)warnOnce.shown={};if(!warnOnce.shown[text]){warnOnce.shown[text]=1;err(text)}}function convertJsFunctionToWasm(func,sig){if(typeof WebAssembly.Function==="function"){var typeNames={"i":"i32","j":"i64","f":"f32","d":"f64"};var type={parameters:[],results:sig[0]=="v"?[]:[typeNames[sig[0]]]};for(var i=1;i<sig.length;++i){type.parameters.push(typeNames[sig[i]])}return new WebAssembly.Function(type,func)}var typeSection=[1,0,1,96];var sigRet=sig.slice(0,1);var sigParam=sig.slice(1);var typeCodes={"i":127,"j":126,"f":125,"d":124};typeSection.push(sigParam.length);for(var i=0;i<sigParam.length;++i){typeSection.push(typeCodes[sigParam[i]])}if(sigRet=="v"){typeSection.push(0)}else{typeSection=typeSection.concat([1,typeCodes[sigRet]])}typeSection[1]=typeSection.length-2;var bytes=new Uint8Array([0,97,115,109,1,0,0,0].concat(typeSection,[2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0]));var module=new WebAssembly.Module(bytes);var instance=new WebAssembly.Instance(module,{"e":{"f":func}});var wrappedFunc=instance.exports["f"];return wrappedFunc}var freeTableIndexes=[];var functionsInTableMap;function addFunctionWasm(func,sig){var table=wasmTable;if(!functionsInTableMap){functionsInTableMap=new WeakMap;for(var i=0;i<table.length;i++){var item=table.get(i);if(item){functionsInTableMap.set(item,i)}}}if(functionsInTableMap.has(func)){return functionsInTableMap.get(func)}var ret;if(freeTableIndexes.length){ret=freeTableIndexes.pop()}else{ret=table.length;try{table.grow(1)}catch(err){if(!(err instanceof RangeError)){throw err}throw"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH."}}try{table.set(ret,func)}catch(err){if(!(err instanceof TypeError)){throw err}assert(typeof sig!=="undefined","Missing signature argument to addFunction");var wrapped=convertJsFunctionToWasm(func,sig);table.set(ret,wrapped)}functionsInTableMap.set(func,ret);return ret}function removeFunctionWasm(index){functionsInTableMap.delete(wasmTable.get(index));freeTableIndexes.push(index)}var funcWrappers={};function dynCall(sig,ptr,args){if(args&&args.length){assert(args.length===sig.substring(1).replace(/j/g,"--").length);assert("dynCall_"+sig in Module,"bad function pointer type - no table for sig \'"+sig+"\'");return Module["dynCall_"+sig].apply(null,[ptr].concat(args))}else{assert(sig.length==1);assert("dynCall_"+sig in Module,"bad function pointer type - no table for sig \'"+sig+"\'");return Module["dynCall_"+sig].call(null,ptr)}}var tempRet0=0;var setTempRet0=function(value){tempRet0=value};var wasmBinary;if(Module["wasmBinary"])wasmBinary=Module["wasmBinary"];if(!Object.getOwnPropertyDescriptor(Module,"wasmBinary"))Object.defineProperty(Module,"wasmBinary",{configurable:true,get:function(){abort("Module.wasmBinary has been replaced with plain wasmBinary (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)")}});var noExitRuntime;if(Module["noExitRuntime"])noExitRuntime=Module["noExitRuntime"];if(!Object.getOwnPropertyDescriptor(Module,"noExitRuntime"))Object.defineProperty(Module,"noExitRuntime",{configurable:true,get:function(){abort("Module.noExitRuntime has been replaced with plain noExitRuntime (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)")}});if(typeof WebAssembly!=="object"){abort("No WebAssembly support found. Build with -s WASM=0 to target JavaScript instead.")}function setValue(ptr,value,type,noSafe){type=type||"i8";if(type.charAt(type.length-1)==="*")type="i32";switch(type){case"i1":HEAP8[ptr>>0]=value;break;case"i8":HEAP8[ptr>>0]=value;break;case"i16":HEAP16[ptr>>1]=value;break;case"i32":HEAP32[ptr>>2]=value;break;case"i64":tempI64=[value>>>0,(tempDouble=value,+Math_abs(tempDouble)>=1?tempDouble>0?(Math_min(+Math_floor(tempDouble/4294967296),4294967295)|0)>>>0:~~+Math_ceil((tempDouble-+(~~tempDouble>>>0))/4294967296)>>>0:0)],HEAP32[ptr>>2]=tempI64[0],HEAP32[ptr+4>>2]=tempI64[1];break;case"float":HEAPF32[ptr>>2]=value;break;case"double":HEAPF64[ptr>>3]=value;break;default:abort("invalid type for setValue: "+type)}}var wasmMemory;var wasmTable=new WebAssembly.Table({"initial":3864,"maximum":3864+0,"element":"anyfunc"});var ABORT=false;var EXITSTATUS=0;function assert(condition,text){if(!condition){abort("Assertion failed: "+text)}}function getCFunc(ident){var func=Module["_"+ident];assert(func,"Cannot call unknown function "+ident+", make sure it is exported");return func}function ccall(ident,returnType,argTypes,args,opts){var toC={"string":function(str){var ret=0;if(str!==null&&str!==undefined&&str!==0){var len=(str.length<<2)+1;ret=stackAlloc(len);stringToUTF8(str,ret,len)}return ret},"array":function(arr){var ret=stackAlloc(arr.length);writeArrayToMemory(arr,ret);return ret}};function convertReturnValue(ret){if(returnType==="string")return UTF8ToString(ret);if(returnType==="boolean")return Boolean(ret);return ret}var func=getCFunc(ident);var cArgs=[];var stack=0;assert(returnType!=="array",\'Return type should not be "array".\');if(args){for(var i=0;i<args.length;i++){var converter=toC[argTypes[i]];if(converter){if(stack===0)stack=stackSave();cArgs[i]=converter(args[i])}else{cArgs[i]=args[i]}}}var ret=func.apply(null,cArgs);ret=convertReturnValue(ret);if(stack!==0)stackRestore(stack);return ret}var ALLOC_NONE=3;var UTF8Decoder=typeof TextDecoder!=="undefined"?new TextDecoder("utf8"):undefined;function UTF8ArrayToString(heap,idx,maxBytesToRead){var endIdx=idx+maxBytesToRead;var endPtr=idx;while(heap[endPtr]&&!(endPtr>=endIdx))++endPtr;if(endPtr-idx>16&&heap.subarray&&UTF8Decoder){return UTF8Decoder.decode(heap.subarray(idx,endPtr))}else{var str="";while(idx<endPtr){var u0=heap[idx++];if(!(u0&128)){str+=String.fromCharCode(u0);continue}var u1=heap[idx++]&63;if((u0&224)==192){str+=String.fromCharCode((u0&31)<<6|u1);continue}var u2=heap[idx++]&63;if((u0&240)==224){u0=(u0&15)<<12|u1<<6|u2}else{if((u0&248)!=240)warnOnce("Invalid UTF-8 leading byte 0x"+u0.toString(16)+" encountered when deserializing a UTF-8 string on the asm.js/wasm heap to a JS string!");u0=(u0&7)<<18|u1<<12|u2<<6|heap[idx++]&63}if(u0<65536){str+=String.fromCharCode(u0)}else{var ch=u0-65536;str+=String.fromCharCode(55296|ch>>10,56320|ch&1023)}}}return str}function UTF8ToString(ptr,maxBytesToRead){return ptr?UTF8ArrayToString(HEAPU8,ptr,maxBytesToRead):""}function stringToUTF8Array(str,heap,outIdx,maxBytesToWrite){if(!(maxBytesToWrite>0))return 0;var startIdx=outIdx;var endIdx=outIdx+maxBytesToWrite-1;for(var i=0;i<str.length;++i){var u=str.charCodeAt(i);if(u>=55296&&u<=57343){var u1=str.charCodeAt(++i);u=65536+((u&1023)<<10)|u1&1023}if(u<=127){if(outIdx>=endIdx)break;heap[outIdx++]=u}else if(u<=2047){if(outIdx+1>=endIdx)break;heap[outIdx++]=192|u>>6;heap[outIdx++]=128|u&63}else if(u<=65535){if(outIdx+2>=endIdx)break;heap[outIdx++]=224|u>>12;heap[outIdx++]=128|u>>6&63;heap[outIdx++]=128|u&63}else{if(outIdx+3>=endIdx)break;if(u>=2097152)warnOnce("Invalid Unicode code point 0x"+u.toString(16)+" encountered when serializing a JS string to an UTF-8 string on the asm.js/wasm heap! (Valid unicode code points should be in range 0-0x1FFFFF).");heap[outIdx++]=240|u>>18;heap[outIdx++]=128|u>>12&63;heap[outIdx++]=128|u>>6&63;heap[outIdx++]=128|u&63}}heap[outIdx]=0;return outIdx-startIdx}function stringToUTF8(str,outPtr,maxBytesToWrite){assert(typeof maxBytesToWrite=="number","stringToUTF8(str, outPtr, maxBytesToWrite) is missing the third parameter that specifies the length of the output buffer!");return stringToUTF8Array(str,HEAPU8,outPtr,maxBytesToWrite)}function lengthBytesUTF8(str){var len=0;for(var i=0;i<str.length;++i){var u=str.charCodeAt(i);if(u>=55296&&u<=57343)u=65536+((u&1023)<<10)|str.charCodeAt(++i)&1023;if(u<=127)++len;else if(u<=2047)len+=2;else if(u<=65535)len+=3;else len+=4}return len}var UTF16Decoder=typeof TextDecoder!=="undefined"?new TextDecoder("utf-16le"):undefined;function UTF16ToString(ptr,maxBytesToRead){assert(ptr%2==0,"Pointer passed to UTF16ToString must be aligned to two bytes!");var endPtr=ptr;var idx=endPtr>>1;var maxIdx=idx+maxBytesToRead/2;while(!(idx>=maxIdx)&&HEAPU16[idx])++idx;endPtr=idx<<1;if(endPtr-ptr>32&&UTF16Decoder){return UTF16Decoder.decode(HEAPU8.subarray(ptr,endPtr))}else{var i=0;var str="";while(1){var codeUnit=HEAP16[ptr+i*2>>1];if(codeUnit==0||i==maxBytesToRead/2)return str;++i;str+=String.fromCharCode(codeUnit)}}}function stringToUTF16(str,outPtr,maxBytesToWrite){assert(outPtr%2==0,"Pointer passed to stringToUTF16 must be aligned to two bytes!");assert(typeof maxBytesToWrite=="number","stringToUTF16(str, outPtr, maxBytesToWrite) is missing the third parameter that specifies the length of the output buffer!");if(maxBytesToWrite===undefined){maxBytesToWrite=2147483647}if(maxBytesToWrite<2)return 0;maxBytesToWrite-=2;var startPtr=outPtr;var numCharsToWrite=maxBytesToWrite<str.length*2?maxBytesToWrite/2:str.length;for(var i=0;i<numCharsToWrite;++i){var codeUnit=str.charCodeAt(i);HEAP16[outPtr>>1]=codeUnit;outPtr+=2}HEAP16[outPtr>>1]=0;return outPtr-startPtr}function lengthBytesUTF16(str){return str.length*2}function UTF32ToString(ptr,maxBytesToRead){assert(ptr%4==0,"Pointer passed to UTF32ToString must be aligned to four bytes!");var i=0;var str="";while(!(i>=maxBytesToRead/4)){var utf32=HEAP32[ptr+i*4>>2];if(utf32==0)break;++i;if(utf32>=65536){var ch=utf32-65536;str+=String.fromCharCode(55296|ch>>10,56320|ch&1023)}else{str+=String.fromCharCode(utf32)}}return str}function stringToUTF32(str,outPtr,maxBytesToWrite){assert(outPtr%4==0,"Pointer passed to stringToUTF32 must be aligned to four bytes!");assert(typeof maxBytesToWrite=="number","stringToUTF32(str, outPtr, maxBytesToWrite) is missing the third parameter that specifies the length of the output buffer!");if(maxBytesToWrite===undefined){maxBytesToWrite=2147483647}if(maxBytesToWrite<4)return 0;var startPtr=outPtr;var endPtr=startPtr+maxBytesToWrite-4;for(var i=0;i<str.length;++i){var codeUnit=str.charCodeAt(i);if(codeUnit>=55296&&codeUnit<=57343){var trailSurrogate=str.charCodeAt(++i);codeUnit=65536+((codeUnit&1023)<<10)|trailSurrogate&1023}HEAP32[outPtr>>2]=codeUnit;outPtr+=4;if(outPtr+4>endPtr)break}HEAP32[outPtr>>2]=0;return outPtr-startPtr}function lengthBytesUTF32(str){var len=0;for(var i=0;i<str.length;++i){var codeUnit=str.charCodeAt(i);if(codeUnit>=55296&&codeUnit<=57343)++i;len+=4}return len}function writeArrayToMemory(array,buffer){assert(array.length>=0,"writeArrayToMemory array must have a length (should be an array or typed array)");HEAP8.set(array,buffer)}function writeAsciiToMemory(str,buffer,dontAddNull){for(var i=0;i<str.length;++i){assert(str.charCodeAt(i)===str.charCodeAt(i)&255);HEAP8[buffer++>>0]=str.charCodeAt(i)}if(!dontAddNull)HEAP8[buffer>>0]=0}var WASM_PAGE_SIZE=65536;function alignUp(x,multiple){if(x%multiple>0){x+=multiple-x%multiple}return x}var buffer,HEAP8,HEAPU8,HEAP16,HEAPU16,HEAP32,HEAPU32,HEAPF32,HEAPF64;function updateGlobalBufferAndViews(buf){buffer=buf;Module["HEAP8"]=HEAP8=new Int8Array(buf);Module["HEAP16"]=HEAP16=new Int16Array(buf);Module["HEAP32"]=HEAP32=new Int32Array(buf);Module["HEAPU8"]=HEAPU8=new Uint8Array(buf);Module["HEAPU16"]=HEAPU16=new Uint16Array(buf);Module["HEAPU32"]=HEAPU32=new Uint32Array(buf);Module["HEAPF32"]=HEAPF32=new Float32Array(buf);Module["HEAPF64"]=HEAPF64=new Float64Array(buf)}var STACK_BASE=5431632,STACK_MAX=188752,DYNAMIC_BASE=5431632,DYNAMICTOP_PTR=188592;assert(STACK_BASE%16===0,"stack must start aligned");assert(DYNAMIC_BASE%16===0,"heap must start aligned");var TOTAL_STACK=5242880;if(Module["TOTAL_STACK"])assert(TOTAL_STACK===Module["TOTAL_STACK"],"the stack size can no longer be determined at runtime");var INITIAL_INITIAL_MEMORY=Module["INITIAL_MEMORY"]||16777216;if(!Object.getOwnPropertyDescriptor(Module,"INITIAL_MEMORY"))Object.defineProperty(Module,"INITIAL_MEMORY",{configurable:true,get:function(){abort("Module.INITIAL_MEMORY has been replaced with plain INITIAL_INITIAL_MEMORY (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)")}});assert(INITIAL_INITIAL_MEMORY>=TOTAL_STACK,"INITIAL_MEMORY should be larger than TOTAL_STACK, was "+INITIAL_INITIAL_MEMORY+"! (TOTAL_STACK="+TOTAL_STACK+")");assert(typeof Int32Array!=="undefined"&&typeof Float64Array!=="undefined"&&Int32Array.prototype.subarray!==undefined&&Int32Array.prototype.set!==undefined,"JS engine does not provide full typed array support");if(Module["wasmMemory"]){wasmMemory=Module["wasmMemory"]}else{wasmMemory=new WebAssembly.Memory({"initial":INITIAL_INITIAL_MEMORY/WASM_PAGE_SIZE,"maximum":2147483648/WASM_PAGE_SIZE})}if(wasmMemory){buffer=wasmMemory.buffer}INITIAL_INITIAL_MEMORY=buffer.byteLength;assert(INITIAL_INITIAL_MEMORY%WASM_PAGE_SIZE===0);assert(65536%WASM_PAGE_SIZE===0);updateGlobalBufferAndViews(buffer);HEAP32[DYNAMICTOP_PTR>>2]=DYNAMIC_BASE;function writeStackCookie(){assert((STACK_MAX&3)==0);HEAPU32[(STACK_MAX>>2)+1]=34821223;HEAPU32[(STACK_MAX>>2)+2]=2310721022;HEAP32[0]=1668509029}function checkStackCookie(){var cookie1=HEAPU32[(STACK_MAX>>2)+1];var cookie2=HEAPU32[(STACK_MAX>>2)+2];if(cookie1!=34821223||cookie2!=2310721022){abort("Stack overflow! Stack cookie has been overwritten, expected hex dwords 0x89BACDFE and 0x2135467, but received 0x"+cookie2.toString(16)+" "+cookie1.toString(16))}if(HEAP32[0]!==1668509029)abort("Runtime error: The application has corrupted its heap memory area (address zero)!")}(function(){var h16=new Int16Array(1);var h8=new Int8Array(h16.buffer);h16[0]=25459;if(h8[0]!==115||h8[1]!==99)throw"Runtime error: expected the system to be little-endian!"})();function callRuntimeCallbacks(callbacks){while(callbacks.length>0){var callback=callbacks.shift();if(typeof callback=="function"){callback(Module);continue}var func=callback.func;if(typeof func==="number"){if(callback.arg===undefined){Module["dynCall_v"](func)}else{Module["dynCall_vi"](func,callback.arg)}}else{func(callback.arg===undefined?null:callback.arg)}}}var __ATPRERUN__=[];var __ATINIT__=[];var __ATMAIN__=[];var __ATPOSTRUN__=[];var runtimeInitialized=false;var runtimeExited=false;function preRun(){if(Module["preRun"]){if(typeof Module["preRun"]=="function")Module["preRun"]=[Module["preRun"]];while(Module["preRun"].length){addOnPreRun(Module["preRun"].shift())}}callRuntimeCallbacks(__ATPRERUN__)}function initRuntime(){checkStackCookie();assert(!runtimeInitialized);runtimeInitialized=true;callRuntimeCallbacks(__ATINIT__)}function preMain(){checkStackCookie();callRuntimeCallbacks(__ATMAIN__)}function exitRuntime(){checkStackCookie();runtimeExited=true}function postRun(){checkStackCookie();if(Module["postRun"]){if(typeof Module["postRun"]=="function")Module["postRun"]=[Module["postRun"]];while(Module["postRun"].length){addOnPostRun(Module["postRun"].shift())}}callRuntimeCallbacks(__ATPOSTRUN__)}function addOnPreRun(cb){__ATPRERUN__.unshift(cb)}function addOnPostRun(cb){__ATPOSTRUN__.unshift(cb)}assert(Math.imul,"This browser does not support Math.imul(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill");assert(Math.fround,"This browser does not support Math.fround(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill");assert(Math.clz32,"This browser does not support Math.clz32(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill");assert(Math.trunc,"This browser does not support Math.trunc(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill");var Math_abs=Math.abs;var Math_ceil=Math.ceil;var Math_floor=Math.floor;var Math_min=Math.min;var runDependencies=0;var runDependencyWatcher=null;var dependenciesFulfilled=null;var runDependencyTracking={};function addRunDependency(id){runDependencies++;if(Module["monitorRunDependencies"]){Module["monitorRunDependencies"](runDependencies)}if(id){assert(!runDependencyTracking[id]);runDependencyTracking[id]=1;if(runDependencyWatcher===null&&typeof setInterval!=="undefined"){runDependencyWatcher=setInterval(function(){if(ABORT){clearInterval(runDependencyWatcher);runDependencyWatcher=null;return}var shown=false;for(var dep in runDependencyTracking){if(!shown){shown=true;err("still waiting on run dependencies:")}err("dependency: "+dep)}if(shown){err("(end of list)")}},1e4)}}else{err("warning: run dependency added without ID")}}function removeRunDependency(id){runDependencies--;if(Module["monitorRunDependencies"]){Module["monitorRunDependencies"](runDependencies)}if(id){assert(runDependencyTracking[id]);delete runDependencyTracking[id]}else{err("warning: run dependency removed without ID")}if(runDependencies==0){if(runDependencyWatcher!==null){clearInterval(runDependencyWatcher);runDependencyWatcher=null}if(dependenciesFulfilled){var callback=dependenciesFulfilled;dependenciesFulfilled=null;callback()}}}Module["preloadedImages"]={};Module["preloadedAudios"]={};function abort(what){if(Module["onAbort"]){Module["onAbort"](what)}what+="";out(what);err(what);ABORT=true;EXITSTATUS=1;var output="abort("+what+") at "+stackTrace();what=output;throw new WebAssembly.RuntimeError(what)}var FS={error:function(){abort("Filesystem support (FS) was not included. The problem is that you are using files from JS, but files were not used from C/C++, so filesystem support was not auto-included. You can force-include filesystem support with  -s FORCE_FILESYSTEM=1")},init:function(){FS.error()},createDataFile:function(){FS.error()},createPreloadedFile:function(){FS.error()},createLazyFile:function(){FS.error()},open:function(){FS.error()},mkdev:function(){FS.error()},registerDevice:function(){FS.error()},analyzePath:function(){FS.error()},loadFilesFromDB:function(){FS.error()},ErrnoError:function ErrnoError(){FS.error()}};Module["FS_createDataFile"]=FS.createDataFile;Module["FS_createPreloadedFile"]=FS.createPreloadedFile;function hasPrefix(str,prefix){return String.prototype.startsWith?str.startsWith(prefix):str.indexOf(prefix)===0}var dataURIPrefix="data:application/octet-stream;base64,";function isDataURI(filename){return hasPrefix(filename,dataURIPrefix)}var fileURIPrefix="file://";function isFileURI(filename){return hasPrefix(filename,fileURIPrefix)}function createExportWrapper(name,fixedasm){return function(){var displayName=name;var asm=fixedasm;if(!fixedasm){asm=Module["asm"]}assert(runtimeInitialized,"native function `"+displayName+"` called before runtime initialization");assert(!runtimeExited,"native function `"+displayName+"` called after runtime exit (use NO_EXIT_RUNTIME to keep it alive after main() exits)");if(!asm[name]){assert(asm[name],"exported native function `"+displayName+"` not found")}return asm[name].apply(null,arguments)}}var wasmBinaryFile="physx.release.wasm";if(!isDataURI(wasmBinaryFile)){wasmBinaryFile=locateFile(wasmBinaryFile)}function getBinary(){try{if(wasmBinary){return new Uint8Array(wasmBinary)}if(readBinary){return readBinary(wasmBinaryFile)}else{throw"both async and sync fetching of the wasm failed"}}catch(err){abort(err)}}function getBinaryPromise(){if(!wasmBinary&&(ENVIRONMENT_IS_WEB||ENVIRONMENT_IS_WORKER)&&typeof fetch==="function"&&!isFileURI(wasmBinaryFile)){return fetch(wasmBinaryFile,{credentials:"same-origin"}).then(function(response){if(!response["ok"]){throw"failed to load wasm binary file at \'"+wasmBinaryFile+"\'"}return response["arrayBuffer"]()}).catch(function(){return getBinary()})}return new Promise(function(resolve,reject){resolve(getBinary())})}function createWasm(){var info={"env":asmLibraryArg,"wasi_snapshot_preview1":asmLibraryArg};function receiveInstance(instance,module){var exports=instance.exports;Module["asm"]=exports;removeRunDependency("wasm-instantiate")}addRunDependency("wasm-instantiate");var trueModule=Module;function receiveInstantiatedSource(output){assert(Module===trueModule,"the Module object should not be replaced during async compilation - perhaps the order of HTML elements is wrong?");trueModule=null;receiveInstance(output["instance"])}function instantiateArrayBuffer(receiver){return getBinaryPromise().then(function(binary){return WebAssembly.instantiate(binary,info)}).then(receiver,function(reason){err("failed to asynchronously prepare wasm: "+reason);abort(reason)})}function instantiateAsync(){if(!wasmBinary&&typeof WebAssembly.instantiateStreaming==="function"&&!isDataURI(wasmBinaryFile)&&!isFileURI(wasmBinaryFile)&&typeof fetch==="function"){fetch(wasmBinaryFile,{credentials:"same-origin"}).then(function(response){var result=WebAssembly.instantiateStreaming(response,info);return result.then(receiveInstantiatedSource,function(reason){err("wasm streaming compile failed: "+reason);err("falling back to ArrayBuffer instantiation");return instantiateArrayBuffer(receiveInstantiatedSource)})})}else{return instantiateArrayBuffer(receiveInstantiatedSource)}}if(Module["instantiateWasm"]){try{var exports=Module["instantiateWasm"](info,receiveInstance);return exports}catch(e){err("Module.instantiateWasm callback failed with error: "+e);return false}}instantiateAsync();return{}}var tempDouble;var tempI64;__ATINIT__.push({func:function(){___wasm_call_ctors()}});function demangle(func){warnOnce("warning: build with  -s DEMANGLE_SUPPORT=1  to link in libcxxabi demangling");return func}function demangleAll(text){var regex=/\\b_Z[\\w\\d_]+/g;return text.replace(regex,function(x){var y=demangle(x);return x===y?x:y+" ["+x+"]"})}function jsStackTrace(){var err=new Error;if(!err.stack){try{throw new Error}catch(e){err=e}if(!err.stack){return"(no stack trace available)"}}return err.stack.toString()}function stackTrace(){var js=jsStackTrace();if(Module["extraStackTrace"])js+="\\n"+Module["extraStackTrace"]();return demangleAll(js)}function ___handle_stack_overflow(){abort("stack overflow")}var char_0=48;var char_9=57;function makeLegalFunctionName(name){if(undefined===name){return"_unknown"}name=name.replace(/[^a-zA-Z0-9_]/g,"$");var f=name.charCodeAt(0);if(f>=char_0&&f<=char_9){return"_"+name}else{return name}}function createNamedFunction(name,body){name=makeLegalFunctionName(name);return new Function("body","return function "+name+"() {\\n"+\'    "use strict";\'+"    return body.apply(this, arguments);\\n"+"};\\n")(body)}var emval_free_list=[];var emval_handle_array=[{},{value:undefined},{value:null},{value:true},{value:false}];function count_emval_handles(){var count=0;for(var i=5;i<emval_handle_array.length;++i){if(emval_handle_array[i]!==undefined){++count}}return count}function get_first_emval(){for(var i=5;i<emval_handle_array.length;++i){if(emval_handle_array[i]!==undefined){return emval_handle_array[i]}}return null}function init_emval(){Module["count_emval_handles"]=count_emval_handles;Module["get_first_emval"]=get_first_emval}function __emval_register(value){switch(value){case undefined:{return 1}case null:{return 2}case true:{return 3}case false:{return 4}default:{var handle=emval_free_list.length?emval_free_list.pop():emval_handle_array.length;emval_handle_array[handle]={refcount:1,value:value};return handle}}}function extendError(baseErrorType,errorName){var errorClass=createNamedFunction(errorName,function(message){this.name=errorName;this.message=message;var stack=new Error(message).stack;if(stack!==undefined){this.stack=this.toString()+"\\n"+stack.replace(/^Error(:[^\\n]*)?\\n/,"")}});errorClass.prototype=Object.create(baseErrorType.prototype);errorClass.prototype.constructor=errorClass;errorClass.prototype.toString=function(){if(this.message===undefined){return this.name}else{return this.name+": "+this.message}};return errorClass}var PureVirtualError=undefined;function embind_init_charCodes(){var codes=new Array(256);for(var i=0;i<256;++i){codes[i]=String.fromCharCode(i)}embind_charCodes=codes}var embind_charCodes=undefined;function readLatin1String(ptr){var ret="";var c=ptr;while(HEAPU8[c]){ret+=embind_charCodes[HEAPU8[c++]]}return ret}function getInheritedInstanceCount(){return Object.keys(registeredInstances).length}function getLiveInheritedInstances(){var rv=[];for(var k in registeredInstances){if(registeredInstances.hasOwnProperty(k)){rv.push(registeredInstances[k])}}return rv}var deletionQueue=[];function flushPendingDeletes(){while(deletionQueue.length){var obj=deletionQueue.pop();obj.$$.deleteScheduled=false;obj["delete"]()}}var delayFunction=undefined;function setDelayFunction(fn){delayFunction=fn;if(deletionQueue.length&&delayFunction){delayFunction(flushPendingDeletes)}}function init_embind(){Module["getInheritedInstanceCount"]=getInheritedInstanceCount;Module["getLiveInheritedInstances"]=getLiveInheritedInstances;Module["flushPendingDeletes"]=flushPendingDeletes;Module["setDelayFunction"]=setDelayFunction}var registeredInstances={};var BindingError=undefined;function throwBindingError(message){throw new BindingError(message)}function getBasestPointer(class_,ptr){if(ptr===undefined){throwBindingError("ptr should not be undefined")}while(class_.baseClass){ptr=class_.upcast(ptr);class_=class_.baseClass}return ptr}function registerInheritedInstance(class_,ptr,instance){ptr=getBasestPointer(class_,ptr);if(registeredInstances.hasOwnProperty(ptr)){throwBindingError("Tried to register registered instance: "+ptr)}else{registeredInstances[ptr]=instance}}function requireHandle(handle){if(!handle){throwBindingError("Cannot use deleted val. handle = "+handle)}return emval_handle_array[handle].value}var registeredTypes={};function getTypeName(type){var ptr=___getTypeName(type);var rv=readLatin1String(ptr);_free(ptr);return rv}function requireRegisteredType(rawType,humanName){var impl=registeredTypes[rawType];if(undefined===impl){throwBindingError(humanName+" has unknown type "+getTypeName(rawType))}return impl}function unregisterInheritedInstance(class_,ptr){ptr=getBasestPointer(class_,ptr);if(registeredInstances.hasOwnProperty(ptr)){delete registeredInstances[ptr]}else{throwBindingError("Tried to unregister unregistered instance: "+ptr)}}function detachFinalizer(handle){}var finalizationGroup=false;function runDestructor($$){if($$.smartPtr){$$.smartPtrType.rawDestructor($$.smartPtr)}else{$$.ptrType.registeredClass.rawDestructor($$.ptr)}}function releaseClassHandle($$){$$.count.value-=1;var toDelete=0===$$.count.value;if(toDelete){runDestructor($$)}}function attachFinalizer(handle){if("undefined"===typeof FinalizationGroup){attachFinalizer=function(handle){return handle};return handle}finalizationGroup=new FinalizationGroup(function(iter){for(var result=iter.next();!result.done;result=iter.next()){var $$=result.value;if(!$$.ptr){console.warn("object already deleted: "+$$.ptr)}else{releaseClassHandle($$)}}});attachFinalizer=function(handle){finalizationGroup.register(handle,handle.$$,handle.$$);return handle};detachFinalizer=function(handle){finalizationGroup.unregister(handle.$$)};return attachFinalizer(handle)}function __embind_create_inheriting_constructor(constructorName,wrapperType,properties){constructorName=readLatin1String(constructorName);wrapperType=requireRegisteredType(wrapperType,"wrapper");properties=requireHandle(properties);var arraySlice=[].slice;var registeredClass=wrapperType.registeredClass;var wrapperPrototype=registeredClass.instancePrototype;var baseClass=registeredClass.baseClass;var baseClassPrototype=baseClass.instancePrototype;var baseConstructor=registeredClass.baseClass.constructor;var ctor=createNamedFunction(constructorName,function(){registeredClass.baseClass.pureVirtualFunctions.forEach(function(name){if(this[name]===baseClassPrototype[name]){throw new PureVirtualError("Pure virtual function "+name+" must be implemented in JavaScript")}}.bind(this));Object.defineProperty(this,"__parent",{value:wrapperPrototype});this["__construct"].apply(this,arraySlice.call(arguments))});wrapperPrototype["__construct"]=function __construct(){if(this===wrapperPrototype){throwBindingError("Pass correct \'this\' to __construct")}var inner=baseConstructor["implement"].apply(undefined,[this].concat(arraySlice.call(arguments)));detachFinalizer(inner);var $$=inner.$$;inner["notifyOnDestruction"]();$$.preservePointerOnDelete=true;Object.defineProperties(this,{$$:{value:$$}});attachFinalizer(this);registerInheritedInstance(registeredClass,$$.ptr,this)};wrapperPrototype["__destruct"]=function __destruct(){if(this===wrapperPrototype){throwBindingError("Pass correct \'this\' to __destruct")}detachFinalizer(this);unregisterInheritedInstance(registeredClass,this.$$.ptr)};ctor.prototype=Object.create(wrapperPrototype);for(var p in properties){ctor.prototype[p]=properties[p]}return __emval_register(ctor)}var structRegistrations={};function runDestructors(destructors){while(destructors.length){var ptr=destructors.pop();var del=destructors.pop();del(ptr)}}function simpleReadValueFromPointer(pointer){return this["fromWireType"](HEAPU32[pointer>>2])}var awaitingDependencies={};var typeDependencies={};var InternalError=undefined;function throwInternalError(message){throw new InternalError(message)}function whenDependentTypesAreResolved(myTypes,dependentTypes,getTypeConverters){myTypes.forEach(function(type){typeDependencies[type]=dependentTypes});function onComplete(typeConverters){var myTypeConverters=getTypeConverters(typeConverters);if(myTypeConverters.length!==myTypes.length){throwInternalError("Mismatched type converter count")}for(var i=0;i<myTypes.length;++i){registerType(myTypes[i],myTypeConverters[i])}}var typeConverters=new Array(dependentTypes.length);var unregisteredTypes=[];var registered=0;dependentTypes.forEach(function(dt,i){if(registeredTypes.hasOwnProperty(dt)){typeConverters[i]=registeredTypes[dt]}else{unregisteredTypes.push(dt);if(!awaitingDependencies.hasOwnProperty(dt)){awaitingDependencies[dt]=[]}awaitingDependencies[dt].push(function(){typeConverters[i]=registeredTypes[dt];++registered;if(registered===unregisteredTypes.length){onComplete(typeConverters)}})}});if(0===unregisteredTypes.length){onComplete(typeConverters)}}function __embind_finalize_value_object(structType){var reg=structRegistrations[structType];delete structRegistrations[structType];var rawConstructor=reg.rawConstructor;var rawDestructor=reg.rawDestructor;var fieldRecords=reg.fields;var fieldTypes=fieldRecords.map(function(field){return field.getterReturnType}).concat(fieldRecords.map(function(field){return field.setterArgumentType}));whenDependentTypesAreResolved([structType],fieldTypes,function(fieldTypes){var fields={};fieldRecords.forEach(function(field,i){var fieldName=field.fieldName;var getterReturnType=fieldTypes[i];var getter=field.getter;var getterContext=field.getterContext;var setterArgumentType=fieldTypes[i+fieldRecords.length];var setter=field.setter;var setterContext=field.setterContext;fields[fieldName]={read:function(ptr){return getterReturnType["fromWireType"](getter(getterContext,ptr))},write:function(ptr,o){var destructors=[];setter(setterContext,ptr,setterArgumentType["toWireType"](destructors,o));runDestructors(destructors)}}});return[{name:reg.name,"fromWireType":function(ptr){var rv={};for(var i in fields){rv[i]=fields[i].read(ptr)}rawDestructor(ptr);return rv},"toWireType":function(destructors,o){for(var fieldName in fields){if(!(fieldName in o)){throw new TypeError(\'Missing field:  "\'+fieldName+\'"\')}}var ptr=rawConstructor();for(fieldName in fields){fields[fieldName].write(ptr,o[fieldName])}if(destructors!==null){destructors.push(rawDestructor,ptr)}return ptr},"argPackAdvance":8,"readValueFromPointer":simpleReadValueFromPointer,destructorFunction:rawDestructor}]})}function getShiftFromSize(size){switch(size){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+size)}}function registerType(rawType,registeredInstance,options){options=options||{};if(!("argPackAdvance"in registeredInstance)){throw new TypeError("registerType registeredInstance requires argPackAdvance")}var name=registeredInstance.name;if(!rawType){throwBindingError(\'type "\'+name+\'" must have a positive integer typeid pointer\')}if(registeredTypes.hasOwnProperty(rawType)){if(options.ignoreDuplicateRegistrations){return}else{throwBindingError("Cannot register type \'"+name+"\' twice")}}registeredTypes[rawType]=registeredInstance;delete typeDependencies[rawType];if(awaitingDependencies.hasOwnProperty(rawType)){var callbacks=awaitingDependencies[rawType];delete awaitingDependencies[rawType];callbacks.forEach(function(cb){cb()})}}function __embind_register_bool(rawType,name,size,trueValue,falseValue){var shift=getShiftFromSize(size);name=readLatin1String(name);registerType(rawType,{name:name,"fromWireType":function(wt){return!!wt},"toWireType":function(destructors,o){return o?trueValue:falseValue},"argPackAdvance":8,"readValueFromPointer":function(pointer){var heap;if(size===1){heap=HEAP8}else if(size===2){heap=HEAP16}else if(size===4){heap=HEAP32}else{throw new TypeError("Unknown boolean type size: "+name)}return this["fromWireType"](heap[pointer>>shift])},destructorFunction:null})}function ClassHandle_isAliasOf(other){if(!(this instanceof ClassHandle)){return false}if(!(other instanceof ClassHandle)){return false}var leftClass=this.$$.ptrType.registeredClass;var left=this.$$.ptr;var rightClass=other.$$.ptrType.registeredClass;var right=other.$$.ptr;while(leftClass.baseClass){left=leftClass.upcast(left);leftClass=leftClass.baseClass}while(rightClass.baseClass){right=rightClass.upcast(right);rightClass=rightClass.baseClass}return leftClass===rightClass&&left===right}function shallowCopyInternalPointer(o){return{count:o.count,deleteScheduled:o.deleteScheduled,preservePointerOnDelete:o.preservePointerOnDelete,ptr:o.ptr,ptrType:o.ptrType,smartPtr:o.smartPtr,smartPtrType:o.smartPtrType}}function throwInstanceAlreadyDeleted(obj){function getInstanceTypeName(handle){return handle.$$.ptrType.registeredClass.name}throwBindingError(getInstanceTypeName(obj)+" instance already deleted")}function ClassHandle_clone(){if(!this.$$.ptr){throwInstanceAlreadyDeleted(this)}if(this.$$.preservePointerOnDelete){this.$$.count.value+=1;return this}else{var clone=attachFinalizer(Object.create(Object.getPrototypeOf(this),{$$:{value:shallowCopyInternalPointer(this.$$)}}));clone.$$.count.value+=1;clone.$$.deleteScheduled=false;return clone}}function ClassHandle_delete(){if(!this.$$.ptr){throwInstanceAlreadyDeleted(this)}if(this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete){throwBindingError("Object already scheduled for deletion")}detachFinalizer(this);releaseClassHandle(this.$$);if(!this.$$.preservePointerOnDelete){this.$$.smartPtr=undefined;this.$$.ptr=undefined}}function ClassHandle_isDeleted(){return!this.$$.ptr}function ClassHandle_deleteLater(){if(!this.$$.ptr){throwInstanceAlreadyDeleted(this)}if(this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete){throwBindingError("Object already scheduled for deletion")}deletionQueue.push(this);if(deletionQueue.length===1&&delayFunction){delayFunction(flushPendingDeletes)}this.$$.deleteScheduled=true;return this}function init_ClassHandle(){ClassHandle.prototype["isAliasOf"]=ClassHandle_isAliasOf;ClassHandle.prototype["clone"]=ClassHandle_clone;ClassHandle.prototype["delete"]=ClassHandle_delete;ClassHandle.prototype["isDeleted"]=ClassHandle_isDeleted;ClassHandle.prototype["deleteLater"]=ClassHandle_deleteLater}function ClassHandle(){}var registeredPointers={};function ensureOverloadTable(proto,methodName,humanName){if(undefined===proto[methodName].overloadTable){var prevFunc=proto[methodName];proto[methodName]=function(){if(!proto[methodName].overloadTable.hasOwnProperty(arguments.length)){throwBindingError("Function \'"+humanName+"\' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+proto[methodName].overloadTable+")!")}return proto[methodName].overloadTable[arguments.length].apply(this,arguments)};proto[methodName].overloadTable=[];proto[methodName].overloadTable[prevFunc.argCount]=prevFunc}}function exposePublicSymbol(name,value,numArguments){if(Module.hasOwnProperty(name)){if(undefined===numArguments||undefined!==Module[name].overloadTable&&undefined!==Module[name].overloadTable[numArguments]){throwBindingError("Cannot register public name \'"+name+"\' twice")}ensureOverloadTable(Module,name,name);if(Module.hasOwnProperty(numArguments)){throwBindingError("Cannot register multiple overloads of a function with the same number of arguments ("+numArguments+")!")}Module[name].overloadTable[numArguments]=value}else{Module[name]=value;if(undefined!==numArguments){Module[name].numArguments=numArguments}}}function RegisteredClass(name,constructor,instancePrototype,rawDestructor,baseClass,getActualType,upcast,downcast){this.name=name;this.constructor=constructor;this.instancePrototype=instancePrototype;this.rawDestructor=rawDestructor;this.baseClass=baseClass;this.getActualType=getActualType;this.upcast=upcast;this.downcast=downcast;this.pureVirtualFunctions=[]}function upcastPointer(ptr,ptrClass,desiredClass){while(ptrClass!==desiredClass){if(!ptrClass.upcast){throwBindingError("Expected null or instance of "+desiredClass.name+", got an instance of "+ptrClass.name)}ptr=ptrClass.upcast(ptr);ptrClass=ptrClass.baseClass}return ptr}function constNoSmartPtrRawPointerToWireType(destructors,handle){if(handle===null){if(this.isReference){throwBindingError("null is not a valid "+this.name)}return 0}if(!handle.$$){throwBindingError(\'Cannot pass "\'+_embind_repr(handle)+\'" as a \'+this.name)}if(!handle.$$.ptr){throwBindingError("Cannot pass deleted object as a pointer of type "+this.name)}var handleClass=handle.$$.ptrType.registeredClass;var ptr=upcastPointer(handle.$$.ptr,handleClass,this.registeredClass);return ptr}function genericPointerToWireType(destructors,handle){var ptr;if(handle===null){if(this.isReference){throwBindingError("null is not a valid "+this.name)}if(this.isSmartPointer){ptr=this.rawConstructor();if(destructors!==null){destructors.push(this.rawDestructor,ptr)}return ptr}else{return 0}}if(!handle.$$){throwBindingError(\'Cannot pass "\'+_embind_repr(handle)+\'" as a \'+this.name)}if(!handle.$$.ptr){throwBindingError("Cannot pass deleted object as a pointer of type "+this.name)}if(!this.isConst&&handle.$$.ptrType.isConst){throwBindingError("Cannot convert argument of type "+(handle.$$.smartPtrType?handle.$$.smartPtrType.name:handle.$$.ptrType.name)+" to parameter type "+this.name)}var handleClass=handle.$$.ptrType.registeredClass;ptr=upcastPointer(handle.$$.ptr,handleClass,this.registeredClass);if(this.isSmartPointer){if(undefined===handle.$$.smartPtr){throwBindingError("Passing raw pointer to smart pointer is illegal")}switch(this.sharingPolicy){case 0:if(handle.$$.smartPtrType===this){ptr=handle.$$.smartPtr}else{throwBindingError("Cannot convert argument of type "+(handle.$$.smartPtrType?handle.$$.smartPtrType.name:handle.$$.ptrType.name)+" to parameter type "+this.name)}break;case 1:ptr=handle.$$.smartPtr;break;case 2:if(handle.$$.smartPtrType===this){ptr=handle.$$.smartPtr}else{var clonedHandle=handle["clone"]();ptr=this.rawShare(ptr,__emval_register(function(){clonedHandle["delete"]()}));if(destructors!==null){destructors.push(this.rawDestructor,ptr)}}break;default:throwBindingError("Unsupporting sharing policy")}}return ptr}function nonConstNoSmartPtrRawPointerToWireType(destructors,handle){if(handle===null){if(this.isReference){throwBindingError("null is not a valid "+this.name)}return 0}if(!handle.$$){throwBindingError(\'Cannot pass "\'+_embind_repr(handle)+\'" as a \'+this.name)}if(!handle.$$.ptr){throwBindingError("Cannot pass deleted object as a pointer of type "+this.name)}if(handle.$$.ptrType.isConst){throwBindingError("Cannot convert argument of type "+handle.$$.ptrType.name+" to parameter type "+this.name)}var handleClass=handle.$$.ptrType.registeredClass;var ptr=upcastPointer(handle.$$.ptr,handleClass,this.registeredClass);return ptr}function RegisteredPointer_getPointee(ptr){if(this.rawGetPointee){ptr=this.rawGetPointee(ptr)}return ptr}function RegisteredPointer_destructor(ptr){if(this.rawDestructor){this.rawDestructor(ptr)}}function RegisteredPointer_deleteObject(handle){if(handle!==null){handle["delete"]()}}function downcastPointer(ptr,ptrClass,desiredClass){if(ptrClass===desiredClass){return ptr}if(undefined===desiredClass.baseClass){return null}var rv=downcastPointer(ptr,ptrClass,desiredClass.baseClass);if(rv===null){return null}return desiredClass.downcast(rv)}function getInheritedInstance(class_,ptr){ptr=getBasestPointer(class_,ptr);return registeredInstances[ptr]}function makeClassHandle(prototype,record){if(!record.ptrType||!record.ptr){throwInternalError("makeClassHandle requires ptr and ptrType")}var hasSmartPtrType=!!record.smartPtrType;var hasSmartPtr=!!record.smartPtr;if(hasSmartPtrType!==hasSmartPtr){throwInternalError("Both smartPtrType and smartPtr must be specified")}record.count={value:1};return attachFinalizer(Object.create(prototype,{$$:{value:record}}))}function RegisteredPointer_fromWireType(ptr){var rawPointer=this.getPointee(ptr);if(!rawPointer){this.destructor(ptr);return null}var registeredInstance=getInheritedInstance(this.registeredClass,rawPointer);if(undefined!==registeredInstance){if(0===registeredInstance.$$.count.value){registeredInstance.$$.ptr=rawPointer;registeredInstance.$$.smartPtr=ptr;return registeredInstance["clone"]()}else{var rv=registeredInstance["clone"]();this.destructor(ptr);return rv}}function makeDefaultHandle(){if(this.isSmartPointer){return makeClassHandle(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:rawPointer,smartPtrType:this,smartPtr:ptr})}else{return makeClassHandle(this.registeredClass.instancePrototype,{ptrType:this,ptr:ptr})}}var actualType=this.registeredClass.getActualType(rawPointer);var registeredPointerRecord=registeredPointers[actualType];if(!registeredPointerRecord){return makeDefaultHandle.call(this)}var toType;if(this.isConst){toType=registeredPointerRecord.constPointerType}else{toType=registeredPointerRecord.pointerType}var dp=downcastPointer(rawPointer,this.registeredClass,toType.registeredClass);if(dp===null){return makeDefaultHandle.call(this)}if(this.isSmartPointer){return makeClassHandle(toType.registeredClass.instancePrototype,{ptrType:toType,ptr:dp,smartPtrType:this,smartPtr:ptr})}else{return makeClassHandle(toType.registeredClass.instancePrototype,{ptrType:toType,ptr:dp})}}function init_RegisteredPointer(){RegisteredPointer.prototype.getPointee=RegisteredPointer_getPointee;RegisteredPointer.prototype.destructor=RegisteredPointer_destructor;RegisteredPointer.prototype["argPackAdvance"]=8;RegisteredPointer.prototype["readValueFromPointer"]=simpleReadValueFromPointer;RegisteredPointer.prototype["deleteObject"]=RegisteredPointer_deleteObject;RegisteredPointer.prototype["fromWireType"]=RegisteredPointer_fromWireType}function RegisteredPointer(name,registeredClass,isReference,isConst,isSmartPointer,pointeeType,sharingPolicy,rawGetPointee,rawConstructor,rawShare,rawDestructor){this.name=name;this.registeredClass=registeredClass;this.isReference=isReference;this.isConst=isConst;this.isSmartPointer=isSmartPointer;this.pointeeType=pointeeType;this.sharingPolicy=sharingPolicy;this.rawGetPointee=rawGetPointee;this.rawConstructor=rawConstructor;this.rawShare=rawShare;this.rawDestructor=rawDestructor;if(!isSmartPointer&&registeredClass.baseClass===undefined){if(isConst){this["toWireType"]=constNoSmartPtrRawPointerToWireType;this.destructorFunction=null}else{this["toWireType"]=nonConstNoSmartPtrRawPointerToWireType;this.destructorFunction=null}}else{this["toWireType"]=genericPointerToWireType}}function replacePublicSymbol(name,value,numArguments){if(!Module.hasOwnProperty(name)){throwInternalError("Replacing nonexistant public symbol")}if(undefined!==Module[name].overloadTable&&undefined!==numArguments){Module[name].overloadTable[numArguments]=value}else{Module[name]=value;Module[name].argCount=numArguments}}function embind__requireFunction(signature,rawFunction){signature=readLatin1String(signature);function makeDynCaller(dynCall){var args=[];for(var i=1;i<signature.length;++i){args.push("a"+i)}var name="dynCall_"+signature+"_"+rawFunction;var body="return function "+name+"("+args.join(", ")+") {\\n";body+="    return dynCall(rawFunction"+(args.length?", ":"")+args.join(", ")+");\\n";body+="};\\n";return new Function("dynCall","rawFunction",body)(dynCall,rawFunction)}var dc=Module["dynCall_"+signature];var fp=makeDynCaller(dc);if(typeof fp!=="function"){throwBindingError("unknown function pointer with signature "+signature+": "+rawFunction)}return fp}var UnboundTypeError=undefined;function throwUnboundTypeError(message,types){var unboundTypes=[];var seen={};function visit(type){if(seen[type]){return}if(registeredTypes[type]){return}if(typeDependencies[type]){typeDependencies[type].forEach(visit);return}unboundTypes.push(type);seen[type]=true}types.forEach(visit);throw new UnboundTypeError(message+": "+unboundTypes.map(getTypeName).join([", "]))}function __embind_register_class(rawType,rawPointerType,rawConstPointerType,baseClassRawType,getActualTypeSignature,getActualType,upcastSignature,upcast,downcastSignature,downcast,name,destructorSignature,rawDestructor){name=readLatin1String(name);getActualType=embind__requireFunction(getActualTypeSignature,getActualType);if(upcast){upcast=embind__requireFunction(upcastSignature,upcast)}if(downcast){downcast=embind__requireFunction(downcastSignature,downcast)}rawDestructor=embind__requireFunction(destructorSignature,rawDestructor);var legalFunctionName=makeLegalFunctionName(name);exposePublicSymbol(legalFunctionName,function(){throwUnboundTypeError("Cannot construct "+name+" due to unbound types",[baseClassRawType])});whenDependentTypesAreResolved([rawType,rawPointerType,rawConstPointerType],baseClassRawType?[baseClassRawType]:[],function(base){base=base[0];var baseClass;var basePrototype;if(baseClassRawType){baseClass=base.registeredClass;basePrototype=baseClass.instancePrototype}else{basePrototype=ClassHandle.prototype}var constructor=createNamedFunction(legalFunctionName,function(){if(Object.getPrototypeOf(this)!==instancePrototype){throw new BindingError("Use \'new\' to construct "+name)}if(undefined===registeredClass.constructor_body){throw new BindingError(name+" has no accessible constructor")}var body=registeredClass.constructor_body[arguments.length];if(undefined===body){throw new BindingError("Tried to invoke ctor of "+name+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(registeredClass.constructor_body).toString()+") parameters instead!")}return body.apply(this,arguments)});var instancePrototype=Object.create(basePrototype,{constructor:{value:constructor}});constructor.prototype=instancePrototype;var registeredClass=new RegisteredClass(name,constructor,instancePrototype,rawDestructor,baseClass,getActualType,upcast,downcast);var referenceConverter=new RegisteredPointer(name,registeredClass,true,false,false);var pointerConverter=new RegisteredPointer(name+"*",registeredClass,false,false,false);var constPointerConverter=new RegisteredPointer(name+" const*",registeredClass,false,true,false);registeredPointers[rawType]={pointerType:pointerConverter,constPointerType:constPointerConverter};replacePublicSymbol(legalFunctionName,constructor);return[referenceConverter,pointerConverter,constPointerConverter]})}function new_(constructor,argumentList){if(!(constructor instanceof Function)){throw new TypeError("new_ called with constructor type "+typeof constructor+" which is not a function")}var dummy=createNamedFunction(constructor.name||"unknownFunctionName",function(){});dummy.prototype=constructor.prototype;var obj=new dummy;var r=constructor.apply(obj,argumentList);return r instanceof Object?r:obj}function craftInvokerFunction(humanName,argTypes,classType,cppInvokerFunc,cppTargetFunc){var argCount=argTypes.length;if(argCount<2){throwBindingError("argTypes array size mismatch! Must at least get return value and \'this\' types!")}var isClassMethodFunc=argTypes[1]!==null&&classType!==null;var needsDestructorStack=false;for(var i=1;i<argTypes.length;++i){if(argTypes[i]!==null&&argTypes[i].destructorFunction===undefined){needsDestructorStack=true;break}}var returns=argTypes[0].name!=="void";var argsList="";var argsListWired="";for(var i=0;i<argCount-2;++i){argsList+=(i!==0?", ":"")+"arg"+i;argsListWired+=(i!==0?", ":"")+"arg"+i+"Wired"}var invokerFnBody="return function "+makeLegalFunctionName(humanName)+"("+argsList+") {\\n"+"if (arguments.length !== "+(argCount-2)+") {\\n"+"throwBindingError(\'function "+humanName+" called with \' + arguments.length + \' arguments, expected "+(argCount-2)+" args!\');\\n"+"}\\n";if(needsDestructorStack){invokerFnBody+="var destructors = [];\\n"}var dtorStack=needsDestructorStack?"destructors":"null";var args1=["throwBindingError","invoker","fn","runDestructors","retType","classParam"];var args2=[throwBindingError,cppInvokerFunc,cppTargetFunc,runDestructors,argTypes[0],argTypes[1]];if(isClassMethodFunc){invokerFnBody+="var thisWired = classParam.toWireType("+dtorStack+", this);\\n"}for(var i=0;i<argCount-2;++i){invokerFnBody+="var arg"+i+"Wired = argType"+i+".toWireType("+dtorStack+", arg"+i+"); // "+argTypes[i+2].name+"\\n";args1.push("argType"+i);args2.push(argTypes[i+2])}if(isClassMethodFunc){argsListWired="thisWired"+(argsListWired.length>0?", ":"")+argsListWired}invokerFnBody+=(returns?"var rv = ":"")+"invoker(fn"+(argsListWired.length>0?", ":"")+argsListWired+");\\n";if(needsDestructorStack){invokerFnBody+="runDestructors(destructors);\\n"}else{for(var i=isClassMethodFunc?1:2;i<argTypes.length;++i){var paramName=i===1?"thisWired":"arg"+(i-2)+"Wired";if(argTypes[i].destructorFunction!==null){invokerFnBody+=paramName+"_dtor("+paramName+"); // "+argTypes[i].name+"\\n";args1.push(paramName+"_dtor");args2.push(argTypes[i].destructorFunction)}}}if(returns){invokerFnBody+="var ret = retType.fromWireType(rv);\\n"+"return ret;\\n"}else{}invokerFnBody+="}\\n";args1.push(invokerFnBody);var invokerFunction=new_(Function,args1).apply(null,args2);return invokerFunction}function heap32VectorToArray(count,firstElement){var array=[];for(var i=0;i<count;i++){array.push(HEAP32[(firstElement>>2)+i])}return array}function __embind_register_class_class_function(rawClassType,methodName,argCount,rawArgTypesAddr,invokerSignature,rawInvoker,fn){var rawArgTypes=heap32VectorToArray(argCount,rawArgTypesAddr);methodName=readLatin1String(methodName);rawInvoker=embind__requireFunction(invokerSignature,rawInvoker);whenDependentTypesAreResolved([],[rawClassType],function(classType){classType=classType[0];var humanName=classType.name+"."+methodName;function unboundTypesHandler(){throwUnboundTypeError("Cannot call "+humanName+" due to unbound types",rawArgTypes)}var proto=classType.registeredClass.constructor;if(undefined===proto[methodName]){unboundTypesHandler.argCount=argCount-1;proto[methodName]=unboundTypesHandler}else{ensureOverloadTable(proto,methodName,humanName);proto[methodName].overloadTable[argCount-1]=unboundTypesHandler}whenDependentTypesAreResolved([],rawArgTypes,function(argTypes){var invokerArgsArray=[argTypes[0],null].concat(argTypes.slice(1));var func=craftInvokerFunction(humanName,invokerArgsArray,null,rawInvoker,fn);if(undefined===proto[methodName].overloadTable){func.argCount=argCount-1;proto[methodName]=func}else{proto[methodName].overloadTable[argCount-1]=func}return[]});return[]})}function __embind_register_class_constructor(rawClassType,argCount,rawArgTypesAddr,invokerSignature,invoker,rawConstructor){assert(argCount>0);var rawArgTypes=heap32VectorToArray(argCount,rawArgTypesAddr);invoker=embind__requireFunction(invokerSignature,invoker);var args=[rawConstructor];var destructors=[];whenDependentTypesAreResolved([],[rawClassType],function(classType){classType=classType[0];var humanName="constructor "+classType.name;if(undefined===classType.registeredClass.constructor_body){classType.registeredClass.constructor_body=[]}if(undefined!==classType.registeredClass.constructor_body[argCount-1]){throw new BindingError("Cannot register multiple constructors with identical number of parameters ("+(argCount-1)+") for class \'"+classType.name+"\'! Overload resolution is currently only performed using the parameter count, not actual type info!")}classType.registeredClass.constructor_body[argCount-1]=function unboundTypeHandler(){throwUnboundTypeError("Cannot construct "+classType.name+" due to unbound types",rawArgTypes)};whenDependentTypesAreResolved([],rawArgTypes,function(argTypes){classType.registeredClass.constructor_body[argCount-1]=function constructor_body(){if(arguments.length!==argCount-1){throwBindingError(humanName+" called with "+arguments.length+" arguments, expected "+(argCount-1))}destructors.length=0;args.length=argCount;for(var i=1;i<argCount;++i){args[i]=argTypes[i]["toWireType"](destructors,arguments[i-1])}var ptr=invoker.apply(null,args);runDestructors(destructors);return argTypes[0]["fromWireType"](ptr)};return[]});return[]})}function __embind_register_class_function(rawClassType,methodName,argCount,rawArgTypesAddr,invokerSignature,rawInvoker,context,isPureVirtual){var rawArgTypes=heap32VectorToArray(argCount,rawArgTypesAddr);methodName=readLatin1String(methodName);rawInvoker=embind__requireFunction(invokerSignature,rawInvoker);whenDependentTypesAreResolved([],[rawClassType],function(classType){classType=classType[0];var humanName=classType.name+"."+methodName;if(isPureVirtual){classType.registeredClass.pureVirtualFunctions.push(methodName)}function unboundTypesHandler(){throwUnboundTypeError("Cannot call "+humanName+" due to unbound types",rawArgTypes)}var proto=classType.registeredClass.instancePrototype;var method=proto[methodName];if(undefined===method||undefined===method.overloadTable&&method.className!==classType.name&&method.argCount===argCount-2){unboundTypesHandler.argCount=argCount-2;unboundTypesHandler.className=classType.name;proto[methodName]=unboundTypesHandler}else{ensureOverloadTable(proto,methodName,humanName);proto[methodName].overloadTable[argCount-2]=unboundTypesHandler}whenDependentTypesAreResolved([],rawArgTypes,function(argTypes){var memberFunction=craftInvokerFunction(humanName,argTypes,classType,rawInvoker,context);if(undefined===proto[methodName].overloadTable){memberFunction.argCount=argCount-2;proto[methodName]=memberFunction}else{proto[methodName].overloadTable[argCount-2]=memberFunction}return[]});return[]})}function validateThis(this_,classType,humanName){if(!(this_ instanceof Object)){throwBindingError(humanName+\' with invalid "this": \'+this_)}if(!(this_ instanceof classType.registeredClass.constructor)){throwBindingError(humanName+\' incompatible with "this" of type \'+this_.constructor.name)}if(!this_.$$.ptr){throwBindingError("cannot call emscripten binding method "+humanName+" on deleted object")}return upcastPointer(this_.$$.ptr,this_.$$.ptrType.registeredClass,classType.registeredClass)}function __embind_register_class_property(classType,fieldName,getterReturnType,getterSignature,getter,getterContext,setterArgumentType,setterSignature,setter,setterContext){fieldName=readLatin1String(fieldName);getter=embind__requireFunction(getterSignature,getter);whenDependentTypesAreResolved([],[classType],function(classType){classType=classType[0];var humanName=classType.name+"."+fieldName;var desc={get:function(){throwUnboundTypeError("Cannot access "+humanName+" due to unbound types",[getterReturnType,setterArgumentType])},enumerable:true,configurable:true};if(setter){desc.set=function(){throwUnboundTypeError("Cannot access "+humanName+" due to unbound types",[getterReturnType,setterArgumentType])}}else{desc.set=function(v){throwBindingError(humanName+" is a read-only property")}}Object.defineProperty(classType.registeredClass.instancePrototype,fieldName,desc);whenDependentTypesAreResolved([],setter?[getterReturnType,setterArgumentType]:[getterReturnType],function(types){var getterReturnType=types[0];var desc={get:function(){var ptr=validateThis(this,classType,humanName+" getter");return getterReturnType["fromWireType"](getter(getterContext,ptr))},enumerable:true};if(setter){setter=embind__requireFunction(setterSignature,setter);var setterArgumentType=types[1];desc.set=function(v){var ptr=validateThis(this,classType,humanName+" setter");var destructors=[];setter(setterContext,ptr,setterArgumentType["toWireType"](destructors,v));runDestructors(destructors)}}Object.defineProperty(classType.registeredClass.instancePrototype,fieldName,desc);return[]});return[]})}function __embind_register_constant(name,type,value){name=readLatin1String(name);whenDependentTypesAreResolved([],[type],function(type){type=type[0];Module[name]=type["fromWireType"](value);return[]})}function __emval_decref(handle){if(handle>4&&0===--emval_handle_array[handle].refcount){emval_handle_array[handle]=undefined;emval_free_list.push(handle)}}function __embind_register_emval(rawType,name){name=readLatin1String(name);registerType(rawType,{name:name,"fromWireType":function(handle){var rv=emval_handle_array[handle].value;__emval_decref(handle);return rv},"toWireType":function(destructors,value){return __emval_register(value)},"argPackAdvance":8,"readValueFromPointer":simpleReadValueFromPointer,destructorFunction:null})}function enumReadValueFromPointer(name,shift,signed){switch(shift){case 0:return function(pointer){var heap=signed?HEAP8:HEAPU8;return this["fromWireType"](heap[pointer])};case 1:return function(pointer){var heap=signed?HEAP16:HEAPU16;return this["fromWireType"](heap[pointer>>1])};case 2:return function(pointer){var heap=signed?HEAP32:HEAPU32;return this["fromWireType"](heap[pointer>>2])};default:throw new TypeError("Unknown integer type: "+name)}}function __embind_register_enum(rawType,name,size,isSigned){var shift=getShiftFromSize(size);name=readLatin1String(name);function ctor(){}ctor.values={};registerType(rawType,{name:name,constructor:ctor,"fromWireType":function(c){return this.constructor.values[c]},"toWireType":function(destructors,c){return c.value},"argPackAdvance":8,"readValueFromPointer":enumReadValueFromPointer(name,shift,isSigned),destructorFunction:null});exposePublicSymbol(name,ctor)}function __embind_register_enum_value(rawEnumType,name,enumValue){var enumType=requireRegisteredType(rawEnumType,"enum");name=readLatin1String(name);var Enum=enumType.constructor;var Value=Object.create(enumType.constructor.prototype,{value:{value:enumValue},constructor:{value:createNamedFunction(enumType.name+"_"+name,function(){})}});Enum.values[enumValue]=Value;Enum[name]=Value}function _embind_repr(v){if(v===null){return"null"}var t=typeof v;if(t==="object"||t==="array"||t==="function"){return v.toString()}else{return""+v}}function floatReadValueFromPointer(name,shift){switch(shift){case 2:return function(pointer){return this["fromWireType"](HEAPF32[pointer>>2])};case 3:return function(pointer){return this["fromWireType"](HEAPF64[pointer>>3])};default:throw new TypeError("Unknown float type: "+name)}}function __embind_register_float(rawType,name,size){var shift=getShiftFromSize(size);name=readLatin1String(name);registerType(rawType,{name:name,"fromWireType":function(value){return value},"toWireType":function(destructors,value){if(typeof value!=="number"&&typeof value!=="boolean"){throw new TypeError(\'Cannot convert "\'+_embind_repr(value)+\'" to \'+this.name)}return value},"argPackAdvance":8,"readValueFromPointer":floatReadValueFromPointer(name,shift),destructorFunction:null})}function __embind_register_function(name,argCount,rawArgTypesAddr,signature,rawInvoker,fn){var argTypes=heap32VectorToArray(argCount,rawArgTypesAddr);name=readLatin1String(name);rawInvoker=embind__requireFunction(signature,rawInvoker);exposePublicSymbol(name,function(){throwUnboundTypeError("Cannot call "+name+" due to unbound types",argTypes)},argCount-1);whenDependentTypesAreResolved([],argTypes,function(argTypes){var invokerArgsArray=[argTypes[0],null].concat(argTypes.slice(1));replacePublicSymbol(name,craftInvokerFunction(name,invokerArgsArray,null,rawInvoker,fn),argCount-1);return[]})}function integerReadValueFromPointer(name,shift,signed){switch(shift){case 0:return signed?function readS8FromPointer(pointer){return HEAP8[pointer]}:function readU8FromPointer(pointer){return HEAPU8[pointer]};case 1:return signed?function readS16FromPointer(pointer){return HEAP16[pointer>>1]}:function readU16FromPointer(pointer){return HEAPU16[pointer>>1]};case 2:return signed?function readS32FromPointer(pointer){return HEAP32[pointer>>2]}:function readU32FromPointer(pointer){return HEAPU32[pointer>>2]};default:throw new TypeError("Unknown integer type: "+name)}}function __embind_register_integer(primitiveType,name,size,minRange,maxRange){name=readLatin1String(name);if(maxRange===-1){maxRange=4294967295}var shift=getShiftFromSize(size);var fromWireType=function(value){return value};if(minRange===0){var bitshift=32-8*size;fromWireType=function(value){return value<<bitshift>>>bitshift}}var isUnsignedType=name.indexOf("unsigned")!=-1;registerType(primitiveType,{name:name,"fromWireType":fromWireType,"toWireType":function(destructors,value){if(typeof value!=="number"&&typeof value!=="boolean"){throw new TypeError(\'Cannot convert "\'+_embind_repr(value)+\'" to \'+this.name)}if(value<minRange||value>maxRange){throw new TypeError(\'Passing a number "\'+_embind_repr(value)+\'" from JS side to C/C++ side to an argument of type "\'+name+\'", which is outside the valid range [\'+minRange+", "+maxRange+"]!")}return isUnsignedType?value>>>0:value|0},"argPackAdvance":8,"readValueFromPointer":integerReadValueFromPointer(name,shift,minRange!==0),destructorFunction:null})}function __embind_register_memory_view(rawType,dataTypeIndex,name){var typeMapping=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];var TA=typeMapping[dataTypeIndex];function decodeMemoryView(handle){handle=handle>>2;var heap=HEAPU32;var size=heap[handle];var data=heap[handle+1];return new TA(buffer,data,size)}name=readLatin1String(name);registerType(rawType,{name:name,"fromWireType":decodeMemoryView,"argPackAdvance":8,"readValueFromPointer":decodeMemoryView},{ignoreDuplicateRegistrations:true})}function __embind_register_std_string(rawType,name){name=readLatin1String(name);var stdStringIsUTF8=name==="std::string";registerType(rawType,{name:name,"fromWireType":function(value){var length=HEAPU32[value>>2];var str;if(stdStringIsUTF8){var decodeStartPtr=value+4;for(var i=0;i<=length;++i){var currentBytePtr=value+4+i;if(HEAPU8[currentBytePtr]==0||i==length){var maxRead=currentBytePtr-decodeStartPtr;var stringSegment=UTF8ToString(decodeStartPtr,maxRead);if(str===undefined){str=stringSegment}else{str+=String.fromCharCode(0);str+=stringSegment}decodeStartPtr=currentBytePtr+1}}}else{var a=new Array(length);for(var i=0;i<length;++i){a[i]=String.fromCharCode(HEAPU8[value+4+i])}str=a.join("")}_free(value);return str},"toWireType":function(destructors,value){if(value instanceof ArrayBuffer){value=new Uint8Array(value)}var getLength;var valueIsOfTypeString=typeof value==="string";if(!(valueIsOfTypeString||value instanceof Uint8Array||value instanceof Uint8ClampedArray||value instanceof Int8Array)){throwBindingError("Cannot pass non-string to std::string")}if(stdStringIsUTF8&&valueIsOfTypeString){getLength=function(){return lengthBytesUTF8(value)}}else{getLength=function(){return value.length}}var length=getLength();var ptr=_malloc(4+length+1);HEAPU32[ptr>>2]=length;if(stdStringIsUTF8&&valueIsOfTypeString){stringToUTF8(value,ptr+4,length+1)}else{if(valueIsOfTypeString){for(var i=0;i<length;++i){var charCode=value.charCodeAt(i);if(charCode>255){_free(ptr);throwBindingError("String has UTF-16 code units that do not fit in 8 bits")}HEAPU8[ptr+4+i]=charCode}}else{for(var i=0;i<length;++i){HEAPU8[ptr+4+i]=value[i]}}}if(destructors!==null){destructors.push(_free,ptr)}return ptr},"argPackAdvance":8,"readValueFromPointer":simpleReadValueFromPointer,destructorFunction:function(ptr){_free(ptr)}})}function __embind_register_std_wstring(rawType,charSize,name){name=readLatin1String(name);var decodeString,encodeString,getHeap,lengthBytesUTF,shift;if(charSize===2){decodeString=UTF16ToString;encodeString=stringToUTF16;lengthBytesUTF=lengthBytesUTF16;getHeap=function(){return HEAPU16};shift=1}else if(charSize===4){decodeString=UTF32ToString;encodeString=stringToUTF32;lengthBytesUTF=lengthBytesUTF32;getHeap=function(){return HEAPU32};shift=2}registerType(rawType,{name:name,"fromWireType":function(value){var length=HEAPU32[value>>2];var HEAP=getHeap();var str;var decodeStartPtr=value+4;for(var i=0;i<=length;++i){var currentBytePtr=value+4+i*charSize;if(HEAP[currentBytePtr>>shift]==0||i==length){var maxReadBytes=currentBytePtr-decodeStartPtr;var stringSegment=decodeString(decodeStartPtr,maxReadBytes);if(str===undefined){str=stringSegment}else{str+=String.fromCharCode(0);str+=stringSegment}decodeStartPtr=currentBytePtr+charSize}}_free(value);return str},"toWireType":function(destructors,value){if(!(typeof value==="string")){throwBindingError("Cannot pass non-string to C++ string type "+name)}var length=lengthBytesUTF(value);var ptr=_malloc(4+length+charSize);HEAPU32[ptr>>2]=length>>shift;encodeString(value,ptr+4,length+charSize);if(destructors!==null){destructors.push(_free,ptr)}return ptr},"argPackAdvance":8,"readValueFromPointer":simpleReadValueFromPointer,destructorFunction:function(ptr){_free(ptr)}})}function __embind_register_value_object(rawType,name,constructorSignature,rawConstructor,destructorSignature,rawDestructor){structRegistrations[rawType]={name:readLatin1String(name),rawConstructor:embind__requireFunction(constructorSignature,rawConstructor),rawDestructor:embind__requireFunction(destructorSignature,rawDestructor),fields:[]}}function __embind_register_value_object_field(structType,fieldName,getterReturnType,getterSignature,getter,getterContext,setterArgumentType,setterSignature,setter,setterContext){structRegistrations[structType].fields.push({fieldName:readLatin1String(fieldName),getterReturnType:getterReturnType,getter:embind__requireFunction(getterSignature,getter),getterContext:getterContext,setterArgumentType:setterArgumentType,setter:embind__requireFunction(setterSignature,setter),setterContext:setterContext})}function __embind_register_void(rawType,name){name=readLatin1String(name);registerType(rawType,{isVoid:true,name:name,"argPackAdvance":0,"fromWireType":function(){return undefined},"toWireType":function(destructors,o){return undefined}})}function __emval_allocateDestructors(destructorsRef){var destructors=[];HEAP32[destructorsRef>>2]=__emval_register(destructors);return destructors}var emval_symbols={};function getStringOrSymbol(address){var symbol=emval_symbols[address];if(symbol===undefined){return readLatin1String(address)}else{return symbol}}var emval_methodCallers=[];function __emval_call_method(caller,handle,methodName,destructorsRef,args){caller=emval_methodCallers[caller];handle=requireHandle(handle);methodName=getStringOrSymbol(methodName);return caller(handle,methodName,__emval_allocateDestructors(destructorsRef),args)}function __emval_call_void_method(caller,handle,methodName,args){caller=emval_methodCallers[caller];handle=requireHandle(handle);methodName=getStringOrSymbol(methodName);caller(handle,methodName,null,args)}function __emval_addMethodCaller(caller){var id=emval_methodCallers.length;emval_methodCallers.push(caller);return id}function __emval_lookupTypes(argCount,argTypes){var a=new Array(argCount);for(var i=0;i<argCount;++i){a[i]=requireRegisteredType(HEAP32[(argTypes>>2)+i],"parameter "+i)}return a}function __emval_get_method_caller(argCount,argTypes){var types=__emval_lookupTypes(argCount,argTypes);var retType=types[0];var signatureName=retType.name+"_$"+types.slice(1).map(function(t){return t.name}).join("_")+"$";var params=["retType"];var args=[retType];var argsList="";for(var i=0;i<argCount-1;++i){argsList+=(i!==0?", ":"")+"arg"+i;params.push("argType"+i);args.push(types[1+i])}var functionName=makeLegalFunctionName("methodCaller_"+signatureName);var functionBody="return function "+functionName+"(handle, name, destructors, args) {\\n";var offset=0;for(var i=0;i<argCount-1;++i){functionBody+="    var arg"+i+" = argType"+i+".readValueFromPointer(args"+(offset?"+"+offset:"")+");\\n";offset+=types[i+1]["argPackAdvance"]}functionBody+="    var rv = handle[name]("+argsList+");\\n";for(var i=0;i<argCount-1;++i){if(types[i+1]["deleteObject"]){functionBody+="    argType"+i+".deleteObject(arg"+i+");\\n"}}if(!retType.isVoid){functionBody+="    return retType.toWireType(destructors, rv);\\n"}functionBody+="};\\n";params.push(functionBody);var invokerFunction=new_(Function,params).apply(null,args);return __emval_addMethodCaller(invokerFunction)}function __emval_incref(handle){if(handle>4){emval_handle_array[handle].refcount+=1}}function __emval_run_destructors(handle){var destructors=emval_handle_array[handle].value;runDestructors(destructors);__emval_decref(handle)}function __emval_take_value(type,argv){type=requireRegisteredType(type,"_emval_take_value");var v=type["readValueFromPointer"](argv);return __emval_register(v)}function _abort(){abort()}var _emscripten_get_now;if(ENVIRONMENT_IS_NODE){_emscripten_get_now=function(){var t=process["hrtime"]();return t[0]*1e3+t[1]/1e6}}else if(typeof dateNow!=="undefined"){_emscripten_get_now=dateNow}else _emscripten_get_now=function(){return performance.now()};var _emscripten_get_now_is_monotonic=true;function setErrNo(value){HEAP32[___errno_location()>>2]=value;return value}function _clock_gettime(clk_id,tp){var now;if(clk_id===0){now=Date.now()}else if((clk_id===1||clk_id===4)&&_emscripten_get_now_is_monotonic){now=_emscripten_get_now()}else{setErrNo(28);return-1}HEAP32[tp>>2]=now/1e3|0;HEAP32[tp+4>>2]=now%1e3*1e3*1e3|0;return 0}function _emscripten_get_sbrk_ptr(){return 188592}function _emscripten_memcpy_big(dest,src,num){HEAPU8.copyWithin(dest,src,src+num)}function _emscripten_get_heap_size(){return HEAPU8.length}function emscripten_realloc_buffer(size){try{wasmMemory.grow(size-buffer.byteLength+65535>>>16);updateGlobalBufferAndViews(wasmMemory.buffer);return 1}catch(e){console.error("emscripten_realloc_buffer: Attempted to grow heap from "+buffer.byteLength+" bytes to "+size+" bytes, but got error: "+e)}}function _emscripten_resize_heap(requestedSize){requestedSize=requestedSize>>>0;var oldSize=_emscripten_get_heap_size();assert(requestedSize>oldSize);var PAGE_MULTIPLE=65536;var maxHeapSize=2147483648;if(requestedSize>maxHeapSize){err("Cannot enlarge memory, asked to go up to "+requestedSize+" bytes, but the limit is "+maxHeapSize+" bytes!");return false}var minHeapSize=16777216;for(var cutDown=1;cutDown<=4;cutDown*=2){var overGrownHeapSize=oldSize*(1+.2/cutDown);overGrownHeapSize=Math.min(overGrownHeapSize,requestedSize+100663296);var newSize=Math.min(maxHeapSize,alignUp(Math.max(minHeapSize,requestedSize,overGrownHeapSize),PAGE_MULTIPLE));var replacement=emscripten_realloc_buffer(newSize);if(replacement){return true}}err("Failed to grow the heap from "+oldSize+" bytes to "+newSize+" bytes, not enough memory!");return false}function flush_NO_FILESYSTEM(){if(typeof _fflush!=="undefined")_fflush(0);var buffers=SYSCALLS.buffers;if(buffers[1].length)SYSCALLS.printChar(1,10);if(buffers[2].length)SYSCALLS.printChar(2,10)}var PATH={splitPath:function(filename){var splitPathRe=/^(\\/?|)([\\s\\S]*?)((?:\\.{1,2}|[^\\/]+?|)(\\.[^.\\/]*|))(?:[\\/]*)$/;return splitPathRe.exec(filename).slice(1)},normalizeArray:function(parts,allowAboveRoot){var up=0;for(var i=parts.length-1;i>=0;i--){var last=parts[i];if(last==="."){parts.splice(i,1)}else if(last===".."){parts.splice(i,1);up++}else if(up){parts.splice(i,1);up--}}if(allowAboveRoot){for(;up;up--){parts.unshift("..")}}return parts},normalize:function(path){var isAbsolute=path.charAt(0)==="/",trailingSlash=path.substr(-1)==="/";path=PATH.normalizeArray(path.split("/").filter(function(p){return!!p}),!isAbsolute).join("/");if(!path&&!isAbsolute){path="."}if(path&&trailingSlash){path+="/"}return(isAbsolute?"/":"")+path},dirname:function(path){var result=PATH.splitPath(path),root=result[0],dir=result[1];if(!root&&!dir){return"."}if(dir){dir=dir.substr(0,dir.length-1)}return root+dir},basename:function(path){if(path==="/")return"/";var lastSlash=path.lastIndexOf("/");if(lastSlash===-1)return path;return path.substr(lastSlash+1)},extname:function(path){return PATH.splitPath(path)[3]},join:function(){var paths=Array.prototype.slice.call(arguments,0);return PATH.normalize(paths.join("/"))},join2:function(l,r){return PATH.normalize(l+"/"+r)}};var SYSCALLS={mappings:{},buffers:[null,[],[]],printChar:function(stream,curr){var buffer=SYSCALLS.buffers[stream];assert(buffer);if(curr===0||curr===10){(stream===1?out:err)(UTF8ArrayToString(buffer,0));buffer.length=0}else{buffer.push(curr)}},varargs:undefined,get:function(){assert(SYSCALLS.varargs!=undefined);SYSCALLS.varargs+=4;var ret=HEAP32[SYSCALLS.varargs-4>>2];return ret},getStr:function(ptr){var ret=UTF8ToString(ptr);return ret},get64:function(low,high){if(low>=0)assert(high===0);else assert(high===-1);return low}};function _fd_write(fd,iov,iovcnt,pnum){var num=0;for(var i=0;i<iovcnt;i++){var ptr=HEAP32[iov+i*8>>2];var len=HEAP32[iov+(i*8+4)>>2];for(var j=0;j<len;j++){SYSCALLS.printChar(fd,HEAPU8[ptr+j])}num+=len}HEAP32[pnum>>2]=num;return 0}function _gettimeofday(ptr){var now=Date.now();HEAP32[ptr>>2]=now/1e3|0;HEAP32[ptr+4>>2]=now%1e3*1e3|0;return 0}function _usleep(useconds){var start=_emscripten_get_now();while(_emscripten_get_now()-start<useconds/1e3){}}function _nanosleep(rqtp,rmtp){if(rqtp===0){setErrNo(28);return-1}var seconds=HEAP32[rqtp>>2];var nanoseconds=HEAP32[rqtp+4>>2];if(nanoseconds<0||nanoseconds>999999999||seconds<0){setErrNo(28);return-1}if(rmtp!==0){HEAP32[rmtp>>2]=0;HEAP32[rmtp+4>>2]=0}return _usleep(seconds*1e6+nanoseconds/1e3)}function _pthread_attr_destroy(attr){return 0}function _pthread_attr_init(attr){return 0}function _pthread_attr_setstacksize(){}function _pthread_cancel(){}function _pthread_create(){return 6}function _exit(status){exit(status)}function _pthread_exit(status){_exit(status)}function _pthread_join(){}function _pthread_mutexattr_destroy(){}function _pthread_mutexattr_init(){}function _pthread_mutexattr_setprotocol(){}function _pthread_mutexattr_settype(){}function _setTempRet0($i){setTempRet0($i|0)}init_emval();PureVirtualError=Module["PureVirtualError"]=extendError(Error,"PureVirtualError");embind_init_charCodes();init_embind();BindingError=Module["BindingError"]=extendError(Error,"BindingError");InternalError=Module["InternalError"]=extendError(Error,"InternalError");init_ClassHandle();init_RegisteredPointer();UnboundTypeError=Module["UnboundTypeError"]=extendError(Error,"UnboundTypeError");var ASSERTIONS=true;var asmLibraryArg={"__handle_stack_overflow":___handle_stack_overflow,"_embind_create_inheriting_constructor":__embind_create_inheriting_constructor,"_embind_finalize_value_object":__embind_finalize_value_object,"_embind_register_bool":__embind_register_bool,"_embind_register_class":__embind_register_class,"_embind_register_class_class_function":__embind_register_class_class_function,"_embind_register_class_constructor":__embind_register_class_constructor,"_embind_register_class_function":__embind_register_class_function,"_embind_register_class_property":__embind_register_class_property,"_embind_register_constant":__embind_register_constant,"_embind_register_emval":__embind_register_emval,"_embind_register_enum":__embind_register_enum,"_embind_register_enum_value":__embind_register_enum_value,"_embind_register_float":__embind_register_float,"_embind_register_function":__embind_register_function,"_embind_register_integer":__embind_register_integer,"_embind_register_memory_view":__embind_register_memory_view,"_embind_register_std_string":__embind_register_std_string,"_embind_register_std_wstring":__embind_register_std_wstring,"_embind_register_value_object":__embind_register_value_object,"_embind_register_value_object_field":__embind_register_value_object_field,"_embind_register_void":__embind_register_void,"_emval_call_method":__emval_call_method,"_emval_call_void_method":__emval_call_void_method,"_emval_decref":__emval_decref,"_emval_get_method_caller":__emval_get_method_caller,"_emval_incref":__emval_incref,"_emval_run_destructors":__emval_run_destructors,"_emval_take_value":__emval_take_value,"abort":_abort,"clock_gettime":_clock_gettime,"emscripten_get_sbrk_ptr":_emscripten_get_sbrk_ptr,"emscripten_memcpy_big":_emscripten_memcpy_big,"emscripten_resize_heap":_emscripten_resize_heap,"fd_write":_fd_write,"gettimeofday":_gettimeofday,"memory":wasmMemory,"nanosleep":_nanosleep,"pthread_attr_destroy":_pthread_attr_destroy,"pthread_attr_init":_pthread_attr_init,"pthread_attr_setstacksize":_pthread_attr_setstacksize,"pthread_cancel":_pthread_cancel,"pthread_create":_pthread_create,"pthread_exit":_pthread_exit,"pthread_join":_pthread_join,"pthread_mutexattr_destroy":_pthread_mutexattr_destroy,"pthread_mutexattr_init":_pthread_mutexattr_init,"pthread_mutexattr_setprotocol":_pthread_mutexattr_setprotocol,"pthread_mutexattr_settype":_pthread_mutexattr_settype,"setTempRet0":_setTempRet0,"table":wasmTable};var asm=createWasm();var ___wasm_call_ctors=Module["___wasm_call_ctors"]=createExportWrapper("__wasm_call_ctors");var _memcpy=Module["_memcpy"]=createExportWrapper("memcpy");var _free=Module["_free"]=createExportWrapper("free");var ___getTypeName=Module["___getTypeName"]=createExportWrapper("__getTypeName");var ___embind_register_native_and_builtin_types=Module["___embind_register_native_and_builtin_types"]=createExportWrapper("__embind_register_native_and_builtin_types");var ___errno_location=Module["___errno_location"]=createExportWrapper("__errno_location");var _htonl=Module["_htonl"]=createExportWrapper("htonl");var _htons=Module["_htons"]=createExportWrapper("htons");var _ntohs=Module["_ntohs"]=createExportWrapper("ntohs");var _fflush=Module["_fflush"]=createExportWrapper("fflush");var _malloc=Module["_malloc"]=createExportWrapper("malloc");var stackSave=Module["stackSave"]=createExportWrapper("stackSave");var stackRestore=Module["stackRestore"]=createExportWrapper("stackRestore");var stackAlloc=Module["stackAlloc"]=createExportWrapper("stackAlloc");var _emscripten_main_thread_process_queued_calls=Module["_emscripten_main_thread_process_queued_calls"]=createExportWrapper("emscripten_main_thread_process_queued_calls");var ___set_stack_limit=Module["___set_stack_limit"]=createExportWrapper("__set_stack_limit");var __growWasmMemory=Module["__growWasmMemory"]=createExportWrapper("__growWasmMemory");var dynCall_viiiiiiii=Module["dynCall_viiiiiiii"]=createExportWrapper("dynCall_viiiiiiii");var dynCall_iiiii=Module["dynCall_iiiii"]=createExportWrapper("dynCall_iiiii");var dynCall_iiii=Module["dynCall_iiii"]=createExportWrapper("dynCall_iiii");var dynCall_iii=Module["dynCall_iii"]=createExportWrapper("dynCall_iii");var dynCall_ii=Module["dynCall_ii"]=createExportWrapper("dynCall_ii");var dynCall_iiiiiii=Module["dynCall_iiiiiii"]=createExportWrapper("dynCall_iiiiiii");var dynCall_iiiiii=Module["dynCall_iiiiii"]=createExportWrapper("dynCall_iiiiii");var dynCall_vi=Module["dynCall_vi"]=createExportWrapper("dynCall_vi");var dynCall_vii=Module["dynCall_vii"]=createExportWrapper("dynCall_vii");var dynCall_viii=Module["dynCall_viii"]=createExportWrapper("dynCall_viii");var dynCall_fii=Module["dynCall_fii"]=createExportWrapper("dynCall_fii");var dynCall_viif=Module["dynCall_viif"]=createExportWrapper("dynCall_viif");var dynCall_iiff=Module["dynCall_iiff"]=createExportWrapper("dynCall_iiff");var dynCall_iifff=Module["dynCall_iifff"]=createExportWrapper("dynCall_iifff");var dynCall_iiiff=Module["dynCall_iiiff"]=createExportWrapper("dynCall_iiiff");var dynCall_iiifff=Module["dynCall_iiifff"]=createExportWrapper("dynCall_iiifff");var dynCall_viff=Module["dynCall_viff"]=createExportWrapper("dynCall_viff");var dynCall_viiff=Module["dynCall_viiff"]=createExportWrapper("dynCall_viiff");var dynCall_viiii=Module["dynCall_viiii"]=createExportWrapper("dynCall_viiii");var dynCall_i=Module["dynCall_i"]=createExportWrapper("dynCall_i");var dynCall_iifffi=Module["dynCall_iifffi"]=createExportWrapper("dynCall_iifffi");var dynCall_viiiii=Module["dynCall_viiiii"]=createExportWrapper("dynCall_viiiii");var dynCall_dii=Module["dynCall_dii"]=createExportWrapper("dynCall_dii");var dynCall_viid=Module["dynCall_viid"]=createExportWrapper("dynCall_viid");var dynCall_vifi=Module["dynCall_vifi"]=createExportWrapper("dynCall_vifi");var dynCall_viifi=Module["dynCall_viifi"]=createExportWrapper("dynCall_viifi");var dynCall_iiiiifiiiii=Module["dynCall_iiiiifiiiii"]=createExportWrapper("dynCall_iiiiifiiiii");var dynCall_iiiiiifiiiiif=Module["dynCall_iiiiiifiiiiif"]=createExportWrapper("dynCall_iiiiiifiiiiif");var dynCall_iiiiiiii=Module["dynCall_iiiiiiii"]=createExportWrapper("dynCall_iiiiiiii");var dynCall_iiiiiiiii=Module["dynCall_iiiiiiiii"]=createExportWrapper("dynCall_iiiiiiiii");var dynCall_iif=Module["dynCall_iif"]=createExportWrapper("dynCall_iif");var dynCall_iiif=Module["dynCall_iiif"]=createExportWrapper("dynCall_iiif");var dynCall_iiffff=Module["dynCall_iiffff"]=createExportWrapper("dynCall_iiffff");var dynCall_viiif=Module["dynCall_viiif"]=createExportWrapper("dynCall_viiif");var dynCall_iiiiffii=Module["dynCall_iiiiffii"]=createExportWrapper("dynCall_iiiiffii");var dynCall_iiiif=Module["dynCall_iiiif"]=createExportWrapper("dynCall_iiiif");var dynCall_v=Module["dynCall_v"]=createExportWrapper("dynCall_v");var dynCall_vif=Module["dynCall_vif"]=createExportWrapper("dynCall_vif");var dynCall_fi=Module["dynCall_fi"]=createExportWrapper("dynCall_fi");var dynCall_iifi=Module["dynCall_iifi"]=createExportWrapper("dynCall_iifi");var dynCall_viiiiiii=Module["dynCall_viiiiiii"]=createExportWrapper("dynCall_viiiiiii");var dynCall_viiifi=Module["dynCall_viiifi"]=createExportWrapper("dynCall_viiifi");var dynCall_viiffi=Module["dynCall_viiffi"]=createExportWrapper("dynCall_viiffi");var dynCall_viifffi=Module["dynCall_viifffi"]=createExportWrapper("dynCall_viifffi");var dynCall_viiiiii=Module["dynCall_viiiiii"]=createExportWrapper("dynCall_viiiiii");var dynCall_viiifiiiii=Module["dynCall_viiifiiiii"]=createExportWrapper("dynCall_viiifiiiii");var dynCall_viiiifiiiiif=Module["dynCall_viiiifiiiiif"]=createExportWrapper("dynCall_viiiifiiiiif");var dynCall_iiiifiiiii=Module["dynCall_iiiifiiiii"]=createExportWrapper("dynCall_iiiifiiiii");var dynCall_iiiiifiiiiif=Module["dynCall_iiiiifiiiiif"]=createExportWrapper("dynCall_iiiiifiiiiif");var dynCall_vifiiii=Module["dynCall_vifiiii"]=createExportWrapper("dynCall_vifiiii");var dynCall_viiiiiiiii=Module["dynCall_viiiiiiiii"]=createExportWrapper("dynCall_viiiiiiiii");var dynCall_viffiiiif=Module["dynCall_viffiiiif"]=createExportWrapper("dynCall_viffiiiif");var dynCall_viffiifffffiii=Module["dynCall_viffiifffffiii"]=createExportWrapper("dynCall_viffiifffffiii");var dynCall_viffffiifffiiiiif=Module["dynCall_viffffiifffiiiiif"]=createExportWrapper("dynCall_viffffiifffiiiiif");var dynCall_iiiifffffii=Module["dynCall_iiiifffffii"]=createExportWrapper("dynCall_iiiifffffii");var dynCall_iiiifffffi=Module["dynCall_iiiifffffi"]=createExportWrapper("dynCall_iiiifffffi");var dynCall_viiiiiiiiiiifii=Module["dynCall_viiiiiiiiiiifii"]=createExportWrapper("dynCall_viiiiiiiiiiifii");var dynCall_viiiiiiiiii=Module["dynCall_viiiiiiiiii"]=createExportWrapper("dynCall_viiiiiiiiii");var dynCall_viiiffi=Module["dynCall_viiiffi"]=createExportWrapper("dynCall_viiiffi");var dynCall_vifii=Module["dynCall_vifii"]=createExportWrapper("dynCall_vifii");var dynCall_viiiffii=Module["dynCall_viiiffii"]=createExportWrapper("dynCall_viiiffii");var dynCall_iiiiifiii=Module["dynCall_iiiiifiii"]=createExportWrapper("dynCall_iiiiifiii");var dynCall_iiiiiifiii=Module["dynCall_iiiiiifiii"]=createExportWrapper("dynCall_iiiiiifiii");var dynCall_iiiiiiifiif=Module["dynCall_iiiiiiifiif"]=createExportWrapper("dynCall_iiiiiiifiif");var dynCall_iiiiiifiif=Module["dynCall_iiiiiifiif"]=createExportWrapper("dynCall_iiiiiifiif");var dynCall_iiiifii=Module["dynCall_iiiifii"]=createExportWrapper("dynCall_iiiifii");var dynCall_fiiiiiifiifif=Module["dynCall_fiiiiiifiifif"]=createExportWrapper("dynCall_fiiiiiifiifif");var dynCall_fiiiiiifiiiif=Module["dynCall_fiiiiiifiiiif"]=createExportWrapper("dynCall_fiiiiiifiiiif");var dynCall_fiff=Module["dynCall_fiff"]=createExportWrapper("dynCall_fiff");var dynCall_viiifii=Module["dynCall_viiifii"]=createExportWrapper("dynCall_viiifii");var dynCall_iiiiiiiiii=Module["dynCall_iiiiiiiiii"]=createExportWrapper("dynCall_iiiiiiiiii");var dynCall_iiiiiiiiiii=Module["dynCall_iiiiiiiiiii"]=createExportWrapper("dynCall_iiiiiiiiiii");var dynCall_viij=Module["dynCall_viij"]=createExportWrapper("dynCall_viij");var dynCall_viiji=Module["dynCall_viiji"]=createExportWrapper("dynCall_viiji");var dynCall_viijijj=Module["dynCall_viijijj"]=createExportWrapper("dynCall_viijijj");var dynCall_viijj=Module["dynCall_viijj"]=createExportWrapper("dynCall_viijj");var dynCall_iiiij=Module["dynCall_iiiij"]=createExportWrapper("dynCall_iiiij");var dynCall_viiiij=Module["dynCall_viiiij"]=createExportWrapper("dynCall_viiiij");var dynCall_ji=Module["dynCall_ji"]=createExportWrapper("dynCall_ji");var dynCall_iidiiii=Module["dynCall_iidiiii"]=createExportWrapper("dynCall_iidiiii");var dynCall_jiji=Module["dynCall_jiji"]=createExportWrapper("dynCall_jiji");if(!Object.getOwnPropertyDescriptor(Module,"intArrayFromString"))Module["intArrayFromString"]=function(){abort("\'intArrayFromString\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"intArrayToString"))Module["intArrayToString"]=function(){abort("\'intArrayToString\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"ccall"))Module["ccall"]=function(){abort("\'ccall\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"cwrap"))Module["cwrap"]=function(){abort("\'cwrap\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"setValue"))Module["setValue"]=function(){abort("\'setValue\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"getValue"))Module["getValue"]=function(){abort("\'getValue\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"allocate"))Module["allocate"]=function(){abort("\'allocate\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"getMemory"))Module["getMemory"]=function(){abort("\'getMemory\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")};if(!Object.getOwnPropertyDescriptor(Module,"UTF8ArrayToString"))Module["UTF8ArrayToString"]=function(){abort("\'UTF8ArrayToString\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"UTF8ToString"))Module["UTF8ToString"]=function(){abort("\'UTF8ToString\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"stringToUTF8Array"))Module["stringToUTF8Array"]=function(){abort("\'stringToUTF8Array\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"stringToUTF8"))Module["stringToUTF8"]=function(){abort("\'stringToUTF8\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"lengthBytesUTF8"))Module["lengthBytesUTF8"]=function(){abort("\'lengthBytesUTF8\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"stackTrace"))Module["stackTrace"]=function(){abort("\'stackTrace\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"addOnPreRun"))Module["addOnPreRun"]=function(){abort("\'addOnPreRun\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"addOnInit"))Module["addOnInit"]=function(){abort("\'addOnInit\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"addOnPreMain"))Module["addOnPreMain"]=function(){abort("\'addOnPreMain\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"addOnExit"))Module["addOnExit"]=function(){abort("\'addOnExit\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"addOnPostRun"))Module["addOnPostRun"]=function(){abort("\'addOnPostRun\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"writeStringToMemory"))Module["writeStringToMemory"]=function(){abort("\'writeStringToMemory\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"writeArrayToMemory"))Module["writeArrayToMemory"]=function(){abort("\'writeArrayToMemory\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"writeAsciiToMemory"))Module["writeAsciiToMemory"]=function(){abort("\'writeAsciiToMemory\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"addRunDependency"))Module["addRunDependency"]=function(){abort("\'addRunDependency\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")};if(!Object.getOwnPropertyDescriptor(Module,"removeRunDependency"))Module["removeRunDependency"]=function(){abort("\'removeRunDependency\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")};if(!Object.getOwnPropertyDescriptor(Module,"FS_createFolder"))Module["FS_createFolder"]=function(){abort("\'FS_createFolder\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")};if(!Object.getOwnPropertyDescriptor(Module,"FS_createPath"))Module["FS_createPath"]=function(){abort("\'FS_createPath\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")};if(!Object.getOwnPropertyDescriptor(Module,"FS_createDataFile"))Module["FS_createDataFile"]=function(){abort("\'FS_createDataFile\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")};if(!Object.getOwnPropertyDescriptor(Module,"FS_createPreloadedFile"))Module["FS_createPreloadedFile"]=function(){abort("\'FS_createPreloadedFile\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")};if(!Object.getOwnPropertyDescriptor(Module,"FS_createLazyFile"))Module["FS_createLazyFile"]=function(){abort("\'FS_createLazyFile\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")};if(!Object.getOwnPropertyDescriptor(Module,"FS_createLink"))Module["FS_createLink"]=function(){abort("\'FS_createLink\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")};if(!Object.getOwnPropertyDescriptor(Module,"FS_createDevice"))Module["FS_createDevice"]=function(){abort("\'FS_createDevice\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")};if(!Object.getOwnPropertyDescriptor(Module,"FS_unlink"))Module["FS_unlink"]=function(){abort("\'FS_unlink\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")};if(!Object.getOwnPropertyDescriptor(Module,"dynamicAlloc"))Module["dynamicAlloc"]=function(){abort("\'dynamicAlloc\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"loadDynamicLibrary"))Module["loadDynamicLibrary"]=function(){abort("\'loadDynamicLibrary\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"loadWebAssemblyModule"))Module["loadWebAssemblyModule"]=function(){abort("\'loadWebAssemblyModule\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"getLEB"))Module["getLEB"]=function(){abort("\'getLEB\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"getFunctionTables"))Module["getFunctionTables"]=function(){abort("\'getFunctionTables\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"alignFunctionTables"))Module["alignFunctionTables"]=function(){abort("\'alignFunctionTables\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"registerFunctions"))Module["registerFunctions"]=function(){abort("\'registerFunctions\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"addFunction"))Module["addFunction"]=function(){abort("\'addFunction\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"removeFunction"))Module["removeFunction"]=function(){abort("\'removeFunction\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"getFuncWrapper"))Module["getFuncWrapper"]=function(){abort("\'getFuncWrapper\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"prettyPrint"))Module["prettyPrint"]=function(){abort("\'prettyPrint\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"makeBigInt"))Module["makeBigInt"]=function(){abort("\'makeBigInt\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"dynCall"))Module["dynCall"]=function(){abort("\'dynCall\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"getCompilerSetting"))Module["getCompilerSetting"]=function(){abort("\'getCompilerSetting\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"print"))Module["print"]=function(){abort("\'print\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"printErr"))Module["printErr"]=function(){abort("\'printErr\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"getTempRet0"))Module["getTempRet0"]=function(){abort("\'getTempRet0\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"setTempRet0"))Module["setTempRet0"]=function(){abort("\'setTempRet0\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"callMain"))Module["callMain"]=function(){abort("\'callMain\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"abort"))Module["abort"]=function(){abort("\'abort\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"stringToNewUTF8"))Module["stringToNewUTF8"]=function(){abort("\'stringToNewUTF8\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"emscripten_realloc_buffer"))Module["emscripten_realloc_buffer"]=function(){abort("\'emscripten_realloc_buffer\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"ENV"))Module["ENV"]=function(){abort("\'ENV\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"ERRNO_CODES"))Module["ERRNO_CODES"]=function(){abort("\'ERRNO_CODES\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"ERRNO_MESSAGES"))Module["ERRNO_MESSAGES"]=function(){abort("\'ERRNO_MESSAGES\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"setErrNo"))Module["setErrNo"]=function(){abort("\'setErrNo\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"DNS"))Module["DNS"]=function(){abort("\'DNS\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"GAI_ERRNO_MESSAGES"))Module["GAI_ERRNO_MESSAGES"]=function(){abort("\'GAI_ERRNO_MESSAGES\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"Protocols"))Module["Protocols"]=function(){abort("\'Protocols\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"Sockets"))Module["Sockets"]=function(){abort("\'Sockets\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"UNWIND_CACHE"))Module["UNWIND_CACHE"]=function(){abort("\'UNWIND_CACHE\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"readAsmConstArgs"))Module["readAsmConstArgs"]=function(){abort("\'readAsmConstArgs\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"jstoi_q"))Module["jstoi_q"]=function(){abort("\'jstoi_q\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"jstoi_s"))Module["jstoi_s"]=function(){abort("\'jstoi_s\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"abortStackOverflow"))Module["abortStackOverflow"]=function(){abort("\'abortStackOverflow\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"reallyNegative"))Module["reallyNegative"]=function(){abort("\'reallyNegative\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"formatString"))Module["formatString"]=function(){abort("\'formatString\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"PATH"))Module["PATH"]=function(){abort("\'PATH\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"PATH_FS"))Module["PATH_FS"]=function(){abort("\'PATH_FS\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"SYSCALLS"))Module["SYSCALLS"]=function(){abort("\'SYSCALLS\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"syscallMmap2"))Module["syscallMmap2"]=function(){abort("\'syscallMmap2\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"syscallMunmap"))Module["syscallMunmap"]=function(){abort("\'syscallMunmap\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"flush_NO_FILESYSTEM"))Module["flush_NO_FILESYSTEM"]=function(){abort("\'flush_NO_FILESYSTEM\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"JSEvents"))Module["JSEvents"]=function(){abort("\'JSEvents\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"specialHTMLTargets"))Module["specialHTMLTargets"]=function(){abort("\'specialHTMLTargets\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"demangle"))Module["demangle"]=function(){abort("\'demangle\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"demangleAll"))Module["demangleAll"]=function(){abort("\'demangleAll\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"jsStackTrace"))Module["jsStackTrace"]=function(){abort("\'jsStackTrace\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"stackTrace"))Module["stackTrace"]=function(){abort("\'stackTrace\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"getEnvStrings"))Module["getEnvStrings"]=function(){abort("\'getEnvStrings\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"checkWasiClock"))Module["checkWasiClock"]=function(){abort("\'checkWasiClock\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"writeI53ToI64"))Module["writeI53ToI64"]=function(){abort("\'writeI53ToI64\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"writeI53ToI64Clamped"))Module["writeI53ToI64Clamped"]=function(){abort("\'writeI53ToI64Clamped\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"writeI53ToI64Signaling"))Module["writeI53ToI64Signaling"]=function(){abort("\'writeI53ToI64Signaling\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"writeI53ToU64Clamped"))Module["writeI53ToU64Clamped"]=function(){abort("\'writeI53ToU64Clamped\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"writeI53ToU64Signaling"))Module["writeI53ToU64Signaling"]=function(){abort("\'writeI53ToU64Signaling\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"readI53FromI64"))Module["readI53FromI64"]=function(){abort("\'readI53FromI64\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"readI53FromU64"))Module["readI53FromU64"]=function(){abort("\'readI53FromU64\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"convertI32PairToI53"))Module["convertI32PairToI53"]=function(){abort("\'convertI32PairToI53\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"convertU32PairToI53"))Module["convertU32PairToI53"]=function(){abort("\'convertU32PairToI53\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"Browser"))Module["Browser"]=function(){abort("\'Browser\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"FS"))Module["FS"]=function(){abort("\'FS\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"MEMFS"))Module["MEMFS"]=function(){abort("\'MEMFS\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"TTY"))Module["TTY"]=function(){abort("\'TTY\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"PIPEFS"))Module["PIPEFS"]=function(){abort("\'PIPEFS\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"SOCKFS"))Module["SOCKFS"]=function(){abort("\'SOCKFS\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"GL"))Module["GL"]=function(){abort("\'GL\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"emscriptenWebGLGet"))Module["emscriptenWebGLGet"]=function(){abort("\'emscriptenWebGLGet\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"emscriptenWebGLGetTexPixelData"))Module["emscriptenWebGLGetTexPixelData"]=function(){abort("\'emscriptenWebGLGetTexPixelData\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"emscriptenWebGLGetUniform"))Module["emscriptenWebGLGetUniform"]=function(){abort("\'emscriptenWebGLGetUniform\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"emscriptenWebGLGetVertexAttrib"))Module["emscriptenWebGLGetVertexAttrib"]=function(){abort("\'emscriptenWebGLGetVertexAttrib\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"AL"))Module["AL"]=function(){abort("\'AL\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"SDL_unicode"))Module["SDL_unicode"]=function(){abort("\'SDL_unicode\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"SDL_ttfContext"))Module["SDL_ttfContext"]=function(){abort("\'SDL_ttfContext\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"SDL_audio"))Module["SDL_audio"]=function(){abort("\'SDL_audio\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"SDL"))Module["SDL"]=function(){abort("\'SDL\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"SDL_gfx"))Module["SDL_gfx"]=function(){abort("\'SDL_gfx\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"GLUT"))Module["GLUT"]=function(){abort("\'GLUT\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"EGL"))Module["EGL"]=function(){abort("\'EGL\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"GLFW_Window"))Module["GLFW_Window"]=function(){abort("\'GLFW_Window\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"GLFW"))Module["GLFW"]=function(){abort("\'GLFW\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"GLEW"))Module["GLEW"]=function(){abort("\'GLEW\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"IDBStore"))Module["IDBStore"]=function(){abort("\'IDBStore\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"runAndAbortIfError"))Module["runAndAbortIfError"]=function(){abort("\'runAndAbortIfError\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"emval_handle_array"))Module["emval_handle_array"]=function(){abort("\'emval_handle_array\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"emval_free_list"))Module["emval_free_list"]=function(){abort("\'emval_free_list\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"emval_symbols"))Module["emval_symbols"]=function(){abort("\'emval_symbols\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"init_emval"))Module["init_emval"]=function(){abort("\'init_emval\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"count_emval_handles"))Module["count_emval_handles"]=function(){abort("\'count_emval_handles\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"get_first_emval"))Module["get_first_emval"]=function(){abort("\'get_first_emval\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"getStringOrSymbol"))Module["getStringOrSymbol"]=function(){abort("\'getStringOrSymbol\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"requireHandle"))Module["requireHandle"]=function(){abort("\'requireHandle\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"emval_newers"))Module["emval_newers"]=function(){abort("\'emval_newers\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"craftEmvalAllocator"))Module["craftEmvalAllocator"]=function(){abort("\'craftEmvalAllocator\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"emval_get_global"))Module["emval_get_global"]=function(){abort("\'emval_get_global\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"emval_methodCallers"))Module["emval_methodCallers"]=function(){abort("\'emval_methodCallers\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"InternalError"))Module["InternalError"]=function(){abort("\'InternalError\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"BindingError"))Module["BindingError"]=function(){abort("\'BindingError\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"UnboundTypeError"))Module["UnboundTypeError"]=function(){abort("\'UnboundTypeError\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"PureVirtualError"))Module["PureVirtualError"]=function(){abort("\'PureVirtualError\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"init_embind"))Module["init_embind"]=function(){abort("\'init_embind\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"throwInternalError"))Module["throwInternalError"]=function(){abort("\'throwInternalError\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"throwBindingError"))Module["throwBindingError"]=function(){abort("\'throwBindingError\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"throwUnboundTypeError"))Module["throwUnboundTypeError"]=function(){abort("\'throwUnboundTypeError\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"ensureOverloadTable"))Module["ensureOverloadTable"]=function(){abort("\'ensureOverloadTable\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"exposePublicSymbol"))Module["exposePublicSymbol"]=function(){abort("\'exposePublicSymbol\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"replacePublicSymbol"))Module["replacePublicSymbol"]=function(){abort("\'replacePublicSymbol\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"extendError"))Module["extendError"]=function(){abort("\'extendError\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"createNamedFunction"))Module["createNamedFunction"]=function(){abort("\'createNamedFunction\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"registeredInstances"))Module["registeredInstances"]=function(){abort("\'registeredInstances\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"getBasestPointer"))Module["getBasestPointer"]=function(){abort("\'getBasestPointer\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"registerInheritedInstance"))Module["registerInheritedInstance"]=function(){abort("\'registerInheritedInstance\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"unregisterInheritedInstance"))Module["unregisterInheritedInstance"]=function(){abort("\'unregisterInheritedInstance\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"getInheritedInstance"))Module["getInheritedInstance"]=function(){abort("\'getInheritedInstance\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"getInheritedInstanceCount"))Module["getInheritedInstanceCount"]=function(){abort("\'getInheritedInstanceCount\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"getLiveInheritedInstances"))Module["getLiveInheritedInstances"]=function(){abort("\'getLiveInheritedInstances\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"registeredTypes"))Module["registeredTypes"]=function(){abort("\'registeredTypes\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"awaitingDependencies"))Module["awaitingDependencies"]=function(){abort("\'awaitingDependencies\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"typeDependencies"))Module["typeDependencies"]=function(){abort("\'typeDependencies\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"registeredPointers"))Module["registeredPointers"]=function(){abort("\'registeredPointers\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"registerType"))Module["registerType"]=function(){abort("\'registerType\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"whenDependentTypesAreResolved"))Module["whenDependentTypesAreResolved"]=function(){abort("\'whenDependentTypesAreResolved\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"embind_charCodes"))Module["embind_charCodes"]=function(){abort("\'embind_charCodes\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"embind_init_charCodes"))Module["embind_init_charCodes"]=function(){abort("\'embind_init_charCodes\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"readLatin1String"))Module["readLatin1String"]=function(){abort("\'readLatin1String\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"getTypeName"))Module["getTypeName"]=function(){abort("\'getTypeName\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"heap32VectorToArray"))Module["heap32VectorToArray"]=function(){abort("\'heap32VectorToArray\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"requireRegisteredType"))Module["requireRegisteredType"]=function(){abort("\'requireRegisteredType\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"getShiftFromSize"))Module["getShiftFromSize"]=function(){abort("\'getShiftFromSize\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"integerReadValueFromPointer"))Module["integerReadValueFromPointer"]=function(){abort("\'integerReadValueFromPointer\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"enumReadValueFromPointer"))Module["enumReadValueFromPointer"]=function(){abort("\'enumReadValueFromPointer\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"floatReadValueFromPointer"))Module["floatReadValueFromPointer"]=function(){abort("\'floatReadValueFromPointer\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"simpleReadValueFromPointer"))Module["simpleReadValueFromPointer"]=function(){abort("\'simpleReadValueFromPointer\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"runDestructors"))Module["runDestructors"]=function(){abort("\'runDestructors\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"new_"))Module["new_"]=function(){abort("\'new_\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"craftInvokerFunction"))Module["craftInvokerFunction"]=function(){abort("\'craftInvokerFunction\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"embind__requireFunction"))Module["embind__requireFunction"]=function(){abort("\'embind__requireFunction\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"tupleRegistrations"))Module["tupleRegistrations"]=function(){abort("\'tupleRegistrations\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"structRegistrations"))Module["structRegistrations"]=function(){abort("\'structRegistrations\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"genericPointerToWireType"))Module["genericPointerToWireType"]=function(){abort("\'genericPointerToWireType\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"constNoSmartPtrRawPointerToWireType"))Module["constNoSmartPtrRawPointerToWireType"]=function(){abort("\'constNoSmartPtrRawPointerToWireType\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"nonConstNoSmartPtrRawPointerToWireType"))Module["nonConstNoSmartPtrRawPointerToWireType"]=function(){abort("\'nonConstNoSmartPtrRawPointerToWireType\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"init_RegisteredPointer"))Module["init_RegisteredPointer"]=function(){abort("\'init_RegisteredPointer\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"RegisteredPointer"))Module["RegisteredPointer"]=function(){abort("\'RegisteredPointer\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"RegisteredPointer_getPointee"))Module["RegisteredPointer_getPointee"]=function(){abort("\'RegisteredPointer_getPointee\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"RegisteredPointer_destructor"))Module["RegisteredPointer_destructor"]=function(){abort("\'RegisteredPointer_destructor\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"RegisteredPointer_deleteObject"))Module["RegisteredPointer_deleteObject"]=function(){abort("\'RegisteredPointer_deleteObject\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"RegisteredPointer_fromWireType"))Module["RegisteredPointer_fromWireType"]=function(){abort("\'RegisteredPointer_fromWireType\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"runDestructor"))Module["runDestructor"]=function(){abort("\'runDestructor\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"releaseClassHandle"))Module["releaseClassHandle"]=function(){abort("\'releaseClassHandle\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"finalizationGroup"))Module["finalizationGroup"]=function(){abort("\'finalizationGroup\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"detachFinalizer_deps"))Module["detachFinalizer_deps"]=function(){abort("\'detachFinalizer_deps\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"detachFinalizer"))Module["detachFinalizer"]=function(){abort("\'detachFinalizer\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"attachFinalizer"))Module["attachFinalizer"]=function(){abort("\'attachFinalizer\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"makeClassHandle"))Module["makeClassHandle"]=function(){abort("\'makeClassHandle\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"init_ClassHandle"))Module["init_ClassHandle"]=function(){abort("\'init_ClassHandle\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"ClassHandle"))Module["ClassHandle"]=function(){abort("\'ClassHandle\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"ClassHandle_isAliasOf"))Module["ClassHandle_isAliasOf"]=function(){abort("\'ClassHandle_isAliasOf\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"throwInstanceAlreadyDeleted"))Module["throwInstanceAlreadyDeleted"]=function(){abort("\'throwInstanceAlreadyDeleted\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"ClassHandle_clone"))Module["ClassHandle_clone"]=function(){abort("\'ClassHandle_clone\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"ClassHandle_delete"))Module["ClassHandle_delete"]=function(){abort("\'ClassHandle_delete\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"deletionQueue"))Module["deletionQueue"]=function(){abort("\'deletionQueue\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"ClassHandle_isDeleted"))Module["ClassHandle_isDeleted"]=function(){abort("\'ClassHandle_isDeleted\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"ClassHandle_deleteLater"))Module["ClassHandle_deleteLater"]=function(){abort("\'ClassHandle_deleteLater\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"flushPendingDeletes"))Module["flushPendingDeletes"]=function(){abort("\'flushPendingDeletes\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"delayFunction"))Module["delayFunction"]=function(){abort("\'delayFunction\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"setDelayFunction"))Module["setDelayFunction"]=function(){abort("\'setDelayFunction\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"RegisteredClass"))Module["RegisteredClass"]=function(){abort("\'RegisteredClass\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"shallowCopyInternalPointer"))Module["shallowCopyInternalPointer"]=function(){abort("\'shallowCopyInternalPointer\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"downcastPointer"))Module["downcastPointer"]=function(){abort("\'downcastPointer\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"upcastPointer"))Module["upcastPointer"]=function(){abort("\'upcastPointer\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"validateThis"))Module["validateThis"]=function(){abort("\'validateThis\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"char_0"))Module["char_0"]=function(){abort("\'char_0\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"char_9"))Module["char_9"]=function(){abort("\'char_9\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"makeLegalFunctionName"))Module["makeLegalFunctionName"]=function(){abort("\'makeLegalFunctionName\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"warnOnce"))Module["warnOnce"]=function(){abort("\'warnOnce\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"stackSave"))Module["stackSave"]=function(){abort("\'stackSave\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"stackRestore"))Module["stackRestore"]=function(){abort("\'stackRestore\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"stackAlloc"))Module["stackAlloc"]=function(){abort("\'stackAlloc\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"AsciiToString"))Module["AsciiToString"]=function(){abort("\'AsciiToString\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"stringToAscii"))Module["stringToAscii"]=function(){abort("\'stringToAscii\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"UTF16ToString"))Module["UTF16ToString"]=function(){abort("\'UTF16ToString\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"stringToUTF16"))Module["stringToUTF16"]=function(){abort("\'stringToUTF16\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"lengthBytesUTF16"))Module["lengthBytesUTF16"]=function(){abort("\'lengthBytesUTF16\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"UTF32ToString"))Module["UTF32ToString"]=function(){abort("\'UTF32ToString\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"stringToUTF32"))Module["stringToUTF32"]=function(){abort("\'stringToUTF32\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"lengthBytesUTF32"))Module["lengthBytesUTF32"]=function(){abort("\'lengthBytesUTF32\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"allocateUTF8"))Module["allocateUTF8"]=function(){abort("\'allocateUTF8\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};if(!Object.getOwnPropertyDescriptor(Module,"allocateUTF8OnStack"))Module["allocateUTF8OnStack"]=function(){abort("\'allocateUTF8OnStack\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")};Module["writeStackCookie"]=writeStackCookie;Module["checkStackCookie"]=checkStackCookie;if(!Object.getOwnPropertyDescriptor(Module,"ALLOC_NORMAL"))Object.defineProperty(Module,"ALLOC_NORMAL",{configurable:true,get:function(){abort("\'ALLOC_NORMAL\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}});if(!Object.getOwnPropertyDescriptor(Module,"ALLOC_STACK"))Object.defineProperty(Module,"ALLOC_STACK",{configurable:true,get:function(){abort("\'ALLOC_STACK\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}});if(!Object.getOwnPropertyDescriptor(Module,"ALLOC_DYNAMIC"))Object.defineProperty(Module,"ALLOC_DYNAMIC",{configurable:true,get:function(){abort("\'ALLOC_DYNAMIC\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}});if(!Object.getOwnPropertyDescriptor(Module,"ALLOC_NONE"))Object.defineProperty(Module,"ALLOC_NONE",{configurable:true,get:function(){abort("\'ALLOC_NONE\' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}});var calledRun;function ExitStatus(status){this.name="ExitStatus";this.message="Program terminated with exit("+status+")";this.status=status}dependenciesFulfilled=function runCaller(){if(!calledRun)run();if(!calledRun)dependenciesFulfilled=runCaller};function run(args){args=args||arguments_;if(runDependencies>0){return}writeStackCookie();preRun();if(runDependencies>0)return;function doRun(){if(calledRun)return;calledRun=true;Module["calledRun"]=true;if(ABORT)return;initRuntime();preMain();readyPromiseResolve(Module);if(Module["onRuntimeInitialized"])Module["onRuntimeInitialized"]();assert(!Module["_main"],\'compiled without a main, but one is present. if you added it from JS, use Module["onRuntimeInitialized"]\');postRun()}if(Module["setStatus"]){Module["setStatus"]("Running...");setTimeout(function(){setTimeout(function(){Module["setStatus"]("")},1);doRun()},1)}else{doRun()}checkStackCookie()}Module["run"]=run;function checkUnflushedContent(){var print=out;var printErr=err;var has=false;out=err=function(x){has=true};try{var flush=flush_NO_FILESYSTEM;if(flush)flush()}catch(e){}out=print;err=printErr;if(has){warnOnce("stdio streams had content in them that was not flushed. you should set EXIT_RUNTIME to 1 (see the FAQ), or make sure to emit a newline when you printf etc.");warnOnce("(this may also be due to not including full filesystem support - try building with -s FORCE_FILESYSTEM=1)")}}function exit(status,implicit){checkUnflushedContent();if(implicit&&noExitRuntime&&status===0){return}if(noExitRuntime){if(!implicit){var msg="program exited (with status: "+status+"), but EXIT_RUNTIME is not set, so halting execution but not exiting the runtime or preventing further async execution (build with EXIT_RUNTIME=1, if you want a true shutdown)";readyPromiseReject(msg)}}else{ABORT=true;EXITSTATUS=status;exitRuntime();if(Module["onExit"])Module["onExit"](status)}quit_(status,new ExitStatus(status))}if(Module["preInit"]){if(typeof Module["preInit"]=="function")Module["preInit"]=[Module["preInit"]];while(Module["preInit"].length>0){Module["preInit"].pop()()}}noExitRuntime=true;run();\n\n\n  return PHYSX.ready\n}\n);\n})();\nif (typeof exports === \'object\' && typeof module === \'object\')\n      module.exports = PHYSX;\n    else if (typeof define === \'function\' && define[\'amd\'])\n      define([], function() { return PHYSX; });\n    else if (typeof exports === \'object\')\n      exports["PHYSX"] = PHYSX;\n    '},function(t,e,i){t.exports=i.p+"src/wasm/physx.release.f61d819df796f75a491fe1e617d29854.wasm"},function(t,e,i){var n;const r=i(13),{Util:a}=i(0),o={trumpet:[.66,.54,.6,.82,.83,.9,.83,.71,.48,.3,.21,.22,.15,.1],organ:[.001831,.11747,.606061,.667617,.32325,.32325,.667617,.606061,.11747],ukulele:[.914102564102564,1,.624358974358974,.683333333333333,.638461538461538],sin:[1],marimba:[.8105694691387023,0,-.0900632743487447,0,.8434636622299385,0,-.016542234064055146,0,.010007030483193857,0,-.00669892123255126,0,.0018838011188271615,1,-.0036025309739497885,1,.0028047386475387615,0]},s={red:{pitch:5,pan:1,timbre:"trumpet"},green:{pitch:1.5,pan:0,timbre:"organ"},blue:{pitch:1,pan:.5,timbre:"trumpet"},yellow:{pitch:4,pan:.8,timbre:"ukulele"},white:{pitch:2,pan:1,timbre:"sin"}};class l{constructor(){this.baseFrequency=140,this.voice={},this.envelope=new n.AmplitudeEnvelope({attack:.11,decay:0,sustain:.5,release:1.2});let t=this.envelope;this.envelope.toDestination();for(let e in s)this.voice[e]=this.createVoice(s[e]),this.voice[e].gain.connect(t)}createVoice(t){let e=this.baseFrequency*t.pitch,i=o[t.timbre];const r=new n.Gain(0),a=new n.Panner(2*t.pan-1).connect(r),s=new n.Oscillator({mute:!1,volume:-14,detune:0,frequency:e,partialCount:i.length,partials:i,phase:0,type:"custom"}).connect(a);return s.start(),{synth:s,gain:r}}rebase(t){this.baseFrequency=t;for(let e in this.voice)this.voice[e].synth.frequency.value=s[e].pitch*t}transform(t){let{r:e,g:i,b:n}=t.unitObject(),r=Math.min(e,i,n),a=Math.min(e,i)-r;this.voice.red.gain.gain.value=e-a-r,this.voice.green.gain.gain.value=i-a-r,this.voice.blue.gain.gain.value=n-r,this.voice.yellow.gain.gain.value=a,this.voice.white.gain.gain.value=r}static get Timbres(){return o}static get Voices(){return s}}a.registerComponentSystem("kromophone",{schema:{source:{oneOf:["none","camera","paint"],default:"camera"},active:{default:!1}},events:{colorchanged:function(t){this.kromophone&&"paint"===this.data.source&&this.kromophone.envelope.triggerAttackRelease(.5)},startdrawing:function(t){this.kromophone&&"paint"===this.data.source&&this.kromophone.envelope.triggerAttack()},enddrawing:function(t){this.kromophone&&"paint"===this.data.source&&this.kromophone.envelope.triggerRelease()}},init(){this.cameraBytes=new Uint8Array(4)},update(t){this.data.active?this.start():this.stop(),this.data.source!==t.source&&this.kromophone&&("camera"===t.source&&this.kromophone.envelope.triggerRelease(),"camera"===this.data.source&&this.kromophone.envelope.triggerAttack())},start(){this.kromophone?(n.start(),n.Destination.mute=!1):i.e(0).then(i.bind(null,182)).then((t=>{n=t,this.Tone=n,n.start(),this.kromophone=new l,"camera"===this.data.source&&this.kromophone.envelope.triggerAttack()}))},stop(){n&&(n.Destination.mute=!0)},sonify(t,{duration:e=.5}){if(!this.kromophone)return;let i=t;t.isColor&&(i="#"+t.getHexString()),this.kromophone.transform(i),e>0?this.kromophone.envelope.triggerAttackRelease(e):this.kromophone.envelope.triggerAttack(e)},tick(t,e){if(this.kromophone&&"paint"===this.data.source){let t=this.el.sceneEl.systems["paint-system"].brush.ccolor;t&&this.kromophone.transform(t)}},tock(t,e){if(!this.kromophone)return;if("camera"!==this.data.source)return;if(!this.data.active)return;let i=this.cameraBytes,n=this.el.sceneEl.renderer.getContext(),a=n.getParameter(n.VIEWPORT);this.el.sceneEl.is("vr-mode")?n.readPixels(Math.round(.55*a[2]),Math.round(a[3]/2),1,1,n.RGBA,n.UNSIGNED_BYTE,i):n.readPixels(Math.round(a[2]/2),Math.round(a[3]/2),1,1,n.RGBA,n.UNSIGNED_BYTE,i),this.kromophone.transform(new r(i))}})},function(t,e,i){"use strict";i.r(e);var n=i(8),r=i(0),a=i(3),o=i(13),s=i.n(o),l=i(1),c=i(5),u=i(4);function h(t){return function(e){if(this.data.grabElements)for(let i of Object.values(this.grabbed))i.emit(t,e.detail)}}AFRAME.registerSystem("pencil-tool",{clonePencil(){this.lastGrabbed&&this.lastGrabbed.createLockedClone()},deletePencil(){this.lastGrabbed&&this.lastGrabbed.data.locked&&this.lastGrabbed.el.remove()},unlockPencil(){if(!this.lastGrabbed)return;if(!this.lastGrabbed.data.locked)return;let t=this.el.systems["paint-system"],e=this.lastGrabbed.el.components["hand-draw-tool"];e&&(Object.assign(t.data,e.system.data),t.brush=e.system.brush,t.el.emit("brushchanged",{brush:t.brush}))},toggleGrabRotation(){document.querySelectorAll("*[manipulator]").forEach((t=>{t.is("rotating")?t.removeState("rotating"):t.addState("rotating")}))},toggleTriggerGrab(){document.querySelectorAll("*[manipulator]").forEach((t=>{t.is("grabmode")?(t.removeState("grabmode"),t.removeEventListener("triggerdown",t.components.manipulator.onGripClose),t.removeEventListener("triggerup",t.components.manipulator.onGripOpen)):(t.addState("grabmode"),t.addEventListener("triggerdown",t.components.manipulator.onGripClose),t.addEventListener("triggerup",t.components.manipulator.onGripOpen))}))},createHandle({radius:t,height:e,parentEl:i,segments:n=10}){let r=document.createElement("a-cylinder");return i?i.append(r):console.warn("Should specify a parent el to avoid more warnings"),r.setAttribute("radius",t),r.setAttribute("height",e),r.setAttribute("segments-radial",n),r.setAttribute("segments-height",1),r.setAttribute("material","side: double; src: #asset-shelf; metalness: 0.4; roughness: 0.7"),r.setAttribute("position",`0 ${-e/2} 0`),r.classList.add("clickable"),r.setAttribute("propogate-grab",""),r}}),AFRAME.registerComponent("pencil-tool",{dependencies:["grab-activate","six-dof-tool"],schema:{throttle:{type:"int",default:30},scaleTip:{type:"boolean",default:!0},pressureTip:{type:"boolean",default:!1},detailTip:{type:"boolean",default:!1},drawThrough:{type:"boolean",default:!1},radius:{default:.03},tipRatio:{default:.2},extraStates:{type:"array"},extraRayLength:{default:0},enabled:{default:!0},locked:{default:!1},lockable:{default:!0},brush:{default:void 0,type:"string",parse:t=>t},paintSystemData:{default:void 0,type:"string",parse:t=>t},lockedColor:{type:"color"}},events:{bbuttonup:function(t){this.data.lockable&&this.createLockedClone()},stateadded:function(t){"grabbed"!==t.detail&&"wielded"!==t.detail||(this.system.lastGrabbed=this,this.overlay=this.overlay||{el:this.el},this.overlay.brush=this.el.components["hand-draw-tool"].system.brush,window.Compositor&&window.Compositor.el&&(window.Compositor.component.overlays[this.el.components["hand-draw-tool"].id]=this.overlay))},activate:function(){this.activatePencil()}},async init(){this.el.classList.add("grab-root"),this.el.setAttribute("shadow","cast: true; receive: false"),this.el.hasAttribute("set-brush")&&(this.data.locked=!0,this.data.lockable=!1,await r.Util.whenComponentInitialized(this.el,"set-brush")),this.el.setAttribute("six-dof-tool","lockedComponentDependencies",["manipulator-weight"]),this.el.sceneEl.systems["button-caster"].install(["bbutton"]);for(let t of this.data.extraStates)this.el.addState(t);var t;if(this.data.locked){let e,i;e=this.data.systemData?JSON.parse(this.data.paintSystemData):Object.assign({},this.el.sceneEl.systems["paint-system"].data),i=this.el.hasAttribute("set-brush")?this.el.components["set-brush"]&&this.el.components["set-brush"].brush?this.el.components["set-brush"].brush:new l.Brush:l.Brush.fromStore(JSON.parse(this.data.brush),c.a),console.log("Restoring brush",i.constructor.name,i.baseid),t={data:e,brush:i},r.Util.whenComponentInitialized(this.el,"hand-draw-tool",(()=>{this.el.components["hand-draw-tool"].system=t}))}let e,i=this.data.radius,n=.3*this.data.tipRatio,a=.3-n,o=document.createElement("a-cylinder");this.height=.3,this.tipHeight=n,o.setAttribute("radius",i),o.setAttribute("height",a),o.setAttribute("segments-radial",10),o.setAttribute("segments-height",1),o.setAttribute("material","side: double; src: #asset-shelf; metalness: 0.4; roughness: 0.7"),o.classList.add("clickable"),o.setAttribute("propogate-grab",""),this.handle=o,this.el.append(o),this.data.locked&&(o.setAttribute("material","emissive",this.data.lockedColor),o.setAttribute("material","emissiveIntensity",.04)),this.data.detailTip?(e=document.createElement("a-cone"),e.setAttribute("radius-top",i),e.setAttribute("radius-bottom",0),e.setAttribute("segments-height",2),e.setAttribute("segments-radial",4)):this.data.pressureTip?(e=document.createElement("a-sphere"),e.setAttribute("radius",n/2),e.setAttribute("segments-height",12),e.setAttribute("segments-width",16)):this.data.scaleTip?(e=document.createElement("a-cone"),e.setAttribute("radius-top",i),e.setAttribute("radius-bottom",0),e.setAttribute("segments-height",2),e.setAttribute("segments-radial",16)):(e=document.createElement("a-cylinder"),e.setAttribute("radius",i/2),e.setAttribute("segments-height",1),e.setAttribute("segments-width",16)),e.setAttribute("height",n),e.setAttribute("position",`0 -${a/2+n/2} 0`),this.el.is("erasing")||this.el.hasAttribute("set-brush")&&"destination-out"===this.el.getAttribute("set-brush").mode?e.setAttribute("material","metalness: 0; roughness: 0.9; color: #eee"):(this.data.locked?e.setAttribute("material",{color:t.brush.color,shader:"flat"}):e.setAttribute("show-current-color",""),this.data.detailTip&&r.Util.whenLoaded(e,(()=>{e.setAttribute("material",{shader:"standard",transparent:!1}),e.getObject3D("mesh").material.flatShading=!0,e.getObject3D("mesh").material.needsUpdate=!0}))),e.classList.add("clickable"),e.setAttribute("propogate-grab",""),this.el.append(e),e.setAttribute("material","side","double"),this.tip=e;let s=document.createElement("a-plane");this.el.append(s),this.data.locked?s.setAttribute("material",{src:t.brush.previewSrc,transparent:!0}):s.setAttribute("show-current-brush",""),s.setAttribute("width",i),s.setAttribute("height",i),s.setAttribute("rotation","-90 180 0"),s.setAttribute("position",`0 ${a/2+1e-4} 0`),this.el.object3D.up.set(0,0,1),this.el.setAttribute("grab-options","showHand: false"),this.el.setAttribute("raycaster",`objects: .canvas; showLine: false; direction: 0 -1 0; origin: 0 -${a/2} 0; far: ${n}`),this.raycasterTick=this.el.components.raycaster.tock,this.el.components.raycaster.tock=function(){},this.el.setAttribute("hand-draw-tool","")},update(t){this.tip&&(this.updateEnabled(),this.data.drawThrough&&this.tip.setAttribute("material","wireframe",!0),this.el.hasAttribute("preactivate-tooltip")&&!this.el.hasAttribute("tooltip-style")&&this.el.setAttribute("tooltip-style","scale: 0.3 0.3 1.0; offset: 0 -0.2 0"))},activatePencil({subPencil:t=!1}={}){console.log("Activating pencil"),this.el.setAttribute("action-tooltips",{trigger:"Toggle Pencil",b:"Clone Pencil",shelf:"6DoF Tool Shelf"}),this.raycasterTick&&(this.el.components.raycaster.tock=this.raycasterTick),this.el.addEventListener("raycaster-intersection",(t=>{this.data.enabled&&(this.updateDrawTool(),this.el.components["hand-draw-tool"].isDrawing=!0,this.el.components["hand-draw-tool"].startDraw())})),this.el.addEventListener("raycaster-intersection-cleared",(t=>{this.data.enabled&&(this.el.components["hand-draw-tool"].endDraw(),this.el.components["hand-draw-tool"].isDrawing=!1)})),this.el.addEventListener("click",(t=>{this.el.is("grabbed")&&(this.data.enabled=!this.data.enabled,this.updateEnabled())})),this.tick=AFRAME.utils.throttleTick(this._tick,this.data.throttle,this),this.activatePencil=function(){throw new Error("Tried to activate already activated pencil")}},calcFar(){return this.tipHeight*this.el.object3D.scale.x+this.data.extraRayLength},updateRaycaster:function(t){let e=this.data;var i=this.raycaster;i.far=e.far,i.near=e.near,this.unitLineEndVec3.copy(e.origin).add(e.direction).normalize()},updateDrawTool(){let t=this.calcFar();this.el.components.raycaster.data.far=t,this.updateRaycaster.call(this.el.components.raycaster);let e=this.el.components["hand-draw-tool"],i=this.el.components.raycaster.intersections.sort((t=>navigator.xr?t.distance:-t.distance))[0];if(i){this.hadIntersection=!0;let n=i.distance/t;this.data.scaleTip?e.distanceScale=THREE.Math.lerp(1,.1,n):e.distanceScale=1,this.data.pressureTip?e.pressure=THREE.Math.lerp(1,.1,n):this.el.components["hand-draw-tool"].pressure=1}else this.hadIntersection&&this.el.is("erasing")&&(this.el.emit("fakeclearstate","erasing"),this.hadIntersection=!1)},_tick(){this.updateDrawTool()},tick(){},updateEnabled(){this.tip.setAttribute("visible",this.data.enabled);let t=this.el.components["hand-draw-tool"];!this.data.enabled&&t.isDrawing?(console.log("Ending draw"),t.endDraw(),t.isDrawing=!1):this.data.enabled&&this.el.components.raycaster.intersectedEls.length>0&&(t.isDrawing=!0,t.startDraw())},createLockedClone(){let t=document.createElement("a-entity");this.el.parentEl.append(t);let e=this.el.components["hand-draw-tool"].system;t.setAttribute("pencil-tool",Object.assign({},this.el.getAttribute("pencil-tool"),{locked:!0,brush:JSON.stringify(e.brush.store()),paintSystemData:JSON.stringify(e.data),lockedColor:s()(`hsl(${360*Math.random()}, 100%, 80%)`).rgb().hex()})),t.setAttribute("six-dof-tool",{lockedClone:!0,lockedComponent:"pencil-tool"});for(let e of this.el.components["six-dof-tool"].data.lockedComponentDependencies)this.el.hasAttribute(e)&&t.setAttribute(e,this.el.getAttribute(e));return r.Util.whenLoaded(t,(()=>{r.Util.positionObject3DAtTarget(t.object3D,this.el.object3D),t.emit("activate",{})})),t}}),AFRAME.registerComponent("multi-pencil-base",{init(){this.el.setAttribute("grab-options","showHand: false"),this.el.classList.add("grab-root");let t=e=>{"grabbed"===e.detail&&(this.el.querySelectorAll("*[pencil-tool]").forEach((t=>t.components["pencil-tool"].activatePencil({subPencil:!0}))),this.el.removeEventListener("stateadded",t))};this.el.addEventListener("stateadded",t)},calcFarFn(t){return()=>t.components["pencil-tool"].tipHeight*this.el.object3D.scale.x}}),AFRAME.registerComponent("pencil-broom",{dependencies:["multi-pencil-base","six-dof-tool"],init(){this.base=this.el.components["multi-pencil-base"];for(let t=0;t<4;t++)for(let e=0;e<3;e++){let i=document.createElement("a-entity");i.setAttribute("pencil-tool",""),i.setAttribute("position",`${.05*t+t%2*.02} 0 ${.05*e}`),i["redirect-grab"]=this.el,this.el.append(i),i.components["pencil-tool"].calcFar=this.base.calcFarFn(i)}}}),AFRAME.registerComponent("spike-ball",{dependencies:["multi-pencil-base","six-dof-tool"],init(){this.base=this.el.components["multi-pencil-base"];for(let t=0;t<10;t++){let t=document.createElement("a-entity");t.setAttribute("pencil-tool",""),t.setAttribute("rotation",`${360*Math.random()} ${360*Math.random()} ${360*Math.random()}`),t["redirect-grab"]=this.el,this.el.append(t),t.components["pencil-tool"].calcFar=this.base.calcFarFn(t)}}}),AFRAME.registerComponent("hammer-tool",{dependencies:["multi-pencil-base","six-dof-tool"],schema:{throttle:{type:"int",default:30},scaleTip:{type:"boolean",default:!0},pressureTip:{type:"boolean",default:!1}},init(){let t=document.createElement("a-cylinder");t.setAttribute("radius",.03),t.setAttribute("height",.3),t.setAttribute("segments-radial",10),t.setAttribute("segments-height",1),t.setAttribute("material","side: double; src: #asset-shelf; metalness: 0.4; roughness: 0.7"),t.classList.add("clickable"),t.setAttribute("propogate-grab",""),this.el.append(t);let e=document.createElement("a-entity");e.setAttribute("rotation","0 0 90"),e.setAttribute("rotation","0 0 90"),e.setAttribute("position","0 0.15 0"),this.el.append(e);let i=document.createElement("a-cylinder");this.head=i,i.setAttribute("radius",.05),i.setAttribute("height",.2),i.setAttribute("segments-radial",10),i.setAttribute("segments-height",1),i.setAttribute("propogate-grab",""),i.setAttribute("material","side: double; color: #aaa; metalness: 0.9; roughness: 0.4"),i.setAttribute("raycaster","objects: .canvas; showLine: true; direction: 0 1 0; origin: 0 0 0; far: 0.1"),i.setAttribute("hand-draw-tool",""),e.append(i);let r=document.createElement("a-sphere");r.setAttribute("radius",.01),r.setAttribute("show-current-color",""),r.setAttribute("position","0 0.1 0"),r.setAttribute("propogate-grab",""),r.setAttribute("segments-height",8),r.setAttribute("segments-width",12),i.append(r),this.tip=r,this._tick=this.tick,this.tick=AFRAME.utils.throttleTick(this.tick,this.data.throttle,this),i.addEventListener("raycaster-intersection",(t=>{let e=THREE.Math.mapLinear(this.speed,0,.008,0,1);console.log("Hit",this.speed,e);let r=i.components["hand-draw-tool"];r.pressure=e,r.isDrawing=!0,r.hasDrawn=!1,r.singleShot=!0,r.startDraw(),n.a.bang(this.el),this.el.addState("hitting")})),i.addEventListener("raycaster-intersection-cleared",(t=>{console.log("Hit cleared"),this.el.removeState("hitting")}))},tick(t,e){if(!this.velocity)return this.velocity=new THREE.Vector3,this.lastPosition=new THREE.Vector3,this.position=new THREE.Vector3,void this.tip.object3D.getWorldPosition(this.lastPosition);if(this.el.is("hitting")){let t=this.head.components["hand-draw-tool"];return void(t.hasDrawn&&(t.isDrawing=!1,t.hasDrawn=!1,t.endDraw()))}let{lastPosition:i,position:n,velocity:r}=this;this.tip.object3D.getWorldPosition(n),r.subVectors(n,i),this.speed=r.length()/e,i.copy(n)}}),AFRAME.registerComponent("drip-tool",{dependencies:["six-dof-tool"],schema:{radius:{default:.06},tipRatio:{default:.2},maxRate:{default:120}},events:{click:function(t){this.addDrop()}},init(){a.Pool.init(this),this.el.classList.add("grab-root"),this.el.setAttribute("grab-options","showHand: false");let t=this.data.radius,e=.3*this.data.tipRatio,i=.3-e,n=document.createElement("a-cylinder");this.height=.3,this.tipHeight=e,n.setAttribute("radius",t),n.setAttribute("height",i),n.setAttribute("segments-radial",10),n.setAttribute("segments-height",1),n.setAttribute("material","side: double; src: #asset-shelf; metalness: 0.4; roughness: 0.7"),n.setAttribute("position",`0 ${-i/2} 0`),n.classList.add("clickable"),n.setAttribute("propogate-grab",""),this.el.append(n),this.drops=[],this.raycaster=new THREE.Raycaster},addDrop(){let t=document.createElement("a-sphere");t.setAttribute("radius",2*this.data.radius/3),t.setAttribute("color",this.el.sceneEl.systems["paint-system"].brush.color),r.Util.whenLoaded(t,(()=>{t.object3D.position.copy(this.el.object3D.position)})),t.object3D.velocity=new THREE.Vector3(0,0,0),this.el.parentEl.append(t),this.drops.push(t)},tick(t,e){if(this.updateDrops(t,e),!this.el.is("grabbed"))return;let i=this.pool("up",THREE.Vector3);i.set(0,1,0),i.transformDirection(this.el.object3D.matrixWorld);let n=(1-i.dot(this.el.sceneEl.object3D.up))/2;if(n=THREE.Math.smootherstep(n,.005,1),!this.lastDropTime)return void(this.lastDropTime=t);let r=this.data.maxRate/n;t-this.lastDropTime>r&&(this.addDrop(),this.lastDropTime=t)},updateDrops(t,e){if(0===this.drops.length)return;let i=this.pool("nextPos",THREE.Vector3),n=Array.from(document.querySelectorAll(".canvas, .clickable")).filter((t=>!(t==this.el||this.el.contains(t)))).map((t=>t.object3D)),r=this.pool("dir",THREE.Vector3),a=this.pool("posWorld",THREE.Vector3),o=[];for(let t of this.drops){let s=t.object3D;s.velocity.y+=-9.8*e/1e3/1e3,s.velocity.clampLength(0,.005),i.copy(s.position),i.addScaledVector(s.velocity,e),r.copy(s.velocity).transformDirection(s.matrixWorld).normalize(),a.copy(s.position),s.parent.localToWorld(a),this.raycaster.set(a,r),this.raycaster.far=s.velocity.length()*e+.01,o.length=0,this.raycaster.intersectObjects(n,!0,o);let l=o.filter((t=>t.object.el)).sort((t=>navigator.xr?t.distance:-t.distance))[0];if(l){this.removeDrop(t);let e=l.object.el;if(e){let t,i=!1;"draw-canvas"in e.components?(i=!0,t=e.components["draw-canvas"]):"forward-draw"in e.components&&(i=!0,t=e.components["forward-draw"]),i&&t.drawUV(l.uv,{})}}s.position.copy(i),s.position.length()>10&&this.removeDrop()}},removeDrop(t){this.drops.indexOf(t)<0||(n.a.play("sfx-05",t),this.el.parentEl.removeChild(t),this.drops.splice(this.drops.indexOf(t),1))}}),AFRAME.registerComponent("six-dof-tool",{schema:{lockedClone:{default:!1},lockedComponent:{type:"string"},lockedComponentDependencies:{type:"array",default:[]},reparentOnActivate:{default:!0},summonable:{default:!1},orientation:{default:{x:0,y:-1,z:0},type:"vec3"}},events:{activate:function(){if(this.data.reparentOnActivate){console.log("Reparenting",this.data);let t=new THREE.Matrix4;this.el.object3D.updateMatrixWorld(),t.copy(this.el.object3D.matrixWorld),this.el.object3D.parent.remove(this.el.object3D),(document.querySelector("#activated-tool-root")||this.el.sceneEl).object3D.add(this.el.object3D),r.Util.applyMatrix(t,this.el.object3D)}}},init(){this.data.summonable&&!this.el.hasAttribute("summonable")&&this.el.setAttribute("summonable","once: true; activateOnSummon: true")}}),AFRAME.registerComponent("summonable",{schema:{speechOnly:{default:!1},once:{default:!0},activateOnSummon:{default:!0}},events:{activate:function(t){this.hasFlown=!0,(this.el.getAttribute("action-tooltips").trigger||"").startsWith("Summon")&&this.el.setAttribute("action-tooltips",{trigger:null})},click:function(t){this.data.once&&this.hasFlown||(!this.data.speechOnly||t.detail&&"speech"===t.detail.type)&&this.flyToUser()}},init(){this.el.setAttribute("action-tooltips",{trigger:"Summon "+(this.el.hasAttribute("preactivate-tooltip")?this.el.getAttribute("preactivate-tooltip"):"")})},flyToUser(){this.hasFlown=!0,r.Util.flyToCamera(this.el),this.data.activateOnSummon&&this.el.emit("activate")}}),AFRAME.registerComponent("viewport-tool",{dependencies:["six-dof-tool","grab-activate"],events:{click:function(t){this.positionViewport()}},init(){a.Pool.init(this),this.el.classList.add("grab-root");let t=document.createElement("a-cylinder");t.setAttribute("height",.3),t.setAttribute("radius",.07),t.setAttribute("segments-radial",6),t.setAttribute("segments-height",1),t.setAttribute("material","side: double; src: #asset-shelf; metalness: 0.4; roughness: 0.7"),t.classList.add("clickable"),t.setAttribute("propogate-grab",""),this.el.append(t);let e=document.createElement("a-cylinder");e.setAttribute("height",.06),e.setAttribute("radius",.16),e.setAttribute("segments-radial",6),e.setAttribute("segments-height",1),e.setAttribute("material","side: double; src: #asset-shelf; metalness: 0.4; roughness: 0.7"),e.classList.add("clickable"),e.setAttribute("propogate-grab",""),e.setAttribute("position","0 -0.15 0"),this.el.append(e);let i=document.createElement("a-cone");i.setAttribute("radius-bottom",.04),i.setAttribute("height",.08),i.setAttribute("position","0 0.08 -0.1"),i.setAttribute("rotation","-90 0 0"),i.setAttribute("segments-radial",4),i.setAttribute("material","src: #asset-shelf; metalness: 0.4; roughness: 0.7; flatShading: true"),this.el.append(i),this.el.setAttribute("summonable","speechOnly","true")},positionViewport(){document.querySelector("#camera").object3D;this.el.sceneEl.systems["artist-root"].resetPosition();let t=document.querySelector("#artist-root").object3D;r.Util.positionObject3DAtTarget(t,this.el.object3D),t.position.y-=document.querySelector("#camera-root").object3D.position.y-.6,t.quaternion.w=1,t.quaternion.y=0,t.quaternion.x=0,t.quaternion.z=0}}),AFRAME.registerComponent("movement-tool",{dependencies:["six-dof-tool","grab-activate","summonable"],schema:{speed:{default:2.5}},events:{activate:function(){this.tick=this._tick},stateremoved:function(t){"grabbed"===t.detail&&this.grip.object3D.position.set(0,0,0)}},init(){a.Pool.init(this),this.el.classList.add("grab-root"),this.el.setAttribute("grab-options","showHand: false");let t=document.createElement("a-cylinder");t.setAttribute("height",.3),t.setAttribute("radius",.07),t.setAttribute("segments-radial",6),t.setAttribute("segments-height",1),t.setAttribute("material","side: double; src: #asset-shelf; metalness: 0.4; roughness: 0.7"),t.classList.add("clickable"),t.setAttribute("propogate-grab",""),this.el.append(t);let e=document.createElement("a-entity");e.setAttribute("position","0 0.25 0");let i=document.createElement("a-sphere");i.setAttribute("radius",.07),i.setAttribute("segments-radial",6),i.setAttribute("segments-height",4),i.setAttribute("material","side: double; metalness: 0.7; roughness: 0.3"),i.setAttribute("constrain-to-sphere","innerRadius: 0; outerRadius: 0.14"),i.setAttribute("action-tooltips","grip: Move around"),i.classList.add("clickable"),e.append(i),this.gripPositioner=e,this.grip=i,this.el.append(e),this.artistRoot=document.querySelector("#artist-root")},tick(){},_tick(t,e){if(!this.grip.is("grabbed"))return;let i=this.pool("worldThis",THREE.Vector3),n=this.pool("worldGrip",THREE.Vector3);this.gripPositioner.object3D.getWorldPosition(i),this.grip.object3D.getWorldPosition(n),n.sub(i),this.artistRoot.object3D.position.addScaledVector(n,e/1e3*this.data.speed),this.artistRoot.object3D.scale.copy(this.grip.object3D.scale),this.artistRoot.object3D.scale.multiply(this.artistRoot.object3D.scale)}}),AFRAME.registerComponent("selection-box-tool",{dependencies:["six-dof-tool","grab-activate"],schema:{boxSize:{type:"vec3",default:{x:.2,y:.2,z:.2}},selector:{type:"string",default:".clickable, .canvas"},grabElements:{default:!0},grabVertices:{default:!1},selectVertices:{default:!1},selectElGeometry:{default:!0},undoable:{default:!1},duplicateOnGrab:{default:!1},weight:{default:0}},events:{stateadded:function(t){"grabbed"===t.detail&&this.startGrab()},stateremoved:function(t){"grabbed"===t.detail&&this.stopGrab()},click:function(t){this.toggleGrabbing(!this.grabbing)},bbuttondown:h("bbuttondown"),bbuttonup:h("bbuttonup"),abuttondown:h("abuttondown"),abuttonup:h("abuttonup"),xbuttondown:h("xbuttondown"),xbuttonup:h("xbuttonup"),ybuttondown:h("ybuttondown"),ybuttonup:h("ybuttonup")},emits:{grabstarted:{grabbed:null},grabended:{}},init(){this.el.classList.add("grab-root"),this.handle=this.el.sceneEl.systems["pencil-tool"].createHandle({radius:.07,height:.3,parentEl:this.el}),a.Pool.init(this),r.Util.emitsEvents(this);let t=document.createElement("a-box");this.box=t,t.classList.add("clickable"),t.setAttribute("material","color: #333; shader: matcap; wireframe: true"),this.el.append(t),this.grabbing=!1},update(t){if(this.box.setAttribute("width",this.data.boxSize.x),this.box.setAttribute("height",this.data.boxSize.y),this.box.setAttribute("depth",this.data.boxSize.z),this.box.setAttribute("position",{x:0,y:this.data.boxSize.y/2,z:0}),this.data.grabElements&&this.data.duplicateOnGrab)throw new Error("Duplicating elements doesn't work yet")},toggleGrabbing(t){this.grabbing!==t&&(this.grabbing=t,this.box.setAttribute("material","color",this.grabbing?"#6fde96":"#333"),this.grabbing&&this.el.is("grabbed")?this.startGrab():this.el.is("grabbed")&&this.stopGrab(),this.data.selectVertices&&(t?this.el.sceneEl.systems["vertex-handle"].selectors.push(this):this.el.sceneEl.systems["vertex-handle"].selectors.splice(this.el.sceneEl.systems["vertex-handle"].selectors.indexOf(this),1)))},selectPoints(t,e){for(let t of r.Util.meshPointsInContainerMesh(Compositor.mesh,this.box.getObject3D("mesh")))e.add(t)},selectObjects(){let t=document.querySelectorAll(this.data.selector);if(!this.data.grabElements){let e=[];for(let i of t)r.Util.traverseFindAll(i.object3D,(t=>"Mesh"===t.type||"SkinnedMesh"===t.type),{outputArray:e,visibleOnly:!0});t=e.map((t=>({object3D:t})))}return t},preprocessContainedTarget(t){},startGrab(){if(this.data.selectVertices)return;let t=this.selectObjects();this.grabbers={},this.grabbed={},this.grabberId={},this.grabChildren={},this.box.getObject3D("mesh").geometry.computeBoundingBox();let e=this.box.getObject3D("mesh").geometry.boundingBox,i=this.pool("worldPos",THREE.Vector3),n=this.pool("localPos",THREE.Vector3);for(let a of t){let t=this.data.grabElements?r.Util.resolveGrabRedirection(a):a;if(t===this.el)continue;if(t===this.box)continue;if(t.object3D.uuid in this.grabbers)continue;if(this.data.grabElements&&this.data.selectElGeometry){if(!a.getObject3D("mesh"))continue;if(!r.Util.visibleWithAncestors(a.object3D))continue;if(!r.Util.objectsIntersect(a.getObject3D("mesh"),this.box.object3D))continue}else if(this.data.grabElements){if(!r.Util.visibleWithAncestors(t.object3D))continue;if(a.object3D.getWorldPosition(i),n.copy(i),this.box.getObject3D("mesh").worldToLocal(n),!e.containsPoint(n))continue}else{let t=!1;for(let r=0;r<a.object3D.geometry.attributes.position.count;++r)if(i.fromBufferAttribute(a.object3D.geometry.attributes.position,r),a.object3D.localToWorld(i),this.box.getObject3D("mesh").worldToLocal(i),e.containsPoint(i)){t=!0,n.copy(i);break}if(!t)continue}if(this.preprocessContainedTarget(t),this.data.duplicateOnGrab){let e=t.object3D,i=e.clone(!0);e.parent.add(i),t.object3D=i}let o=new THREE.Object3D;if(this.el.object3D.add(o),this.data.weight>0&&(o.distanceWeight=THREE.Math.clamp(Math.sqrt(this.data.weight*n.length()/this.box.getObject3D("mesh").geometry.boundingSphere.radius),0,1)),r.Util.positionObject3DAtTarget(o,t.object3D),this.grabbers[t.object3D.uuid]=o,this.grabbed[o.uuid]=t,this.grabberId[o.uuid]=o,this.data.grabElements&&(t.grabbingManipulator=this,t.addState("grabbed")),this.grabVertices){let e=new THREE.Object3D;t.object3D.add(e),this.grabChildren[o.uuid]=e}}Object.values(this.grabbed).length>0&&u.Undo.collect((()=>{if(this.data.duplicateOnGrab)for(let t of Object.values(this.grabbed))u.Undo.push((()=>t.parent.remove(t)));else for(let t of Object.values(this.grabbed))u.Undo.pushObjectMatrix(t.object3D)})),this.tick=this._tick,Object.keys(this.grabbed).length>0&&(this.emitDetails.grabstarted.grabbed=this.grabbed,this.el.emit("grabstarted",this.emitDetails.grabstarted))},stopGrab(){if(!this.data.selectVertices){if(this.tick=function(){},this.data.grabElements)for(let t of Object.values(this.grabbed))delete t.grabbingManipulator,t.removeState("grabbed");this.data.duplicateOnGrab&&this.grabbing&&this.toggleGrabbing(!1),this.el.emit("grabended",this.emitDetails.grabended)}},tick(t,e){},_tick(t,e){if(!this.el.is("grabbed"))return;if(!this.grabbing)return;let i=this.pool("interpMat",THREE.Matrix4);for(let t of Object.values(this.grabbers))this.grabbed[t.uuid]&&this.grabbed[t.uuid].object3D&&this.grabbed[t.uuid].object3D.parent?this.data.weight>0?(i.copy(this.grabbed[t.uuid].object3D.matrix),r.Util.positionObject3DAtTarget(this.grabbed[t.uuid].object3D,t),r.Util.interpTransformMatrices(t.distanceWeight,this.grabbed[t.uuid].object3D.matrix,i,{result:this.grabbed[t.uuid].object3D.matrix}),r.Util.applyMatrix(this.grabbed[t.uuid].object3D.matrix,this.grabbed[t.uuid].object3D)):r.Util.positionObject3DAtTarget(this.grabbed[t.uuid].object3D,t):(console.warn("Grabbed object disappeared",t),delete this.grabbed[t.uuid])}});const d=t=>Math.log(t+1);AFRAME.registerComponent("dynamic-pencil-weight",{tick(t,e){if(!this.el.is("grabbed"))return;let i=this.el.components.raycaster.intersections[0];if(!i)return void(this.el.components["manipulator-weight"].data.weight=0);let n=this.el.components["pencil-tool"].calcFar(),r=i.distance/n;this.el.components["manipulator-weight"].data.weight=THREE.Math.mapLinear(d(r),d(0),d(1),.999,.1),console.log("Setting weight",this.el.components["manipulator-weight"].data.weight)}}),AFRAME.registerComponent("desk-registration-tool",{events:{bbuttonup:function(t){this.addPoint()},click:function(t){this.addPoint()}},init(){this.el.classList.add("grab-root"),this.handle=this.el.sceneEl.systems["pencil-tool"].createHandle({radius:.04,height:.3,parentEl:this.el});let t=document.createElement("a-entity");this.el.append(t),t.setAttribute("geometry","primitive: tetrahedron; radius: 0.02"),t.setAttribute("position","0 -0.3 0"),this.tip=t,this.el.sceneEl.systems["button-caster"].install(["bbutton"]),this.points=[]},addPoint(){let t;t=this.points.length>=3?this.points.shift():new THREE.Vector3,this.tip.object3D.getWorldPosition(t),this.points.push(t),this.points.length>=3&&this.regress(),console.log("Desk point",t.toArray())},regress(){let t=new THREE.Plane;t.setFromCoplanarPoints(...this.points),console.log("Aligning to desk",this.points,t);let e=new THREE.Vector3,i=Compositor.el.object3D;i.lookAt(t.normal),e.copy(this.points[0]),e.multiplyScalar(1/3),e.addScaledVector(this.points[1],1/3),e.addScaledVector(this.points[2],1/3),t.projectPoint(e,i.position)}});const p=new THREE.Vector3(0,0,1);AFRAME.registerComponent("straight-edge-tool",{dependencies:["grab-activate","six-dof-tool"],schema:{object:{type:"selector"},lockMostRecentTool:{default:!1}},init(){a.Pool.init(this),this.el.setAttribute("geometry","primitive: plane; width: 0.03; height: 0.1"),this.el.setAttribute("material","shader: standard; src: #asset-shelf");let t=document.createElement("a-entity");this.el.append(t),t.setAttribute("geometry","primitive: plane; width: 0.01; height: 0.1"),t.setAttribute("material","shader: standard; src: #asset-shelf; side: double"),t.setAttribute("rotation","0 90 0"),t.setAttribute("position","0.015 0 0"),this.startingPosition=new THREE.Vector3,this.startingQuaternion=new THREE.Quaternion,this.plane=new THREE.Plane(new THREE.Vector3(1,0,0)),this.obj=new THREE.Object3D,this.el.object3D.add(this.obj),this.el.classList.add("clickable"),this.el.sceneEl.systems.manipulator.installConstraint(this.el,this.moveObj.bind(this)),this.constraint=this.constraint.bind(this);let e=document.createElement("a-entity");this.el.append(e),e.setAttribute("icon-button","#asset-lead-pencil"),e.setAttribute("tooltip","Lock Last Used Tool"),e.setAttribute("toggle-button",{component:"straight-edge-tool",property:"lockMostRecentTool",target:this.el}),e.setAttribute("scale","0.05 0.05 0.05"),e.setAttribute("position","0 0.032 -0.047");let i=document.createElement("a-entity");this.el.append(i),i.setAttribute("icon-button","#asset-rotate-3d-variant"),i.setAttribute("tooltip","Align Angle"),i.setAttribute("scale","0.05 0.05 0.05"),i.setAttribute("position","-0.45 0.0 -0.047"),i.addEventListener("click",(()=>{let t=this.el.getAttribute("rotation");const e=45;this.el.setAttribute("rotation",`${Math.round(t.x/e)*e} ${Math.round(t.y/e)*e} ${Math.round(t.z/e)*e}`)}))},update(t){this.data.object!==t.object&&(this.object&&(this.el.sceneEl.systems.manipulator.removeConstraint(this.object,this.constraint),this.ready=!1,this.object=null),this.data.object&&(console.log("Locking",this.data.object),this.el.sceneEl.systems.manipulator.installConstraint(this.data.object,this.constraint),this.object=this.data.object)),this.data.lockMostRecentTool!==t&&this.el.sceneEl.systems["pencil-tool"].lastGrabbed&&(this.data.lockMostRecentTool?(this.el.setAttribute("straight-edge-tool","object",this.el.sceneEl.systems["pencil-tool"].lastGrabbed.el),this.constraint()):this.object===this.el.sceneEl.systems["pencil-tool"].lastGrabbed.el&&this.el.setAttribute("straight-edge-tool","object",null))},constraint(t,e,i){this.ready||(this.ready=!0,this.startingPosition.copy(this.data.object.object3D.position),this.startingQuaternion.copy(this.data.object.object3D.quaternion),r.Util.positionObject3DAtTarget(this.obj,this.data.object.object3D),this.plane.constant=0,this.plane.constant=-this.el.getAttribute("geometry").width/2),r.Util.positionObject3DAtTarget(this.obj,this.data.object.object3D),this.startingPosition.copy(this.obj.position),this.plane.projectPoint(this.startingPosition,this.obj.position),this.obj.quaternion.setFromUnitVectors(p,this.data.object.components["six-dof-tool"].data.orientation),r.Util.positionObject3DAtTarget(this.data.object.object3D,this.obj)},moveObj(){this.data.object&&this.ready&&r.Util.positionObject3DAtTarget(this.data.object.object3D,this.obj)}}),AFRAME.registerComponent("protractor-tool",{}),AFRAME.registerComponent("tool-weight-tool",{dependencies:["six-dof-tool","grab-activate"],schema:{weight:{default:.9}},events:{stateremoved:function(t){"grabbed"===t.detail&&this.attachToTool()},stateadded:function(t){"grabbed"===t.detail&&this.detachTool()},bbuttondown:function(t){this.el.is("grabbed")&&this.makeClone()}},init(){this.el.classList.add("grab-root"),this.handle=document.createElement("a-entity"),this.el.append(this.handle),this.handle.classList.add("clickable"),this.handle.setAttribute("propogate-grab",""),this.handle.setAttribute("geometry","primitive: torus; radius: 0.05; radiusTubular: 0.01; segmentsRadial: 8; segmentsTubular: 16"),this.handle.setAttribute("material","shader: matcap; src: #asset-shelf"),this.handle.setAttribute("rotation","90 0 0"),this.el.setAttribute("action-tooltips","b: Clone"),this.placeholder=new THREE.Object3D},attachToTool(){this.attachedTo||document.querySelectorAll("a-entity[six-dof-tool]").forEach((t=>{if(this.attachedTo)return;if(t===this.el)return;if(!r.Util.visibleWithAncestors(t.object3D))return;if(t.hasAttribute("tool-weight-tool"))return;if(!r.Util.objectsIntersect(this.handle.object3D,t.object3D))return;console.log("Intersecting tool",t);let e=this.placeholder;t.object3D.add(e),r.Util.positionObject3DAtTarget(e,this.el.object3D),t.object3D.add(this.el.object3D),r.Util.positionObject3DAtTarget(this.el.object3D,e),t.object3D.remove(e),t["tool-weight-tool-data"]||(t["tool-weight-tool-data"]={originalWeight:t.hasAttribute("manipulator-weight")?AFRAME.utils.clone(t.getAttribute("manipulator-weight")):null,weightCount:0}),t["tool-weight-tool-data"].weightCount++,t.setAttribute("manipulator-weight",`weight: ${this.calcWeight(t["tool-weight-tool-data"].weightCount)}; type: slow`),this.attachedTo=t}))},calcWeight(t){let e=0;for(let i=1;i<=t;i++)e+=1/Math.pow(2,i);return e},detachTool(){if(!this.attachedTo)return;let t=this.placeholder;this.el.sceneEl.object3D.add(t),r.Util.positionObject3DAtTarget(t,this.el.object3D),(document.querySelector("#world-root")||this.el.sceneEl).object3D.add(this.el.object3D),r.Util.positionObject3DAtTarget(this.el.object3D,t);let e=this.attachedTo;e["tool-weight-tool-data"].weightCount--,0===e["tool-weight-tool-data"].weightCount?(e["tool-weight-tool-data"].originalWeight?this.attachedTo.setAttribute("manipulator-weight",e["tool-weight-tool-data"].originalWeight):this.attachedTo.removeAttribute("manipulator-weight"),delete e["tool-weight-tool-data"]):e.setAttribute("manipulator-weight",`weight: ${this.calcWeight(e["tool-weight-tool-data"].weightCount)}; type: slow`),this.attachedTo=void 0},makeClone(){let t=document.createElement("a-entity");this.el.attachedTo?this.el.parentEl.append(t):this.el.sceneEl.append(t),r.Util.whenLoaded(t,(()=>{t.setAttribute("tool-weight-tool",this.el.getAttribute("tool-weight-tool")),r.Util.positionObject3DAtTarget(t.object3D,this.el.object3D),r.Util.whenComponentInitialized(t,"tool-weight-tool",(()=>{r.Util.whenLoaded(t.components["tool-weight-tool"].handle,(()=>{r.Util.callLater((()=>{console.log("tool weight initialized"),t.components["tool-weight-tool"].attachToTool()}))}))}))}))}}),AFRAME.registerComponent("lathe-selection-tool",{init(){this.el.setAttribute("selection-box-tool","boxSize: 0.1 0.4 0.1")}})},function(t,e,i){"use strict";i.r(e);var n=i(0),r=i(5),a=i(18),o=i(1),s=i(9),l=i.n(s);const c={};for(let t of i(388).keys()){let e=t.slice("./".length);if(e.startsWith("."))continue;let n=i(389)(`./${e}`);c[e]=n}AFRAME.registerSystem("brush-system",{schema:{autoLoadBrushes:{default:!1}},init(){this.data.autoLoadBrushes&&this.loadDefaultBrushes(),this.brushList=r.a,this.brusheTypes=o,this.brushPacks=c},loadDefaultBrushes(){r.a.push.apply(r.a,[new o.ImageBrush("s1","silky_textured",{width:20,height:20,autoRotate:!0}),new o.ImageBrush("s2","silky_textured",{textured:!0,width:64,height:16}),new o.ProceduralBrush("p1",{width:20,height:20,hardness:.9,connected:!0,hqBlending:!0,tooltip:"Hard"}),new o.ImageBrush("lines1","lines_condensed",{width:20,height:20,connected:!0,dragRotate:!0,tooltip:"Paint Brush"}),new o.ImageBrush("lines2","lines_condensed1",{width:20,height:20,connected:!0,dragRotate:!0,textured:!0}),new o.ImageBrush("lines3","line_grunge2",{width:20,height:20}),new o.ImageBrush("lines4","line_grunge1",{width:64,height:16,textured:!0}),new o.ImageBrush("dots1","dots",{width:20,height:20,autoRotate:!0,drawEdges:!1}),new o.LambdaBrush("lines5",{connected:!0,drawEdges:!0,hqBlending:!0,tooltip:"Vertical Line"},((t,{width:e,height:i})=>{t.beginPath(),t.moveTo(e/2,0),t.lineTo(e/2,i),t.stroke()})),new o.LambdaBrush("square",{connected:!0,drawEdges:!0,hqBlending:!0,tooltip:"Square"},((t,{width:e,height:i})=>{t.fillRect(0,0,e,i)})),new o.ImageBrush("diamond","diamond",{width:20,height:20,connected:!0,hqBlending:!0}),new o.FillBrush("fill1"),new o.FillBrush("fill2",{mode:"source-atop",previewSrc:i(37)}),new o.FxBrush("scatter",{baseBrush:new o.ImageBrush("s1","silky_textured",{width:20,height:20,autoRotate:!0}),type:"scatter"}),new o.NoiseBrush("noise1",{hidden:!0}),new o.FxBrush("noise2",{baseBrush:new o.ProceduralBrush("",{connected:!0,hqBlending:!1}),type:"noise",previewSrc:i(35)}),new o.ProceduralBrush("eraser",{connected:!0,hqBlending:!1,tooltip:"Default",mode:"destination-out",tooltip:"Eraser"}),new o.FxBrush("blur1",{baseBrush:new o.ProceduralBrush("",{connected:!0,hqBlending:!1}),type:"blur",previewSrc:i(34)}),new o.FxBrush("nudge1",{baseBrush:new o.ProceduralBrush("",{connected:!0,hqBlending:!1}),dragRotate:!0,type:"nudge",previewSrc:i(24)}),new o.FxBrush("nudeg2",{baseBrush:new o.ImageBrush("","lines2",{width:40,height:20,connected:!0}),dragRotate:!0,type:"nudge",previewSrc:i(24)}),new o.ProceduralBrush("charcoal1",{connected:!0,hqBlending:"always",minMovement:1.3,invertScale:!0,tooltip:"Charcoal Stick"}),new o.LineBrush("straight",{tooltip:"Straight Line"}),new o.FillShapeBrush("fill_shape",{tooltip:"Fill Shape",previewSrc:i(39)}),new o.StretchBrush("stretch_line_grunge1","line_grunge1",{tooltip:"Grunge"}),new o.StretchBrush("stretch_lines1","silky_textured",{tooltip:"Silky",textured:!0}),new o.StretchBrush("stretch_leaf","stamp_leaf1",{tooltip:"Leaf",textured:!0}),new o.StretchBrush("stretch_ink","ink",{tooltip:"Ink",textured:!1}),new o.StretchBrush("stretch_thick","thick_paint",{tooltip:"Thick Paint",textured:!0,switchbackAngle:100}),new o.StretchBrush("stretch_water2","watercolor",{tooltip:"Watercolor",textured:!1,switchbackAngle:90}),new o.StretchBrush("stretch_pencil","pencil-stroke",{tooltip:"Pencil Stroke",textured:!1}),new o.StretchBrush("stretch_pencil2","pencil-line",{tooltip:"Crayon",textured:!1,switchbackAngle:90}),new o.StretchBrush("stretch_pencil3","pencil2",{tooltip:"Pencil Line",textured:!1,switchbackAngle:90}),new o.ProceduralBrush("charcoal2",{connected:!0,hqBlending:"always",minMovement:.5,tooltip:"Charcoal Pencil",hidden:!0}),new o.ImageBrush("cloth1","cloth",{widht:48,height:48,drawEdges:!0,tooltip:"Hatches",hidden:!0})].filter((t=>!t.invalid)))},addUserBrushes(t){let e=document.querySelector("*[brush-shelf]")?document.querySelector("*[brush-shelf]").components["brush-shelf"]:null;if(e)for(let i of t)e.addBrush(o.Brush.fullRestore(i))},loadPack(t){c[t]?(console.log("Loading pack",t,c[t]),this.sceneEl.systems["file-upload"].handleURL(c[t])):console.warn("No such brush pack",t)}}),AFRAME.registerComponent("brush-editor",{schema:{type:{oneOf:["ImageBrush","StretchBrush","FxBrush"],default:"ImageBrush"},name:{default:"New Brush"},textured:{default:!1,passthrough:!0},mode:{default:"source-over",passthrough:!0},fx:{default:"scatter"},connected:{default:!0,passthrough:!0},autoRotate:{default:!1,passthrough:!0},dragRotate:{default:!0,passthrough:!0},hqBlending:{default:!1,passthrough:!0},requireMovement:{default:!1}},events:{componentchanged:function(t){"visible"===t.detail.name&&(this.el.getAttribute("visible")?(this.el.sceneEl.systems["file-upload"].fileInterceptors.push(this.interceptFile),this.useBrush(this.el.sceneEl.systems["paint-system"].brush)):this.el.sceneEl.systems["file-upload"].fileInterceptors.splice(this.el.sceneEl.systems["file-upload"].fileInterceptors.indexOf(this.interceptFile),1))},click:function(t){if(t.target.hasAttribute("click-action"))return this[t.target.getAttribute("click-action")](t),t.stopPropagation(),!0;t.target.hasAttribute("layer-mode")&&(this.el.setAttribute("brush-editor","mode",t.target.getAttribute("layer-mode")),t.target.emit("popupaction","close"))}},init(){this.interceptFile=this.interceptFile.bind(this),n.Util.whenLoaded(this.el.sceneEl,(()=>{let t=new Image;t.src=r.a[0].previewSrc,this.setImage(t),this.el.getAttribute("visible")&&this.el.sceneEl.systems["file-upload"].fileInterceptors.push(this.interceptFile)})),this.el.sceneEl.addEventListener("brushchanged",(t=>{if(!this.el.getAttribute("visible"))return;let e=t.detail.brush;this.useBrush(e)}))},interceptFile(t){for(let e=0;e<t.length;++e){let i=t[e];if(i.kind&&"file"!==i.kind)continue;let n=i instanceof File?i:i.getAsFile();if(!(i.type?/image\//.test(i.type):/\.(png|jpg|jpeg|bmp|svg)$/i.test(n.name)))continue;let r=new Image;return new Promise((t=>{r.onload=t,r.src=Object(a.toSrcString)(n)})).then((()=>{this.setImage(r)})),t.splice(e,1),!0}return!1},useCanvas(){let t=new Image;Compositor.component.quickDraw(),t.src=Compositor.component.preOverlayCanvas.toDataURL(),this.setImage(t)},useLayer(){let t=new Image;t.src=n.Util.autoCropCanvas(Compositor.drawableCanvas).toDataURL(),this.setImage(t)},useBrush(t){if(t.previewSrc instanceof Image)if(t.previewSrc.src.startsWith("blob:")||t.previewSrc.src.startsWith("http")){let e=new Image;e.src=t.previewSrc.src,e.src=n.Util.cloneCanvas(e).toDataURL(),e.width=t.previewSrc.width,e.height=t.previewSrc.height,this.setImage(e)}else this.setImage(t.previewSrc);else{let e=new Image;e.src=t.previewSrc,this.setImage(e)}},setImage(t){console.log("Setting image"),this.image=t,this.el.querySelector(".preview").setAttribute("material","src",t)},update(t){this.el.querySelectorAll(".image-brush, .stretch-brush, .fx-brush").forEach((t=>t.setAttribute("visible",!1)));let e="."+this.data.type.replace(/(?!^)([A-Z])/g,"-$1").toLowerCase();this.el.querySelectorAll(e).forEach((t=>t.setAttribute("visible",!0)))},createBrush(){if(!this.image)return void console.warn("Cannot create brush. No image set");let t,e={};for(let[t,i]of Object.entries(this.schema))i.passthrough&&(e[t]=this.data[t]);return this.data.requireMovement&&(e.minMovement=1),this.image.width>this.image.height?(e.width=24,e.height=24*this.image.height/this.image.width):(e.height=24,e.width=24*this.image.width/this.image.height),"FxBrush"===this.data.type?(e.baseBrush=new o.ImageBrush(l.a.generate(),this.image,e),e.type=this.data.fx,t=new o[this.data.type](l.a.generate(),e)):t=new o[this.data.type](l.a.generate(),this.image,e),t.user=!0,t},addBrush(){let t=this.createBrush();document.querySelector("*[brush-shelf]").components["brush-shelf"].addBrush(t),this.el.sceneEl.systems["paint-system"].selectBrush(r.a.length-1)},saveAll(){let t=[];for(let e of r.a)e.user&&(e.deleted||t.push(e.fullStore()));let e=JSON.stringify(t);this.el.sceneEl.systems["settings-system"].downloadCompressed(e,{extension:"vartiste-brushez"},"User created brushes")},deleteBrush(){let t=this.el.sceneEl.systems["paint-system"].brush;if(!t.user)return;let e=r.a.indexOf(t);if(e<0)return;let i=document.querySelector("*[brush-shelf]").components["brush-shelf"];t.deleted=!0,e===r.a.length-1?i.deleteLastBrush():i.hideBrushAt(e)}})},function(t,e,i){"use strict";e.byteLength=function(t){var e=c(t),i=e[0],n=e[1];return 3*(i+n)/4-n},e.toByteArray=function(t){var e,i,n=c(t),o=n[0],s=n[1],l=new a(function(t,e,i){return 3*(e+i)/4-i}(0,o,s)),u=0,h=s>0?o-4:o;for(i=0;i<h;i+=4)e=r[t.charCodeAt(i)]<<18|r[t.charCodeAt(i+1)]<<12|r[t.charCodeAt(i+2)]<<6|r[t.charCodeAt(i+3)],l[u++]=e>>16&255,l[u++]=e>>8&255,l[u++]=255&e;2===s&&(e=r[t.charCodeAt(i)]<<2|r[t.charCodeAt(i+1)]>>4,l[u++]=255&e);1===s&&(e=r[t.charCodeAt(i)]<<10|r[t.charCodeAt(i+1)]<<4|r[t.charCodeAt(i+2)]>>2,l[u++]=e>>8&255,l[u++]=255&e);return l},e.fromByteArray=function(t){for(var e,i=t.length,r=i%3,a=[],o=16383,s=0,l=i-r;s<l;s+=o)a.push(u(t,s,s+o>l?l:s+o));1===r?(e=t[i-1],a.push(n[e>>2]+n[e<<4&63]+"==")):2===r&&(e=(t[i-2]<<8)+t[i-1],a.push(n[e>>10]+n[e>>4&63]+n[e<<2&63]+"="));return a.join("")};for(var n=[],r=[],a="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,l=o.length;s<l;++s)n[s]=o[s],r[o.charCodeAt(s)]=s;function c(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var i=t.indexOf("=");return-1===i&&(i=e),[i,i===e?0:4-i%4]}function u(t,e,i){for(var r,a,o=[],s=e;s<i;s+=3)r=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(255&t[s+2]),o.push(n[(a=r)>>18&63]+n[a>>12&63]+n[a>>6&63]+n[63&a]);return o.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,i,n,r){var a,o,s=8*r-n-1,l=(1<<s)-1,c=l>>1,u=-7,h=i?r-1:0,d=i?-1:1,p=t[e+h];for(h+=d,a=p&(1<<-u)-1,p>>=-u,u+=s;u>0;a=256*a+t[e+h],h+=d,u-=8);for(o=a&(1<<-u)-1,a>>=-u,u+=n;u>0;o=256*o+t[e+h],h+=d,u-=8);if(0===a)a=1-c;else{if(a===l)return o?NaN:1/0*(p?-1:1);o+=Math.pow(2,n),a-=c}return(p?-1:1)*o*Math.pow(2,a-n)},e.write=function(t,e,i,n,r,a){var o,s,l,c=8*a-r-1,u=(1<<c)-1,h=u>>1,d=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:a-1,f=n?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,o=u):(o=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-o))<1&&(o--,l*=2),(e+=o+h>=1?d/l:d*Math.pow(2,1-h))*l>=2&&(o++,l/=2),o+h>=u?(s=0,o=u):o+h>=1?(s=(e*l-1)*Math.pow(2,r),o+=h):(s=e*Math.pow(2,h-1)*Math.pow(2,r),o=0));r>=8;t[i+p]=255&s,p+=f,s/=256,r-=8);for(o=o<<r|s,c+=r;c>0;t[i+p]=255&o,p+=f,o/=256,c-=8);t[i+p-f]|=128*m}},function(t,e){var i={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==i.call(t)}},function(t,e,i){(function(t,e){!function(t,i){"use strict";if(!t.setImmediate){var n,r,a,o,s,l=1,c={},u=!1,h=t.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(t);d=d&&d.setTimeout?d:t,"[object process]"==={}.toString.call(t.process)?n=function(t){e.nextTick((function(){f(t)}))}:!function(){if(t.postMessage&&!t.importScripts){var e=!0,i=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=i,e}}()?t.MessageChannel?((a=new MessageChannel).port1.onmessage=function(t){f(t.data)},n=function(t){a.port2.postMessage(t)}):h&&"onreadystatechange"in h.createElement("script")?(r=h.documentElement,n=function(t){var e=h.createElement("script");e.onreadystatechange=function(){f(t),e.onreadystatechange=null,r.removeChild(e),e=null},r.appendChild(e)}):n=function(t){setTimeout(f,0,t)}:(o="setImmediate$"+Math.random()+"$",s=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(o)&&f(+e.data.slice(o.length))},t.addEventListener?t.addEventListener("message",s,!1):t.attachEvent("onmessage",s),n=function(e){t.postMessage(o+e,"*")}),d.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),i=0;i<e.length;i++)e[i]=arguments[i+1];var r={callback:t,args:e};return c[l]=r,n(l),l++},d.clearImmediate=p}function p(t){delete c[t]}function f(t){if(u)setTimeout(f,0,t);else{var e=c[t];if(e){u=!0;try{!function(t){var e=t.callback,i=t.args;switch(i.length){case 0:e();break;case 1:e(i[0]);break;case 2:e(i[0],i[1]);break;case 3:e(i[0],i[1],i[2]);break;default:e.apply(void 0,i)}}(e)}finally{p(t),u=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,i(19),i(21))},function(t,e,i){i(380);const n=i(381),{fetchFile:r}=i(172);t.exports={createFFmpeg:n,fetchFile:r}},function(t,e,i){var n=function(t){"use strict";var e,i=Object.prototype,n=i.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},a=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",s=r.toStringTag||"@@toStringTag";function l(t,e,i){return Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,i){return t[e]=i}}function c(t,e,i,n){var r=e&&e.prototype instanceof g?e:g,a=Object.create(r.prototype),o=new k(n||[]);return a._invoke=function(t,e,i){var n=h;return function(r,a){if(n===p)throw new Error("Generator is already running");if(n===f){if("throw"===r)throw a;return S()}for(i.method=r,i.arg=a;;){var o=i.delegate;if(o){var s=T(o,i);if(s){if(s===m)continue;return s}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(n===h)throw n=f,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);n=p;var l=u(t,e,i);if("normal"===l.type){if(n=i.done?f:d,l.arg===m)continue;return{value:l.arg,done:i.done}}"throw"===l.type&&(n=f,i.method="throw",i.arg=l.arg)}}}(t,i,o),a}function u(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var h="suspendedStart",d="suspendedYield",p="executing",f="completed",m={};function g(){}function y(){}function b(){}var A={};A[a]=function(){return this};var v=Object.getPrototypeOf,w=v&&v(v(R([])));w&&w!==i&&n.call(w,a)&&(A=w);var E=b.prototype=g.prototype=Object.create(A);function _(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function x(t,e){function i(r,a,o,s){var l=u(t[r],t,a);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){i("next",t,o,s)}),(function(t){i("throw",t,o,s)})):e.resolve(h).then((function(t){c.value=t,o(c)}),(function(t){return i("throw",t,o,s)}))}s(l.arg)}var r;this._invoke=function(t,n){function a(){return new e((function(e,r){i(t,n,e,r)}))}return r=r?r.then(a,a):a()}}function T(t,i){var n=t.iterator[i.method];if(n===e){if(i.delegate=null,"throw"===i.method){if(t.iterator.return&&(i.method="return",i.arg=e,T(t,i),"throw"===i.method))return m;i.method="throw",i.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var r=u(n,t.iterator,i.arg);if("throw"===r.type)return i.method="throw",i.arg=r.arg,i.delegate=null,m;var a=r.arg;return a?a.done?(i[t.resultName]=a.value,i.next=t.nextLoc,"return"!==i.method&&(i.method="next",i.arg=e),i.delegate=null,m):a:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,m)}function M(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(M,this),this.reset(!0)}function R(t){if(t){var i=t[a];if(i)return i.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function i(){for(;++r<t.length;)if(n.call(t,r))return i.value=t[r],i.done=!1,i;return i.value=e,i.done=!0,i};return o.next=o}}return{next:S}}function S(){return{value:e,done:!0}}return y.prototype=E.constructor=b,b.constructor=y,y.displayName=l(b,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,l(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},t.awrap=function(t){return{__await:t}},_(x.prototype),x.prototype[o]=function(){return this},t.AsyncIterator=x,t.async=function(e,i,n,r,a){void 0===a&&(a=Promise);var o=new x(c(e,i,n,r),a);return t.isGeneratorFunction(i)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},_(E),l(E,s,"Generator"),E[a]=function(){return this},E.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var i in t)e.push(i);return e.reverse(),function i(){for(;e.length;){var n=e.pop();if(n in t)return i.value=n,i.done=!1,i}return i.done=!0,i}},t.values=R,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(C),!t)for(var i in this)"t"===i.charAt(0)&&n.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var i=this;function r(n,r){return s.type="throw",s.arg=t,i.next=n,r&&(i.method="next",i.arg=e),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var l=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(l&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i];if(r.tryLoc<=this.prev&&n.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=t,o.arg=e,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),C(i),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var n=i.completion;if("throw"===n.type){var r=n.arg;C(i)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,i,n){return this.delegate={iterator:R(t),resultName:i,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}(t.exports);try{regeneratorRuntime=n}catch(t){Function("r","regeneratorRuntime = r")(n)}},function(t,e,i){const{defaultArgs:n,baseOptions:r}=i(382),{setLogging:a,setCustomLogger:o,log:s}=i(171),l=i(383),c=i(384),{defaultOptions:u,getCreateFFmpegCore:h}=i(172),{version:d}=i(173),p=Error("ffmpeg.wasm is not ready, make sure you have completed load().");t.exports=(t={})=>{const{log:e,logger:i,progress:f,...m}={...r,...u,...t};let g=null,y=null,b=null,A=!1,v=f;const w=({type:t,message:e})=>{s(t,e),l(e,v),(t=>{"FFMPEG_END"===t&&null!==b&&(b(),b=null,A=!1)})(e)};return a(e),o(i),s("info",`use ffmpeg.wasm v${d}`),{setProgress:t=>{v=t},setLogger:t=>{o(t)},setLogging:a,load:async()=>{if(s("info","load ffmpeg-core"),null!==g)throw Error("ffmpeg.wasm was loaded, you should not load it again, use ffmpeg.isLoaded() to check next time.");{s("info","loading ffmpeg-core");const{createFFmpegCore:t,corePath:e,workerPath:i,wasmPath:n}=await h(m);g=await t({mainScriptUrlOrBlob:e,printErr:t=>w({type:"fferr",message:t}),print:t=>w({type:"ffout",message:t}),locateFile:(t,e)=>{if("undefined"!=typeof window){if(void 0!==n&&t.endsWith("ffmpeg-core.wasm"))return n;if(void 0!==i&&t.endsWith("ffmpeg-core.worker.js"))return i}return e+t}}),y=g.cwrap("proxy_main","number",["number","number"]),s("info","ffmpeg-core loaded")}},isLoaded:()=>null!==g,run:(...t)=>{if(s("info",`run ffmpeg command: ${t.join(" ")}`),null===g)throw p;if(A)throw Error("ffmpeg.wasm can only run one command at a time");return A=!0,new Promise((e=>{const i=[...n,...t].filter((t=>0!==t.length));b=e,y(...c(g,i))}))},exit:()=>{if(null===g)throw p;A=!1,g.exit(1),g=null,y=null,b=null},FS:(t,...e)=>{if(s("info",`run FS.${t} ${e.map((t=>"string"==typeof t?t:`<${t.length} bytes binary file>`)).join(" ")}`),null===g)throw p;{let i=null;try{i=g.FS[t](...e)}catch(i){throw"readdir"===t?Error(`ffmpeg.FS('readdir', '${e[0]}') error. Check if the path exists, ex: ffmpeg.FS('readdir', '/')`):"readFile"===t?Error(`ffmpeg.FS('readFile', '${e[0]}') error. Check if the path exists`):Error("Oops, something went wrong in FS operation.")}return i}}}}},function(t,e){t.exports={defaultArgs:["./ffmpeg","-nostdin","-y"],baseOptions:{log:!1,logger:()=>{},progress:()=>{},corePath:""}}},function(t,e){let i=0,n=0;const r=t=>{const[e,i,n]=t.split(":");return 60*parseFloat(e)*60+60*parseFloat(i)+parseFloat(n)};t.exports=(t,e)=>{if("string"==typeof t)if(t.startsWith("  Duration")){const a=t.split(", ")[0].split(": ")[1],o=r(a);e({duration:o,ratio:n}),(0===i||i>o)&&(i=o)}else if(t.startsWith("frame")||t.startsWith("size")){const a=t.split("time=")[1].split(" ")[0],o=r(a);n=o/i,e({ratio:n,time:o})}else t.startsWith("video:")&&(e({ratio:1}),i=0)}},function(t,e){t.exports=(t,e)=>{const i=t._malloc(e.length*Uint32Array.BYTES_PER_ELEMENT);return e.forEach(((e,n)=>{const r=t._malloc(e.length+1);t.writeAsciiToMemory(e,r),t.setValue(i+Uint32Array.BYTES_PER_ELEMENT*n,r,"i32")})),[e.length,i]}},function(t,e,i){(function(e){const n=i(43),{devDependencies:r}=i(173);t.exports={corePath:void 0!==e&&"development"===e.env.FFMPEG_ENV?n("/node_modules/@ffmpeg/core/dist/ffmpeg-core.js"):`https://unpkg.com/@ffmpeg/core@${r["@ffmpeg/core"].substring(1)}/dist/ffmpeg-core.js`}}).call(this,i(21))},function(t,e,i){const n=i(43),{log:r}=i(171),a=async(t,e)=>{r("info",`fetch ${t}`);const i=await(await fetch(t)).arrayBuffer();r("info",`${t} file size = ${i.byteLength} bytes`);const n=new Blob([i],{type:e}),a=URL.createObjectURL(n);return r("info",`${t} blob URL = ${a}`),a};t.exports=async({corePath:t})=>{if("string"!=typeof t)throw Error("corePath should be a string!");const e=n(t),i=await a(e,"application/javascript"),o=await a(e.replace("ffmpeg-core.js","ffmpeg-core.wasm"),"application/wasm"),s=await a(e.replace("ffmpeg-core.js","ffmpeg-core.worker.js"),"application/javascript");return"undefined"==typeof createFFmpegCore?new Promise((t=>{const e=document.createElement("script"),n=()=>{e.removeEventListener("load",n),r("info","ffmpeg-core.js script loaded"),t({createFFmpegCore:createFFmpegCore,corePath:i,wasmPath:o,workerPath:s})};e.src=i,e.type="text/javascript",e.addEventListener("load",n),document.getElementsByTagName("head")[0].appendChild(e)})):(r("info","ffmpeg-core.js script is loaded already"),Promise.resolve({createFFmpegCore:createFFmpegCore,corePath:i,wasmPath:o,workerPath:s}))}},function(t,e,i){const n=i(43);t.exports=async t=>{let e=t;if(void 0===t)return new Uint8Array;if("string"==typeof t)if(/data:_data\/([a-zA-Z]*);base64,([^"]*)/.test(t))e=atob(t.split(",")[1]).split("").map((t=>t.charCodeAt(0)));else{const i=await fetch(n(t));e=await i.arrayBuffer()}else(t instanceof File||t instanceof Blob)&&(e=await(i=t,new Promise(((t,e)=>{const n=new FileReader;n.onload=()=>{t(n.result)},n.onerror=({target:{error:{code:t}}})=>{e(Error(`File could not be read! Code=${t}`))},n.readAsArrayBuffer(i)}))));var i;return new Uint8Array(e)}},function(t,e,i){var n={"./cloudy.vartiste-brushez":174,"./fire.vartiste-brushez":175,"./misc.vartiste-brushez":176};function r(t){var e=a(t);return i(e)}function a(t){if(!i.o(n,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return n[t]}r.keys=function(){return Object.keys(n)},r.resolve=a,t.exports=r,r.id=388},function(t,e,i){var n={"./cloudy.vartiste-brushez":174,"./fire.vartiste-brushez":175,"./misc.vartiste-brushez":176};function r(t){var e=a(t);return i(e)}function a(t){if(!i.o(n,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return n[t]}r.keys=function(){return Object.keys(n)},r.resolve=a,t.exports=r,r.id=389},function(t,e,i){"use strict";i.r(e);var n,r=i(0),a=i(3),o=i(2);r.Util.registerComponentSystem("avatar",{schema:{importAvatar:{default:!1},leftHandEl:{type:"selector",default:"#left-hand"},rightHandEl:{type:"selector",default:"#right-hand"},debug:{default:!1}},init(){this.intercept=this.intercept.bind(this),this.onGripClose=this.onGripClose.bind(this),this.onGripOpen=this.onGripOpen.bind(this),this.rightHandTransform=(new THREE.Matrix4).makeRotationFromEuler(new THREE.Euler(-Math.PI/2,-Math.PI/2,0)),this.leftHandTransform=(new THREE.Matrix4).makeRotationFromEuler(new THREE.Euler(-Math.PI/2,Math.PI/2,0)),this.hipTransform=(new THREE.Matrix4).identity(),this.headTransform=(new THREE.Matrix4).makeRotationFromEuler(new THREE.Euler(0,Math.PI,0))},update(t){this.data.importAvatar&&!t.importAvatar?(console.log("Registering import avatar handler"),this.el.sceneEl.systems["file-upload"].fileInterceptors.push(this.intercept)):!this.data.importAvatar&&t.importAvatar&&(console.log("Clearing import avatar handler"),this.el.sceneEl.systems["file-upload"].fileInterceptors.splice(this.el.sceneEl.systems["file-upload"].fileInterceptors.indexOf(this.intercept),1)),this.data.leftHandEl!==t.leftHandEl&&(t.leftHandEl&&(t.leftHandEl.removeEventListener("gripup",this.onGripOpen),t.leftHandEl.removeEventListener("gripdown",this.onGripClose)),this.data.leftHandEl.addEventListener("gripup",this.onGripOpen),this.data.leftHandEl.addEventListener("gripdown",this.onGripClose)),this.data.rightHandEl!==t.rightHandEl&&(t.rightHandEl&&(t.rightHandEl.removeEventListener("gripup",this.onGripOpen),t.rightHandEl.removeEventListener("gripdown",this.onGripClose)),this.data.rightHandEl.addEventListener("gripup",this.onGripOpen),this.data.rightHandEl.addEventListener("gripdown",this.onGripClose))},onGripClose(t){let e=t.target===this.data.rightHandEl?this.rightGripAnim:this.leftGripAnim;e&&r.Util.callLater((()=>e.play()))},onGripOpen(t){let e=t.target===this.data.rightHandEl?this.rightGripAnim:this.leftGripAnim;e&&r.Util.callLater((()=>e.stop()))},intercept(t){console.log("Handling avatar");for(let e=0;e<t.length;++e){let i=t[e];if(console.log("Checking",i,i instanceof Blob,i.kind),"file"!==i.kind&&!(i instanceof Blob))continue;let n=i instanceof Blob?i:i.getAsFile(),r=/\.(glb|vrm)$/i.test(n.name);if(console.log("IsGLB",r),r)return(async()=>{let t,e=new THREE.GLTFLoader,i=await n.arrayBuffer();try{t=await new Promise(((t,n)=>e.parse(i,"",t,n)))}catch(t){return console.error("Could not load model",t),void(window.loadErrorBuffer=i)}console.log("Loaded Avatar",t),this.scene&&this.scene.parent.remove(this.scene),await this.setAvatarModel(t)})(),!0}},async setAvatarModel(t){if(this.scene=t.scene||(t.scenes?t.scenes[0]:null)||t,this.animations=t.animations,this.el.sceneEl.object3D.add(this.scene),this.scene.traverse((t=>{this.data.debug||(t.layers.disableAll(),t.layers.enable(o.CAMERA_LAYERS.SPECTATOR)),t.frustumCulled=!1,t instanceof THREE.Mesh&&(t.castShadow=!0,t.receiveShadow=!0)})),this.leftHand=r.Util.traverseFind(this.scene,(t=>"LeftHand"===t.name)),this.rightHand=r.Util.traverseFind(this.scene,(t=>"RightHand"===t.name)),this.head=r.Util.traverseFind(this.scene,(t=>"Head"===t.name)),this.hips=r.Util.traverseFind(this.scene,(t=>"Hips"===t.name)),this.head&&this.hips){let t=new THREE.Vector3,e=new THREE.Vector3;this.hips.getWorldPosition(t),this.head.getWorldPosition(e),e.sub(t),this.headToHip=e}if(this.mixer=null,this.animations.length>0){this.mixer=new THREE.AnimationMixer(this.scene);let t=this.animations.find((t=>"allGrip_L"===t.name));this.leftGripAnim=t?this.mixer.clipAction(t):null;let e=this.animations.find((t=>"allGrip_R"===t.name));this.rightGripAnim=e?this.mixer.clipAction(e):null,this.mixer.setTime(10)}this.startAudioMonitoring()},async startAudioMonitoring(){n||(n=window.Tone?window.Tone:await i.e(0).then(i.bind(null,182)));const t=new n.Meter({normalRange:!0}),e=(new n.UserMedia).connect(t);await e.open(),console.log("mic open"),this.meter=t},tick(t,e){if(this.scene){if(this.mixer&&this.mixer.update(0),!this.data.debug){let t=r.Util.cameraObject3D();if(this.hips&&(t.getWorldPosition(this.hips.position),this.hips.parent.worldToLocal(this.hips.position),this.hips.position.sub(this.headToHip),this.hips.rotation.y=Math.PI),this.head&&(r.Util.positionObject3DAtTarget(this.head,t),this.head.matrix.multiply(this.headTransform),r.Util.applyMatrix(this.head.matrix,this.head)),this.leftHand&&(r.Util.positionObject3DAtTarget(this.leftHand,this.data.leftHandEl.object3D),this.leftHand.matrix.multiply(this.leftHandTransform),r.Util.applyMatrix(this.leftHand.matrix,this.leftHand)),this.rightHand&&(r.Util.positionObject3DAtTarget(this.rightHand,this.data.rightHandEl.object3D),this.rightHand.matrix.multiply(this.rightHandTransform),r.Util.applyMatrix(this.rightHand.matrix,this.rightHand)),this.leftHand&&this.rightHand)for(let t of[this.data.leftHandEl,this.data.rightHandEl])t.object3D.traverse((t=>{t.layers.disable(o.CAMERA_LAYERS.DEFAULT),t.layers.disable(o.CAMERA_LAYERS.SPECTATOR),t.layers.enable(o.CAMERA_LAYERS.LEFT_EYE),t.layers.enable(o.CAMERA_LAYERS.RIGHT_EYE)}))}if(this.meter){let t=this.meter.getValue();t=Math.min(1,5*t),this.scene.traverse((e=>{let i=e.userData.hubs_component_morph_audio_feedback;if(e.userData.gltfExtensions&&e.userData.gltfExtensions.MOZ_hubs_components&&(i=e.userData.gltfExtensions.MOZ_hubs_components["morph-audio-feedback"]),!i)return;let n=THREE.MathUtils.mapLinear(t,0,1,i.minValue,i.maxValue);i.name in e.morphTargetDictionary?e.morphTargetInfluences[e.morphTargetDictionary[i.name]]=n:console.warn("No such morph target",i.name,e)}))}}}}),r.Util.registerComponentSystem("avatar-pose-export-provider",{schema:{throttle:{default:100}},init(){a.Pool.init(this),this.tick=AFRAME.utils.throttleTick(this.tick,this.data.throttle,this),this.needsUpdate=!1,this.hasUpdatedThisTick=!1,this.updateEmitData={leftHand:{matrix:{elements:new Float32Array(16)},visible:!1},rightHand:{matrix:{elements:new Float32Array(16)},visible:!1},head:{matrix:{elements:new Float32Array(16)},visible:!0},canvas:{matrix:{elements:new Float32Array(16)},width:null,height:null,visible:!0},tool:{matrix:null}},this.poserEl=document.createElement("a-entity"),this.el.append(this.poserEl),this.poser=this.poserEl.object3D,r.Util.whenLoaded(this.el,(async()=>{this.rightHandEl=document.querySelector("#right-hand"),this.leftHandEl=document.querySelector("#left-hand")}))},updatePose(){if(!this.needsUpdate)return this.updateEmitData;if(this.hasUpdatedThisTick)return this.updateEmitData;this.pool("canvasLocation",THREE.Vector3);Compositor.el.object3D.updateMatrixWorld(),this.updateEmitData.canvas.matrix.elements.set(Compositor.el.object3D.matrix.elements),this.updateEmitData.canvas.width=Compositor.el.getAttribute("geometry").width,this.updateEmitData.canvas.height=Compositor.el.getAttribute("geometry").height;let t=this.el.sceneEl.systems["pencil-tool"].lastGrabbed;return t&&t.el.is("grabbed")?this.updateEmitData.tool.matrix=t.el.object3D.matrixWorld.elements:this.updateEmitData.tool.matrix=null,this.updateObj(this.leftHandEl,this.updateEmitData.leftHand),this.updateObj(this.rightHandEl,this.updateEmitData.rightHand),this.updateObj(r.Util.cameraObject3D(),this.updateEmitData.head),this.updateEmitData.leftHand.visible=!!this.leftHandEl.getObject3D("mesh"),this.updateEmitData.rightHand.visible=!!this.rightHandEl.getObject3D("mesh"),this.needsUpdate=!1,this.hasUpdatedThisTick=!0,this.updateEmitData},updateObj(t,e){t instanceof THREE.Object3D||(t=t.object3D),r.Util.positionObject3DAtTarget(this.poser,t),this.poser.updateMatrixWorld(),e.matrix.elements.set(this.poser.matrixWorld.elements)},tick(t,e){this.updatePose()},tock(){this.hasUpdatedThisTick=!1}}),AFRAME.registerComponent("remote-avatar",{schema:{id:{type:"string"},throttle:{default:100}},init(){this.tick=AFRAME.utils.throttleTick(this.tick,this.data.throttle,this),this.el.innerHTML=i(160),r.Util.whenLoaded(this.el,(()=>{this.head=this.el.querySelector(".remote-head"),this.leftHand=this.el.querySelector(".remote-left"),this.rightHand=this.el.querySelector(".remote-right"),this.canvas=this.el.querySelector(".remote-canvas")})),this.el.classList.add("grab-root")},updateObj(t,e){t&&(e.matrix.fromArray(new Float32Array(t.matrix.elements)||t.matrix),e.matrix.decompose(e.position,e.quaternion,e.scale),e.visible=!1!==t.visible)},updatePose(t){this.poseData=t},_updatePose(t){this.head&&(this.updateObj(t.head,this.head.object3D),this.updateObj(t.rightHand,this.rightHand.object3D),this.updateObj(t.leftHand,this.leftHand.object3D),this.updateObj(t.canvas,this.canvas.object3D))},tick(t,e){this.poseData&&(this._updatePose(this.poseData),this.poseData=null)}}),AFRAME.registerComponent("spectator-avatar",{events:{object3dset:function(t){this.setAvatar()}},init(){this.setAvatar()},setAvatar(){this.el.getObject3D("mesh")&&this.el.sceneEl.systems.avatar.setAvatarModel(this.el.getObject3D("mesh"))}})},function(t,e){t.exports="#version 100\nprecision mediump float;\nuniform sampler2D u_input;\nuniform sampler2D u_base;\nvarying vec2 vUv;\nvoid main() {\n\tvec3 vec = texture2D(u_input, vUv).xyz;\n\tvec3 base = texture2D(u_base, vUv).xyz;\n\tvec.x = (vec.x + base.x) - 1.0;\n\tvec.y = (vec.y + base.y) - 1.0;\n\tvec.x = clamp(vec.x + 0.5, 0.0, 1.0);\n\tvec.y = clamp(vec.y + 0.5, 0.0, 1.0);\n\tvec.z = max(vec.z, base.z);\n\tgl_FragColor = vec4(vec, 1.0);\n}\n"},function(t,e,i){"use strict";i.r(e);var n=i(8);const r=i(158);class a{constructor(t,e){if(!e.title)throw new Error("Must specify busy title");Object.assign(this,e),this.system=t,this.startTime=this.system.el.sceneEl.time,this.finished=!1,this.doneCallbacks=null}done(){if(this.finished)console.warn("Already finsihed job",this.title);else{if(this.finished=!0,this.endTime=this.system.el.sceneEl.time,this.duration=this.endTime-this.startTime,this.doneCallbacks)for(let t of this.doneCallbacks)t();this.system.ended(this),console.info(`${this.title} took ${this.duration} ms`)}}error(t){this.done(),console.error(t),this.system.displayError(`Error during ${this.title}:\n${t}`)}await(){return this.doneCallbacks||(this.doneCallbacks=[]),new Promise(((t,e)=>{this.doneCallbacks.push(t)}))}}AFRAME.registerSystem("busy-indicator",{init(){this.indicators=[],this.busyObjects=new Set},busy(t){let e=new a(this,t);return this.busyObjects.add(e),this.setupIndicators(),e},ended(t){this.busyObjects.delete(t),this.setupIndicators()},setupIndicators(){if(0===this.busyObjects.size){for(let t of this.indicators)t.el.setAttribute("visible",!1),t.el.pause();return}let t="Busy...\n"+Array.from(this.busyObjects).map((t=>"- "+t.title)).join("\n");for(let e of this.indicators)e.el.setAttribute("visible",!0),e.el.setAttribute("tooltip",t),e.el.play()},register(t){this.indicators.push(t),this.setupIndicators()},unregister(t){this.indicators.splice(this.indicators.indexOf(this))},displayError(t){for(let e of this.indicators)e.showError(t.toString())}}),AFRAME.registerComponent("busy-indicator",{init(){this.el.innerHTML=r,this.system.register(this)},remove(){this.system.unregister(this)},showError(t){let e=document.createElement("a-entity");this.el.sceneEl.append(e),e.setAttribute("text","wrapCount: 20; color: red;"),e.setAttribute("text","value",t),e.setAttribute("frame","closable: true"),VARTISTE.Util.whenLoaded(e,(()=>{VARTISTE.Util.positionObject3DAtTarget(e.object3D,this.el.object3D)})),n.a.play("error",this.el)}})},function(t,e,i){"use strict";i.r(e);var n=i(5),r=(i(4),i(31)),a=i(0);AFRAME.registerComponent("brush-shelf",{init(){this.system=this.el.sceneEl.systems["paint-system"],this.el.innerHTML=i(157),this.el.addEventListener("click",(t=>{if(t.target.hasAttribute("click-action"))console.log("Clicked",t.target.getAttribute("click-action")),this[t.target.getAttribute("click-action")+"Action"](t);else if(t.target.hasAttribute("brush-idx")){let e=t.target.getAttribute("brush-idx");this.system.selectBrush(e)}})),this.el.sceneEl.addEventListener("brushchanged",(t=>{t.detail.brush;let e=t.detail.index;for(let t of this.el.querySelectorAll("*[brush-idx]"))t.getAttribute("brush-idx")==e?t.addState(r.STATE_TOGGLED):t.removeState(r.STATE_TOGGLED)})),this.brushRow=document.createElement("a-entity"),this.el.querySelector(".brushes").append(this.brushRow),a.Util.whenLoaded(this.el,(async()=>{this.brushButtons=[];for(let t=0;t<n.a.length;++t)await this.addBrush(n.a[t],!0)}))},async addBrush(t,e=!1){if(t.hidden)return;if(this.nextTimeExpand){if(this.el.querySelector(".brushes").children.length>4){let t=this.el.querySelector(".brushes").children.length-4;this.el.setAttribute("shelf","height",3.5+.6*t),this.el.setAttribute("shelf","offset",`0 ${.6*-t/2} 0`)}this.nextTimeExpand=!1}let i=document.createElement("a-entity"),r=n.a.indexOf(t);r<0&&(n.a.push(t),r=n.a.length-1),i.setAttribute("icon-button",t.previewSrc),i.setAttribute("brush-idx",r),i.setAttribute("tooltip",t.tooltip),i.setAttribute("action-tooltips","trigger: Set Brush"),this.brushButtons.push(i),this.brushRow.append(i),e&&await a.Util.whenLoaded(i),n.a.filter((t=>!t.hidden)).indexOf(t)%8==7&&(e&&(await a.Util.delay(10),this.brushRow.setAttribute("icon-row","autoPosition: false; mergeButtons: true")),this.brushRow=document.createElement("a-entity"),this.brushRow.setAttribute("position",`0 ${-.6*this.el.querySelector(".brushes").children.length} 0`),this.el.querySelector(".brushes").append(this.brushRow),this.nextTimeExpand=!0)},deleteLastBrush(){Array.from(this.el.querySelectorAll("*[brush-idx]")).slice(-1)[0].remove(),n.a.pop()},hideBrushAt(t){this.el.querySelector(`*[brush-idx="${t}"]`).setAttribute("visible",!1)},toggleRotationAction(){this.system.setRotateBrush(!this.system.data.rotateBrush)},toggleOrientationAction(){document.querySelectorAll("*[hand-draw-tool]").forEach((t=>t.setAttribute("tracked-controls",{orientationOffset:{x:133,y:180,z:90}})))},increaseBrushSizeAction(){this.system.scaleBrush(100)},decreaseBrushSizeAction(){this.system.scaleBrush(-100)},clearLayerAction(){this.el.sceneEl.systems["cut-copy-system"].clear()}})},function(t,e,i){"use strict";i.r(e),i.d(e,"Intersector",(function(){return d})),i.d(e,"System",(function(){return m}));var n=i(7),r=i.n(n),a={showArm:!0,opacity:1,segments:16,boneScale:1/6,boneColor:16777215,jointScale:.2,jointColor:null},o=[6138368,10485825],s=(new THREE.Quaternion).setFromEuler(new THREE.Euler(Math.PI/2,0,0)),l=(new THREE.Quaternion).setFromEuler(new THREE.Euler(0,0,Math.PI/2)),c=0;function u(t){this.options=t=Object.assign({},a,t||{}),this.options.jointColor=this.options.jointColor||o[c%2],this.object3D=new THREE.Object3D,this.material=isNaN(t.opacity)?new THREE.MeshPhongMaterial({fog:!1}):new THREE.MeshPhongMaterial({fog:!1,transparent:!0,opacity:t.opacity}),this.createFingers(),this.createArm(),c++}u.prototype.createFingers=function(){var t,e,i,n=this.options,r=40*n.boneScale,a=40*n.jointScale;this.fingerMeshes=[];for(var o=0;o<5;o++){e=[],i=0===o?3:4;for(var s=0;s<i;s++)(t=new THREE.Mesh(new THREE.SphereGeometry(a,n.segments,n.segments),this.material.clone())).name="hand-bone-"+s,t.material.color.setHex(n.jointColor),this.object3D.add(t),e.push(t),(t=new THREE.Mesh(new THREE.CylinderGeometry(r,r,40,n.segments),this.material.clone())).name="hand-joint-"+s,t.material.color.setHex(n.boneColor),this.object3D.add(t),e.push(t);(t=new THREE.Mesh(new THREE.SphereGeometry(a,n.segments,n.segments),this.material.clone())).material.color.setHex(n.jointColor),this.object3D.add(t),e.push(t),this.fingerMeshes.push(e)}return this},u.prototype.createArm=function(){if(this.options.showArm){var t=this.options,e=40*t.boneScale,i=40*t.jointScale;this.armMesh=new THREE.Object3D,this.armBones=[],this.armSpheres=[];for(var n=0;n<=3;n++)this.armBones.push(new THREE.Mesh(new THREE.CylinderGeometry(e,e,n<2?1e3:100,t.segments),this.material.clone())),this.armBones[n].material.color.setHex(t.boneColor),this.armBones[n].castShadow=!0,this.armBones[n].name="ArmBone"+n,n>1&&this.armBones[n].quaternion.multiply(l),this.armMesh.add(this.armBones[n]);for(this.armSpheres=[],n=0;n<=3;n++)this.armSpheres.push(new THREE.Mesh(new THREE.SphereGeometry(i,t.segments,t.segments),this.material.clone())),this.armSpheres[n].material.color.setHex(t.jointColor),this.armSpheres[n].castShadow=!0,this.armSpheres[n].name="ArmSphere"+n,this.armMesh.add(this.armSpheres[n]);return this.object3D.add(this.armMesh),this}},u.prototype.traverse=function(t){for(var e,i=0;i<5;i++)for(var n=0,r=(e=this.fingerMeshes[i]).length;n<r;n++)t(e[n]);return this.armMesh&&this.armMesh.traverse(t),this},u.prototype.scaleTo=function(t){var e,i,n,r,a,o,s,l,c,u,h,d,p;for(n=t.middleFinger.proximal.length/this.fingerMeshes[2][1].geometry.parameters.height,c=d=0;d<5;c=++d)for(o=t.fingers[c],u=0;;){if(u===this.fingerMeshes[c].length-1){(h=this.fingerMeshes[c][u]).scale.set(n,n,n);break}r=o.bones[3-u/2],(h=this.fingerMeshes[c][u]).scale.set(n,n,n),u++,h=this.fingerMeshes[c][u],s=r.length/h.geometry.parameters.height,h.scale.set(n,s,n),u++}if(this.options.showArm){for(e=t.arm.length/(this.armBones[0].geometry.parameters.height+this.armBones[0].geometry.parameters.radiusTop),i=t.arm.width/(this.armBones[2].geometry.parameters.height+this.armBones[2].geometry.parameters.radiusTop),c=p=0;p<=3;c=++p)this.armBones[c].scale.set(n,c<2?e:i,n),this.armSpheres[c].scale.set(n,n,n);a=t.arm.width/2*.85,l=t.arm.length/2,this.armBones[0].position.setX(a),this.armBones[1].position.setX(-a),this.armBones[2].position.setY(l),this.armBones[3].position.setY(-l),this.armSpheres[0].position.set(-a,l,0),this.armSpheres[1].position.set(a,l,0),this.armSpheres[2].position.set(a,-l,0),this.armSpheres[3].position.set(-a,-l,0)}return this},u.prototype.formTo=function(t){var e,i,n,r,a,o;for(n=o=0;o<5;n=++o)for(i=t.fingers[n],r=0;;){if(r===this.fingerMeshes[n].length-1){(a=this.fingerMeshes[n][r]).position.fromArray(e.prevJoint);break}e=i.bones[3-r/2],(a=this.fingerMeshes[n][r]).position.fromArray(e.nextJoint),++r,(a=this.fingerMeshes[n][r]).position.fromArray(e.center()),a.setRotationFromMatrix((new THREE.Matrix4).fromArray(e.matrix())),a.quaternion.multiply(s),++r}return this.armMesh&&(this.armMesh.position.fromArray(t.arm.center()),this.armMesh.setRotationFromMatrix((new THREE.Matrix4).fromArray(t.arm.matrix())),this.armMesh.quaternion.multiply(s)),this},u.prototype.setVisibility=function(t){for(var e,i=0;i<5;i++)for(e=0;this.fingerMeshes[i][e].visible=t,++e!==this.fingerMeshes[i].length;);if(this.options.showArm)for(var n=0;n<=3;n++)this.armBones[n].visible=t,this.armSpheres[n].visible=t;return this},u.prototype.show=function(){return this.setVisibility(!0),this},u.prototype.hide=function(){return this.setVisibility(!1),this},u.prototype.getMesh=function(){return this.object3D};function h(t){this._index=0,this._size=t,this._array=[]}function d(){this.arrowHelper=this.createArrowHelper(),this.raycaster=new THREE.Raycaster(new THREE.Vector3,new THREE.Vector3,0,.2)}window.Leap=r.a,h.prototype._incr=function(){this._index=++this._index%this._size},h.prototype.array=function(){return this._array},h.prototype.push=function(t){this._array[this._index]=t,this._incr()},d.prototype.update=function(t,e,i,n){this.holdDistance=t.holdDistance,this.debug=t.debug,this.raycaster.far=this.holdDistance,this.raycaster.ray.direction.fromArray(i.palmNormal),this.raycaster.ray.direction.multiplyScalar(-1),this.raycaster.ray.direction.normalize(),this.raycaster.ray.origin.fromArray(i.palmPosition),e.localToWorld(this.raycaster.ray.origin),this.debug?(this.arrowHelper=this.arrowHelper||this.createArrowHelper(),this.arrowHelper.position.copy(this.raycaster.ray.origin),e.worldToLocal(this.arrowHelper.position),this.arrowHelper.setDirection(this.raycaster.ray.direction),this.arrowHelper.setLength(this.holdDistance),this.arrowHelper.setColor(n?16711680:65280)):delete this.arrowHelper},d.prototype.intersectObjects=function(t,e){return this.raycaster.intersectObjects(t,e)},d.prototype.createArrowHelper=function(){return new THREE.ArrowHelper(new THREE.Vector3(1,0,0),new THREE.Vector3,this.holdDistance)},d.prototype.getMesh=function(){return this.arrowHelper},d.prototype.show=function(){return this.arrowHelper&&(this.arrowHelper.visible=!1),this},d.prototype.hide=function(){return this.arrowHelper&&(this.arrowHelper.visible=!1),this};var p=new THREE.Vector3,f=new THREE.Quaternion;r.a.Controller.plugin("transform",(function(t){var e,i,n,a,o,s;return t||(t={}),e=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],s=new THREE.Matrix4,!0===t.vr&&(this.setOptimizeHMD(!0),t.quaternion=(new THREE.Quaternion).setFromRotationMatrix((new THREE.Matrix4).set(-1,0,0,0,0,0,-1,0,0,-1,0,0,0,0,0,1)),t.scale=.001,t.position=new THREE.Vector3(0,0,-.08)),"desktop"===t.vr&&(t.quaternion=(new THREE.Quaternion).setFromRotationMatrix(new THREE.Matrix4),t.scale=.001,t.position=new THREE.Vector3(0,-.6,-1.08)),t.getTransform=function(i){var n;return t.matrix?(n="function"==typeof t.matrix?t.matrix(i):t.matrix,window.THREE&&n instanceof THREE.Matrix4?n.elements:n):t.position||t.quaternion||t.scale?(s.set.apply(s,e),t.quaternion&&s.makeRotationFromQuaternion("function"==typeof t.quaternion?t.quaternion(i):t.quaternion),t.position&&s.setPosition("function"==typeof t.position?t.position(i):t.position),s.elements):e},t.getScale=function(e){return isNaN(t.scale)||(t.scale=new THREE.Vector3(t.scale,t.scale,t.scale)),"function"==typeof t.scale?t.scale(e):t.scale},a=function(t,e){var i,n,a,o;for(o=[],n=0,a=e.length;n<a;n++)(i=e[n])?o.push(r.a.vec3.transformMat4(i,i,t)):o.push(void 0);return o},n=function(t,e,i){var n,r,a;return n=e[0],r=e[1],a=e[2],t[0]=i[0]*n+i[4]*r+i[8]*a,t[1]=i[1]*n+i[5]*r+i[9]*a,t[2]=i[2]*n+i[6]*r+i[10]*a,t},i=function(t,e){var i,r,a,o;for(o=[],r=0,a=e.length;r<a;r++)(i=e[r])?o.push(n(i,i,t)):o.push(void 0);return o},o=function(t,e,n){var o,s,l,c,u,h,d,p;for(i(e,[t.direction,t.palmNormal,t.palmVelocity,t.arm.basis[0],t.arm.basis[1],t.arm.basis[2]]),l=0,u=(d=t.fingers).length;l<u;l++)o=d[l],i(e,[o.direction,o.metacarpal.basis[0],o.metacarpal.basis[1],o.metacarpal.basis[2],o.proximal.basis[0],o.proximal.basis[1],o.proximal.basis[2],o.medial.basis[0],o.medial.basis[1],o.medial.basis[2],o.distal.basis[0],o.distal.basis[1],o.distal.basis[2]]);for(r.a.glMatrix.mat4.scale(e,e,n),a(e,[t.palmPosition,t.stabilizedPalmPosition,t.sphereCenter,t.arm.nextJoint,t.arm.prevJoint]),c=0,h=(p=t.fingers).length;c<h;c++)o=p[c],a(e,[o.carpPosition,o.mcpPosition,o.pipPosition,o.dipPosition,o.distal.nextJoint,o.tipPosition]);return s=(n[0]+n[1]+n[2])/3,t.arm.width*=s},{frame:function(e){var i,n,a,s,l,c,u,h,d,p;if(e.valid&&!e.data.transformed){for(e.data.transformed=!0,p=[],s=0,c=(h=e.hands).length;s<c;s++){for(n=h[s],o(n,t.getTransform(n),(t.getScale(n)||new THREE.Vector3(1,1,1)).toArray()),t.effectiveParent&&o(n,t.effectiveParent.matrixWorld.elements,t.effectiveParent.scale.toArray()),a=null,l=0,u=(d=n.fingers).length;l<u;l++)i=d[l],a=r.a.vec3.create(),r.a.vec3.sub(a,i.mcpPosition,i.carpPosition),i.metacarpal.length=r.a.vec3.length(a),r.a.vec3.sub(a,i.pipPosition,i.mcpPosition),i.proximal.length=r.a.vec3.length(a),r.a.vec3.sub(a,i.dipPosition,i.pipPosition),i.medial.length=r.a.vec3.length(a),r.a.vec3.sub(a,i.tipPosition,i.dipPosition),i.distal.length=r.a.vec3.length(a);r.a.vec3.sub(a,n.arm.prevJoint,n.arm.nextJoint),p.push(n.arm.length=r.a.vec3.length(a))}return p}}}}));const m=AFRAME.registerSystem("leap",{schema:{vr:{default:!0},scale:{default:.001},position:{type:"vec3",default:{x:p.x,y:p.y,z:p.z}},quaternion:{type:"vec4",default:{x:f.x,y:f.y,z:f.z,w:f.w}}},init:function(){this.controller=r.a.loop({loopWhileDisconnected:!1}).use("transform",this.data).on("connect",(()=>{this.hasConnected=!0,this.el.sceneEl.emit("leap-connect")}))},getFrame:function(){return this.controller.frame()},isConnected:function(){return this.controller.connected()}});var g=1;const y=["valve-index-controls","oculus-touch-controls","vive-controls","tracked-controls-webxr","tracked-controls-webvr","tracked-controls"];function b(t){var e=0;t=t.array();for(var i=0;i<t.length;i++)e+=t[i];return e/t.length}AFRAME.registerComponent("leap-hand",{schema:{hand:{default:"",oneOf:["left","right"],required:!0},holdDistance:{default:.2},holdDebounce:{default:100},holdSensitivity:{default:.95},pinchSensitivity:{default:.8},releaseSensitivity:{default:.75},pinchPressureStart:{default:.75},debug:{default:!1},emulateConfig:{default:"vive-controls"},pinchButton:{default:"trigger"},grabButton:{default:"grip"}},init:function(){this.system=this.el.sceneEl.systems.leap,this.handID=g++,this.hand=null,this.handBody=null,this.handMesh=new u,this.isVisible=!1,this.isHolding=!1;var t=Math.floor(this.data.holdDebounce/(1e3/120));this.grabStrength=0,this.pinchStrength=0,this.grabStrengthBuffer=new h(t),this.pinchStrengthBuffer=new h(t),this.intersector=new d,this.holdTarget=null;let e=this.handMesh.getMesh();this.el.setObject3D("mesh",e),this.el.object3D.parent.add(e),this.handMesh.hide(),this.el.emit("controllermodelready",{name:this.data.emulateConfig}),this.pinchEvent={},this.data.debug&&this.el.object3D.add(this.intersector.getMesh())},remove:function(){this.handMesh&&(this.el.removeObject3D("mesh"),this.handMesh=null),this.handBody&&(this.handBody.remove(),this.handBody=null),this.intersector.getMesh()&&(this.el.object3D.remove(this.intersector.getMesh()),this.intersector=null)},tick:function(){if(this.system.hasConnected&&this.system.isConnected()){var t=this.getHand();if(this.hand=t,t&&t.valid){for(let t of y)t in this.el.components&&(this.el.components[t].pause(),this.el.removeAttribute("gltf-model"));if(this.palmDirection=this.palmDirection||new THREE.Vector3,this.handDirection=this.handDirection||new THREE.Vector3,this.cameraMatrix=this.cameraMatrix||new THREE.Matrix4,this.originVector=this.originVector||new THREE.Vector3,this.el.object3D.position.fromArray(t.palmPosition),this.palmDirection.fromArray(t.palmNormal),this.palmDirection.multiplyScalar(-1),this.handDirection.fromArray(t.direction),this.handDirection.multiplyScalar(-1),this.palmDirection.lerp(this.handDirection,.3),this.el.object3D.matrix.lookAt(this.palmDirection,this.originVector,this.el.sceneEl.object3D.up),this.el.object3D.quaternion.setFromRotationMatrix(this.el.object3D.matrix),this.el.sceneEl.is("vr-mode")){let t=document.getElementById("camera-root").object3D;this.cameraMatrix.compose(t.position,t.quaternion,t.scale),this.cameraMatrix.decompose(this.el.parentEl.object3D.position,this.el.parentEl.object3D.quaternion,this.el.parentEl.object3D.scale),this.el.parentEl.object3D.matrix.copy(this.cameraMatrix)}this.el.hasAttribute("smooth-controller")&&this.el.components["smooth-controller"].stabilize(3),this.handMesh.scaleTo(t),this.handMesh.formTo(t),this.grabStrengthBuffer.push(t.grabStrength),this.pinchStrengthBuffer.push(t.pinchStrength),this.grabStrength=b(this.grabStrengthBuffer),this.pinchStrength=b(this.pinchStrengthBuffer);var e=this.grabStrength>(this.isHolding?this.data.releaseSensitivity:this.data.holdSensitivity),i=this.pinchStrength>(this.isPinching?this.data.releaseSensitivity:this.data.pinchSensitivity);e&&!this.isHolding&&this.hold(t),!e&&this.isHolding&&this.release(t),i&&!this.isPinching&&this.pinch(t),!i&&this.isPinching&&this.unpinch(t),this.isHolding||(this.pinchEvent.value=THREE.Math.mapLinear(this.pinchStrength,this.data.pinchPressureStart,1,0,1),this.el.emit("triggerchanged",this.pinchEvent))}else this.isHolding&&(this.release(null),this.unpinch(null));t&&!this.isVisible&&(this.handMesh.show(),this.intersector.show(),this.el.emit("controllerconnected",{name:this.data.emulateConfig})),!t&&this.isVisible&&(this.handMesh.hide(),this.intersector.hide(),this.el.emit("controllerdisconnected",{name:this.data.emulateConfig})),this.isVisible=!!t}},getHand:function(){var t=this.data,e=this.system.getFrame();return e.hands.length?e.hands[e.hands[0].type===t.hand?0:1]:null},hold:function(t){this.el.emit(`${this.data.grabButton}down`,{type:"hand"}),this.isHolding=!0},pinch:function(t){this.isHolding||(this.el.emit(`${this.data.pinchButton}down`),this.isPinching=!0)},unpinch:function(t){this.isHolding||(this.el.emit(`${this.data.pinchButton}up`),this.isPinching=!1)},release:function(t){this.el.emit(`${this.data.grabButton}up`,{type:"hand"}),this.isHolding=!1},getEventDetail:function(t){return{hand:t,handID:this.handID,body:this.handBody?this.handBody.palmBody:null}}})},function(t,e,i){"use strict";i.r(e);var n=i(0);function r(t){return.0031308>=t?12.92*t:1.055*Math.pow(t,.4166666666666667)-.055}function a(t){return.04045<t?Math.pow((t+.055)/1.055,2.4):t/12.92}function o(t,e,i){let n=.4122214708*t+.5363325363*e+.0514459929*i,r=.2119034982*t+.6806995451*e+.1073969566*i,a=.0883024619*t+.2817188376*e+.6299787005*i,o=Math.cbrt(n),s=Math.cbrt(r),l=Math.cbrt(a);return[.2104542553*o+.793617785*s-.0040720468*l,1.9779984951*o-2.428592205*s+.4505937099*l,.0259040371*o+.7827717662*s-.808675766*l]}function s(t,e,i){let n=t+.3963377774*e+.2158037573*i,r=t-.1055613458*e-.0638541728*i,a=t-.0894841775*e-1.291485548*i,o=n*n*n,s=r*r*r,l=a*a*a;return[4.0767416621*o-3.3077115913*s+.2309699292*l,-1.2684380046*o+2.6097574011*s-.3413193965*l,-.0041960863*o-.7034186147*s+1.707614701*l]}function l(t){const e=.206,i=1.206/1.03;return.5*(i*t-e+Math.sqrt((i*t-e)*(i*t-e)+.12*i*t))}function c(t){return(t*t+.206*t)/(1.170873786407767*(t+.03))}function u(t,e){let i=function(t,e){let i,n,r,a,o,s,l,c;-1.88170328*t-.80936493*e>1?(i=1.19086277,n=1.76576728,r=.59662641,a=.75515197,o=.56771245,s=4.0767416621,l=-3.3077115913,c=.2309699292):1.81444104*t-1.19445276*e>1?(i=.73956515,n=-.45954404,r=.08285427,a=.1254107,o=.14503204,s=-1.2684380046,l=2.6097574011,c=-.3413193965):(i=1.35733652,n=-.00915799,r=-1.1513021,a=-.50559606,o=.00692167,s=-.0041960863,l=-.7034186147,c=1.707614701);let u=i+n*t+r*e+a*t*t+o*t*e,h=.3963377774*t+.2158037573*e,d=-.1055613458*t-.0638541728*e,p=-.0894841775*t-1.291485548*e;{let t=1+u*h,e=1+u*d,i=1+u*p,n=s*(t*t*t)+l*(e*e*e)+c*(i*i*i),r=s*(3*h*t*t)+l*(3*d*e*e)+c*(3*p*i*i);u-=n*r/(r*r-.5*n*(s*(6*h*h*t)+l*(6*d*d*e)+c*(6*p*p*i)))}return u}(t,e),n=s(1,i*t,i*e),r=Math.cbrt(1/Math.max(Math.max(n[0],n[1]),n[2]));return[r,r*i]}function h(t,e,i=null){i||(i=u(t,e));let n=i[0],r=i[1];return[r/n,r/(1-n)]}function d(t,e,i){let n,r,a=u(e,i),o=function(t,e,i,n,r,a=null){let o;if(a||(a=u(t,e)),(i-r)*a[1]-(a[0]-r)*n<=0)o=a[1]*r/(n*a[0]+a[1]*(r-i));else{o=a[1]*(r-1)/(n*(a[0]-1)+a[1]*(r-i));{let a=i-r,s=.3963377774*t+.2158037573*e,l=-.1055613458*t-.0638541728*e,c=-.0894841775*t-1.291485548*e,u=a+n*s,h=a+n*l,d=a+n*c;{let t=r*(1-o)+o*i,e=o*n,a=t+e*s,p=t+e*l,f=t+e*c,m=a*a*a,g=p*p*p,y=f*f*f,b=3*u*a*a,A=3*h*p*p,v=3*d*f*f,w=6*u*u*a,E=6*h*h*p,_=6*d*d*f,x=4.0767416621*m-3.3077115913*g+.2309699292*y-1,T=4.0767416621*b-3.3077115913*A+.2309699292*v,M=T/(T*T-.5*x*(4.0767416621*w-3.3077115913*E+.2309699292*_)),C=-x*M,k=-1.2684380046*m+2.6097574011*g-.3413193965*y-1,R=-1.2684380046*b+2.6097574011*A-.3413193965*v,S=R/(R*R-.5*k*(-1.2684380046*w+2.6097574011*E-.3413193965*_)),D=-k*S,O=-.0041960863*m-.7034186147*g+1.707614701*y-1,P=-.0041960863*b-.7034186147*A+1.707614701*v,F=P/(P*P-.5*O*(-.0041960863*w-.7034186147*E+1.707614701*_)),U=-O*F;C=M>=0?C:1e6,D=S>=0?D:1e6,U=F>=0?U:1e6,o+=Math.min(C,Math.min(D,U))}}}return o}(e,i,t,1,t,a),s=h(e,i,a);{let r=t*(.11516993+1/(7.4477897+4.1590124*i+e*(1.75198401*i-2.19557347+e*(-2.13704948-10.02301043*i+e*(5.38770819*i-4.24894561+4.69891013*e))))),a=(1-t)*(.11239642+1/(1.6132032-.68124379*i+e*(.40370612+.90148123*i+e*(.6122399*i-.27087943+e*(.00299215-.45399568*i-.14661872*e)))));n=.9*(o/Math.min(t*s[0],(1-t)*s[1]))*Math.sqrt(Math.sqrt(1/(1/(r*r*r*r)+1/(a*a*a*a))))}{let e=.4*t,i=.8*(1-t);r=Math.sqrt(1/(1/(e*e)+1/(i*i)))}return[r,n,o]}function p(t,e,i){if(1==i)return[255,255,255];if(0==i)return[0,0,0];let n,a,o,l,u,h=Math.cos(2*Math.PI*t),p=Math.sin(2*Math.PI*t),f=c(i),m=d(f,h,p),g=m[0],y=m[1],b=m[2];e<.8?(a=1.25*e,o=0,l=.8*g,u=1-l/y):(a=5*(e-.8),o=y,l=.2*y*y*1.25*1.25/g,u=1-l/(b-y)),n=o+a*l/(1-u*a);let A=s(f,n*h,n*p);return[255*r(A[0]),255*r(A[1]),255*r(A[2])]}const f=i(13),{Undo:m}=i(4),g={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"},uuid:"DB0461DE-8349-4483-B90E-210136A9DA19",type:"BufferGeometry",data:{attributes:{position:{itemSize:3,type:"Float32Array",array:[0,.05000000074505806,.009999999776482582,-.05000000074505806,.20000000298023224,.009999999776482582,.05000000074505806,.20000000298023224,.009999999776482582],normalized:!1},normal:{itemSize:3,type:"Float32Array",array:[0,0,0,0,0,0,0,0,0],normalized:!1},color:{itemSize:3,type:"Float32Array",array:[1,1,1,1,1,1,1,1,1],normalized:!1}},groups:[{start:0,materialIndex:0,count:3}],boundingSphere:{center:[0,.125,.01],radius:.09013878188659974}}};AFRAME.registerComponent("color-picker",{dependencies:["material","geometry"],schema:{brightness:{type:"float",default:.5},colorSpace:{default:"oklab",oneOf:["rgb","oklab"]}},init(){this.system=document.querySelector("a-scene").systems["paint-system"];var t=i(27),e=i(344)(`./color-wheel-${this.data.colorSpace}.glsl`),n=new THREE.ShaderMaterial({uniforms:{brightness:{type:"f",value:this.data.brightness}},vertexShader:t,fragmentShader:e});this.mesh=this.el.getObject3D("mesh"),this.mesh.material=n,this.el.addEventListener("draw",(t=>{let e=t.detail.intersection.uv;e.x=2*e.x-1,e.y=2*e.y-1;var i,n,r,a={r:Math.sqrt(e.x*e.x+e.y*e.y),theta:Math.PI+Math.atan2(e.y,e.x)};i=(a.theta*(180/Math.PI)+180)%360/360,n=a.r,r=this.data.brightness;var o=f(p(i,n,r)).hex();this.handleColor(o)})),this.el.setAttribute("action-tooltips","trigger: Select Color")},handleColor(t){this.system.selectColor(t)},update(t){this.mesh.material.uniforms.brightness.value=this.data.brightness}}),AFRAME.registerComponent("brightness-picker",{schema:{target:{type:"selector"}},init(){this.system=document.querySelector("a-scene").systems["paint-system"];var t=i(27),e=i(347),n=new THREE.ShaderMaterial({uniforms:{u_color:{type:"vec3",value:new THREE.Vector3(1,1,1)}},vertexShader:t,fragmentShader:e});this.mesh=this.el.getObject3D("mesh"),this.mesh.material=n,this.el.setAttribute("action-tooltips","trigger: Change Brightness"),this.onColorChanged=t=>{let e=f(this.system.data.color).rgb();this.mesh.material.uniforms.u_color.value.set(e.red()/255,e.green()/255,e.blue()/255)},this.el.sceneEl.addEventListener("colorchanged",this.onColorChanged),this.el.addEventListener("draw",(t=>{let e=t.detail.intersection.uv;if(this.data.target){this.data.target.setAttribute("color-picker",{brightness:e.y});let t=f(this.system.data.color).rgb(),i=function(t,e,i){if(0===t&&0===e&&0===i)return[0,0,0];let n,r=o(a(t/255),a(e/255),a(i/255)),s=Math.sqrt(r[1]*r[1]+r[2]*r[2]),c=r[1]/s,u=r[2]/s,h=r[0],p=.5+.5*Math.atan2(-r[2],-r[1])/Math.PI,f=d(h,c,u),m=f[0],g=f[1],y=f[2];if(s<g){let t=0,e=.8*m;n=(s-t)/(e+(1-e/g)*(s-t))*.8}else{let t=.2*g*g*1.25*1.25/m;n=.8+(s-g)/(t+(1-t/(y-g))*(s-g))*.2}return[p,n,l(h)]}(t.red(),t.green(),t.blue());this.system.selectColor(f(p(i[0],i[1],e.y)).hex())}else this.brightness=e.y,this.el.emit("brightnesschanged",{brightness:this.brightness})}))},remove(){this.el.sceneEl.removeEventListener("colorchanged",this.onColorChanged)}}),AFRAME.registerComponent("opacity-picker",{init(){this.system=document.querySelector("a-scene").systems["paint-system"];var t=i(27),e=i(348),n=new THREE.ShaderMaterial({vertexShader:t,fragmentShader:e,transparent:!0});this.mesh=this.el.getObject3D("mesh"),this.mesh.material=n;let r=(new THREE.BufferGeometryLoader).parse(g);this.indicator=new THREE.Mesh(r,new THREE.MeshBasicMaterial({color:11040562,side:THREE.DoubleSide})),this.el.object3D.add(this.indicator),this.adjustIndicator(this.system.data.opacity);let a=new THREE.EdgesGeometry(this.mesh.geometry),o=new THREE.LineBasicMaterial({color:16777215,linewidth:1}),s=new THREE.LineSegments(a,o);this.el.object3D.add(s),this.el.hasAttribute("action-tooltips")||this.el.setAttribute("action-tooltips","trigger: Select Opacity"),this.el.addEventListener("click",(t=>{if(this.layer&&!this.wasDrawing){let t=this.layer.oldOpacity;m.push((()=>{this.layer.opacity=t,this.layer.touch()}))}this.handleClick(t)})),this.el.addEventListener("draw",(t=>{if(this.layer&&!this.wasDrawing){this.wasDrawing=!0;let e=this.layer.opacity;m.push((()=>{this.layer.opacity=e,this.adjustIndicator(e)})),t.detail.sourceEl.addEventListener("enddrawing",(()=>{this.wasDrawing=!1}),{once:!0})}this.handleClick(t)})),this.el.sceneEl.addEventListener("opacitychanged",(t=>{this.layer||this.adjustIndicator(t.detail.opacity)}))},adjustIndicator(t){let e=Math.pow(t,1/2.2);this.indicator.position.x=1.9*e-.95},handleClick(t){let e=t.detail.intersection.uv,i=Math.pow(e.x,2.2);i>.95&&(i=1),this.adjustIndicator(i),this.layer?(this.layer.opacity=i,this.layer.touch()):this.system.selectOpacity(i)}}),AFRAME.registerComponent("show-current-color",{init(){this.system=this.el.sceneEl.systems["paint-system"],this.el.setAttribute("material",{shader:"flat",color:this.system.data.color}),this.onColorChanged=t=>{this.el.setAttribute("material",{color:t.detail.color})},this.el.sceneEl.addEventListener("colorchanged",this.onColorChanged)},remove(){this.el.sceneEl.removeEventListener("colorchanged",this.onColorChanged)}}),AFRAME.registerComponent("show-current-brush",{init(){this.system=this.el.sceneEl.systems["paint-system"],this.baseWidth=this.el.getAttribute("width"),this.el.setAttribute("material",{shader:"flat",transparent:!0,color:"#fff"});let t=t=>{this.el.setAttribute("material",{src:t.previewSrc}),this.el.setAttribute("height",this.baseWidth/t.width*t.height)};this.el.sceneEl.addEventListener("brushchanged",(e=>t(e.detail.brush))),t(this.system.brush)}}),AFRAME.registerComponent("show-current-brush-scale",{init(){this.system=this.el.sceneEl.systems["paint-system"],this.el.sceneEl.addEventListener("brushscalechanged",(t=>{this.el.setAttribute("text","value",`x${Math.round(4*Math.log(t.detail.brushScale))}`)}))}}),AFRAME.registerComponent("brush-scale-lever",{dependencies:["lever"],init(){this.system=this.el.sceneEl.systems["paint-system"],this.tick=AFRAME.utils.throttleTick(this.tick,30,this)},tick(t,e){Math.abs(this.el.components.lever.value)>0&&(this.system.scaleBrush(this.el.components.lever.value*e),this.el.components.lever.grip.is("grabbed")||(this.el.components.lever.value=0,this.el.components.lever.setValue(0)))}}),AFRAME.registerComponent("palette",{schema:{colors:{type:"array"},maxCount:{default:0},allowDuplicates:{default:!0}},init(){this.el.addEventListener("click",(t=>{if(t.target.hasAttribute("click-action"))return void this[t.target.getAttribute("click-action")](t);if(!t.target.hasAttribute("button-style"))return;this.el.sceneEl.systems["paint-system"].selectColor(t.target.getAttribute("button-style").color)}))},update(t){this.el.querySelectorAll(".custom").forEach((t=>this.el.removeChild(t)));for(let t of this.data.colors)this.addButton(t)},addToPalette(t){let e=this.el.sceneEl.systems["paint-system"];if(!this.data.allowDuplicates&&this.data.colors.indexOf(e.data.color)>=0)return;if(this.data.maxCount<=0||this.data.colors.length<this.data.maxCount)return this.addButton(e.data.color),void this.data.colors.push(e.data.color);this.data.colors.push(e.data.color),this.data.colors.splice(0,1);let i=this.el.querySelectorAll("*[icon-button]");for(let t=0;t<this.data.colors.length;++t)i[t].setAttribute("button-style","color",this.data.colors[t]),i[t].components["icon-button"].setColor(this.data.colors[t])},addButton(t){let e=document.createElement("a-entity");e.setAttribute("icon-button",""),e.setAttribute("button-style",`color: ${t}`),e.setAttribute("tooltip",t),e.classList.add("custom"),this.el.append(e)}}),AFRAME.registerComponent("color-selector-lever",{dependencies:["lever"],schema:{component:{type:"string"}},events:{anglechanged:function(t){this.isDragging=!0,this.updateColorValue(t.detail.value),this.isDragging=!1},editfinished:function(t){this.updateColorValue(THREE.MathUtils.clamp(parseInt(t.detail.value),0,this.el.components.lever.data.valueRange.y))}},init(){this.system=this.el.sceneEl.systems["paint-system"],this.el.sceneEl.addEventListener("colorchanged",this.onColorChanged.bind(this)),this.el.hasAttribute("tooltip")||this.el.setAttribute("tooltip",n.Util.titleCase(this.data.component)),n.Util.whenLoaded(this.el,(()=>{this.onColorChanged({color:this.system.data.color}),this.el.querySelector(".label").setAttribute("text","value",this.el.getAttribute("tooltip")),this.valueEl=this.el.querySelector(".value")}))},updateColorValue(t){let e=this.system.brush.ccolor||f(this.system.data.color);e=e[this.data.component](t),console.log("Levering color",e.rgb().hex(),t),this.el.sceneEl.systems["paint-system"].selectColor(e.rgb().hex()),"ccolor"in this.system.brush&&(this.system.brush.ccolor=e)},onColorChanged(t){let e;e=this.system.brush.ccolor?this.system.brush.ccolor[this.data.component]():f(t.detail.color)[this.data.component](),this.isDragging||this.el.components.lever.setValue(e),this.el.querySelector(".value").setAttribute("text","value",`${Math.round(e)}`)}}),AFRAME.registerComponent("color-entry-field",{events:{editfinished:function(t){let e;try{e=f(t.detail.value).rgb().hex()}catch(i){e=f("#"+t.detail.value).rgb().hex()}this.system.selectColor(e)}},init(){this.system=this.el.sceneEl.systems["paint-system"],this.el.sceneEl.addEventListener("colorchanged",this.onColorChanged.bind(this)),this.el.setAttribute("text","value",this.system.data.color)},onColorChanged(t){this.el.setAttribute("text","value",t.detail.color)}})},function(t,e,i){"use strict";i.r(e);const{CubeUVReflectionMapping:n,GammaEncoding:r,LinearEncoding:a,LinearToneMapping:o,NearestFilter:s,NoBlending:l,RGBDEncoding:c,RGBEEncoding:u,RGBEFormat:h,RGBM16Encoding:d,RGBM7Encoding:p,UnsignedByteType:f,sRGBEncoding:m}=THREE,{BufferAttribute:g}=THREE,{BufferGeometry:y}=THREE,{Mesh:b}=THREE,{OrthographicCamera:A}=THREE,{PerspectiveCamera:v}=THREE,{RawShaderMaterial:w}=THREE,{Scene:E}=THREE,{Vector2:_}=THREE,{Vector3:x}=THREE,{WebGLRenderTarget:T}=THREE;var M=Math.pow(2,8),C=[.125,.215,.35,.446,.526,.582],k=5+C.length,R=20,S={[a]:0,[m]:1,[u]:2,[p]:3,[d]:4,[c]:5,[r]:6},D=new A,{_lodPlanes:O,_sizeLods:P,_sigmas:F}=function(){for(var t=[],e=[],i=[],n=8,r=0;r<k;r++){var a=Math.pow(2,n);e.push(a);var o=1/a;r>4?o=C[r-8+4-1]:0==r&&(o=0),i.push(o);for(var s=1/(a-1),l=-s/2,c=1+s/2,u=[l,l,c,l,c,c,l,l,c,c,l,c],h=new Float32Array(108),d=new Float32Array(72),p=new Float32Array(36),f=0;f<6;f++){var m=f%3*2/3-1,b=f>2?0:-1,A=[m,b,0,m+2/3,b,0,m+2/3,b+1,0,m,b,0,m+2/3,b+1,0,m,b+1,0];h.set(A,18*f),d.set(u,12*f);var v=[f,f,f,f,f,f];p.set(v,6*f)}var w=new y;w.setAttribute("position",new g(h,3)),w.setAttribute("uv",new g(d,2)),w.setAttribute("faceIndex",new g(p,1)),t.push(w),n>4&&n--}return{_lodPlanes:t,_sizeLods:e,_sigmas:i}}(),U=null,B=(1+Math.sqrt(5))/2,I=1/B,j=[new x(1,1,1),new x(-1,1,1),new x(1,1,-1),new x(-1,1,-1),new x(0,B,I),new x(0,B,-I),new x(I,0,B),new x(-I,0,B),new x(B,I,0),new x(-B,I,0)];function L(t){var e,i,n,r;this._renderer=t,this._pingPongRenderTarget=null,this._blurMaterial=(e=R,i=new Float32Array(e),n=new x(0,1,0),(r=new w({defines:{n:e},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:n},inputEncoding:{value:S[a]},outputEncoding:{value:S[a]}},vertexShader:W(),fragmentShader:`\nprecision mediump float;\nprecision mediump int;\nvarying vec3 vOutputDirection;\nuniform sampler2D envMap;\nuniform int samples;\nuniform float weights[n];\nuniform bool latitudinal;\nuniform float dTheta;\nuniform float mipInt;\nuniform vec3 poleAxis;\n\n${X()}\n\n#define ENVMAP_TYPE_CUBE_UV\n#include <cube_uv_reflection_fragment>\n\nvec3 getSample(float theta, vec3 axis) {\n\tfloat cosTheta = cos(theta);\n\t// Rodrigues' axis-angle rotation\n\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t+ cross(axis, vOutputDirection) * sin(theta)\n\t\t+ axis * dot(axis, vOutputDirection) * (1.0 - cosTheta);\n\treturn bilinearCubeUV(envMap, sampleDirection, mipInt);\n}\n\nvoid main() {\n\tvec3 axis = latitudinal ? poleAxis : cross(poleAxis, vOutputDirection);\n\tif (all(equal(axis, vec3(0.0))))\n\t\taxis = vec3(vOutputDirection.z, 0.0, - vOutputDirection.x);\n\taxis = normalize(axis);\n\tgl_FragColor = vec4(0.0);\n\tgl_FragColor.rgb += weights[0] * getSample(0.0, axis);\n\tfor (int i = 1; i < n; i++) {\n\t\tif (i >= samples)\n\t\t\tbreak;\n\t\tfloat theta = dTheta * float(i);\n\t\tgl_FragColor.rgb += weights[i] * getSample(-1.0 * theta, axis);\n\t\tgl_FragColor.rgb += weights[i] * getSample(theta, axis);\n\t}\n\tgl_FragColor = linearToOutputTexel(gl_FragColor);\n}\n\t\t`,blending:l,depthTest:!1,depthWrite:!1})).type="SphericalGaussianBlur",r),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}function N(t){return void 0!==t&&t.type===f&&(t.encoding===a||t.encoding===m||t.encoding===r)}function H(t){var e=new T(3*M,3*M,t);return e.texture.mapping=n,e.texture.name="PMREM.cubeUv",e.scissorTest=!0,e}function z(t,e,i,n,r){t.viewport.set(e,i,n,r),t.scissor.set(e,i,n,r)}function V(){var t=new _(1,1),e=new w({uniforms:{envMap:{value:null},texelSize:{value:t},inputEncoding:{value:S[a]},outputEncoding:{value:S[a]}},vertexShader:W(),fragmentShader:`\nprecision mediump float;\nprecision mediump int;\nvarying vec3 vOutputDirection;\nuniform sampler2D envMap;\nuniform vec2 texelSize;\n\n${X()}\n\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n\nvoid main() {\n\tgl_FragColor = vec4(0.0);\n\tvec3 outputDirection = normalize(vOutputDirection);\n\tvec2 uv;\n\tuv.y = asin(clamp(outputDirection.y, -1.0, 1.0)) * RECIPROCAL_PI + 0.5;\n\tuv.x = atan(outputDirection.z, outputDirection.x) * RECIPROCAL_PI2 + 0.5;\n\tvec2 f = fract(uv / texelSize - 0.5);\n\tuv -= f * texelSize;\n\tvec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tuv.x += texelSize.x;\n\tvec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tuv.y += texelSize.y;\n\tvec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tuv.x -= texelSize.x;\n\tvec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tvec3 tm = mix(tl, tr, f.x);\n\tvec3 bm = mix(bl, br, f.x);\n\tgl_FragColor.rgb = mix(tm, bm, f.y);\n\tgl_FragColor = linearToOutputTexel(gl_FragColor);\n}\n\t\t`,blending:l,depthTest:!1,depthWrite:!1});return e.type="EquirectangularToCubeUV",e}function G(){var t=new w({uniforms:{envMap:{value:null},inputEncoding:{value:S[a]},outputEncoding:{value:S[a]}},vertexShader:W(),fragmentShader:`\nprecision mediump float;\nprecision mediump int;\nvarying vec3 vOutputDirection;\nuniform samplerCube envMap;\n\n${X()}\n\nvoid main() {\n\tgl_FragColor = vec4(0.0);\n\tgl_FragColor.rgb = envMapTexelToLinear(textureCube(envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ))).rgb;\n\tgl_FragColor = linearToOutputTexel(gl_FragColor);\n}\n\t\t`,blending:l,depthTest:!1,depthWrite:!1});return t.type="CubemapToCubeUV",t}function W(){return"\nprecision mediump float;\nprecision mediump int;\nattribute vec3 position;\nattribute vec2 uv;\nattribute float faceIndex;\nvarying vec3 vOutputDirection;\nvec3 getDirection(vec2 uv, float face) {\n\tuv = 2.0 * uv - 1.0;\n\tvec3 direction = vec3(uv, 1.0);\n\tif (face == 0.0) {\n\t\tdirection = direction.zyx;\n\t\tdirection.z *= -1.0;\n\t} else if (face == 1.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.z *= -1.0;\n\t} else if (face == 3.0) {\n\t\tdirection = direction.zyx;\n\t\tdirection.x *= -1.0;\n\t} else if (face == 4.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.y *= -1.0;\n\t} else if (face == 5.0) {\n\t\tdirection.xz *= -1.0;\n\t}\n\treturn direction;\n}\nvoid main() {\n\tvOutputDirection = getDirection(uv, faceIndex);\n\tgl_Position = vec4( position, 1.0 );\n}\n\t"}function X(){return"\nuniform int inputEncoding;\nuniform int outputEncoding;\n\n#include <encodings_pars_fragment>\n\nvec4 inputTexelToLinear(vec4 value){\n\tif(inputEncoding == 0){\n\t\treturn value;\n\t}else if(inputEncoding == 1){\n\t\treturn sRGBToLinear(value);\n\t}else if(inputEncoding == 2){\n\t\treturn RGBEToLinear(value);\n\t}else if(inputEncoding == 3){\n\t\treturn RGBMToLinear(value, 7.0);\n\t}else if(inputEncoding == 4){\n\t\treturn RGBMToLinear(value, 16.0);\n\t}else if(inputEncoding == 5){\n\t\treturn RGBDToLinear(value, 256.0);\n\t}else{\n\t\treturn GammaToLinear(value, 2.2);\n\t}\n}\n\nvec4 linearToOutputTexel(vec4 value){\n\tif(outputEncoding == 0){\n\t\treturn value;\n\t}else if(outputEncoding == 1){\n\t\treturn LinearTosRGB(value);\n\t}else if(outputEncoding == 2){\n\t\treturn LinearToRGBE(value);\n\t}else if(outputEncoding == 3){\n\t\treturn LinearToRGBM(value, 7.0);\n\t}else if(outputEncoding == 4){\n\t\treturn LinearToRGBM(value, 16.0);\n\t}else if(outputEncoding == 5){\n\t\treturn LinearToRGBD(value, 256.0);\n\t}else{\n\t\treturn LinearToGamma(value, 2.2);\n\t}\n}\n\nvec4 envMapTexelToLinear(vec4 color) {\n\treturn inputTexelToLinear(color);\n}\n\t"}L.prototype={constructor:L,fromScene:function(t,e=0,i=.1,n=100){U=this._renderer.getRenderTarget();var r=this._allocateTargets();return this._sceneToCubeUV(t,i,n,r),e>0&&this._blur(r,0,0,e),this._applyPMREM(r),this._cleanup(r),r},fromEquirectangular:function(t){return t.magFilter=s,t.minFilter=s,t.generateMipmaps=!1,this.fromCubemap(t)},fromCubemap:function(t){U=this._renderer.getRenderTarget();var e=this._allocateTargets(t);return this._textureToCubeUV(t,e),this._applyPMREM(e),this._cleanup(e),e},compileCubemapShader:function(){null===this._cubemapShader&&(this._cubemapShader=G(),this._compileMaterial(this._cubemapShader))},compileEquirectangularShader:function(){null===this._equirectShader&&(this._equirectShader=V(),this._compileMaterial(this._equirectShader))},dispose:function(){this._blurMaterial.dispose(),null!==this._cubemapShader&&this._cubemapShader.dispose(),null!==this._equirectShader&&this._equirectShader.dispose();for(var t=0;t<O.length;t++)O[t].dispose()},_cleanup:function(t){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(U),t.scissorTest=!1,t.setSize(t.width,t.height)},_allocateTargets:function(t){var e={magFilter:s,minFilter:s,generateMipmaps:!1,type:f,format:h,encoding:N(t)?t.encoding:u,depthBuffer:!1,stencilBuffer:!1},i=H(e);return i.depthBuffer=!t,this._pingPongRenderTarget=H(e),i},_compileMaterial:function(t){var e=new E;e.add(new b(O[0],t)),this._renderer.compile(e,D)},_sceneToCubeUV:function(t,e,i,n){var r=new v(90,1,e,i),s=[1,1,1,1,-1,1],l=[1,1,-1,-1,-1,1],c=this._renderer,u=c.outputEncoding,h=c.toneMapping,d=c.toneMappingExposure,p=c.getClearColor(),f=c.getClearAlpha();c.toneMapping=o,c.toneMappingExposure=1,c.outputEncoding=a,t.scale.z*=-1;var m=t.background;if(m&&m.isColor){m.convertSRGBToLinear();var g=Math.max(m.r,m.g,m.b),y=Math.min(Math.max(Math.ceil(Math.log2(g)),-128),127);m=m.multiplyScalar(Math.pow(2,-y));var b=(y+128)/255;c.setClearColor(m,b),t.background=null}for(var A=0;A<6;A++){var w=A%3;0==w?(r.up.set(0,s[A],0),r.lookAt(l[A],0,0)):1==w?(r.up.set(0,0,s[A]),r.lookAt(0,l[A],0)):(r.up.set(0,s[A],0),r.lookAt(0,0,l[A])),z(n,w*M,A>2?M:0,M,M),c.setRenderTarget(n),c.render(t,r)}c.toneMapping=h,c.toneMappingExposure=d,c.outputEncoding=u,c.setClearColor(p,f),t.scale.z*=-1},_textureToCubeUV:function(t,e){var i=new E,n=this._renderer;t.isCubeTexture?null==this._cubemapShader&&(this._cubemapShader=G()):null==this._equirectShader&&(this._equirectShader=V());var r=t.isCubeTexture?this._cubemapShader:this._equirectShader;i.add(new b(O[0],r));var a=r.uniforms;a.envMap.value=t,t.isCubeTexture||a.texelSize.value.set(1/t.image.width,1/t.image.height),a.inputEncoding.value=S[t.encoding],a.outputEncoding.value=S[e.texture.encoding],z(e,0,0,3*M,2*M),n.setRenderTarget(e),n.render(i,D)},_applyPMREM:function(t){var e=this._renderer,i=e.autoClear;e.autoClear=!1;for(var n=1;n<k;n++){var r=Math.sqrt(F[n]*F[n]-F[n-1]*F[n-1]),a=j[(n-1)%j.length];this._blur(t,n-1,n,r,a)}e.autoClear=i},_blur:function(t,e,i,n,r){var a=this._pingPongRenderTarget;this._halfBlur(t,a,e,i,n,"latitudinal",r),this._halfBlur(a,t,i,i,n,"longitudinal",r)},_halfBlur:function(t,e,i,n,r,a,o){var s=this._renderer,l=this._blurMaterial;"latitudinal"!==a&&"longitudinal"!==a&&console.error("blur direction must be either latitudinal or longitudinal!");var c=new E;c.add(new b(O[n],l));var u=l.uniforms,h=P[i]-1,d=isFinite(r)?Math.PI/(2*h):2*Math.PI/39,p=r/d,f=isFinite(r)?1+Math.floor(3*p):R;f>R&&console.warn(`sigmaRadians, ${r}, is too large and will clip, as it requested ${f} samples when the maximum is set to 20`);for(var m=[],g=0,y=0;y<R;++y){var A=y/p,v=Math.exp(-A*A/2);m.push(v),0==y?g+=v:y<f&&(g+=2*v)}for(y=0;y<m.length;y++)m[y]=m[y]/g;u.envMap.value=t.texture,u.samples.value=f,u.weights.value=m,u.latitudinal.value="latitudinal"===a,o&&(u.poleAxis.value=o),u.dTheta.value=d,u.mipInt.value=8-i,u.inputEncoding.value=S[t.texture.encoding],u.outputEncoding.value=S[t.texture.encoding];var w=P[n];z(e,A=3*Math.max(0,M-2*w),(0===n?0:2*M)+2*w*(n>4?n-8+4:0),3*w,2*w),s.setRenderTarget(e),s.render(c,D)}};var Y=i(32);AFRAME.registerComponent("hdri-environment",{dependencies:["material"],schema:{src:{type:"selector"},exposure:{default:.724},toneMapping:{default:1},envMapSelector:{type:"string",default:"a-scene"},intensity:{default:1},replaceTexture:{default:!0},updateEnvMapThrottle:{default:100}},update(t){t.src!==this.data.src&&this.setHDRI(),t.envMapSelector!==this.data.envMapSelector&&(this.envMapSelectorElements=Array.from(document.querySelectorAll(this.data.envMapSelector))),this.el.sceneEl.renderer.toneMapping=this.data.toneMapping,this.el.sceneEl.renderer.toneMappingExposure=this.data.exposure,t.updateEnvMapThrottle!==this.data.updateEnvMapThrottle&&(this.data.updateEnvMapThrottle<=0?this.tick=function(){}:this.tick=AFRAME.utils.throttleTick(this._tick,this.data.updateEnvMapThrottle,this))},loadRGBE:t=>new Promise(((e,i)=>{(new Y.a).setDataType(THREE.UnsignedByteType).load(t,(function(t,i){e({texture:t,textureData:i})}))})),async setHDRI(){let t=this.data.src.getAttribute("src");/^https?:\/\//.test(t)||(t=new URL(t,window.location).toString());let{texture:e}=await this.loadRGBE(t),i=this.el.sceneEl.renderer;i.toneMapping=this.data.toneMapping,i.toneMappingExposure=this.data.exposure;let n=i.xr.enabled;i.xr.enabled=!1;var r=new(THREE.PMREMGenerator||L)(i);r.compileEquirectangularShader();let a=this.el.getObject3D("mesh");this.data.replaceTexture&&(a.material.map=e,a.material.color.set("#FFFFFF"),a.material.needsUpdate=!0,a.scale.x=-1,a.scale.z=-1),this.hdriTexture=e;var o=r.fromEquirectangular(e).texture;this.envMap=o,i.xr.enabled=n,r.dispose(),this.setEnvMap()},setEnvMap(){if(this.envMapSelectorElements)for(let t of this.envMapSelectorElements)t.object3D.traverseVisible((t=>{!t.material||"MeshStandardMaterial"!==t.material.type||t.material.envMap===this.envMap&&t.material.envMapIntensity===this.data.envMapIntensity||(t.material.envMap=this.envMap,t.material.envMapIntensity=this.data.intensity,t.material.needsUpdate=!0)}))},_tick(){this.setEnvMap()}})},function(t,e,i){"use strict";i.r(e);var n=i(0);const r={Handedness:Object.freeze({NONE:"none",LEFT:"left",RIGHT:"right"}),ComponentState:Object.freeze({DEFAULT:"default",TOUCHED:"touched",PRESSED:"pressed"}),ComponentProperty:Object.freeze({BUTTON:"button",X_AXIS:"xAxis",Y_AXIS:"yAxis",STATE:"state"}),ComponentType:Object.freeze({TRIGGER:"trigger",SQUEEZE:"squeeze",TOUCHPAD:"touchpad",THUMBSTICK:"thumbstick",BUTTON:"button"}),ButtonTouchThreshold:.05,AxisTouchThreshold:.1,VisualResponseProperty:Object.freeze({TRANSFORM:"transform",VISIBILITY:"visibility"})};async function a(t){const e=await fetch(t);if(e.ok)return e.json();throw new Error(e.statusText)}async function o(t,e,i=null,n=!0){if(!t)throw new Error("No xrInputSource supplied");if(!e)throw new Error("No basePath supplied");const r=await async function(t){if(!t)throw new Error("No basePath supplied");return await a(`${t}/profilesList.json`)}(e);let o;if(t.profiles.some((t=>{const i=r[t];return i&&(o={profileId:t,profilePath:`${e}/${i.path}`,deprecated:!!i.deprecated}),!!o})),!o){if(!i)throw new Error("No matching profile name found");const t=r[i];if(!t)throw new Error(`No matching profile name found and default profile "${i}" missing.`);o={profileId:i,profilePath:`${e}/${t.path}`,deprecated:!!t.deprecated}}const s=await a(o.profilePath);let l;if(n){let e;if(e="any"===t.handedness?s.layouts[Object.keys(s.layouts)[0]]:s.layouts[t.handedness],!e)throw new Error(`No matching handedness, ${t.handedness}, in profile ${o.profileId}`);e.assetPath&&(l=o.profilePath.replace("profile.json",e.assetPath))}return{profile:s,assetPath:l}}const s={xAxis:0,yAxis:0,button:0,state:r.ComponentState.DEFAULT};class l{constructor(t){this.componentProperty=t.componentProperty,this.states=t.states,this.valueNodeName=t.valueNodeName,this.valueNodeProperty=t.valueNodeProperty,this.valueNodeProperty===r.VisualResponseProperty.TRANSFORM&&(this.minNodeName=t.minNodeName,this.maxNodeName=t.maxNodeName),this.value=0,this.updateFromComponent(s)}updateFromComponent({xAxis:t,yAxis:e,button:i,state:n}){const{normalizedXAxis:a,normalizedYAxis:o}=function(t=0,e=0){let i=t,n=e;if(Math.sqrt(t*t+e*e)>1){const r=Math.atan2(e,t);i=Math.cos(r),n=Math.sin(r)}return{normalizedXAxis:.5*i+.5,normalizedYAxis:.5*n+.5}}(t,e);switch(this.componentProperty){case r.ComponentProperty.X_AXIS:this.value=this.states.includes(n)?a:.5;break;case r.ComponentProperty.Y_AXIS:this.value=this.states.includes(n)?o:.5;break;case r.ComponentProperty.BUTTON:this.value=this.states.includes(n)?i:0;break;case r.ComponentProperty.STATE:this.valueNodeProperty===r.VisualResponseProperty.VISIBILITY?this.value=this.states.includes(n):this.value=this.states.includes(n)?1:0;break;default:throw new Error(`Unexpected visualResponse componentProperty ${this.componentProperty}`)}}}class c{constructor(t,e){if(!(t&&e&&e.visualResponses&&e.gamepadIndices&&0!==Object.keys(e.gamepadIndices).length))throw new Error("Invalid arguments supplied");this.id=t,this.type=e.type,this.rootNodeName=e.rootNodeName,this.touchPointNodeName=e.touchPointNodeName,this.visualResponses={},Object.keys(e.visualResponses).forEach((t=>{const i=new l(e.visualResponses[t]);this.visualResponses[t]=i})),this.gamepadIndices=Object.assign({},e.gamepadIndices),this.values={state:r.ComponentState.DEFAULT,button:void 0!==this.gamepadIndices.button?0:void 0,xAxis:void 0!==this.gamepadIndices.xAxis?0:void 0,yAxis:void 0!==this.gamepadIndices.yAxis?0:void 0}}get data(){return{id:this.id,...this.values}}updateFromGamepad(t){if(this.values.state=r.ComponentState.DEFAULT,void 0!==this.gamepadIndices.button&&t.buttons.length>this.gamepadIndices.button){const e=t.buttons[this.gamepadIndices.button];this.values.button=e.value,this.values.button=this.values.button<0?0:this.values.button,this.values.button=this.values.button>1?1:this.values.button,e.pressed||1===this.values.button?this.values.state=r.ComponentState.PRESSED:(e.touched||this.values.button>r.ButtonTouchThreshold)&&(this.values.state=r.ComponentState.TOUCHED)}void 0!==this.gamepadIndices.xAxis&&t.axes.length>this.gamepadIndices.xAxis&&(this.values.xAxis=t.axes[this.gamepadIndices.xAxis],this.values.xAxis=this.values.xAxis<-1?-1:this.values.xAxis,this.values.xAxis=this.values.xAxis>1?1:this.values.xAxis,this.values.state===r.ComponentState.DEFAULT&&Math.abs(this.values.xAxis)>r.AxisTouchThreshold&&(this.values.state=r.ComponentState.TOUCHED)),void 0!==this.gamepadIndices.yAxis&&t.axes.length>this.gamepadIndices.yAxis&&(this.values.yAxis=t.axes[this.gamepadIndices.yAxis],this.values.yAxis=this.values.yAxis<-1?-1:this.values.yAxis,this.values.yAxis=this.values.yAxis>1?1:this.values.yAxis,this.values.state===r.ComponentState.DEFAULT&&Math.abs(this.values.yAxis)>r.AxisTouchThreshold&&(this.values.state=r.ComponentState.TOUCHED)),Object.values(this.visualResponses).forEach((t=>{t.updateFromComponent(this.values)}))}}class u{constructor(t,e,i){if(!t)throw new Error("No xrInputSource supplied");if(!e)throw new Error("No profile supplied");this.xrInputSource=t,this.assetUrl=i,this.id=e.profileId,this.layoutDescription=e.layouts[t.handedness],this.components={},Object.keys(this.layoutDescription.components).forEach((t=>{const e=this.layoutDescription.components[t];this.components[t]=new c(t,e)})),this.updateFromGamepad()}get gripSpace(){return this.xrInputSource.gripSpace}get targetRaySpace(){return this.xrInputSource.targetRaySpace}get data(){const t=[];return Object.values(this.components).forEach((e=>{t.push(e.data)})),t}updateFromGamepad(){Object.values(this.components).forEach((t=>{t.updateFromGamepad(this.xrInputSource.gamepad)}))}}AFRAME.registerSystem("webxr-input-profiles",{schema:{url:{default:"https://cdn.jsdelivr.net/npm/@webxr-input-profiles/assets@latest/dist/profiles"},disableTrackedControls:{default:!0},enableFallbackProfile:{default:!0},forceProfile:{default:""},enableWorkarounds:{default:!0}},start(){this.start=function(){},this.tick=AFRAME.utils.throttleTick(this._tick,100,this),this.motionControllers=new Map,this.loadingControllers=new Set,this.updateReferenceSpace=this.updateReferenceSpace.bind(this),this.el.addEventListener("enter-vr",this.updateReferenceSpace),this.el.addEventListener("exit-vr",this.updateReferenceSpace),this.data.disableTrackedControls&&(this.el.systems["tracked-controls-webxr"].pause(),this.el.systems["tracked-controls-webxr"].tick=function(){}),this.updateControllerList=this.updateControllerList.bind(this)},resetControllers(){for(let t of this.motionControllers.values())this.motionControllers.delete(t.xrInputSource)},updateReferenceSpace(){var t=this,e=this.el.xrSession;if(!e)return this.referenceSpace=void 0,this.controllers=[],this.motionControllers.clear(),void(this.oldControllersLength>0&&(this.oldControllersLength=0,this.el.emit("controllersupdated",void 0,!1)));var i=t.el.sceneEl.systems.webxr.sessionReferenceSpaceType;e.requestReferenceSpace(i).then((function(i){i||console.warn("Empty reference space recieved!",e),t.referenceSpace=i})).catch((function(e){throw t.el.sceneEl.systems.webxr.warnIfFeatureNotRequested(i,'webxr-input-profiles uses reference space "'+i+'".'),e}))},tick(){},_tick(){this.el.sceneEl.xrSession!==this.connectedSession&&(this.connectedSession&&this.connectedSession.removeEventListener("inputsourceschange",this.updateControllerList),this.connectedSession=this.el.sceneEl.xrSession,this.connectedSession&&(this.connectedSession.addEventListener("inputsourceschange",this.updateControllerList),this.updateControllerList()))},profileWorkarounds:t=>"htc-vive-focus-plus"===t.profiles[0]&&t.gamepad.buttons.length>3?{profiles:["htc-vive-focus-3"].concat(t.profiles),gamepad:t.gamepad,handedness:t.handedness}:t,async updateControllerList(){let t=this.el.sceneEl.xrSession;if(!t)return;let e=t.inputSources;for(let t of this.motionControllers.values())t.seen=!1;for(let t of e)if(this.motionControllers.has(t))this.motionControllers.get(t).seen=!0;else{if(this.loadingControllers.has(t))continue;this.loadingControllers.add(t);try{let e=t;this.data.forceProfile.length>0?e={profiles:[this.data.forceProfile],gamepad:t.gamepad,handedness:t.handedness}:this.data.enableWorkarounds&&(e=this.profileWorkarounds(t));let i=await o(e,this.data.url,"generic-trigger");console.log("Fetched profile",i,t);let n=new u(t,i.profile,i.assetPath);n.seen=!0,this.motionControllers.set(t,n),this.loadingControllers.delete(t)}catch(e){console.warn("Could not load input profile for",t,e);continue}}for(let t of this.motionControllers.values())t.seen||this.motionControllers.delete(t.xrInputSource)}}),AFRAME.registerComponent("webxr-motion-controller",{schema:{hand:{oneOf:["left","right"]},hideTrackingMesh:{default:!1},originSpace:{oneOf:["targetRaySpace","gripSpace"],default:"targetRaySpace"},fallbackToLaserControls:{default:!0},highlightButtonPresses:{default:!1},highlightColor:{type:"color",default:"#33b889"},remapButtons:{type:"map"}},events:{object3dset:function(t){let e=this.el.getObject3D("mesh");e&&(()=>{if(!this.data.hideTrackingMesh)return;let t=e.getObjectByName("TRACKING_MESH");t&&(t.visible=!1)})()}},init(){if(!navigator.xr)return console.log("No webXR, falling back to laser controls"),this.pause(),this.enabled=!1,this.data.enabled=!1,this.tick=function(){},this.el.setAttribute("laser-controls",`hand: ${this.data.hand}`),void n.Util.whenLoaded(this.el,(()=>{}));this.system=this.el.sceneEl.systems["webxr-input-profiles"],this.system.start(),this.lastComponentState=new Map,this.lastComponentEventState=new Map,this.lastButtonAmount=new Map,this.lastXAxis=new Map,this.lastYAxis=new Map,this.changedDetail={value:0},this.movedDetail={axis:[0,0]},this.rayMatrix=new THREE.Matrix4,this.rayForward=new THREE.Vector3},remove(){let t=this.el.getObject3D("mesh");t&&(t.remove(),this.el.setObject3D("mesh",void 0))},tick(t,e){this.checkForController(),this.updatePose(),this.updateButtons()},updatePose(){if(!this.controller)return;let t,e=this.el.sceneEl.frame;if(e){if(!this.system.referenceSpace)return console.warn("No reference space. Updating reference space"),void this.system.updateReferenceSpace();t=this.controller[this.data.originSpace]&&this.controller[this.data.originSpace]._pose&&!this.controller[this.data.originSpace]._pose._realViewMatrix?e.getPose(this.controller.targetRaySpace,this.system.referenceSpace):e.getPose(this.controller[this.data.originSpace],this.system.referenceSpace);var i=this.el.object3D;if(t&&(this.hasUpdatedPose=!0,i.matrix.elements=t.transform.matrix,i.matrix.decompose(i.position,i.rotation,i.scale),this.el.getObject3D("mesh")&&this.setPoseController!==this.controller))if(this.setPoseController=this.controller,"gripSpace"===this.data.originSpace){if(!0){let t=e.getPose(this.controller.targetRaySpace,this.system.referenceSpace);this.rayMatrix.elements=t.transform.matrix,this.rayMatrix.invert(),this.rayMatrix.multiply(i.matrix),this.rayMatrix.invert(),this.rayMatrix.extractRotation(this.rayMatrix);let n=new THREE.Vector3(0,0,-1);n.applyMatrix4(this.rayMatrix),this.el.setAttribute("raycaster",{direction:n})}else{let t=e.getPose(this.controller.targetRaySpace,this.controller.gripSpace);this.rayMatrix.elements=t.transform.matrix,this.rayMatrix.extractRotation(this.rayMatrix);let i=new THREE.Vector3(0,0,-1);i.applyMatrix4(this.rayMatrix),this.el.setAttribute("raycaster",{direction:i})}}else{if(!0){let t=e.getPose(this.controller.gripSpace,this.system.referenceSpace);this.rayMatrix.elements=t.transform.matrix,this.rayMatrix.invert(),this.rayMatrix.multiply(i.matrix),this.rayMatrix.invert();let r=this.el.getObject3D("mesh");r.matrix.compose(r.position,r.quaternion,r.scale),r.matrix.multiply(this.rayMatrix),n.Util.applyMatrix(r.matrix,r)}else{let t=e.getPose(this.controller.gripSpace,this.controller.targetRaySpace);this.rayMatrix.elements=t.transform.matrix,console.log("ray",this.controller.targetRaySpace===this.controller.gripSpace,this.rayMatrix.elements);let i=this.el.getObject3D("mesh");i.matrix.compose(i.position,i.quaternion,i.scale),i.matrix.multiply(this.rayMatrix),n.Util.applyMatrix(i.matrix,i)}}}},getAFrameComponentName(t){switch(t.type){case"squeeze":return"grip";case"thumbstick":return"thumbstick";case"touchpad":return"trackpad";case"trigger":return"trigger";case"button":return t.id.split("-").join("");default:return console.warn("Unkown component type",t.type,t),t.type}},updateButtons(){if(this.controller){this.controller.updateFromGamepad();for(let t of Object.values(this.controller.components)){if(this.updateComponentVisuals(t),!t.values||!t.values.state)continue;let e=t.values.state;if(this.lastComponentState.has(t)||this.lastComponentState.set(t,"default"),this.lastComponentState.get(t)!==e){let i="";i=e===r.ComponentState.PRESSED?"down":"up",i!==this.lastComponentEventState.get(t)&&(event=this.getAFrameComponentName(t)+i,this.lastComponentState.set(t,e),this.lastComponentEventState.set(t,i),this.el.emit("buttonchanged",{id:t.gamepadIndices.button,state:e}),this.el.emit(event,{id:t.gamepadIndices.button,state:e}))}"squeeze"===t.type||"trigger"===t.type?t.values.button!==this.lastButtonAmount.get(t)&&(this.changedDetail.value=t.values.button,this.el.emit(this.getAFrameComponentName(t)+"changed",this.changedDetail),this.lastButtonAmount.set(t,t.values.button)):"touchpad"!==t.type&&"thumbstick"!==t.type||t.values.xAxis===this.lastXAxis.get(t)&&t.values.yAxis===this.lastYAxis.get(t)||(this.movedDetail.axis[0]=t.values.xAxis,this.movedDetail.axis[1]=t.values.yAxis,this.el.emit("axismove",this.movedDetail),this.lastXAxis.set(t,t.values.xAxis),this.lastYAxis.set(t,t.values.yAxis))}}},updateComponentVisuals(t){let e=this.el.getObject3D("mesh");if(e){for(let i of Object.values(t.visualResponses)){const t=e.getObjectByName(i.valueNodeName);if("visibility"===i.valueNodeProperty)t.visible=i.value;else if("transform"===i.valueNodeProperty){const n=e.getObjectByName(i.minNodeName),r=e.getObjectByName(i.maxNodeName);THREE.Quaternion.slerp(n.quaternion,r.quaternion,t.quaternion,i.value),t.position.lerpVectors(n.position,r.position,i.value)}}if(this.data.highlightButtonPresses&&Object.values(t.visualResponses).length){let i=t.values.button,n=e.getObjectByName(Object.values(t.visualResponses)[0].valueNodeName);if(!n)return void console.warn("can't find node",t.visualResponses[0].valueNodeName);n.traverse((t=>{t.material&&(t.material.emissiveMap&&(t.material=t.material.clone(),t.material.emissiveMap=null,t.material.needsUpdate=!0),t.material.emissive.setRGB(i*this.data.highlightColor.r,i*this.data.highlightColor.g,i*this.data.highlightColor.b))}))}}},checkForController(){if(this.controller&&!this.system.motionControllers.has(this.controller.xrInputSource)&&(this.controller=void 0),!this.controller)for(let t of this.system.motionControllers.values())t.xrInputSource.handedness===this.data.hand&&(this.el.setAttribute("gltf-model",t.assetUrl),this.controller=t,this.el.emit("webxrcontrollerset",{controller:t}))}});var h="mouseenter",d="mouseleave",p="cursor-hovering",f="cursor-hovered";AFRAME.registerComponent("webxr-laser",{dependencies:["raycaster"],schema:{type:"string"},events:{webxrcontrollerset:function(t){this.el.components.raycaster.data.enabled=!0,this.el.setAttribute("raycaster","showLine",!0)},triggerup:function(t){this.intersectedEl&&(this.eventDetail.intersection=this.el.components.raycaster.getIntersection(this.intersectedEl),this.twoWayEmit("click"))},"raycaster-intersection":function(t){var e,i,n,r,a=this.el;i=t.detail.els[0]===a?1:0,r=t.detail.intersections[i],(n=t.detail.els[i])&&this.intersectedEl!==n&&(this.intersectedEl&&(e=this.el.components.raycaster.getIntersection(this.intersectedEl))&&e.distance<=r.distance||(this.clearCurrentIntersection(!0),this.setIntersection(n,r)))},"raycaster-intersection-cleared":function(t){-1!==t.detail.clearedEls.indexOf(this.intersectedEl)&&this.clearCurrentIntersection()}},init(){this.eventDetail={cursorEl:this.el},this.intersectedEventDetail={cursorEl:this.el},this.el.hasAttribute("webxr-motion-controller")||this.el.setAttribute("webxr-motion-controller",this.el.getAttribute("webxr-laser")),this.el.hasAttribute("smoothed-webxr-motion-controller")||this.el.setAttribute("smoothed-webxr-motion-controller",""),this.el.components.raycaster.data.enabled=!1},clearCurrentIntersection(t){if(!this.intersectedEl)return;if(this.intersectedEl.removeState(f),this.el.removeState(p),this.twoWayEmit(d),this.intersectedEl=null,!0===t)return;let e=this.el.components.raycaster.intersections;if(0===e.length)return;let i=e[e[0].object.el===this.cursorEl?1:0];i&&this.setIntersection(i.object.el,i)},setIntersection(t,e){var i=this.el;this.data;this.intersectedEl!==t&&(this.intersectedEl=t,i.addState(p),t.addState(f),this.twoWayEmit(h))},twoWayEmit(t){var e,i=this.el,n=this.intersectedEl;e=this.el.components.raycaster.getIntersection(n),this.eventDetail.intersectedEl=n,this.eventDetail.intersection=e,i.emit(t,this.eventDetail),n&&(this.intersectedEventDetail.intersection=e,n.emit(t,this.intersectedEventDetail))}}),AFRAME.registerComponent("smoothed-webxr-motion-controller",{dependencies:["webxr-motion-controller"],schema:{amount:{default:n.Util.isLowPower()?.2:.8}},init(){let t=this;this.el.components["webxr-motion-controller"]||console.warn("Can't set smoothed-webxr-motion-controller without as webxr-motion-controller"),function(){this.oldMatrix=new THREE.Matrix4,this.oldUpdatePose=this.updatePose.bind(this),this.newMatrix=new THREE.Matrix4,this.smoothing=t,this.t=this.el.sceneEl.time}.call(this.el.components["webxr-motion-controller"]),this.el.components["webxr-motion-controller"].updatePose=this.updatePose.bind(this.el.components["webxr-motion-controller"])},updatePose:function(){if(!this.controller)return;if(this.oldMatrix.copy(this.el.object3D.matrix),this.oldUpdatePose.call(this),!this.hasUpdatedPose)return;let t=this.smoothing.data.amount;n.Util.interpTransformMatrices(1-t,this.oldMatrix,this.el.object3D.matrix,{result:this.newMatrix}),n.Util.applyMatrix(this.newMatrix,this.el.object3D)}})},function(t,e,i){"use strict";i.r(e);var n={};i.r(n),i.d(n,"StyleTransferNode",(function(){return ai_nodes_StyleTransferNode})),i.d(n,"AIRenderNode",(function(){return ai_nodes_AIRenderNode}));var r=i(6);AFRAME.registerSystem("ai",{init(){},async tf(){return this._tf||(this._tf=await Promise.all([i.e(3),i.e(2)]).then(i.bind(null,420)),this._tf.ENV.set("WEBGL_PACK",!1)),this._tf},async loadModels(){return this.loadingModels||(this.loadingModels=(async()=>{console.log("initializing ai");let t=await this.tf();this.styleNet=await t.loadGraphModel(this.el.sceneEl.systems["vartiste-extras"].data.url+"/ai-models/saved_model_style_js/model.json"),this.transformNet=await t.loadGraphModel(this.el.sceneEl.systems["vartiste-extras"].data.url+"/ai-models/saved_model_transformer_separable_js/model.json")})()),await this.loadingModels},async loadRenderModels(){return this.loadingRenderModels||(this.loadingRenderModels=(async()=>{console.log("Loading render model");let t=await this.tf();this.renderNet=await t.loadGraphModel(this.el.sceneEl.systems["vartiste-extras"].data.url+"/ai-models/render/model.json"),this.renderNet.artifacts.modelTopology.node[0].attr.shape.shape.dim[1].size="-1",this.renderNet.artifacts.modelTopology.node[0].attr.shape.shape.dim[2].size="-1",this.renderNet.executor.inputs[0].shape[1]=-1,this.renderNet.executor.inputs[0].shape[2]=-1})()),await this.loadingRenderModels}});class ai_nodes_StyleTransferNode extends r.CanvasNode{constructor(t,{shader:e="blur",...i}={}){super(t,i),Object.defineProperty(this,"system",{enumerable:!1,value:AFRAME.scenes[0].systems.ai}),Object.defineProperty(this,"data",{enumerable:!1,value:{}})}disconnectDestination(){this.destination=void 0}touch(){super.touch(),this.data.styleEncodingTime=0}async updateCanvas(t){if(!this.destination)return;this.canvas;this.checkIfUpdateNeeded(t)&&this.sources[0]&&(this.data.isRunningInference?this.data.resetUpdateTime:(this.data.isRunningInference=!0,await this.runInference(),this.data.isRunningInference=!1,this.updateTime=document.querySelector("a-scene").time,this.resetUpdateTime&&(this.updateTime=0)))}async runInference(){await this.system.loadModels();let t=await this.system.tf(),{styleNet:e,transformNet:i}=this.system;if(await t.nextFrame(),!this.data.styleEncoding||this.sources[0].updateTime>=this.data.styleEncodingTime){this.data.styleEncoding&&this.data.styleEncoding.dispose();let i=this.sources[0].canvas;this.data.styleEncoding=await t.tidy((()=>(this.data.styleEncodingTime=document.querySelector("a-scene").time,e.predict(t.browser.fromPixels(i).toFloat().div(t.scalar(255)).expandDims()))))}console.log("BottleNeck predicted"),await t.nextFrame();const n=await t.tidy((()=>i.predict([t.browser.fromPixels(this.destination.canvas).toFloat().div(t.scalar(255)).expandDims(),this.data.styleEncoding]).squeeze()));console.log("Stylized predicted"),await t.browser.toPixels(n,this.canvas),n.dispose()}}class ai_nodes_AIRenderNode extends r.CanvasNode{constructor(t,e={}){super(t,e),Object.defineProperty(this,"system",{enumerable:!1,value:AFRAME.scenes[0].systems.ai}),Object.defineProperty(this,"data",{enumerable:!1,value:{}})}disconnectDestination(){this.destination=void 0}touch(){super.touch(),this.data.styleEncodingTime=0}async updateCanvas(t){if(!this.destination)return;this.canvas;this.checkIfUpdateNeeded(t)&&(this.data.isRunningInference?this.data.resetUpdateTime:(this.data.isRunningInference=!0,await this.runInference(),this.data.isRunningInference=!1,this.updateTime=document.querySelector("a-scene").time,this.resetUpdateTime&&(this.updateTime=0)))}async runInference(){await this.system.loadRenderModels();let t=await this.system.tf(),{renderNet:e}=this.system;await t.nextFrame();let i=this.destination.canvas,n=await t.tidy((()=>{let n=t.browser.fromPixels(i).toFloat().div(t.scalar(127.5)).sub(1),r=e.predict(n.expandDims(),{training:!0}).add(t.scalar(1)).mul(.5).squeeze();return r=t.image.resizeBilinear(r,[i.height,i.width]),r}));await t.browser.toPixels(n,this.canvas),n.dispose()}}var a=i(0),o=(i(22),i(2)),s=i(4),l=(i(44),i(3));const{Layer:c,CanvasNode:u,MaterialNode:h}=r;function d(){let t=new THREE.Texture;return t.generateMipmaps=!1,t.minFilter=THREE.LinearFilter,t}Object.assign(r,n),AFRAME.registerComponent("compositor",{dependencies:["material","geometry"],schema:{width:{default:AFRAME.utils.device.isMobileVR()?512:1024},height:{default:AFRAME.utils.device.isMobileVR()?128:512},baseWidth:{default:1024},geometryWidth:{default:80},throttle:{default:AFRAME.utils.device.isMobileVR()?15:10},textureScale:{default:1},frameRate:{default:10},onionSkin:{default:!1},drawOverlay:{default:!0},usePreOverlayCanvas:{default:!0},useNodes:{default:!1},flipY:{default:!1},flipNormal:{default:!0},skipDrawing:{default:!1},wrapTexture:{default:!1},doubleSided:{default:!1}},init(){let{width:t,height:e}=this.data;this.width=t,this.height=e,l.Pool.init(this);let i=document.createElement("canvas");i.width=t,i.height=e,document.body.append(i),this.compositeCanvas=i,this.preOverlayCanvas=document.createElement("canvas"),this.preOverlayCanvas.width=t,this.preOverlayCanvas.height=e,this.currentFrame=0,this.isAnimating=!1,this.lastFrameChangeTime=0,this.el.setAttribute("material",{src:i}),this.el.getObject3D("mesh").material.map.flipY=this.data.flipY,this.el.getObject3D("mesh").material.map.anisotropy=16,this.el.getObject3D("mesh").layers.mask=3,this.flipUVY(),this.layers=[new c(this.width,this.height),new c(this.width,this.height)],this.activeLayer=this.layers[0],this.layers[0].shelfMatrix.fromArray([.23257503824788683,0,0,0,0,.23257503824788683,0,0,0,0,.7752501274929559,0,-.1669643613343883,1.2792903085111105,-.04627732196156751,1]),this.layers[1].shelfMatrix.fromArray([.1779292490718412,0,0,0,0,.1779292490718412,0,0,0,0,.5930974969061377,0,-.15815008613669024,.27784067165961246,-.009772795407444274,1]),this.overlays={};let n=this.activeLayer.canvas.getContext("2d");n.fillStyle="#FFF",n.fillRect(0,0,this.width,this.height),this.activateLayer(this.layers[1]);let r=document.createElement("canvas");r.width=this.width,r.height=this.height,document.body.append(r),this.overlayCanvas=r,this.overlayCtx=this.overlayCanvas.getContext("2d"),this.el.setAttribute("draw-canvas",{canvas:this.layers[0].canvas,compositor:this}),this.activateLayer(this.activeLayer),this.redirector=document.createElement("a-entity"),a.Util.whenLoaded(this.redirector,(()=>this.redirector.object3D.userData.vartisteUI=!0)),this.el.append(this.redirector),this.redirector.setAttribute("geometry",this.el.getAttribute("geometry")),this.redirector.setAttribute("visible",!1),this.redirector.setAttribute("material","wireframe: true; color: red"),this.redirector.classList.add("raycast-invisible"),this.redirector.addEventListener("stateremoved",(t=>{"grabbed"===t.detail&&this.updateRedirectorTransformation()})),this.tick=AFRAME.utils.throttleTick(this.tick,this.data.throttle,this),this.allNodes=[],this.materialNode=new h(this),this.materialNode.shelfMatrix.fromArray([.4163862789381145,0,0,0,0,.4163862789381145,0,0,0,0,.4163862789381145,0,2.741181743466289,.9692342189892807,.2527472733592222,1]),this.materialNode.shelfMatrix;let o=new u(this);o.shelfMatrix.fromArray([.22465332680396122,0,0,0,0,.22465332680396122,0,0,0,0,.22465332680396122,0,1.340575716244399,.6194291453403057,.20383553138687294,1]),o.connectDestination(this.layers[0]),o.connectInput(this.layers[1],{type:"source",index:0}),this.materialNode.connectInput(o,{type:"canvas"}),this.slowCount=0},update(t){if(1!=this.data.textureScale&&(this.textureCanvas=this.textureCanvas||document.createElement("canvas"),this.textureCanvas.width=this.width*this.data.textureScale,this.textureCanvas.height=this.height*this.data.textureScale),this.data.useNodes!==t.useNodes){for(let t of this.allNodes)t.touch();for(let t of this.layers)t.touch()}this.data.shader!==t.shader&&this.materialNode.touch(),this.data.doubleSided===t.doubleSided&&this.data.shader===t.shader||(this.el.getObject3D("mesh").material.side=this.data.doubleSided?THREE.DoubleSide:THREE.FrontSide,this.el.getObject3D("mesh").material.shadowSide=this.data.doubleSided?THREE.FrontSide:null)},addLayer(t,{layer:e,activate:i=!0}={}){return void 0===e&&(e=new c(this.width,this.height)),void 0===t&&(t=this.layers.length-1),this.layers.splice(t+1,0,e),this.el.emit("layeradded",{layer:e}),i&&this.activateLayer(e),s.Undo.push((t=>this.deleteLayer(e))),e},duplicateLayer(t){let e=new c(t.width,t.height);e.transform=JSON.parse(JSON.stringify(t.transform)),e.mode=t.mode;for(let i=0;i<t.frames.length;++i)i>=e.frames.length&&e.insertFrame(i),e.frames[i].getContext("2d").drawImage(t.frames[i],0,0);let i=this.layers.indexOf(t);return this.layers.splice(i+1,0,e),this.el.emit("layeradded",{layer:e}),this.activateLayer(e),s.Undo.push((t=>this.deleteLayer(e))),e},activateLayer(t){this.ungrabLayer(t),this.activeLayer.active=!1;let e=this.activeLayer;this.el.setAttribute("draw-canvas",{canvas:t.canvas}),this.el.components["draw-canvas"].transform=t.transform,t.active=!0,this.activeLayer=t,this.layers.indexOf(e)>=0&&this.el.emit("layerupdated",{layer:e}),this.layers.indexOf(t)>=0&&this.el.emit("layerupdated",{layer:t})},nextLayer(){let t=this.layers.indexOf(this.activeLayer);this.activateLayer(this.layers[(t+1)%this.layers.length])},prevLayer(){let t=this.layers.indexOf(this.activeLayer)-1;t<0&&(t+=this.layers.length),this.activateLayer(this.layers[t])},swapLayers(t,e){let i=this.layers.indexOf(t),n=this.layers.indexOf(e);this.layers[i]=e,this.layers[n]=t,this.el.emit("layersmoved",{layers:[t,e]}),s.Undo.push((i=>this.swapLayers(t,e)))},mergeLayers(t,e){s.Undo.pushCanvas(e.canvas);let n=e.frame(this.currentFrame).getContext("2d");n.save(),n.translate(e.width/2,e.height/2),n.scale(1/e.transform.scale.x,1/e.transform.scale.y),n.translate(-e.width/2,-e.height/2),n.translate(-e.transform.translation.x,-e.transform.translation.y),"normalMap"===t.mode&&"normalMap"===e.mode?(this.normalProcessor||(this.normalProcessor=new CanvasShaderProcessor({source:i(391)})),this.normalProcessor.setInputCanvas(t.frame(this.currentFrame)),this.normalProcessor.setCanvasAttribute("u_base",e.frame(this.currentFrame)),this.normalProcessor.update(),t.draw(n,this.currentFrame,{mode:"source-over",canvas:this.normalProcessor.canvas})):t.draw(n,this.currentFrame),n.restore(),e.touch()},deleteLayer(t){let e=this.layers.indexOf(t);if(s.Undo.push((()=>this.addLayer(e,{layer:t}))),console.log("Deleting layer",t.id,e),e<0)throw new Error("Cannot find layer to delete",t);this.grabbedLayer==t&&this.ungrabLayer(t),this.layers.splice(e,1),0==this.layers.length&&this.addLayer(0),t.active&&this.layers.length>0&&this.activateLayer(this.layers[e%this.layers.length]),this.el.emit("layerdeleted",{layer:t})},setLayerBlendMode(t,e){let i=t.mode;s.Undo.collect((()=>{s.Undo.push((()=>this.setLayerBlendMode(t,i))),t.mode=e,0===t.updateTime&&a.Util.fillDefaultCanvasForMap(t.canvas,e),t.touch(),this.el.emit("layerupdated",{layer:t})}))},layerforMap(t){let e=this.layers.find((e=>e.mode===t));return e||(e=new c(this.width,this.height),"src"===t?this.addLayer(void 0,{layer:e,activate:!1}):(Compositor.component.addLayer(0,{layer:e,activate:!1}),Compositor.component.setLayerBlendMode(e,t)),Compositor.el.emit("layerupdated",{layer:e}),e)},grabLayer(t){this.grabbedLayer!=t?(this.grabbedLayer&&(this.grabbedLayer.grabbed=!1,this.el.emit("layerupdated",{layer:this.grabbedLayer})),this.redirector.setAttribute("visible",!0),this.el["redirect-grab"]=this.redirector,t.grabbed=!0,this.grabbedLayer=t,this.updateRedirectorTransformation(),this.el.emit("layerupdated",{layer:t})):this.ungrabLayer(t)},ungrabLayer(){if(!this.grabbedLayer)return;this.redirector.setAttribute("visible",!1);let t=this.grabbedLayer;this.el["redirect-grab"]=void 0,t.grabbed=!1,this.grabbedLayer=void 0,this.el.emit("layerupdated",{layer:t})},updateRedirectorTransformation(){let t=this.grabbedLayer;this.redirector.object3D.position.set(t.transform.translation.x/this.width*this.el.components.geometry.data.width,-t.transform.translation.y/this.height*this.el.components.geometry.data.height,0),this.redirector.object3D.scale.set(t.transform.scale.x,t.transform.scale.y,1),this.redirector.object3D.rotation.set(0,0,-t.transform.rotation)},deleteNode(t){let e=this.allNodes.indexOf(t);if(!(e<0)){for(let e of t.getConnections())t.disconnectInput(e),this.el.emit("nodeconnectionschanged",{node:t});for(let e of this.allNodes){let i=e.getConnections();for(let n of i)n.to===t&&(console.log("clearing connection",n),e.disconnectInput(n),this.el.emit("nodeconnectionschanged",{node:e}))}console.log("Deleting node"),this.allNodes.splice(e,1),this.el.emit("nodedeleted",{node:t})}},flipUVY(t){if(!t){let t=0==this.el.getObject3D("mesh").geometry.attributes.uv.array[1];this.el.getObject3D("mesh").geometry.attributes.uv.array[1];if(!this.data.flipY&&t)return;if(this.data.flipY&&!t)return}console.log("Flipping UV Y Coords");let e=this.el.getObject3D("mesh");if(e.geometry&&e.geometry.attributes.uv){let t=e.geometry.attributes.uv.array;for(let i=0;i<2*e.geometry.attributes.uv.count;i+=2)t[i+1]=1-t[i+1];e.geometry.attributes.uv.needsUpdate=!0}},frozenMaterial(){if(this.layers.some((t=>t.updateTime>=this.frozenTime))&&(this._frozenMaterial=null),this._frozenMaterial)return this._frozenMaterial;let t=this.el.getObject3D("mesh").material.clone();for(let e of["map"].concat(o.THREED_MODES))if("envMap"!==e&&Compositor.material[e]&&Compositor.material[e].image){console.log("Copying",e,Compositor.material[e]);try{t[e]=Compositor.material[e].clone(),t[e].image="map"===e?a.Util.cloneCanvas(this.preOverlayCanvas):a.Util.cloneCanvas(Compositor.material[e].image),t[e].needsUpdate=!0}catch(i){console.warn("Couldn't clone map",e,i),t[e]=null,t.needsUpdate=!0}}return t.needsUpdate=!0,this.frozenTime=this.el.sceneEl.time,this._frozenMaterial=t,t},drawOverlay(t){if(!this.data.drawOverlay)return;if(this.el.sceneEl.systems["low-power"].isLowPower()&&this.uiRoot&&this.uiRoot.getAttribute("visible"))return;t.save();const{width:e,height:i}=this;let n,r,a=this.overlayCtx;if(this.data.onionSkin&&this.activeLayer.frames.length>1){const n=[[2,"#4a75e0"],[1,"#4a75e0"],[-1,"#e04a6d"],[-2,"#e04a6d"]];for(let[r,o]of n)this.activeLayer.frames.length<=Math.abs(r)||(a.clearRect(0,0,e,i),a.globalCompositeOperation="copy",this.activeLayer.draw(a,this.activeLayer.frameIdx(this.currentFrame+r)),a.globalCompositeOperation="source-in",a.fillStyle=o,a.fillRect(0,0,e,i),t.globalCompositeOperation="source-over",t.globalAlpha=Math.pow(.5,Math.abs(r)),t.drawImage(this.overlayCanvas,0,0))}a.clearRect(0,0,e,i),a.globalCompositeOperation="source-over";let o=null;for(r in this.overlays)if(this.overlays[r].brush.solo){o=this.overlays[r].brush;break}o||(o=this.el.sceneEl.systems["paint-system"].brush),o.solo&&!o.direct&&this.el.components["draw-canvas"].drawOutlineUV(a,{x:0,y:0},{canvas:this.overlayCanvas});let s=this.el.sceneEl.is("vr-mode");if(!o.solo)for(r in this.overlays){if(n=this.overlays[r],s&&!n.el.id.endsWith("-hand"))continue;let t=n.el.components.raycaster;if(!t)continue;let e=null,i=99999;for(let n of t.intersections)(n.object.el===this.el||n.object.el.hasAttribute("forward-draw"))&&-n.distance<i&&(e=n,i=-n.distance);e&&this.el.components["draw-canvas"].drawOutlineUV(a,n.uv,{canvas:this.overlayCanvas,rotation:n.rotation})}t.globalCompositeOperation="difference",t.globalAlpha=1,t.drawImage(this.overlayCanvas,0,0),o.solo&&o.direct&&(t.globalCompositeOperation="source-over",a.clearRect(0,0,e,i),a.globalCompositeOperation="copy",this.el.components["draw-canvas"].drawOutlineUV(a,{x:0,y:0},{canvas:this.overlayCanvas,brush:o}),t.drawImage(this.overlayCanvas,0,0)),t.restore()},playPauseAnimation(){this.isPlayingAnimation=!this.isPlayingAnimation,this.el.emit("playpause",this.isPlayingAnimation)},setIsPlayingAnimation(t){this.isPlayingAnimation=t,this.el.emit("playpause",this.isPlayingAnimation)},jumpToFrame(t,{force:e=!1,animate:i=!1}={}){this.currentFrame=t;let n=this.pool("param",Object);(this.activeLayer.frames.length>1||e)&&(n.canvas=this.activeLayer.frame(this.currentFrame),this.el.setAttribute("draw-canvas",n),delete n.canvas),i||delete this.playingStartTime,n.frame=this.currentFrame,this.el.emit("framechanged",n),delete n.frame},nextFrame(){this.setIsPlayingAnimation(!1),this.jumpToFrame(++this.currentFrame)},previousFrame(){this.setIsPlayingAnimation(!1),this.jumpToFrame(--this.currentFrame)},addFrameAfter(){this.currentFrame=this.activeLayer.frameIdx(this.currentFrame),this.activeLayer.insertFrame(this.currentFrame),this.nextFrame();let t=this.currentFrame;s.Undo.push((()=>this.deleteFrame(t))),this.el.emit("layerupdated",{layer:this.activeLayer})},addFrameBefore(){this.currentFrame=this.activeLayer.frameIdx(this.currentFrame-1),this.activeLayer.insertFrame(this.activeLayer.frameIdx(this.currentFrame)),this.nextFrame();let t=this.currentFrame;s.Undo.push((()=>this.deleteFrame(t))),console.log(this.activeLayer.frameIdx(this.currentFrame),this.activeLayer.frames),this.el.emit("layerupdated",{layer:this.activeLayer})},duplicateFrameAfter(){let t=this.activeLayer.frame(this.currentFrame);this.addFrameAfter();let e=this.activeLayer.frame(this.currentFrame).getContext("2d");e.globalCompositeOperation="copy",e.drawImage(t,0,0),e.globalCompositeOperation="source-over"},duplicateFrameBefore(){let t=this.activeLayer.frame(this.currentFrame);this.addFrameBefore();let e=this.activeLayer.frame(this.currentFrame).getContext("2d");e.globalCompositeOperation="copy",e.drawImage(t,0,0),e.globalCompositeOperation="source-over"},deleteFrame(t){void 0===t&&(t=this.currentFrame),this.activeLayer.frames.length>1&&(this.currentFrame=this.activeLayer.frameIdx(t),this.activeLayer.deleteFrame(this.currentFrame),this.jumpToFrame(this.activeLayer.frameIdx(this.currentFrame),{force:!0}),this.el.emit("layerupdated",{layer:this.activeLayer}))},toggleOnionSkin(){this.data.onionSkin=!this.data.onionSkin},tick(t,e){if(this.el.sceneEl.systems["low-power"].isLowPower()){let e=this.uiRoot||document.querySelector("#ui");if(this.uiRoot=e,e.getAttribute("visible")&&t-this.drawnT<200)return}if(e>25&&t-this.drawnT<1e3&&!this.el.sceneEl.systems["low-power"].isLowPower())this.slowCount=Math.min(this.slowCount+1,20);else{if(t-this.drawnT<300&&(this.slowCount=Math.max(this.slowCount-1,0)),this.isPlayingAnimation?(this.playingStartTime||(this.playingStartTime=t,this.startingFrame=this.currentFrame),this.jumpToFrame(Math.round((t-this.playingStartTime)*this.data.frameRate/1e3)+this.startingFrame,{animate:!0})):delete this.playingStartTime,this.el["redirect-grab"]&&this.grabbedLayer){let t=this.grabbedLayer,e=this.pool("projection",THREE.Vector3),i=this.pool("diff",THREE.Vector3),n=this.pool("normal",THREE.Vector3),r=this.pool("quat",THREE.Quaternion),a=this.pool("unZ",THREE.Euler);a.copy(this.redirector.object3D.rotation),a.z=0,r.setFromEuler(a),n.set(0,0,-1),i.subVectors(this.redirector.object3D.position,this.el.object3D.position);let o=i.dot(n);n.multiplyScalar(o),e.copy(this.redirector.object3D.position),e.sub(n),t.transform.translation.x=e.x/this.el.components.geometry.data.width*this.width,t.transform.translation.y=-e.y/this.el.components.geometry.data.height*this.height,t.transform.scale.x=this.redirector.object3D.scale.x,t.transform.scale.y=this.redirector.object3D.scale.y,t.transform.rotation=r.angleTo(this.redirector.object3D.quaternion);let s=this.pool("upRot",THREE.Vector3);s.set(0,1,0),s.applyQuaternion(this.redirector.object3D.quaternion),t.transform.rotation*=s.x>0?1:-1,t.touch(),this.updateRedirectorTransformation()}this.data.skipDrawing||(this.data.useNodes?this.drawNodes():this.drawLayers(),this.drawnT=t)}},quickDraw(){this.data.useNodes?this.drawNodes():this.drawLayers()},drawNodes(){let t=[],e=this.allNodes.find((t=>t.solo));e||(e=this.materialNode),e.updateCanvas(this.currentFrame);for(let i in e.inputs){let n=e.inputs[i],r=n.updateTime>this.drawnT||e.updateTime>this.drawnT;t.push({mode:i,draw:n.draw.bind(n),opacity:n.opacity,transform:n.transform,needsUpdate:r,visible:!0,canvas:n.canvas,frames:n.frames||[],frame:n.frame||(()=>n.canvas)})}this.drawLayers(t);for(let t of this.layers)t.updateFrame=t.frameIdx(this.currentFrame)},drawLayers(t){void 0===t&&(t=this.layers);let e=this.compositeCanvas.getContext("2d");e.clearRect(0,0,this.width,this.height);this.width,this.height;let i=this.el.getObject3D("mesh").material,n=this.pool("modesUsed",Set);n.clear();let r=!!this.el.sceneEl.systems["environment-manager"]&&this.el.sceneEl.systems["environment-manager"].canInstallSkybox(),a=this.data.wrapTexture?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,s=!1;for(let l of t){if(!l.visible)continue;if(o.THREED_MODES.indexOf(l.mode)<0){l.updateTime>this.drawnT&&(s=!0),l.draw(e,this.currentFrame);continue}if(!1===l.needsUpdate&&l.updateTime<this.drawnT&&n.add(l.mode),"MeshStandardMaterial"!==i.type&&"MeshMatcapMaterial"!==i.type&&"ShaderMaterial"!==i.type)continue;if(n.has(l.mode))continue;if("envMap"===l.mode&&!r)continue;let t=l.canvas;switch(l.frames.length>1&&(t=l.frame(this.currentFrame)),i[l.mode]||(i[l.mode]=d(),i.needsUpdate=!0),i[l.mode].flipY!=this.data.flipY&&(i[l.mode].flipY=this.data.flipY),i[l.mode].wrapS!==a&&(i[l.mode].wrapS=a,i[l.mode].needsUpdate=!0),i[l.mode].wrapT!==a&&(i[l.mode].wrapT=a,i[l.mode].needsUpdate=!0),i[l.mode].image!==t?(i[l.mode].image=t,i[l.mode].needsUpdate=!0):(l.active||l.needsUpdate||l.updateTime>=this.drawnT)&&(i[l.mode].needsUpdate=!0),l.mode){case"displacementMap":i.displacementBias=0,i.displacementScale=l.opacity;break;case"bumpMap":i.bumpScale=Math.pow(l.opacity,2.2);break;case"emissiveMap":i.emissive&&(i.emissive.r=1,i.emissive.g=1,i.emissive.b=1,i.emissiveIntensity=l.opacity);break;case"normalMap":i.normalScale=new THREE.Vector2(l.opacity,this.data.flipNormal?-l.opacity:l.opacity);break;case"metalnessMap":i.metalness=l.opacity;break;case"roughnessMap":i.roughness=l.opacity;break;case"aoMap":i.aoMapIntensity=l.opacity;for(let t of Compositor.meshes)t.geometry&&t.geometry.attributes.uv&&!t.geometry.attributes.uv2&&(console.log("Cloning to UV2 for aoMap"),t.geometry.attributes.uv2=t.geometry.attributes.uv.clone());break;case"envMap":canInstallSkybox&&this.el.sceneEl.systems["environment-manager"].installSkybox(t,l.opacity),i.envMap.mapping=THREE.SphericalReflectionMapping}n.add(l.mode)}if(this.data.usePreOverlayCanvas){let t=this.preOverlayCanvas.getContext("2d");t.globalCompositeOperation="copy",t.drawImage(this.compositeCanvas,0,0)}if(this.drawOverlay(e),this.el.components["draw-canvas"].transform=this.activeLayer.transform,1!=this.data.textureScale){this.textureCanvas.getContext("2d").drawImage(this.compositeCanvas,0,0,this.textureCanvas.width,this.textureCanvas.height),i.map.image=this.textureCanvas}else i.map.image=this.compositeCanvas;if(i.map.flipY!=this.data.flipY&&(i.map.flipY=this.data.flipY),i.map.needsUpdate=!0,i.map.wrapS=this.data.wrapTexture?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,i.map.wrapT=this.data.wrapTexture?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,"MeshStandardMaterial"===i.type)for(let t of o.THREED_MODES)if("envMap"!=t||r)if(i[t]&&!n.has(t)){switch(t){case"emissiveMap":i.emissiveIntensity=0}i[t]=null,i.needsUpdate=!0}else i[t]&&(i[t].wrapS=this.data.wrapTexture?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,i[t].wrapT=this.data.wrapTexture?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping)},async load(t){this.loading=!0;let e=()=>new Promise((t=>setTimeout(t,10)));this.data.flipY=!1,this.flipUVY(),this.data.flipNormal=t.flipNormal;for(let t of this.layers.slice())console.log("Deleting",t),this.deleteLayer(t),await e();for(let t of this.allNodes.slice())console.log("Deleting",t),this.deleteNode(t),await e();this.data.frameRate=t.frameRate,this.el.setAttribute("compositor",{frameRate:t.frameRate,useNodes:t.useNodes}),this.resize(t.width,t.height),this.data.flipY!=t.flipY&&(console.log("Need to flipUVs"),this.data.flipY=t.flipY,this.flipUVY());let i,n={};for(let r=0;r<t.layers.length;++r){let a=t.layers[r],o=new c(a.width,a.height),s=o.canvas;Object.assign(o,a),o.canvas=s,o.active=!1,o.frames=[s],o.shelfMatrix=(new THREE.Matrix4).fromArray(a.shelfMatrix.elements),n[o.id]=o,a.active&&(i=o);for(let i=0;i<t.canvases[r].length;++i){let n=new Image,a=t.canvases[r][i];for(n.src=a,console.log("Loaded Layer",i,o.id),await e();i>=o.frames.length;)o.insertFrame(o.frames.length);o.frames[i].getContext("2d").drawImage(n,0,0)}await e(),this.layers.push(o),this.el.emit("layeradded",{layer:o}),await e(),this.el.emit("layerupdated",{layer:o}),await e()}this.deleteLayer(this.layers[0]),this.activateLayer(i||this.layers[this.layers.length-1]);let a={};for(let i of t.allNodes){let t=new r[i.type](this);Object.assign(t,i),a[t.id]=t,t.shelfMatrix=(new THREE.Matrix4).fromArray(i.shelfMatrix.elements),"MaterialNode"==i.type&&(this.materialNode=t),this.el.emit("nodeadded",{node:t}),await e()}for(let i of t.allNodes){let t=a[i.id];for(let e of i.connections){if(!e||!e.to)continue;let i=a[e.to]||n[e.to];t.connectInput(i,e)}this.el.emit("nodeconnectionschanged",{node:t}),await e()}this.allNodes.indexOf(this.materialNode)<0&&(this.allNodes.push(this.materialNode),this.el.emit("nodeadded",{node:this.materialNode})),this.loading=!1,console.log("Fully loaded")},resize(t,e,{resample:i=!1,resizeLayers:n=!0,resizeGeometry:r=!0}={}){s.Undo.clearAndResize(t,e);let o=this.width,l=this.height,{width:c,height:u}=a.Util.validateSize({width:t,height:e});if(console.log("Resizing from",o,l,"to",c,u),this.width=c,this.height=u,this.compositeCanvas.width=c,this.compositeCanvas.height=u,this.overlayCanvas.width=this.width,this.overlayCanvas.height=this.height,this.preOverlayCanvas.width=this.width,this.preOverlayCanvas.height=this.height,i){var h=document.createElement("canvas");h.width=c,h.height=u;var d=h.getContext("2d");d.globalCompositeOperation="copy"}for(let t of this.layers)if(i){for(let e of t.frames)console.log("Resampleing",t.id),d.drawImage(e,0,0,c,u),e.width=c,e.height=u,e.getContext("2d").drawImage(h,0,0,c,u);t.width=c,t.height=u}else n&&t.resize(c,u);for(let t of this.allNodes)t.resize(c,u),t.touch();if(this.el.components.geometry){let t=this.width/this.data.baseWidth*this.data.geometryWidth,e=this.height/this.data.baseWidth*this.data.geometryWidth;r&&this.el.setAttribute("geometry",{primitive:"plane",width:t,height:e}),this.flipUVY()}for(let t of this.layers)t.touch(),this.el.emit("layerupdated",{layer:t});this.el.emit("resized",{width:c,height:u})}});window.Compositor=new class{get el(){return this._el||(this._el=document.getElementById("canvas-view")),this._el}get component(){return this.el.components.compositor}get data(){return this.component.data}get material(){return this.el.getObject3D("mesh").material}get mesh(){let t=document.getElementById("composition-view");return t.getObject3D("mesh")&&(t.getObject3D("mesh").getObjectByProperty("type","Mesh")||t.getObject3D("mesh").getObjectByProperty("type","SkinnedMesh"))||this.el.getObject3D("mesh")}get meshRoot(){return document.getElementById("composition-view").getObject3D("mesh")||document.getElementById("canvas-view").getObject3D("mesh")}get meshTransformRoot(){return"Scene"===this.meshRoot.type?this.meshRoot.children[0]:this.meshRoot}get meshes(){if(this.mesh===this._cachedMeshesMesh)return this._meshes;let t=[document.getElementById("composition-view").getObject3D("mesh"),this.el.getObject3D("mesh")];this._meshes=[],this._nonCanvasMeshes=[],this._nonCanvasGeometries=this._nonCanvasGeometries||new Set,this._nonCanvasGeometries.clear();for(let e of t)e&&e.traverse((t=>{t.material===this.material&&this._meshes.push(t)}));for(let t of this._meshes)t!==this.el.getObject3D("mesh")&&(this._nonCanvasMeshes.push(t),t.geometry&&this._nonCanvasGeometries.add(t.geometry));return this._meshes}get nonCanvasMeshes(){if(this.mesh===this._cachedMeshesMesh)return this._nonCanvasMeshes;this.meshes;return this._nonCanvasMeshes}get nonCanvasGeometries(){if(this.mesh===this._cachedMeshesMesh)return this._nonCanvasGeometries;this.meshes;return this._nonCanvasGeometries}get object3D(){let t=document.querySelector("#composition-view");return t.getObject3D("mesh")?t.object3D:this.el.object3D}get drawableCanvas(){return this.component.activeLayer.frame(this.component.currentFrame)}}},function(t,e,i){"use strict";i.r(e);var n=i(2),r=i(11),a=i(30),o=i(22),s=i(4),l=i(0),c=i(3),u=i(8);i(33);function h(){return new Worker(i.p+"vartiste-toolkit.worker.js")}var d=i(44),p=i(180);window.CompressionWorker=h,l.Util.registerComponentSystem("settings-system",{schema:{addReferences:{default:!1},exportJPEG:{default:!1},compressProject:{default:!0}},events:{startcanvasdrawing:function(t){if(!this.el.systems["low-power"].isLowPower())return;console.log("startdraw",t);let e=this.uiRoot||document.querySelector("#ui");this.uiRoot=e,this.wasUIShown=e.getAttribute("visible"),this.wasUIShown&&e.setAttribute("visible",!1)},enddrawing:function(t){if(!this.el.systems["low-power"].isLowPower())return;let e=this.uiRoot||document.querySelector("#ui");this.uiRoot=e,this.wasUIShown&&e.setAttribute("visible",!0),delete this.wasUIShown}},init(){console.log("Starting settings"),this.projectName="vartiste-project",this.quality=1,this.el.emit("projectnamechanged"),this.mediumStabilizationAction(),this.fullQualityAction(),c.Pool.init(this),this.clipboardInput=document.createElement("input"),document.body.append(this.clipboardInput),this.saveAction=l.Util.busify({title:"Saving..."},this.saveAction,this),this.storeToBrowserAction=l.Util.busify({title:"Saving..."},this.storeToBrowserAction,this),this.loadFromBrowser=l.Util.busify({title:"Loading..."},this.loadFromBrowser,this),this.export3dAction=l.Util.busify({title:"Exporting..."},this.export3dAction,this),this.load=l.Util.busify({title:"Loading..."},this.load,this)},popup(t,e){this.el.emit("open-popup",`Attempted to open a poup for ${e}. You may need to take off your headset to view it. You may also need to disable your popup blocker.`),window.open(t);let i=document.createElement("a");i.href=t,i.style="z-index: 10000; position: absolute; top: 50%; left: 50%; padding: 5px; background-color: #eee; transform: translate(-50%,-50%)",i.innerHTML="Open "+e},download(t,e,i){this.el.emit("open-popup",`Attempted to download the ${i}. You may need to take off your headset to download it.`),"string"!=typeof e&&(e=this.makeFileName(e));let n=document.createElement("a");n.href=t,n.style="z-index: 10000; position: absolute; top: 50%; left: 50%; padding: 5px; background-color: #eee; transform: translate(-50%,-50%)",n.innerHTML="Open "+i,n.download=e,n.click(),u.a.play("confirmation",this.el,{volume:.7})},async downloadCompressed(t,e,i){let n,a=this.el.sceneEl.systems["busy-indicator"].busy({title:i}),o=new h;try{n=await new Promise(((e,i)=>{o.onmessage=t=>{e(t.data)},o.onerror=i,o.postMessage(t)}))}finally{o.terminate()}this.download("data:application/x-binary;base64,"+Object(r.a)(n),e,i),a.done(),u.a.play("confirmation",this.el,{volume:.7})},copyToClipboard(t,e){this.clipboardInput.value=t,this.clipboardInput.select(),this.clipboardInput.setSelectionRange(0,99999),document.execCommand("copy"),this.el.emit("open-popup",`Attempted to copy ${e} to the clipboard!`)},makeFileName({extension:t="",suffix:e}){return e&&(e=`-${e}`),`${this.projectName}-${this.formatFileDate()}${e}.${t}`},imageURLType(t){return t?this.data.exportJPEG&&l.Util.isCanvasFullyOpaque(t)?"image/jpeg":"image/png":this.data.exportJPEG?"image/jpeg":"image/png"},compressionQuality(){return this.compressionQualityOverride?this.compressionQualityOverride:this.data.exportJPEG?.85:void 0},imageExtension(){return this.data.exportJPEG?"jpg":"png"},exportAction({suffix:t=""}={}){let e=document.getElementById("canvas-view").components.compositor,i=new Image;if(i.src=e.preOverlayCanvas.toDataURL(this.imageURLType(),this.compressionQuality()),i.style="z-index: 10000; position: absolute; top: 0px; left: 0px",t&&(t=`-${t}`),this.download(i.src,`${this.projectName}-${this.formatFileDate()}${t}.${this.imageExtension()}`,"Canvas Images"),e.data.useNodes)for(let e of n.THREED_MODES)Compositor.material[e]&&Compositor.material[e].image&&this.download(Compositor.material[e].image.toDataURL(this.imageURLType(),this.compressionQuality()),`${this.projectName}-${this.formatFileDate()}${t}-${e}.${this.imageExtension()}`,e);else for(let i of n.THREED_MODES)for(let n of e.layers)n.mode===i&&this.download(n.canvas.toDataURL(this.imageURLType(),this.compressionQuality()),`${this.projectName}-${this.formatFileDate()}${t}-${i}.${this.imageExtension()}`,i)},async saveAction(){let t=document.getElementById("canvas-view").components.compositor,e=await o.a.save({compositor:t}),i=document.getElementById("composition-view");i&&i.emit("updatemesh");let n=JSON.stringify(e);if(this.data.compressProject){let t;console.time("compressProject");let e=new h;try{t=await new Promise(((t,i)=>{e.onmessage=e=>{t(e.data)},e.onerror=i,e.postMessage(n)}))}finally{e.terminate()}console.timeEnd("compressProject"),this.download("data:application/x-binary;base64,"+Object(r.a)(t),`${this.projectName}-${this.formatFileDate()}.vartistez`,"Project File")}else{let t=encodeURIComponent(n);this.download("data:application/x-binary,"+t,`${this.projectName}-${this.formatFileDate()}.vartiste`,"Project File")}},getPreview({width:t=64,height:e=64}={}){let i=Compositor.component,n=document.createElement("canvas");return n.width=t,n.height=e,n.getContext("2d").drawImage(i.preOverlayCanvas,0,0,t,e),n.toDataURL()},openProjectsDB(){let t=new p.a("project_database");return t.version(1).stores({projects:"name, modified",previews:"name"}),t},async storeToBrowserAction(){let t=JSON.stringify(await o.a.save({compositor:Compositor.component})),e=this.openProjectsDB();await e.transaction("rw",e.projects,e.previews,(async()=>{await e.projects.put({name:this.projectName,projectData:t,modified:new Date}),await e.previews.put({name:this.projectName,src:this.getPreview()})})),this.el.emit("open-popup",`Saved at ${new Date}`),document.getElementById("composition-view").emit("updatemesh")},async loadFromBrowser(t){let e=this.openProjectsDB(),i=await e.projects.get(t);this.load(i.projectData)},async deleteFromBrowser(t){let e=this.openProjectsDB();await e.projects.delete(t)},async getExportableGLB(t,{undoStack:e}={}){let i,n=t,r=n.material||Compositor.material;function o(t){t.extensions||(t.extensions={}),AFRAME.utils.extendDeep(t.extensions,n.userData.gltfExtensions)}n||(n=Compositor.meshRoot,r=Compositor.material,i=r.map.image,r.map.image=Compositor.component.preOverlayCanvas,r.map.needsUpdate=!0),n.traverseVisible((t=>{(t.geometry||t.material)&&Object(a.prepareModelForExport)(t,t.material,{undoStack:e})}));let s=this.el.sceneEl.systems["animation-3d"];if(s){let t=s.generateAnimation(n);n.animations?n.animations.push(t):n.animations=[t]}let l=new THREE.GLTFExporter,c=await new Promise(((t,e)=>{l.parse(n,t,{binary:!0,animations:n.animations||[],includeCustomExtensions:!0,mimeType:this.imageURLType(),imageQuality:this.compressionQuality(),postProcessJSON:o})}));return r.map&&i&&(r.map.image=i,r.map.needsUpdate=!0),c},async export3dAction(t,{extension:e}={}){t||(t=Compositor.meshRoot);let i=new s.UndoStack({maxSize:-1}),n=await this.getExportableGLB(t,{undoStack:i});for(!e&&t.userData&&t.userData.gltfExtensions&&t.userData.gltfExtensions.VRM?e="vrm":e||(e="glb"),this.download("data:application:/x-binary;base64,"+Object(r.a)(n),`${this.projectName}-${this.formatFileDate()}.${e}`,"GLB File");i.stack.length;)i.undo();document.getElementById("composition-view").emit("updatemesh")},async exportSketchfabAction(){this.el.systems.sketchfab.loggedIn()?this.el.systems.sketchfab.upload():this.el.systems.sketchfab.login()},async recordAction(){let t=document.getElementById("canvas-view").components.compositor;this.compositeRecorder?(await this.compositeRecorder.stop(),this.download(this.compositeRecorder.createURL(),`${this.projectName}-${this.formatFileDate()}.webm`,"Video Recording"),t.data.drawOverlay=!0,delete this.compositeRecorder):(this.compositeRecorder=new d.a({canvas:t.preOverlayCanvas,frameRate:t.data.frameRate}),t.data.drawOverlay=!1,this.compositeRecorder.start())},addModelView(t,{replace:e=!0,forceAutoScale:i,undo:n=!0}={}){let r=document.getElementById("composition-view"),a=t.scene||t.scenes[0];if(r.getObject3D("mesh")||(e=!0),(i||this.el.sceneEl.components["file-upload"].data.autoscaleModel&&e)&&l.Util.autoScaleViewer(a,r),r.setAttribute("shadow","cast: true; receive: true"),n){let i=r.getObject3D("mesh");s.Undo.collect((()=>{s.Undo.pushObjectMatrix(Compositor.el.object3D),s.Undo.push((()=>{let n=t.scene||t.scenes[0];e&&(i?r.setObject3D("mesh",i):delete r.object3DMap.mesh),n.parent.remove(n)}))}))}if(e)r.setObject3D("mesh",t.scene||t.scenes[0]);else{let e=t.scene||t.scenes[0];e.el=r,e.traverse((t=>t.el=r)),Compositor.meshRoot.add(e),Compositor._cachedMeshesMesh=null,r.emit("updatemesh")}r.setAttribute("composition-viewer","compositor: #canvas-view"),Compositor.el.setAttribute("compositor",{wrapTexture:!0}),a.traverse((t=>{t.geometry&&t.geometry.attributes.position&&t.geometry.attributes.position.count>6&&t.geometry.computeBoundsTree()}));let o=Compositor.el;o.setAttribute("position","-0.33131340738157977 0.6952806276999972 0.33044786242701646"),o.setAttribute("rotation","-24.590389275038515 35.81312512886439 1.0193681034761404"),o.setAttribute("scale","0.002 0.002 0.002")},async load(t){window.isLoadingProject=!0;let e=JSON.parse(t);await o.a.load(e,{compositor:document.getElementById("canvas-view").components.compositor}),window.isLoadingProject=!1,window.loadedSuccessfully=!0},helpAction(){this.popup("landing.html","Instructions")},feedbackAction(){this.popup("https://forms.gle/SnNFFLyPve3kQc7Y9","Feedback Survey")},formatFileDate:()=>(new Date).toJSON().split(":")[0],setQuality(t){Compositor.el.setAttribute("compositor",{textureScale:t}),this.quality=t,this.el.emit("qualitychanged",{quality:t})},lowQualityAction(){this.setQuality(.25)},mediumQualityAction(){this.setQuality(.5)},fullQualityAction(){this.setQuality(1)},setStabilizeAmount(t){document.querySelectorAll("*[smoothed-webxr-motion-controller]").forEach((e=>e.setAttribute("smoothed-webxr-motion-controller",{amount:t}))),this.el.emit("stabilizationchanged",{stabilization:t})},noStabilizationAction(){this.setStabilizeAmount(0)},mediumStabilizationAction(){this.setStabilizeAmount(.8)},maxStabilizationAction(){this.setStabilizeAmount(.95)},undoAction(){s.Undo.undo()},toggleUndoAction(){s.Undo.enabled=!s.Undo.enabled},setProjectName(t){this.projectName=t,this.hasSetProjectName=!0,this.el.emit("projectnamechanged",{name:t})},toggleUIAction(){let t=this.uiRoot||document.querySelector("#ui");this.uiRoot=t,t.setAttribute("visible",!t.getAttribute("visible"));for(let t of document.querySelectorAll("*[raycaster]"))t.components.raycaster.refreshObjects()}}),l.Util.registerComponentSystem("export-3d-helper-system",{schema:{exportCanvas:{default:!0,selector:"#canvas-view"},exportMesh:{default:!0,selector:"#composition-view"},exportShapes:{default:!0,selector:"#shape-root"},exportReferenceObjects:{default:!0,selector:"#reference-spawn"},exportReferenceImages:{default:!1,selector:"#reference-spawn"}},async runExportFn(t){let e=[];for(let t in this.schema)this.data[t]&&e.push(this.el.sceneEl.querySelector(this.schema[t].selector));if(1===e.length)return void await t(e[0].object3D);let i=new Map;for(let t in this.schema){let e=this.el.sceneEl.querySelector(this.schema[t].selector);i.set(e,{visible:e.object3D.visible}),this.data[t]?e.object3D.visible=!0:e.object3D.visible=!1}let n=Compositor.material.map.image;Compositor.material.map.image=Compositor.component.preOverlayCanvas,Compositor.material.map.needsUpdate=!0;try{await t(this.el.sceneEl.querySelector("#canvas-root").object3D)}finally{for(let[t,e]of i.entries())t.object3D.visible=e.visible;Compositor.material.map.image=n,Compositor.material.map.needsUpdate=!0}},export3dAction(){this.runExportFn((async t=>{this.el.sceneEl.systems["settings-system"].export3dAction(t)}))},cloneAsReference(){this.runExportFn((async t=>{let e=document.createElement("a-entity");e.setAttribute("reference-glb",""),e.classList.add("clickable"),document.querySelector("#reference-spawn").append(e);let i=Compositor.component.frozenMaterial(),n=t.clone(!0);n.traverse((t=>{if(t.material&&t.material===Compositor.material&&(t.material=i),"SkinnedMesh"===t.type){let e=Compositor.meshes.find((e=>e.name===t.name));if(!e)return;t.bind(new THREE.Skeleton(e.skeleton.bones.map((t=>t.clone())),e.skeleton.boneInverses.map((t=>(new THREE.Matrix4).copy(t)))),(new THREE.Matrix4).copy(e.bindMatrix))}})),n.matrix.identity(),e.setObject3D("mesh",n),await l.Util.whenLoaded(e),l.Util.positionObject3DAtTarget(e.object3D,t),console.log("Setting reference",n,e)}))}})}]);